var Rm=Object.defineProperty;var Mm=(i,e,t)=>e in i?Rm(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Qe=(i,e,t)=>(Mm(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Oe(){}const Im=i=>i;function Ce(i,e){for(const t in e)i[t]=e[t];return i}function Bf(i){return i()}function hl(){return Object.create(null)}function Lt(i){i.forEach(Bf)}function ii(i){return typeof i=="function"}function Ve(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function Lm(i){return Object.keys(i).length===0}function xo(i,...e){if(i==null){for(const n of e)n(void 0);return Oe}const t=i.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ht(i){let e;return xo(i,t=>e=t)(),e}function Ct(i,e,t){i.$$.on_destroy.push(xo(e,t))}function gt(i,e,t,n){if(i){const r=Uf(i,e,t,n);return i[0](r)}}function Uf(i,e,t,n){return i[1]&&n?Ce(t.ctx.slice(),i[1](n(e))):t.ctx}function pt(i,e,t,n){if(i[2]&&n){const r=i[2](n(t));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],l=Math.max(e.dirty.length,r.length);for(let a=0;a<l;a+=1)s[a]=e.dirty[a]|r[a];return s}return e.dirty|r}return e.dirty}function vt(i,e,t,n,r,s){if(r){const l=Uf(e,t,n,s);i.p(l,r)}}function bt(i){if(i.ctx.length>32){const e=[],t=i.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function je(i){const e={};for(const t in i)t[0]!=="$"&&(e[t]=i[t]);return e}function Xe(i,e){const t={};e=new Set(e);for(const n in i)!e.has(n)&&n[0]!=="$"&&(t[n]=i[n]);return t}function jc(i){const e={};for(const t in i)e[t]=!0;return e}function dl(i){return i??""}function Jt(i,e,t){return i.set(t),e}function At(i){return i&&ii(i.destroy)?i.destroy:Oe}const jf=typeof window<"u";let Nm=jf?()=>window.performance.now():()=>Date.now(),Vc=jf?i=>requestAnimationFrame(i):Oe;const Ir=new Set;function Vf(i){Ir.forEach(e=>{e.c(i)||(Ir.delete(e),e.f())}),Ir.size!==0&&Vc(Vf)}function Fm(i){let e;return Ir.size===0&&Vc(Vf),{promise:new Promise(t=>{Ir.add(e={c:i,f:t})}),abort(){Ir.delete(e)}}}const zc=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ae(i,e){i.appendChild(e)}function zf(i){if(!i)return document;const e=i.getRootNode?i.getRootNode():i.ownerDocument;return e&&e.host?e:i.ownerDocument}function Bm(i){const e=ve("style");return e.textContent="/* empty */",Um(zf(i),e),e.sheet}function Um(i,e){return ae(i.head||i,e),e.sheet}function $(i,e,t){i.insertBefore(e,t||null)}function K(i){i.parentNode&&i.parentNode.removeChild(i)}function Wc(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function ve(i){return document.createElement(i)}function et(i){return document.createTextNode(i)}function ue(){return et(" ")}function Rt(){return et("")}function Ge(i,e,t,n){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t,n)}function ki(i){return function(e){return e.preventDefault(),i.call(this,e)}}function jm(i){return function(e){return e.stopPropagation(),i.call(this,e)}}function te(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}const Vm=["width","height"];function Ss(i,e){const t=Object.getOwnPropertyDescriptors(i.__proto__);for(const n in e)e[n]==null?i.removeAttribute(n):n==="style"?i.style.cssText=e[n]:n==="__value"?i.value=i[n]=e[n]:t[n]&&t[n].set&&Vm.indexOf(n)===-1?i[n]=e[n]:te(i,n,e[n])}function zm(i,e){Object.keys(e).forEach(t=>{as(i,t,e[t])})}function as(i,e,t){e in i?i[e]=typeof i[e]=="boolean"&&t===""?!0:t:te(i,e,t)}function fo(i){return/-/.test(i)?zm:Ss}function Wm(i){return Array.from(i.childNodes)}function ui(i,e){e=""+e,i.data!==e&&(i.data=e)}function ho(i,e){i.value=e??""}function bi(i,e,t,n){t==null?i.style.removeProperty(e):i.style.setProperty(e,t,n?"important":"")}let zs;function Xm(){if(zs===void 0){zs=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{zs=!0}}return zs}function Hm(i,e){getComputedStyle(i).position==="static"&&(i.style.position="relative");const n=ve("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=Xm();let s;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=Ge(window,"message",l=>{l.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{s=Ge(n.contentWindow,"resize",e),e()}),ae(i,n),()=>{(r||s&&n.contentWindow)&&s(),K(n)}}function ei(i,e,t){i.classList.toggle(e,!!t)}function Wf(i,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(i,{detail:e,bubbles:t,cancelable:n})}function Dt(i,e){return new i(e)}const mo=new Map;let go=0;function Ym(i){let e=5381,t=i.length;for(;t--;)e=(e<<5)-e^i.charCodeAt(t);return e>>>0}function Gm(i,e){const t={stylesheet:Bm(e),rules:{}};return mo.set(i,t),t}function ml(i,e,t,n,r,s,l,a=0){const o=16.666/n;let c=`{
`;for(let g=0;g<=1;g+=o){const v=e+(t-e)*s(g);c+=g*100+`%{${l(v,1-v)}}
`}const f=c+`100% {${l(t,1-t)}}
}`,u=`__svelte_${Ym(f)}_${a}`,d=zf(i),{stylesheet:h,rules:m}=mo.get(d)||Gm(d,i);m[u]||(m[u]=!0,h.insertRule(`@keyframes ${u} ${f}`,h.cssRules.length));const p=i.style.animation||"";return i.style.animation=`${p?`${p}, `:""}${u} ${n}ms linear ${r}ms 1 both`,go+=1,u}function Jm(i,e){const t=(i.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),r=t.length-n.length;r&&(i.style.animation=n.join(", "),go-=r,go||qm())}function qm(){Vc(()=>{go||(mo.forEach(i=>{const{ownerNode:e}=i.stylesheet;e&&K(e)}),mo.clear())})}let ks;function hs(i){ks=i}function ht(){if(!ks)throw new Error("Function called outside component initialization");return ks}function Ui(i){ht().$$.on_mount.push(i)}function Xf(i){ht().$$.on_destroy.push(i)}function Gr(){const i=ht();return(e,t,{cancelable:n=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=Wf(e,t,{cancelable:n});return r.slice().forEach(l=>{l.call(i,s)}),!s.defaultPrevented}return!0}}function Hf(i,e){return ht().$$.context.set(i,e),e}function Yf(i){return ht().$$.context.get(i)}function Xc(i,e){const t=i.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const xr=[],Fe=[];let Lr=[];const tc=[],Km=Promise.resolve();let ic=!1;function Qm(){ic||(ic=!0,Km.then(Gf))}function ri(i){Lr.push(i)}function lt(i){tc.push(i)}const xa=new Set;let wr=0;function Gf(){if(wr!==0)return;const i=ks;do{try{for(;wr<xr.length;){const e=xr[wr];wr++,hs(e),Zm(e.$$)}}catch(e){throw xr.length=0,wr=0,e}for(hs(null),xr.length=0,wr=0;Fe.length;)Fe.pop()();for(let e=0;e<Lr.length;e+=1){const t=Lr[e];xa.has(t)||(xa.add(t),t())}Lr.length=0}while(xr.length);for(;tc.length;)tc.pop()();ic=!1,xa.clear(),hs(i)}function Zm(i){if(i.fragment!==null){i.update(),Lt(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(ri)}}function $m(i){const e=[],t=[];Lr.forEach(n=>i.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Lr=e}let Zr;function eg(){return Zr||(Zr=Promise.resolve(),Zr.then(()=>{Zr=null})),Zr}function Aa(i,e,t){i.dispatchEvent(Wf(`${e?"intro":"outro"}${t}`))}const Ks=new Set;let bn;function Je(){bn={r:0,c:[],p:bn}}function qe(){bn.r||Lt(bn.c),bn=bn.p}function T(i,e){i&&i.i&&(Ks.delete(i),i.i(e))}function E(i,e,t,n){if(i&&i.o){if(Ks.has(i))return;Ks.add(i),bn.c.push(()=>{Ks.delete(i),n&&(t&&i.d(1),n())}),i.o(e)}else n&&n()}const tg={duration:0};function jt(i,e,t,n){let s=e(i,t,{direction:"both"}),l=n?0:1,a=null,o=null,c=null,f;function u(){c&&Jm(i,c)}function d(m,p){const g=m.b-l;return p*=Math.abs(g),{a:l,b:m.b,d:g,duration:p,start:m.start,end:m.start+p,group:m.group}}function h(m){const{delay:p=0,duration:g=300,easing:v=Im,tick:b=Oe,css:y}=s||tg,_={start:Nm()+p,b:m};m||(_.group=bn,bn.r+=1),"inert"in i&&(m?f!==void 0&&(i.inert=f):(f=i.inert,i.inert=!0)),a||o?o=_:(y&&(u(),c=ml(i,l,m,g,p,v,y)),m&&b(0,1),a=d(_,g),ri(()=>Aa(i,m,"start")),Fm(S=>{if(o&&S>o.start&&(a=d(o,g),o=null,Aa(i,a.b,"start"),y&&(u(),c=ml(i,l,a.b,a.duration,0,v,s.css))),a){if(S>=a.end)b(l=a.b,1-l),Aa(i,a.b,"end"),o||(a.b?u():--a.group.r||Lt(a.group.c)),a=null;else if(S>=a.start){const C=S-a.start;l=a.a+a.d*v(C/a.duration),b(l,1-l)}}return!!(a||o)}))}return{run(m){ii(s)?eg().then(()=>{s=s({direction:m?"in":"out"}),h(m)}):h(m)},end(){u(),a=o=null}}}function zr(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function ut(i,e){const t={},n={},r={$$scope:1};let s=i.length;for(;s--;){const l=i[s],a=e[s];if(a){for(const o in l)o in a||(n[o]=1);for(const o in a)r[o]||(t[o]=a[o],r[o]=1);i[s]=a}else for(const o in l)r[o]=1}for(const l in n)l in t||(t[l]=void 0);return t}function tt(i){return typeof i=="object"&&i!==null?i:{}}function nt(i,e,t){const n=i.$$.props[e];n!==void 0&&(i.$$.bound[n]=t,t(i.$$.ctx[n]))}function V(i){i&&i.c()}function U(i,e,t){const{fragment:n,after_update:r}=i.$$;n&&n.m(e,t),ri(()=>{const s=i.$$.on_mount.map(Bf).filter(ii);i.$$.on_destroy?i.$$.on_destroy.push(...s):Lt(s),i.$$.on_mount=[]}),r.forEach(ri)}function j(i,e){const t=i.$$;t.fragment!==null&&($m(t.after_update),Lt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ig(i,e){i.$$.dirty[0]===-1&&(xr.push(i),Qm(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function He(i,e,t,n,r,s,l=null,a=[-1]){const o=ks;hs(i);const c=i.$$={fragment:null,ctx:[],props:s,update:Oe,not_equal:r,bound:hl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:hl(),dirty:a,skip_bound:!1,root:e.target||o.$$.root};l&&l(c.root);let f=!1;if(c.ctx=t?t(i,e.props||{},(u,d,...h)=>{const m=h.length?h[0]:d;return c.ctx&&r(c.ctx[u],c.ctx[u]=m)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](m),f&&ig(i,u)),d}):[],c.update(),f=!0,Lt(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const u=Wm(e.target);c.fragment&&c.fragment.l(u),u.forEach(K)}else c.fragment&&c.fragment.c();e.intro&&T(i.$$.fragment),U(i,e.target,e.anchor),Gf()}hs(o)}class Ye{constructor(){Qe(this,"$$");Qe(this,"$$set")}$destroy(){j(this,1),this.$destroy=Oe}$on(e,t){if(!ii(t))return Oe;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!Lm(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ng="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ng);const rg="/call/assets/tabler.min-e4d0db7f.css",Pr=[];function sg(i,e){return{subscribe:Nt(i,e).subscribe}}function Nt(i,e=Oe){let t;const n=new Set;function r(a){if(Ve(i,a)&&(i=a,t)){const o=!Pr.length;for(const c of n)c[1](),Pr.push(c,i);if(o){for(let c=0;c<Pr.length;c+=2)Pr[c][0](Pr[c+1]);Pr.length=0}}}function s(a){r(a(i))}function l(a,o=Oe){const c=[a,o];return n.add(c),n.size===1&&(t=e(r,s)||Oe),a(i),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:r,update:s,subscribe:l}}function og(i,e,t){const n=!Array.isArray(i),r=n?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return sg(t,(l,a)=>{let o=!1;const c=[];let f=0,u=Oe;const d=()=>{if(f)return;u();const m=e(n?c[0]:c,l,a);s?l(m):u=ii(m)?m:Oe},h=r.map((m,p)=>xo(m,g=>{c[p]=g,f&=~(1<<p),o&&d()},()=>{f|=1<<p}));return o=!0,d(),function(){Lt(h),u(),o=!1}})}var po=function(){return po=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},po.apply(this,arguments)};function ag(i){return i.toLowerCase()}var cg=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],lg=/[^A-Z0-9]+/gi;function ug(i,e){e===void 0&&(e={});for(var t=e.splitRegexp,n=t===void 0?cg:t,r=e.stripRegexp,s=r===void 0?lg:r,l=e.transform,a=l===void 0?ag:l,o=e.delimiter,c=o===void 0?" ":o,f=gl(gl(i,n,"$1\0$2"),s,"\0"),u=0,d=f.length;f.charAt(u)==="\0";)u++;for(;f.charAt(d-1)==="\0";)d--;return f.slice(u,d).split("\0").map(a).join(c)}function gl(i,e,t){return e instanceof RegExp?i.replace(e,t):e.reduce(function(n,r){return n.replace(r,t)},i)}function fg(i,e){return e===void 0&&(e={}),ug(i,po({delimiter:"."},e))}function pl(i,e){return e===void 0&&(e={}),fg(i,po({delimiter:"-"},e))}const hg="y",Ze=(i,e,t)=>{if(!i)return;i=pl(i);const n=`${hg}-${i}`,r=[n];if(e){const s=Object.entries(e);for(const[l,a]of s){const o=pl(l);if(!(typeof a>"u"||a===!1))if(a===!0)r.push(`${n}-${o}`);else if(typeof a=="number"||typeof a=="string")r.push(`${n}-${o}-${a}`);else continue}}return t&&r.push(t),r.join(" ")||void 0};function vl(i,e){var t;return console.log(e),typeof e>"u"?"":(t=Ze(i,{show:e}))==null?void 0:t.split(" ")[1]}function dg({element:i,componentName:e,show:t}){if(typeof window>"u")return;let r=getComputedStyle(i).getPropertyValue("--show-config").trim()??"default",s=typeof t<"u"?t?"opened":"closed":void 0,l,a=" "+vl(e,s);const{subscribe:o,set:c}=Nt({classes:a,styles:""});function f(p){clearTimeout(l),s=p;let g=" "+vl(e,s),v="";r==="height"&&(["open","closing"].includes(s)&&(v="max-height: 0;"),["opening","close"].includes(s)&&(v=`max-height: ${i.scrollHeight}px;`),["opened","closed"].includes(s)&&(v="")),c({styles:v,classes:g})}function u(){try{const p=window.getComputedStyle(i),g=[p.animationDelay,p.transitionDelay,p.animationDuration,p.transitionDuration].map((v="0s")=>parseFloat(v)*(/ms/g.test(v)?1:1e3));return Math.max(...g.slice(0,2))+Math.max(...g.slice(2))}catch{return 0}}function d(p){requestAnimationFrame(()=>setTimeout(p))}function h(){s!=="opened"&&d(()=>{f("open"),d(()=>{f("opening"),d(()=>{l=setTimeout(()=>{t=void 0,f("opened")},u())})})})}function m(){s!=="closed"&&d(()=>{f("close"),d(()=>{f("closing"),d(()=>{l=setTimeout(()=>{t=void 0,f("closed")},u())})})})}return{enter:h,leave:m,subscribe:o}}const nc="!",mg=new RegExp(`^[^${nc}]+(?:${nc}(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$`);function Er(i,e=[]){let t;const n=[];i.$on=(s,l)=>{const a=s;let o=()=>{};for(const c of e){if(typeof c=="string"&&c===a){const f=i.$$.callbacks[a]||(i.$$.callbacks[a]=[]);return f.push(l),()=>{const u=f.indexOf(l);u!==-1&&f.splice(u,1)}}if(typeof c=="object"&&c.name===a){const f=l;l=(...u)=>{typeof c=="object"&&c.shouldExclude()||f(...u)}}}return t?o=t(a,l):n.push([a,l]),()=>{o()}};function r(s){Xc(i,s)}return s=>{const l=[],a={};t=(o,c)=>{let f=o,u=c,d=!1;if(f.match(mg)){const g=f.split(nc);f=g[0];const v=Object.fromEntries(g.slice(1).map(b=>[b,!0]));v.passive&&(d=d||{},d.passive=!0),v.nonpassive&&(d=d||{},d.passive=!1),v.capture&&(d=d||{},d.capture=!0),v.once&&(d=d||{},d.once=!0),v.preventDefault&&(u=ki(u)),v.stopPropagation&&(u=jm(u))}const m=Ge(s,f,u,d),p=()=>{m();const g=l.indexOf(p);g>-1&&l.splice(g,1)};return l.push(p),f in a||(a[f]=Ge(s,f,r)),p};for(let o=0;o<n.length;o++)t(n[o][0],n[o][1]);return{destroy:()=>{for(let o=0;o<l.length;o++)l[o]();for(const o of Object.entries(a))o[1]()}}}}function gg(i){let e=i[2],t,n=i[2]&&Da(i);return{c(){n&&n.c(),t=Rt()},m(r,s){n&&n.m(r,s),$(r,t,s)},p(r,s){r[2]?e?Ve(e,r[2])?(n.d(1),n=Da(r),e=r[2],n.c(),n.m(t.parentNode,t)):n.p(r,s):(n=Da(r),e=r[2],n.c(),n.m(t.parentNode,t)):e&&(n.d(1),n=null,e=r[2])},i:Oe,o:Oe,d(r){r&&K(t),n&&n.d(r)}}}function pg(i){let e,t,n,r=[i[12],i[4]],s={};for(let l=0;l<r.length;l+=1)s=Ce(s,r[l]);return{c(){e=ve("textarea"),Ss(e,s)},m(l,a){$(l,e,a),e.autofocus&&e.focus(),i[144](e),ho(e,i[1]),t||(n=[At(i[6].call(null,e)),At(i[7].call(null,e)),At(i[8].call(null,e)),At(i[9].call(null,e)),At(i[10].call(null,e)),At(i[5].call(null,e)),Ge(e,"input",i[145])],t=!0)},p(l,a){Ss(e,s=ut(r,[a[0]&4096&&l[12],a[0]&16&&l[4]])),a[0]&2&&ho(e,l[1])},i:Oe,o:Oe,d(l){l&&K(e),i[144](null),t=!1,Lt(n)}}}function vg(i){let e,t,n,r=[i[12],i[4]],s={};for(let l=0;l<r.length;l+=1)s=Ce(s,r[l]);return{c(){e=ve("input"),Ss(e,s)},m(l,a){$(l,e,a),e.autofocus&&e.focus(),i[142](e),ho(e,i[1]),t||(n=[At(i[6].call(null,e)),At(i[7].call(null,e)),At(i[8].call(null,e)),At(i[9].call(null,e)),At(i[10].call(null,e)),At(i[5].call(null,e)),Ge(e,"input",i[143])],t=!0)},p(l,a){Ss(e,s=ut(r,[a[0]&4096&&l[12],a[0]&16&&l[4]])),a[0]&2&&e.value!==l[1]&&ho(e,l[1])},i:Oe,o:Oe,d(l){l&&K(e),i[142](null),t=!1,Lt(n)}}}function bg(i){let e=i[2],t,n,r=i[2]&&Ra(i);return{c(){r&&r.c(),t=Rt()},m(s,l){r&&r.m(s,l),$(s,t,l),n=!0},p(s,l){s[2]?e?Ve(e,s[2])?(r.d(1),r=Ra(s),e=s[2],r.c(),r.m(t.parentNode,t)):r.p(s,l):(r=Ra(s),e=s[2],r.c(),r.m(t.parentNode,t)):e&&(r.d(1),r=null,e=s[2])},i(s){n||(T(r,s),n=!0)},o(s){E(r,s),n=!1},d(s){s&&K(t),r&&r.d(s)}}}function Da(i){let e,t,n,r=[i[12],i[4]],s={};for(let l=0;l<r.length;l+=1)s=Ce(s,r[l]);return{c(){e=ve(i[2]),fo(i[2])(e,s)},m(l,a){$(l,e,a),i[146](e),t||(n=[At(i[6].call(null,e)),At(i[7].call(null,e)),At(i[8].call(null,e)),At(i[9].call(null,e)),At(i[10].call(null,e)),At(i[5].call(null,e))],t=!0)},p(l,a){fo(l[2])(e,s=ut(r,[a[0]&4096&&l[12],a[0]&16&&l[4]]))},d(l){l&&K(e),i[146](null),t=!1,Lt(n)}}}function Ra(i){let e,t,n,r;const s=i[140].default,l=gt(s,i,i[139],null);let a=[i[12],i[4]],o={};for(let c=0;c<a.length;c+=1)o=Ce(o,a[c]);return{c(){e=ve(i[2]),l&&l.c(),fo(i[2])(e,o)},m(c,f){$(c,e,f),l&&l.m(e,null),i[141](e),t=!0,n||(r=[At(i[6].call(null,e)),At(i[7].call(null,e)),At(i[8].call(null,e)),At(i[9].call(null,e)),At(i[10].call(null,e)),At(i[5].call(null,e))],n=!0)},p(c,f){l&&l.p&&(!t||f[4]&32768)&&vt(l,s,c,c[139],t?pt(s,c[139],f,null):bt(c[139]),null),fo(c[2])(e,o=ut(a,[f[0]&4096&&c[12],f[0]&16&&c[4]]))},i(c){t||(T(l,c),t=!0)},o(c){E(l,c),t=!1},d(c){c&&K(e),l&&l.d(c),i[141](null),n=!1,Lt(r)}}}function yg(i){let e,t,n,r;const s=[bg,vg,pg,gg],l=[];function a(o,c){return o[11].default?0:o[2]==="input"?1:o[2]==="textarea"?2:3}return e=a(i),t=l[e]=s[e](i),{c(){t.c(),n=Rt()},m(o,c){l[e].m(o,c),$(o,n,c),r=!0},p(o,c){let f=e;e=a(o),e===f?l[e].p(o,c):(Je(),E(l[f],1,1,()=>{l[f]=null}),qe(),t=l[e],t?t.p(o,c):(t=l[e]=s[e](o),t.c()),T(t,1),t.m(n.parentNode,n))},i(o){r||(T(t),r=!0)},o(o){E(t),r=!1},d(o){o&&K(n),l[e].d(o)}}}let _g=0;const Ma="el",Cg="div";function Sg(i,e,t){const n=["element","componentName","id","tag","cssProps","value","title","tabindex","role","ariaCurrent","ariaLabel","ariaValuenow","style","show","components","gap","vAlign","shadow","hidden","bgColor","bgGradient","bgOpacity","border","borderTop","borderStart","borderEnd","borderBottom","borderColor","borderRadius","borderRoundSize","borderOpacity","p","pt","pb","ps","pe","px","py","m","mt","mb","ms","me","mx","my","clearfix","ratio","sticky","fixed","d","dSm","dMd","dLg","dXl","dXxl","dPrint","w","h","mw","mh","position","top","start","bottom","end","textColor","textAlign","textAlignSm","textAlignMd","textAlignLg","textAlignXl","textWrap","textTransform","textDecoration","lineHeight","textMuted","textLead","textHeading","textTruncate","textOpacity","fontSize","fontWeight","fontStyle","float","floatSm","floatMd","floatLg","floatXl","floatXxl","container","col","colSm","colMd","colLg","colXl","colXxl","order","orderSm","orderMd","orderLg","orderXl","orderXxl","offset","offsetSm","offsetMd","offsetLg","offsetXl","offsetXxl","row","rowCols","rowColsSm","rowColsMd","rowColsLg","rowColsXl","rowColsXxl","g","gSm","gMd","gLg","gXl","gXxl","gx","gy","alignItems","alignSelf","justifyContent"];let r=Xe(e,n),s,l=Oe,a=()=>(l(),l=xo(I,M=>t(138,s=M)),I);i.$$.on_destroy.push(()=>l());let{$$slots:o={},$$scope:c}=e;const f=jc(o);let{element:u=void 0}=e,{componentName:d=Ma}=e,{id:h=d+"_"+_g++}=e,{tag:m=Cg}=e,{cssProps:p={}}=e,{value:g=void 0}=e,{title:v=void 0}=e,{tabindex:b=void 0}=e,{role:y=void 0}=e,{ariaCurrent:_=void 0}=e,{ariaLabel:S=void 0}=e,{ariaValuenow:C=void 0}=e,{style:k=void 0}=e,{show:w=void 0}=e,{components:A=[]}=e,I;a();let z,H,Q={},{gap:ee=void 0}=e,{vAlign:Z=void 0}=e,{shadow:he=void 0}=e,{hidden:_e=void 0}=e,{bgColor:we=void 0}=e,{bgGradient:O=void 0}=e,{bgOpacity:N=void 0}=e,{border:L=void 0}=e,{borderTop:D=void 0}=e,{borderStart:B=void 0}=e,{borderEnd:P=void 0}=e,{borderBottom:x=void 0}=e,{borderColor:W=void 0}=e,{borderRadius:Y=void 0}=e,{borderRoundSize:ce=void 0}=e,{borderOpacity:ne=void 0}=e,{p:me=void 0}=e,{pt:pe=void 0}=e,{pb:q=void 0}=e,{ps:se=void 0}=e,{pe:J=void 0}=e,{px:de=void 0}=e,{py:fe=void 0}=e,{m:oe=void 0}=e,{mt:ge=void 0}=e,{mb:Se=void 0}=e,{ms:Be=void 0}=e,{me:Te=void 0}=e,{mx:le=void 0}=e,{my:Ie=void 0}=e,{clearfix:ze=void 0}=e,{ratio:$e=void 0}=e,{sticky:ft=void 0}=e,{fixed:it=void 0}=e,{d:dt=void 0}=e,{dSm:at=void 0}=e,{dMd:Wt=void 0}=e,{dLg:Ut=void 0}=e,{dXl:Xt=void 0}=e,{dXxl:ji=void 0}=e,{dPrint:xe=void 0}=e,{w:Re=void 0}=e,{h:Ci=void 0}=e,{mw:Gn=void 0}=e,{mh:hn=void 0}=e,{position:Jn=void 0}=e,{top:xi=void 0}=e,{start:F=void 0}=e,{bottom:X=void 0}=e,{end:ie=void 0}=e,{textColor:be=void 0}=e,{textAlign:Ee=void 0}=e,{textAlignSm:Pe=void 0}=e,{textAlignMd:We=void 0}=e,{textAlignLg:De=void 0}=e,{textAlignXl:mt=void 0}=e,{textWrap:ct=void 0}=e,{textTransform:St=void 0}=e,{textDecoration:_t=void 0}=e,{lineHeight:st=void 0}=e,{textMuted:wt=void 0}=e,{textLead:Mt=void 0}=e,{textHeading:Ot=void 0}=e,{textTruncate:xt=void 0}=e,{textOpacity:Vi=void 0}=e,{fontSize:zi=void 0}=e,{fontWeight:ur=void 0}=e,{fontStyle:Sr=void 0}=e,{float:fr=void 0}=e,{floatSm:kr=void 0}=e,{floatMd:Tr=void 0}=e,{floatLg:Wo=void 0}=e,{floatXl:Xo=void 0}=e,{floatXxl:Ho=void 0}=e,{container:Yo=void 0}=e,{col:Go=void 0}=e,{colSm:Jo=void 0}=e,{colMd:qo=void 0}=e,{colLg:Ko=void 0}=e,{colXl:Qo=void 0}=e,{colXxl:Zo=void 0}=e,{order:$o=void 0}=e,{orderSm:ea=void 0}=e,{orderMd:ta=void 0}=e,{orderLg:ia=void 0}=e,{orderXl:na=void 0}=e,{orderXxl:ra=void 0}=e,{offset:sa=void 0}=e,{offsetSm:oa=void 0}=e,{offsetMd:aa=void 0}=e,{offsetLg:ca=void 0}=e,{offsetXl:la=void 0}=e,{offsetXxl:ua=void 0}=e,{row:fa=void 0}=e,{rowCols:ha=void 0}=e,{rowColsSm:da=void 0}=e,{rowColsMd:ma=void 0}=e,{rowColsLg:ga=void 0}=e,{rowColsXl:pa=void 0}=e,{rowColsXxl:va=void 0}=e,{g:ba=void 0}=e,{gSm:ya=void 0}=e,{gMd:_a=void 0}=e,{gLg:Ca=void 0}=e,{gXl:Sa=void 0}=e,{gXxl:ka=void 0}=e,{gx:Ta=void 0}=e,{gy:wa=void 0}=e,{alignItems:Pa=void 0}=e,{alignSelf:Ea=void 0}=e,{justifyContent:Oa=void 0}=e;const ym=Er(ht()),_m=A!=null&&A[0]?Er(A[0].component,A[0].except):Oe,Cm=A!=null&&A[1]?Er(A[1].component,A[1].except):Oe,Sm=A!=null&&A[2]?Er(A[2].component,A[2].except):Oe,km=A!=null&&A[3]?Er(A[3].component,A[3].except):Oe,Tm=A!=null&&A[4]?Er(A[4].component,A[4].except):Oe;Ui(()=>{u&&a(t(3,I=dg({element:u,componentName:d,show:w})))});function wm(M){Fe[M?"unshift":"push"](()=>{u=M,t(0,u)})}function Pm(M){Fe[M?"unshift":"push"](()=>{u=M,t(0,u)})}function Em(){g=this.value,t(1,g)}function Om(M){Fe[M?"unshift":"push"](()=>{u=M,t(0,u)})}function xm(){g=this.value,t(1,g)}function Am(M){Fe[M?"unshift":"push"](()=>{u=M,t(0,u)})}return i.$$set=M=>{t(147,e=Ce(Ce({},e),je(M))),t(12,r=Xe(e,n)),"element"in M&&t(0,u=M.element),"componentName"in M&&t(13,d=M.componentName),"id"in M&&t(14,h=M.id),"tag"in M&&t(2,m=M.tag),"cssProps"in M&&t(15,p=M.cssProps),"value"in M&&t(1,g=M.value),"title"in M&&t(16,v=M.title),"tabindex"in M&&t(17,b=M.tabindex),"role"in M&&t(18,y=M.role),"ariaCurrent"in M&&t(19,_=M.ariaCurrent),"ariaLabel"in M&&t(20,S=M.ariaLabel),"ariaValuenow"in M&&t(21,C=M.ariaValuenow),"style"in M&&t(22,k=M.style),"show"in M&&t(23,w=M.show),"components"in M&&t(24,A=M.components),"gap"in M&&t(25,ee=M.gap),"vAlign"in M&&t(26,Z=M.vAlign),"shadow"in M&&t(27,he=M.shadow),"hidden"in M&&t(28,_e=M.hidden),"bgColor"in M&&t(29,we=M.bgColor),"bgGradient"in M&&t(30,O=M.bgGradient),"bgOpacity"in M&&t(31,N=M.bgOpacity),"border"in M&&t(32,L=M.border),"borderTop"in M&&t(33,D=M.borderTop),"borderStart"in M&&t(34,B=M.borderStart),"borderEnd"in M&&t(35,P=M.borderEnd),"borderBottom"in M&&t(36,x=M.borderBottom),"borderColor"in M&&t(37,W=M.borderColor),"borderRadius"in M&&t(38,Y=M.borderRadius),"borderRoundSize"in M&&t(39,ce=M.borderRoundSize),"borderOpacity"in M&&t(40,ne=M.borderOpacity),"p"in M&&t(41,me=M.p),"pt"in M&&t(42,pe=M.pt),"pb"in M&&t(43,q=M.pb),"ps"in M&&t(44,se=M.ps),"pe"in M&&t(45,J=M.pe),"px"in M&&t(46,de=M.px),"py"in M&&t(47,fe=M.py),"m"in M&&t(48,oe=M.m),"mt"in M&&t(49,ge=M.mt),"mb"in M&&t(50,Se=M.mb),"ms"in M&&t(51,Be=M.ms),"me"in M&&t(52,Te=M.me),"mx"in M&&t(53,le=M.mx),"my"in M&&t(54,Ie=M.my),"clearfix"in M&&t(55,ze=M.clearfix),"ratio"in M&&t(56,$e=M.ratio),"sticky"in M&&t(57,ft=M.sticky),"fixed"in M&&t(58,it=M.fixed),"d"in M&&t(59,dt=M.d),"dSm"in M&&t(60,at=M.dSm),"dMd"in M&&t(61,Wt=M.dMd),"dLg"in M&&t(62,Ut=M.dLg),"dXl"in M&&t(63,Xt=M.dXl),"dXxl"in M&&t(64,ji=M.dXxl),"dPrint"in M&&t(65,xe=M.dPrint),"w"in M&&t(66,Re=M.w),"h"in M&&t(67,Ci=M.h),"mw"in M&&t(68,Gn=M.mw),"mh"in M&&t(69,hn=M.mh),"position"in M&&t(70,Jn=M.position),"top"in M&&t(71,xi=M.top),"start"in M&&t(72,F=M.start),"bottom"in M&&t(73,X=M.bottom),"end"in M&&t(74,ie=M.end),"textColor"in M&&t(75,be=M.textColor),"textAlign"in M&&t(76,Ee=M.textAlign),"textAlignSm"in M&&t(77,Pe=M.textAlignSm),"textAlignMd"in M&&t(78,We=M.textAlignMd),"textAlignLg"in M&&t(79,De=M.textAlignLg),"textAlignXl"in M&&t(80,mt=M.textAlignXl),"textWrap"in M&&t(81,ct=M.textWrap),"textTransform"in M&&t(82,St=M.textTransform),"textDecoration"in M&&t(83,_t=M.textDecoration),"lineHeight"in M&&t(84,st=M.lineHeight),"textMuted"in M&&t(85,wt=M.textMuted),"textLead"in M&&t(86,Mt=M.textLead),"textHeading"in M&&t(87,Ot=M.textHeading),"textTruncate"in M&&t(88,xt=M.textTruncate),"textOpacity"in M&&t(89,Vi=M.textOpacity),"fontSize"in M&&t(90,zi=M.fontSize),"fontWeight"in M&&t(91,ur=M.fontWeight),"fontStyle"in M&&t(92,Sr=M.fontStyle),"float"in M&&t(93,fr=M.float),"floatSm"in M&&t(94,kr=M.floatSm),"floatMd"in M&&t(95,Tr=M.floatMd),"floatLg"in M&&t(96,Wo=M.floatLg),"floatXl"in M&&t(97,Xo=M.floatXl),"floatXxl"in M&&t(98,Ho=M.floatXxl),"container"in M&&t(99,Yo=M.container),"col"in M&&t(100,Go=M.col),"colSm"in M&&t(101,Jo=M.colSm),"colMd"in M&&t(102,qo=M.colMd),"colLg"in M&&t(103,Ko=M.colLg),"colXl"in M&&t(104,Qo=M.colXl),"colXxl"in M&&t(105,Zo=M.colXxl),"order"in M&&t(106,$o=M.order),"orderSm"in M&&t(107,ea=M.orderSm),"orderMd"in M&&t(108,ta=M.orderMd),"orderLg"in M&&t(109,ia=M.orderLg),"orderXl"in M&&t(110,na=M.orderXl),"orderXxl"in M&&t(111,ra=M.orderXxl),"offset"in M&&t(112,sa=M.offset),"offsetSm"in M&&t(113,oa=M.offsetSm),"offsetMd"in M&&t(114,aa=M.offsetMd),"offsetLg"in M&&t(115,ca=M.offsetLg),"offsetXl"in M&&t(116,la=M.offsetXl),"offsetXxl"in M&&t(117,ua=M.offsetXxl),"row"in M&&t(118,fa=M.row),"rowCols"in M&&t(119,ha=M.rowCols),"rowColsSm"in M&&t(120,da=M.rowColsSm),"rowColsMd"in M&&t(121,ma=M.rowColsMd),"rowColsLg"in M&&t(122,ga=M.rowColsLg),"rowColsXl"in M&&t(123,pa=M.rowColsXl),"rowColsXxl"in M&&t(124,va=M.rowColsXxl),"g"in M&&t(125,ba=M.g),"gSm"in M&&t(126,ya=M.gSm),"gMd"in M&&t(127,_a=M.gMd),"gLg"in M&&t(128,Ca=M.gLg),"gXl"in M&&t(129,Sa=M.gXl),"gXxl"in M&&t(130,ka=M.gXxl),"gx"in M&&t(131,Ta=M.gx),"gy"in M&&t(132,wa=M.gy),"alignItems"in M&&t(133,Pa=M.alignItems),"alignSelf"in M&&t(134,Ea=M.alignSelf),"justifyContent"in M&&t(135,Oa=M.justifyContent),"$$scope"in M&&t(139,c=M.$$scope)},i.$$.update=()=>{var M;i.$$.dirty[0]&8388616&&(I&&w===!1&&I.leave(),I&&w===!0&&I.enter());{t(137,H={bgColor:we,bgGradient:O,bgOpacity:N,border:L,borderTop:D,borderStart:B,borderEnd:P,borderBottom:x,borderColor:W,borderRadius:Y,borderRoundSize:ce,borderOpacity:ne,p:me,pt:pe,pb:q,ps:se,pe:J,px:de,py:fe,m:oe,mt:ge,mb:Se,ms:Be,me:Te,mx:le,my:Ie,gap:ee,clearfix:ze,ratio:$e,sticky:ft,fixed:it,d:dt,dSm:at,dMd:Wt,dLg:Ut,dXl:Xt,dXxl:ji,dPrint:xe,shadow:he,w:Re,h:Ci,mw:Gn,mh:hn,position:Jn,top:xi,start:F,bottom:X,end:ie,vAlign:Z,textColor:be,textAlign:Ee,textAlignSm:Pe,textAlignMd:We,textAlignLg:De,textAlignXl:mt,textWrap:ct,textTransform:St,textDecoration:_t,lineHeight:st,textMuted:wt,textLead:Mt,textHeading:Ot,textTruncate:xt,textOpacity:Vi,fontSize:zi,fontWeight:ur,fontStyle:Sr,hidden:_e,float:fr,floatSm:kr,floatMd:Tr,floatLg:Wo,floatXl:Xo,floatXxl:Ho,container:Yo,col:Go,colSm:Jo,colMd:qo,colLg:Ko,colXl:Qo,colXxl:Zo,order:$o,orderSm:ea,orderMd:ta,orderLg:ia,orderXl:na,orderXxl:ra,offset:sa,offsetSm:oa,offsetMd:aa,offsetLg:ca,offsetXl:la,offsetXxl:ua,row:fa,rowCols:ha,rowColsSm:da,rowColsMd:ma,rowColsLg:ga,rowColsXl:pa,rowColsXxl:va,g:ba,gSm:ya,gMd:_a,gLg:Ca,gXl:Sa,gXxl:ka,gx:Ta,gy:wa,alignItems:Pa,alignSelf:Ea,justifyContent:Oa}),t(136,z=((M=Ze(Ma,H,e.class))==null?void 0:M.replace("y-el ",""))??""),d!==Ma&&t(136,z+=" "+Ze(d,p)),t(136,z+=(s==null?void 0:s.classes)||"");const Dm=`${k?k+";":""}${(s==null?void 0:s.styles)||""}`||void 0;t(4,Q={id:h,class:z,title:v,tabindex:b,role:y,ariaCurrent:_,ariaLabel:S,ariaValuenow:C,style:Dm})}},e=je(e),[u,g,m,I,Q,ym,_m,Cm,Sm,km,Tm,f,r,d,h,p,v,b,y,_,S,C,k,w,A,ee,Z,he,_e,we,O,N,L,D,B,P,x,W,Y,ce,ne,me,pe,q,se,J,de,fe,oe,ge,Se,Be,Te,le,Ie,ze,$e,ft,it,dt,at,Wt,Ut,Xt,ji,xe,Re,Ci,Gn,hn,Jn,xi,F,X,ie,be,Ee,Pe,We,De,mt,ct,St,_t,st,wt,Mt,Ot,xt,Vi,zi,ur,Sr,fr,kr,Tr,Wo,Xo,Ho,Yo,Go,Jo,qo,Ko,Qo,Zo,$o,ea,ta,ia,na,ra,sa,oa,aa,ca,la,ua,fa,ha,da,ma,ga,pa,va,ba,ya,_a,Ca,Sa,ka,Ta,wa,Pa,Ea,Oa,z,H,s,c,o,wm,Pm,Em,Om,xm,Am]}class kg extends Ye{constructor(e){super(),He(this,e,Sg,yg,Ve,{element:0,componentName:13,id:14,tag:2,cssProps:15,value:1,title:16,tabindex:17,role:18,ariaCurrent:19,ariaLabel:20,ariaValuenow:21,style:22,show:23,components:24,gap:25,vAlign:26,shadow:27,hidden:28,bgColor:29,bgGradient:30,bgOpacity:31,border:32,borderTop:33,borderStart:34,borderEnd:35,borderBottom:36,borderColor:37,borderRadius:38,borderRoundSize:39,borderOpacity:40,p:41,pt:42,pb:43,ps:44,pe:45,px:46,py:47,m:48,mt:49,mb:50,ms:51,me:52,mx:53,my:54,clearfix:55,ratio:56,sticky:57,fixed:58,d:59,dSm:60,dMd:61,dLg:62,dXl:63,dXxl:64,dPrint:65,w:66,h:67,mw:68,mh:69,position:70,top:71,start:72,bottom:73,end:74,textColor:75,textAlign:76,textAlignSm:77,textAlignMd:78,textAlignLg:79,textAlignXl:80,textWrap:81,textTransform:82,textDecoration:83,lineHeight:84,textMuted:85,textLead:86,textHeading:87,textTruncate:88,textOpacity:89,fontSize:90,fontWeight:91,fontStyle:92,float:93,floatSm:94,floatMd:95,floatLg:96,floatXl:97,floatXxl:98,container:99,col:100,colSm:101,colMd:102,colLg:103,colXl:104,colXxl:105,order:106,orderSm:107,orderMd:108,orderLg:109,orderXl:110,orderXxl:111,offset:112,offsetSm:113,offsetMd:114,offsetLg:115,offsetXl:116,offsetXxl:117,row:118,rowCols:119,rowColsSm:120,rowColsMd:121,rowColsLg:122,rowColsXl:123,rowColsXxl:124,g:125,gSm:126,gMd:127,gLg:128,gXl:129,gXxl:130,gx:131,gy:132,alignItems:133,alignSelf:134,justifyContent:135},null,[-1,-1,-1,-1,-1])}}const Ke=kg;var NT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function FT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Tg(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),t}const Ts=Math.min,Nr=Math.max,vo=Math.round,or=i=>({x:i,y:i}),wg={left:"right",right:"left",bottom:"top",top:"bottom"},Pg={start:"end",end:"start"};function rc(i,e,t){return Nr(i,Ts(e,t))}function Ls(i,e){return typeof i=="function"?i(e):i}function vr(i){return i.split("-")[0]}function Ns(i){return i.split("-")[1]}function Jf(i){return i==="x"?"y":"x"}function Hc(i){return i==="y"?"height":"width"}function Ao(i){return["top","bottom"].includes(vr(i))?"y":"x"}function Yc(i){return Jf(Ao(i))}function Eg(i,e,t){t===void 0&&(t=!1);const n=Ns(i),r=Yc(i),s=Hc(r);let l=r==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(l=bo(l)),[l,bo(l)]}function Og(i){const e=bo(i);return[sc(i),e,sc(e)]}function sc(i){return i.replace(/start|end/g,e=>Pg[e])}function xg(i,e,t){const n=["left","right"],r=["right","left"],s=["top","bottom"],l=["bottom","top"];switch(i){case"top":case"bottom":return t?e?r:n:e?n:r;case"left":case"right":return e?s:l;default:return[]}}function Ag(i,e,t,n){const r=Ns(i);let s=xg(vr(i),t==="start",n);return r&&(s=s.map(l=>l+"-"+r),e&&(s=s.concat(s.map(sc)))),s}function bo(i){return i.replace(/left|right|bottom|top/g,e=>wg[e])}function Dg(i){return{top:0,right:0,bottom:0,left:0,...i}}function qf(i){return typeof i!="number"?Dg(i):{top:i,right:i,bottom:i,left:i}}function yo(i){return{...i,top:i.y,left:i.x,right:i.x+i.width,bottom:i.y+i.height}}function bl(i,e,t){let{reference:n,floating:r}=i;const s=Ao(e),l=Yc(e),a=Hc(l),o=vr(e),c=s==="y",f=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2,d=n[a]/2-r[a]/2;let h;switch(o){case"top":h={x:f,y:n.y-r.height};break;case"bottom":h={x:f,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:u};break;case"left":h={x:n.x-r.width,y:u};break;default:h={x:n.x,y:n.y}}switch(Ns(e)){case"start":h[l]-=d*(t&&c?-1:1);break;case"end":h[l]+=d*(t&&c?-1:1);break}return h}const Rg=async(i,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:l}=t,a=s.filter(Boolean),o=await(l.isRTL==null?void 0:l.isRTL(e));let c=await l.getElementRects({reference:i,floating:e,strategy:r}),{x:f,y:u}=bl(c,n,o),d=n,h={},m=0;for(let p=0;p<a.length;p++){const{name:g,fn:v}=a[p],{x:b,y,data:_,reset:S}=await v({x:f,y:u,initialPlacement:n,placement:d,strategy:r,middlewareData:h,rects:c,platform:l,elements:{reference:i,floating:e}});if(f=b??f,u=y??u,h={...h,[g]:{...h[g],..._}},S&&m<=50){m++,typeof S=="object"&&(S.placement&&(d=S.placement),S.rects&&(c=S.rects===!0?await l.getElementRects({reference:i,floating:e,strategy:r}):S.rects),{x:f,y:u}=bl(c,d,o)),p=-1;continue}}return{x:f,y:u,placement:d,strategy:r,middlewareData:h}};async function Kf(i,e){var t;e===void 0&&(e={});const{x:n,y:r,platform:s,rects:l,elements:a,strategy:o}=i,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:u="floating",altBoundary:d=!1,padding:h=0}=Ls(e,i),m=qf(h),g=a[d?u==="floating"?"reference":"floating":u],v=yo(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(g)))==null||t?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:f,strategy:o})),b=u==="floating"?{...l.floating,x:n,y:r}:l.reference,y=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),_=await(s.isElement==null?void 0:s.isElement(y))?await(s.getScale==null?void 0:s.getScale(y))||{x:1,y:1}:{x:1,y:1},S=yo(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:y,strategy:o}):b);return{top:(v.top-S.top+m.top)/_.y,bottom:(S.bottom-v.bottom+m.bottom)/_.y,left:(v.left-S.left+m.left)/_.x,right:(S.right-v.right+m.right)/_.x}}const Mg=i=>({name:"arrow",options:i,async fn(e){const{x:t,y:n,placement:r,rects:s,platform:l,elements:a,middlewareData:o}=e,{element:c,padding:f=0}=Ls(i,e)||{};if(c==null)return{};const u=qf(f),d={x:t,y:n},h=Yc(r),m=Hc(h),p=await l.getDimensions(c),g=h==="y",v=g?"top":"left",b=g?"bottom":"right",y=g?"clientHeight":"clientWidth",_=s.reference[m]+s.reference[h]-d[h]-s.floating[m],S=d[h]-s.reference[h],C=await(l.getOffsetParent==null?void 0:l.getOffsetParent(c));let k=C?C[y]:0;(!k||!await(l.isElement==null?void 0:l.isElement(C)))&&(k=a.floating[y]||s.floating[m]);const w=_/2-S/2,A=k/2-p[m]/2-1,I=Ts(u[v],A),z=Ts(u[b],A),H=I,Q=k-p[m]-z,ee=k/2-p[m]/2+w,Z=rc(H,ee,Q),he=!o.arrow&&Ns(r)!=null&&ee!=Z&&s.reference[m]/2-(ee<H?I:z)-p[m]/2<0,_e=he?ee<H?ee-H:ee-Q:0;return{[h]:d[h]+_e,data:{[h]:Z,centerOffset:ee-Z-_e,...he&&{alignmentOffset:_e}},reset:he}}}),Ig=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(e){var t,n;const{placement:r,middlewareData:s,rects:l,initialPlacement:a,platform:o,elements:c}=e,{mainAxis:f=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...g}=Ls(i,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const v=vr(r),b=vr(a)===a,y=await(o.isRTL==null?void 0:o.isRTL(c.floating)),_=d||(b||!p?[bo(a)]:Og(a));!d&&m!=="none"&&_.push(...Ag(a,p,m,y));const S=[a,..._],C=await Kf(e,g),k=[];let w=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&k.push(C[v]),u){const H=Eg(r,l,y);k.push(C[H[0]],C[H[1]])}if(w=[...w,{placement:r,overflows:k}],!k.every(H=>H<=0)){var A,I;const H=(((A=s.flip)==null?void 0:A.index)||0)+1,Q=S[H];if(Q)return{data:{index:H,overflows:w},reset:{placement:Q}};let ee=(I=w.filter(Z=>Z.overflows[0]<=0).sort((Z,he)=>Z.overflows[1]-he.overflows[1])[0])==null?void 0:I.placement;if(!ee)switch(h){case"bestFit":{var z;const Z=(z=w.map(he=>[he.placement,he.overflows.filter(_e=>_e>0).reduce((_e,we)=>_e+we,0)]).sort((he,_e)=>he[1]-_e[1])[0])==null?void 0:z[0];Z&&(ee=Z);break}case"initialPlacement":ee=a;break}if(r!==ee)return{reset:{placement:ee}}}return{}}}};async function Lg(i,e){const{placement:t,platform:n,elements:r}=i,s=await(n.isRTL==null?void 0:n.isRTL(r.floating)),l=vr(t),a=Ns(t),o=Ao(t)==="y",c=["left","top"].includes(l)?-1:1,f=s&&o?-1:1,u=Ls(e,i);let{mainAxis:d,crossAxis:h,alignmentAxis:m}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&typeof m=="number"&&(h=a==="end"?m*-1:m),o?{x:h*f,y:d*c}:{x:d*c,y:h*f}}const Ng=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(e){const{x:t,y:n}=e,r=await Lg(e,i);return{x:t+r.x,y:n+r.y,data:r}}}},Fg=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(e){const{x:t,y:n,placement:r}=e,{mainAxis:s=!0,crossAxis:l=!1,limiter:a={fn:g=>{let{x:v,y:b}=g;return{x:v,y:b}}},...o}=Ls(i,e),c={x:t,y:n},f=await Kf(e,o),u=Ao(vr(r)),d=Jf(u);let h=c[d],m=c[u];if(s){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",b=h+f[g],y=h-f[v];h=rc(b,h,y)}if(l){const g=u==="y"?"top":"left",v=u==="y"?"bottom":"right",b=m+f[g],y=m-f[v];m=rc(b,m,y)}const p=a.fn({...e,[d]:h,[u]:m});return{...p,data:{x:p.x-t,y:p.y-n}}}}};function ar(i){return Qf(i)?(i.nodeName||"").toLowerCase():"#document"}function _i(i){var e;return(i==null||(e=i.ownerDocument)==null?void 0:e.defaultView)||window}function lr(i){var e;return(e=(Qf(i)?i.ownerDocument:i.document)||window.document)==null?void 0:e.documentElement}function Qf(i){return i instanceof Node||i instanceof _i(i).Node}function Yn(i){return i instanceof Element||i instanceof _i(i).Element}function ln(i){return i instanceof HTMLElement||i instanceof _i(i).HTMLElement}function yl(i){return typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof _i(i).ShadowRoot}function Fs(i){const{overflow:e,overflowX:t,overflowY:n,display:r}=Oi(i);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(r)}function Bg(i){return["table","td","th"].includes(ar(i))}function Gc(i){const e=Jc(),t=Oi(i);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function Ug(i){let e=Wr(i);for(;ln(e)&&!Do(e);){if(Gc(e))return e;e=Wr(e)}return null}function Jc(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Do(i){return["html","body","#document"].includes(ar(i))}function Oi(i){return _i(i).getComputedStyle(i)}function Ro(i){return Yn(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function Wr(i){if(ar(i)==="html")return i;const e=i.assignedSlot||i.parentNode||yl(i)&&i.host||lr(i);return yl(e)?e.host:e}function Zf(i){const e=Wr(i);return Do(e)?i.ownerDocument?i.ownerDocument.body:i.body:ln(e)&&Fs(e)?e:Zf(e)}function oc(i,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=Zf(i),s=r===((n=i.ownerDocument)==null?void 0:n.body),l=_i(r);return s?e.concat(l,l.visualViewport||[],Fs(r)?r:[],l.frameElement&&t?oc(l.frameElement):[]):e.concat(r,oc(r,[],t))}function $f(i){const e=Oi(i);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=ln(i),s=r?i.offsetWidth:t,l=r?i.offsetHeight:n,a=vo(t)!==s||vo(n)!==l;return a&&(t=s,n=l),{width:t,height:n,$:a}}function eh(i){return Yn(i)?i:i.contextElement}function Fr(i){const e=eh(i);if(!ln(e))return or(1);const t=e.getBoundingClientRect(),{width:n,height:r,$:s}=$f(e);let l=(s?vo(t.width):t.width)/n,a=(s?vo(t.height):t.height)/r;return(!l||!Number.isFinite(l))&&(l=1),(!a||!Number.isFinite(a))&&(a=1),{x:l,y:a}}const jg=or(0);function th(i){const e=_i(i);return!Jc()||!e.visualViewport?jg:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Vg(i,e,t){return e===void 0&&(e=!1),!t||e&&t!==_i(i)?!1:e}function ws(i,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=i.getBoundingClientRect(),s=eh(i);let l=or(1);e&&(n?Yn(n)&&(l=Fr(n)):l=Fr(i));const a=Vg(s,t,n)?th(s):or(0);let o=(r.left+a.x)/l.x,c=(r.top+a.y)/l.y,f=r.width/l.x,u=r.height/l.y;if(s){const d=_i(s),h=n&&Yn(n)?_i(n):n;let m=d.frameElement;for(;m&&n&&h!==d;){const p=Fr(m),g=m.getBoundingClientRect(),v=Oi(m),b=g.left+(m.clientLeft+parseFloat(v.paddingLeft))*p.x,y=g.top+(m.clientTop+parseFloat(v.paddingTop))*p.y;o*=p.x,c*=p.y,f*=p.x,u*=p.y,o+=b,c+=y,m=_i(m).frameElement}}return yo({width:f,height:u,x:o,y:c})}function zg(i){let{rect:e,offsetParent:t,strategy:n}=i;const r=ln(t),s=lr(t);if(t===s)return e;let l={scrollLeft:0,scrollTop:0},a=or(1);const o=or(0);if((r||!r&&n!=="fixed")&&((ar(t)!=="body"||Fs(s))&&(l=Ro(t)),ln(t))){const c=ws(t);a=Fr(t),o.x=c.x+t.clientLeft,o.y=c.y+t.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-l.scrollLeft*a.x+o.x,y:e.y*a.y-l.scrollTop*a.y+o.y}}function Wg(i){return Array.from(i.getClientRects())}function ih(i){return ws(lr(i)).left+Ro(i).scrollLeft}function Xg(i){const e=lr(i),t=Ro(i),n=i.ownerDocument.body,r=Nr(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Nr(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-t.scrollLeft+ih(i);const a=-t.scrollTop;return Oi(n).direction==="rtl"&&(l+=Nr(e.clientWidth,n.clientWidth)-r),{width:r,height:s,x:l,y:a}}function Hg(i,e){const t=_i(i),n=lr(i),r=t.visualViewport;let s=n.clientWidth,l=n.clientHeight,a=0,o=0;if(r){s=r.width,l=r.height;const c=Jc();(!c||c&&e==="fixed")&&(a=r.offsetLeft,o=r.offsetTop)}return{width:s,height:l,x:a,y:o}}function Yg(i,e){const t=ws(i,!0,e==="fixed"),n=t.top+i.clientTop,r=t.left+i.clientLeft,s=ln(i)?Fr(i):or(1),l=i.clientWidth*s.x,a=i.clientHeight*s.y,o=r*s.x,c=n*s.y;return{width:l,height:a,x:o,y:c}}function _l(i,e,t){let n;if(e==="viewport")n=Hg(i,t);else if(e==="document")n=Xg(lr(i));else if(Yn(e))n=Yg(e,t);else{const r=th(i);n={...e,x:e.x-r.x,y:e.y-r.y}}return yo(n)}function nh(i,e){const t=Wr(i);return t===e||!Yn(t)||Do(t)?!1:Oi(t).position==="fixed"||nh(t,e)}function Gg(i,e){const t=e.get(i);if(t)return t;let n=oc(i,[],!1).filter(a=>Yn(a)&&ar(a)!=="body"),r=null;const s=Oi(i).position==="fixed";let l=s?Wr(i):i;for(;Yn(l)&&!Do(l);){const a=Oi(l),o=Gc(l);!o&&a.position==="fixed"&&(r=null),(s?!o&&!r:!o&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Fs(l)&&!o&&nh(i,l))?n=n.filter(f=>f!==l):r=a,l=Wr(l)}return e.set(i,n),n}function Jg(i){let{element:e,boundary:t,rootBoundary:n,strategy:r}=i;const l=[...t==="clippingAncestors"?Gg(e,this._c):[].concat(t),n],a=l[0],o=l.reduce((c,f)=>{const u=_l(e,f,r);return c.top=Nr(u.top,c.top),c.right=Ts(u.right,c.right),c.bottom=Ts(u.bottom,c.bottom),c.left=Nr(u.left,c.left),c},_l(e,a,r));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}}function qg(i){return $f(i)}function Kg(i,e,t){const n=ln(e),r=lr(e),s=t==="fixed",l=ws(i,!0,s,e);let a={scrollLeft:0,scrollTop:0};const o=or(0);if(n||!n&&!s)if((ar(e)!=="body"||Fs(r))&&(a=Ro(e)),n){const c=ws(e,!0,s,e);o.x=c.x+e.clientLeft,o.y=c.y+e.clientTop}else r&&(o.x=ih(r));return{x:l.left+a.scrollLeft-o.x,y:l.top+a.scrollTop-o.y,width:l.width,height:l.height}}function Cl(i,e){return!ln(i)||Oi(i).position==="fixed"?null:e?e(i):i.offsetParent}function rh(i,e){const t=_i(i);if(!ln(i))return t;let n=Cl(i,e);for(;n&&Bg(n)&&Oi(n).position==="static";)n=Cl(n,e);return n&&(ar(n)==="html"||ar(n)==="body"&&Oi(n).position==="static"&&!Gc(n))?t:n||Ug(i)||t}const Qg=async function(i){let{reference:e,floating:t,strategy:n}=i;const r=this.getOffsetParent||rh,s=this.getDimensions;return{reference:Kg(e,await r(t),n),floating:{x:0,y:0,...await s(t)}}};function Zg(i){return Oi(i).direction==="rtl"}const $g={convertOffsetParentRelativeRectToViewportRelativeRect:zg,getDocumentElement:lr,getClippingRect:Jg,getOffsetParent:rh,getElementRects:Qg,getClientRects:Wg,getDimensions:qg,getScale:Fr,isElement:Yn,isRTL:Zg},ep=(i,e,t)=>{const n=new Map,r={platform:$g,...t},s={...r.platform,_c:n};return Rg(i,e,{...r,platform:s})};function Sl(i){let e,t,n;const r=[i[3]];function s(a){i[21](a)}let l={};for(let a=0;a<r.length;a+=1)l=Ce(l,r[a]);return i[2]!==void 0&&(l.element=i[2]),e=new Ke({props:l}),Fe.push(()=>nt(e,"element",s)),{c(){V(e.$$.fragment)},m(a,o){U(e,a,o),n=!0},p(a,o){const c=o[0]&8?ut(r,[tt(a[3])]):{};!t&&o[0]&4&&(t=!0,c.element=a[2],lt(()=>t=!1)),e.$set(c)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){E(e.$$.fragment,a),n=!1},d(a){j(e,a)}}}function tp(i){let e,t,n=i[0]&&Sl(i);const r=i[20].default,s=gt(r,i,i[23],null);return{c(){n&&n.c(),e=ue(),s&&s.c()},m(l,a){n&&n.m(l,a),$(l,e,a),s&&s.m(l,a),t=!0},p(l,a){l[0]?n?(n.p(l,a),a[0]&1&&T(n,1)):(n=Sl(l),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),E(n,1,1,()=>{n=null}),qe()),s&&s.p&&(!t||a[0]&8388608)&&vt(s,r,l,l[23],t?pt(r,l[23],a,null):bt(l[23]),null)},i(l){t||(T(n),T(s,l),t=!0)},o(l){E(n),E(s,l),t=!1},d(l){l&&K(e),n&&n.d(l),s&&s.d(l)}}}function ip(i){let e,t,n;const r=[{components:i[5]},i[6],i[4]];function s(a){i[22](a)}let l={$$slots:{default:[tp]},$$scope:{ctx:i}};for(let a=0;a<r.length;a+=1)l=Ce(l,r[a]);return i[1]!==void 0&&(l.element=i[1]),e=new Ke({props:l}),Fe.push(()=>nt(e,"element",s)),{c(){V(e.$$.fragment)},m(a,o){U(e,a,o),n=!0},p(a,o){const c=o[0]&112?ut(r,[o[0]&32&&{components:a[5]},o[0]&64&&tt(a[6]),o[0]&16&&tt(a[4])]):{};o[0]&8388621&&(c.$$scope={dirty:o,ctx:a}),!t&&o[0]&2&&(t=!0,c.element=a[1],lt(()=>t=!1)),e.$set(c)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){E(e.$$.fragment,a),n=!1},d(a){j(e,a)}}}function np(i,e,t){let n,r;const s=["target","placement","trigger","popupOffset","autoClose","arrow","componentName","show"];let l=Xe(e,s),{$$slots:a={},$$scope:o}=e,{target:c=void 0}=e,{placement:f=void 0}=e,{trigger:u=void 0}=e,{popupOffset:d=void 0}=e,{autoClose:h="outside"}=e,{arrow:m=void 0}=e,{componentName:p="popup"}=e,{show:g=void 0}=e;const v=[{component:ht(),except:[]},...e.components??[]];let b,y,_,S,C,k,w,A,I="",z="";function H(){A&&u==="hover"&&clearTimeout(A),t(7,g=!0);let D=[];d&&D.push(Ng(d)),D.push(Fg({padding:d})),D.push(Ig()),m&&D.push(Mg({element:_})),ep(y,b,{placement:f,middleware:D}).then(({x:B,y:P,...x})=>{if(t(18,I=`${B}px`),t(19,z=`${P}px`),m){t(15,S=x.placement.split("-")[0]);const W=x.middlewareData.arrow;W&&(t(16,C=W.x?`${W.x}px`:""),t(17,k=W.y?`${W.y}px`:""))}})}function Q(){u==="hover"?A=setTimeout(()=>{t(7,g=!1)},300):t(7,g=!1)}const ee=()=>{g?Q():H()};function Z(D){if(g&&(h===!0||h==="outside")){if(D.composedPath().some(B=>B==b||B==y))return;t(7,g=!1)}}function he(){(h===!0||h==="inside")&&t(7,g=!1)}function _e(D){return D?typeof D=="string"?document.querySelector(D)||b.parentElement:D:b.previousElementSibling||b.parentElement}async function we(){window&&(window.process={env:{NODE_ENV:"production"}}),w=y,typeof window<"u"&&document.addEventListener("click",Z),b==null||b.addEventListener("click",he),u==="click"&&(y==null||y.addEventListener("click",ee)),u==="hover"&&(y==null||y.addEventListener("mouseenter",H),y==null||y.addEventListener("mouseleave",Q),b==null||b.addEventListener("mouseenter",H),b==null||b.addEventListener("mouseleave",Q)),u==="focus"&&(y==null||y.addEventListener("focus",H),y==null||y.addEventListener("blur",Q))}function O(){w&&(u==="click"&&w.removeEventListener("click",ee),typeof window<"u"&&document.removeEventListener("click",Z),b==null||b.removeEventListener("click",he),u==="hover"&&(w.removeEventListener("mouseenter",H),w.removeEventListener("mouseleave",Q),b==null||b.removeEventListener("mouseenter",H),b==null||b.removeEventListener("mouseleave",Q)),u==="focus"&&(w.removeEventListener("focus",H),w.removeEventListener("blur",Q)))}function N(D){_=D,t(2,_)}function L(D){b=D,t(1,b)}return i.$$set=D=>{t(34,e=Ce(Ce({},e),je(D))),t(6,l=Xe(e,s)),"target"in D&&t(8,c=D.target),"placement"in D&&t(9,f=D.placement),"trigger"in D&&t(10,u=D.trigger),"popupOffset"in D&&t(11,d=D.popupOffset),"autoClose"in D&&t(12,h=D.autoClose),"arrow"in D&&t(0,m=D.arrow),"componentName"in D&&t(13,p=D.componentName),"show"in D&&t(7,g=D.show),"$$scope"in D&&t(23,o=D.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&258&&b&&t(14,y=_e(c)),i.$$.dirty[0]&16384&&y&&(O(),we()),t(4,n={componentName:p,class:Ze("popup",{show:g,arrowPlacement:S},e.class),style:`left: ${I}; top: ${z};`}),i.$$.dirty[0]&204800&&t(3,r={componentName:p+"-arrow",class:Ze("popup-arrow"),style:`left: ${C}; top: ${k}`})},e=je(e),[m,b,_,r,n,v,l,g,c,f,u,d,h,p,y,S,C,k,I,z,a,N,L,o]}class rp extends Ye{constructor(e){super(),He(this,e,np,ip,Ve,{target:8,placement:9,trigger:10,popupOffset:11,autoClose:12,arrow:0,componentName:13,show:7},null,[-1,-1])}}const sh=rp;/**
* (c) Iconify
*
* For the full copyright and license information, please view the license.txt
* files at https://github.com/iconify/iconify
*
* Licensed under MIT.
*
* @license MIT
* @version 1.0.8
*/const oh=Object.freeze({left:0,top:0,width:16,height:16}),_o=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Bs=Object.freeze({...oh,..._o}),ac=Object.freeze({...Bs,body:"",hidden:!1}),sp=Object.freeze({width:null,height:null}),ah=Object.freeze({...sp,..._o});function op(i,e=0){const t=i.replace(/^-?[0-9.]*/,"");function n(r){for(;r<0;)r+=4;return r%4}if(t===""){const r=parseInt(i);return isNaN(r)?0:n(r)}else if(t!==i){let r=0;switch(t){case"%":r=25;break;case"deg":r=90}if(r){let s=parseFloat(i.slice(0,i.length-t.length));return isNaN(s)?0:(s=s/r,s%1===0?n(s):0)}}return e}const ap=/[\s,]+/;function cp(i,e){e.split(ap).forEach(t=>{switch(t.trim()){case"horizontal":i.hFlip=!0;break;case"vertical":i.vFlip=!0;break}})}const ch={...ah,preserveAspectRatio:""};function kl(i){const e={...ch},t=(n,r)=>i.getAttribute(n)||r;return e.width=t("width",null),e.height=t("height",null),e.rotate=op(t("rotate","")),cp(e,t("flip","")),e.preserveAspectRatio=t("preserveAspectRatio",t("preserveaspectratio","")),e}function lp(i,e){for(const t in ch)if(i[t]!==e[t])return!0;return!1}const ds=/^[a-z0-9]+(-[a-z0-9]+)*$/,Us=(i,e,t,n="")=>{const r=i.split(":");if(i.slice(0,1)==="@"){if(r.length<2||r.length>3)return null;n=r.shift().slice(1)}if(r.length>3||!r.length)return null;if(r.length>1){const a=r.pop(),o=r.pop(),c={provider:r.length>0?r[0]:n,prefix:o,name:a};return e&&!Qs(c)?null:c}const s=r[0],l=s.split("-");if(l.length>1){const a={provider:n,prefix:l.shift(),name:l.join("-")};return e&&!Qs(a)?null:a}if(t&&n===""){const a={provider:n,prefix:"",name:s};return e&&!Qs(a,t)?null:a}return null},Qs=(i,e)=>i?!!((i.provider===""||i.provider.match(ds))&&(e&&i.prefix===""||i.prefix.match(ds))&&i.name.match(ds)):!1;function up(i,e){const t={};!i.hFlip!=!e.hFlip&&(t.hFlip=!0),!i.vFlip!=!e.vFlip&&(t.vFlip=!0);const n=((i.rotate||0)+(e.rotate||0))%4;return n&&(t.rotate=n),t}function Tl(i,e){const t=up(i,e);for(const n in ac)n in _o?n in i&&!(n in t)&&(t[n]=_o[n]):n in e?t[n]=e[n]:n in i&&(t[n]=i[n]);return t}function fp(i,e){const t=i.icons,n=i.aliases||Object.create(null),r=Object.create(null);function s(l){if(t[l])return r[l]=[];if(!(l in r)){r[l]=null;const a=n[l]&&n[l].parent,o=a&&s(a);o&&(r[l]=[a].concat(o))}return r[l]}return(e||Object.keys(t).concat(Object.keys(n))).forEach(s),r}function hp(i,e,t){const n=i.icons,r=i.aliases||Object.create(null);let s={};function l(a){s=Tl(n[a]||r[a],s)}return l(e),t.forEach(l),Tl(i,s)}function lh(i,e){const t=[];if(typeof i!="object"||typeof i.icons!="object")return t;i.not_found instanceof Array&&i.not_found.forEach(r=>{e(r,null),t.push(r)});const n=fp(i);for(const r in n){const s=n[r];s&&(e(r,hp(i,r,s)),t.push(r))}return t}const dp={provider:"",aliases:{},not_found:{},...oh};function Ia(i,e){for(const t in e)if(t in i&&typeof i[t]!=typeof e[t])return!1;return!0}function uh(i){if(typeof i!="object"||i===null)return null;const e=i;if(typeof e.prefix!="string"||!i.icons||typeof i.icons!="object"||!Ia(i,dp))return null;const t=e.icons;for(const r in t){const s=t[r];if(!r.match(ds)||typeof s.body!="string"||!Ia(s,ac))return null}const n=e.aliases||Object.create(null);for(const r in n){const s=n[r],l=s.parent;if(!r.match(ds)||typeof l!="string"||!t[l]&&!n[l]||!Ia(s,ac))return null}return e}const Co=Object.create(null);function mp(i,e){return{provider:i,prefix:e,icons:Object.create(null),missing:new Set}}function cr(i,e){const t=Co[i]||(Co[i]=Object.create(null));return t[e]||(t[e]=mp(i,e))}function qc(i,e){return uh(e)?lh(e,(t,n)=>{n?i.icons[t]=n:i.missing.add(t)}):[]}function gp(i,e,t){try{if(typeof t.body=="string")return i.icons[e]={...t},!0}catch{}return!1}function pp(i,e){let t=[];return(typeof i=="string"?[i]:Object.keys(Co)).forEach(r=>{(typeof r=="string"&&typeof e=="string"?[e]:Object.keys(Co[r]||{})).forEach(l=>{const a=cr(r,l);t=t.concat(Object.keys(a.icons).map(o=>(r!==""?"@"+r+":":"")+l+":"+o))})}),t}let Ps=!1;function fh(i){return typeof i=="boolean"&&(Ps=i),Ps}function Es(i){const e=typeof i=="string"?Us(i,!0,Ps):i;if(e){const t=cr(e.provider,e.prefix),n=e.name;return t.icons[n]||(t.missing.has(n)?null:void 0)}}function hh(i,e){const t=Us(i,!0,Ps);if(!t)return!1;const n=cr(t.provider,t.prefix);return gp(n,t.name,e)}function wl(i,e){if(typeof i!="object")return!1;if(typeof e!="string"&&(e=i.provider||""),Ps&&!e&&!i.prefix){let r=!1;return uh(i)&&(i.prefix="",lh(i,(s,l)=>{l&&hh(s,l)&&(r=!0)})),r}const t=i.prefix;if(!Qs({provider:e,prefix:t,name:"a"}))return!1;const n=cr(e,t);return!!qc(n,i)}function vp(i){return!!Es(i)}function bp(i){const e=Es(i);return e?{...Bs,...e}:null}function yp(i){const e={loaded:[],missing:[],pending:[]},t=Object.create(null);i.sort((r,s)=>r.provider!==s.provider?r.provider.localeCompare(s.provider):r.prefix!==s.prefix?r.prefix.localeCompare(s.prefix):r.name.localeCompare(s.name));let n={provider:"",prefix:"",name:""};return i.forEach(r=>{if(n.name===r.name&&n.prefix===r.prefix&&n.provider===r.provider)return;n=r;const s=r.provider,l=r.prefix,a=r.name,o=t[s]||(t[s]=Object.create(null)),c=o[l]||(o[l]=cr(s,l));let f;a in c.icons?f=e.loaded:l===""||c.missing.has(a)?f=e.missing:f=e.pending;const u={provider:s,prefix:l,name:a};f.push(u)}),e}function dh(i,e){i.forEach(t=>{const n=t.loaderCallbacks;n&&(t.loaderCallbacks=n.filter(r=>r.id!==e))})}function _p(i){i.pendingCallbacksFlag||(i.pendingCallbacksFlag=!0,setTimeout(()=>{i.pendingCallbacksFlag=!1;const e=i.loaderCallbacks?i.loaderCallbacks.slice(0):[];if(!e.length)return;let t=!1;const n=i.provider,r=i.prefix;e.forEach(s=>{const l=s.icons,a=l.pending.length;l.pending=l.pending.filter(o=>{if(o.prefix!==r)return!0;const c=o.name;if(i.icons[c])l.loaded.push({provider:n,prefix:r,name:c});else if(i.missing.has(c))l.missing.push({provider:n,prefix:r,name:c});else return t=!0,!0;return!1}),l.pending.length!==a&&(t||dh([i],s.id),s.callback(l.loaded.slice(0),l.missing.slice(0),l.pending.slice(0),s.abort))})}))}let Cp=0;function Sp(i,e,t){const n=Cp++,r=dh.bind(null,t,n);if(!e.pending.length)return r;const s={id:n,icons:e,callback:i,abort:r};return t.forEach(l=>{(l.loaderCallbacks||(l.loaderCallbacks=[])).push(s)}),r}const cc=Object.create(null);function Pl(i,e){cc[i]=e}function lc(i){return cc[i]||cc[""]}function kp(i,e=!0,t=!1){const n=[];return i.forEach(r=>{const s=typeof r=="string"?Us(r,e,t):r;s&&n.push(s)}),n}var Tp={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function wp(i,e,t,n){const r=i.resources.length,s=i.random?Math.floor(Math.random()*r):i.index;let l;if(i.random){let C=i.resources.slice(0);for(l=[];C.length>1;){const k=Math.floor(Math.random()*C.length);l.push(C[k]),C=C.slice(0,k).concat(C.slice(k+1))}l=l.concat(C)}else l=i.resources.slice(s).concat(i.resources.slice(0,s));const a=Date.now();let o="pending",c=0,f,u=null,d=[],h=[];typeof n=="function"&&h.push(n);function m(){u&&(clearTimeout(u),u=null)}function p(){o==="pending"&&(o="aborted"),m(),d.forEach(C=>{C.status==="pending"&&(C.status="aborted")}),d=[]}function g(C,k){k&&(h=[]),typeof C=="function"&&h.push(C)}function v(){return{startTime:a,payload:e,status:o,queriesSent:c,queriesPending:d.length,subscribe:g,abort:p}}function b(){o="failed",h.forEach(C=>{C(void 0,f)})}function y(){d.forEach(C=>{C.status==="pending"&&(C.status="aborted")}),d=[]}function _(C,k,w){const A=k!=="success";switch(d=d.filter(I=>I!==C),o){case"pending":break;case"failed":if(A||!i.dataAfterTimeout)return;break;default:return}if(k==="abort"){f=w,b();return}if(A){f=w,d.length||(l.length?S():b());return}if(m(),y(),!i.random){const I=i.resources.indexOf(C.resource);I!==-1&&I!==i.index&&(i.index=I)}o="completed",h.forEach(I=>{I(w)})}function S(){if(o!=="pending")return;m();const C=l.shift();if(C===void 0){if(d.length){u=setTimeout(()=>{m(),o==="pending"&&(y(),b())},i.timeout);return}b();return}const k={status:"pending",resource:C,callback:(w,A)=>{_(k,w,A)}};d.push(k),c++,u=setTimeout(S,i.rotate),t(C,e,k.callback)}return setTimeout(S),v}function mh(i){const e={...Tp,...i};let t=[];function n(){t=t.filter(a=>a().status==="pending")}function r(a,o,c){const f=wp(e,a,o,(u,d)=>{n(),c&&c(u,d)});return t.push(f),f}function s(a){return t.find(o=>a(o))||null}return{query:r,find:s,setIndex:a=>{e.index=a},getIndex:()=>e.index,cleanup:n}}function Kc(i){let e;if(typeof i.resources=="string")e=[i.resources];else if(e=i.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:i.path||"/",maxURL:i.maxURL||500,rotate:i.rotate||750,timeout:i.timeout||5e3,random:i.random===!0,index:i.index||0,dataAfterTimeout:i.dataAfterTimeout!==!1}}const Mo=Object.create(null),$r=["https://api.simplesvg.com","https://api.unisvg.com"],Zs=[];for(;$r.length>0;)$r.length===1||Math.random()>.5?Zs.push($r.shift()):Zs.push($r.pop());Mo[""]=Kc({resources:["https://api.iconify.design"].concat(Zs)});function El(i,e){const t=Kc(e);return t===null?!1:(Mo[i]=t,!0)}function Io(i){return Mo[i]}function Pp(){return Object.keys(Mo)}function Ol(){}const La=Object.create(null);function Ep(i){if(!La[i]){const e=Io(i);if(!e)return;const t=mh(e),n={config:e,redundancy:t};La[i]=n}return La[i]}function gh(i,e,t){let n,r;if(typeof i=="string"){const s=lc(i);if(!s)return t(void 0,424),Ol;r=s.send;const l=Ep(i);l&&(n=l.redundancy)}else{const s=Kc(i);if(s){n=mh(s);const l=i.resources?i.resources[0]:"",a=lc(l);a&&(r=a.send)}}return!n||!r?(t(void 0,424),Ol):n.query(e,r,t)().abort}const xl="iconify2",Os="iconify",ph=Os+"-count",Al=Os+"-version",vh=36e5,Op=168;function uc(i,e){try{return i.getItem(e)}catch{}}function Qc(i,e,t){try{return i.setItem(e,t),!0}catch{}}function Dl(i,e){try{i.removeItem(e)}catch{}}function fc(i,e){return Qc(i,ph,e.toString())}function hc(i){return parseInt(uc(i,ph))||0}const mr={local:!0,session:!0},bh={local:new Set,session:new Set};let Zc=!1;function xp(i){Zc=i}let Ws=typeof window>"u"?{}:window;function yh(i){const e=i+"Storage";try{if(Ws&&Ws[e]&&typeof Ws[e].length=="number")return Ws[e]}catch{}mr[i]=!1}function _h(i,e){const t=yh(i);if(!t)return;const n=uc(t,Al);if(n!==xl){if(n){const a=hc(t);for(let o=0;o<a;o++)Dl(t,Os+o.toString())}Qc(t,Al,xl),fc(t,0);return}const r=Math.floor(Date.now()/vh)-Op,s=a=>{const o=Os+a.toString(),c=uc(t,o);if(typeof c=="string"){try{const f=JSON.parse(c);if(typeof f=="object"&&typeof f.cached=="number"&&f.cached>r&&typeof f.provider=="string"&&typeof f.data=="object"&&typeof f.data.prefix=="string"&&e(f,a))return!0}catch{}Dl(t,o)}};let l=hc(t);for(let a=l-1;a>=0;a--)s(a)||(a===l-1?(l--,fc(t,l)):bh[i].add(a))}function Ch(){if(!Zc){xp(!0);for(const i in mr)_h(i,e=>{const t=e.data,n=e.provider,r=t.prefix,s=cr(n,r);if(!qc(s,t).length)return!1;const l=t.lastModified||-1;return s.lastModifiedCached=s.lastModifiedCached?Math.min(s.lastModifiedCached,l):l,!0})}}function Ap(i,e){const t=i.lastModifiedCached;if(t&&t>=e)return t===e;if(i.lastModifiedCached=e,t)for(const n in mr)_h(n,r=>{const s=r.data;return r.provider!==i.provider||s.prefix!==i.prefix||s.lastModified===e});return!0}function Dp(i,e){Zc||Ch();function t(n){let r;if(!mr[n]||!(r=yh(n)))return;const s=bh[n];let l;if(s.size)s.delete(l=Array.from(s).shift());else if(l=hc(r),!fc(r,l+1))return;const a={cached:Math.floor(Date.now()/vh),provider:i.provider,data:e};return Qc(r,Os+l.toString(),JSON.stringify(a))}e.lastModified&&!Ap(i,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&(e=Object.assign({},e),delete e.not_found),t("local")||t("session"))}function Rl(){}function Rp(i){i.iconsLoaderFlag||(i.iconsLoaderFlag=!0,setTimeout(()=>{i.iconsLoaderFlag=!1,_p(i)}))}function Mp(i,e){i.iconsToLoad?i.iconsToLoad=i.iconsToLoad.concat(e).sort():i.iconsToLoad=e,i.iconsQueueFlag||(i.iconsQueueFlag=!0,setTimeout(()=>{i.iconsQueueFlag=!1;const{provider:t,prefix:n}=i,r=i.iconsToLoad;delete i.iconsToLoad;let s;if(!r||!(s=lc(t)))return;s.prepare(t,n,r).forEach(a=>{gh(t,a,o=>{if(typeof o!="object")a.icons.forEach(c=>{i.missing.add(c)});else try{const c=qc(i,o);if(!c.length)return;const f=i.pendingIcons;f&&c.forEach(u=>{f.delete(u)}),Dp(i,o)}catch(c){console.error(c)}Rp(i)})})}))}const $c=(i,e)=>{const t=kp(i,!0,fh()),n=yp(t);if(!n.pending.length){let o=!0;return e&&setTimeout(()=>{o&&e(n.loaded,n.missing,n.pending,Rl)}),()=>{o=!1}}const r=Object.create(null),s=[];let l,a;return n.pending.forEach(o=>{const{provider:c,prefix:f}=o;if(f===a&&c===l)return;l=c,a=f,s.push(cr(c,f));const u=r[c]||(r[c]=Object.create(null));u[f]||(u[f]=[])}),n.pending.forEach(o=>{const{provider:c,prefix:f,name:u}=o,d=cr(c,f),h=d.pendingIcons||(d.pendingIcons=new Set);h.has(u)||(h.add(u),r[c][f].push(u))}),s.forEach(o=>{const{provider:c,prefix:f}=o;r[c][f].length&&Mp(o,r[c][f])}),e?Sp(e,n,s):Rl},Ip=i=>new Promise((e,t)=>{const n=typeof i=="string"?Us(i,!0):i;if(!n){t(i);return}$c([n||i],r=>{if(r.length&&n){const s=Es(n);if(s){e({...Bs,...s});return}}t(i)})});function Lp(i){try{const e=typeof i=="string"?JSON.parse(i):i;if(typeof e.body=="string")return{...e}}catch{}}function Np(i,e){const t=typeof i=="string"?Us(i,!0,!0):null;if(!t){const s=Lp(i);return{value:i,data:s}}const n=Es(t);if(n!==void 0||!t.prefix)return{value:i,name:t,data:n};const r=$c([t],()=>e(i,t,Es(t)));return{value:i,name:t,loading:r}}function Na(i){return i.hasAttribute("inline")}let Sh=!1;try{Sh=navigator.vendor.indexOf("Apple")===0}catch{}function Fp(i,e){switch(e){case"svg":case"bg":case"mask":return e}return e!=="style"&&(Sh||i.indexOf("<a")===-1)?"svg":i.indexOf("currentColor")===-1?"bg":"mask"}const Bp=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Up=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function dc(i,e,t){if(e===1)return i;if(t=t||100,typeof i=="number")return Math.ceil(i*e*t)/t;if(typeof i!="string")return i;const n=i.split(Bp);if(n===null||!n.length)return i;const r=[];let s=n.shift(),l=Up.test(s);for(;;){if(l){const a=parseFloat(s);isNaN(a)?r.push(s):r.push(Math.ceil(a*e*t)/t)}else r.push(s);if(s=n.shift(),s===void 0)return r.join("");l=!l}}const jp=i=>i==="unset"||i==="undefined"||i==="none";function kh(i,e){const t={...Bs,...i},n={...ah,...e},r={left:t.left,top:t.top,width:t.width,height:t.height};let s=t.body;[t,n].forEach(m=>{const p=[],g=m.hFlip,v=m.vFlip;let b=m.rotate;g?v?b+=2:(p.push("translate("+(r.width+r.left).toString()+" "+(0-r.top).toString()+")"),p.push("scale(-1 1)"),r.top=r.left=0):v&&(p.push("translate("+(0-r.left).toString()+" "+(r.height+r.top).toString()+")"),p.push("scale(1 -1)"),r.top=r.left=0);let y;switch(b<0&&(b-=Math.floor(b/4)*4),b=b%4,b){case 1:y=r.height/2+r.top,p.unshift("rotate(90 "+y.toString()+" "+y.toString()+")");break;case 2:p.unshift("rotate(180 "+(r.width/2+r.left).toString()+" "+(r.height/2+r.top).toString()+")");break;case 3:y=r.width/2+r.left,p.unshift("rotate(-90 "+y.toString()+" "+y.toString()+")");break}b%2===1&&(r.left!==r.top&&(y=r.left,r.left=r.top,r.top=y),r.width!==r.height&&(y=r.width,r.width=r.height,r.height=y)),p.length&&(s='<g transform="'+p.join(" ")+'">'+s+"</g>")});const l=n.width,a=n.height,o=r.width,c=r.height;let f,u;l===null?(u=a===null?"1em":a==="auto"?c:a,f=dc(u,o/c)):(f=l==="auto"?o:l,u=a===null?dc(f,c/o):a==="auto"?c:a);const d={},h=(m,p)=>{jp(p)||(d[m]=p.toString())};return h("width",f),h("height",u),d.viewBox=r.left.toString()+" "+r.top.toString()+" "+o.toString()+" "+c.toString(),{attributes:d,body:s}}const Vp=()=>{let i;try{if(i=fetch,typeof i=="function")return i}catch{}};let So=Vp();function zp(i){So=i}function Wp(){return So}function Xp(i,e){const t=Io(i);if(!t)return 0;let n;if(!t.maxURL)n=0;else{let r=0;t.resources.forEach(l=>{r=Math.max(r,l.length)});const s=e+".json?icons=";n=t.maxURL-r-t.path.length-s.length}return n}function Hp(i){return i===404}const Yp=(i,e,t)=>{const n=[],r=Xp(i,e),s="icons";let l={type:s,provider:i,prefix:e,icons:[]},a=0;return t.forEach((o,c)=>{a+=o.length+1,a>=r&&c>0&&(n.push(l),l={type:s,provider:i,prefix:e,icons:[]},a=o.length),l.icons.push(o)}),n.push(l),n};function Gp(i){if(typeof i=="string"){const e=Io(i);if(e)return e.path}return"/"}const Jp=(i,e,t)=>{if(!So){t("abort",424);return}let n=Gp(e.provider);switch(e.type){case"icons":{const s=e.prefix,a=e.icons.join(","),o=new URLSearchParams({icons:a});n+=s+".json?"+o.toString();break}case"custom":{const s=e.uri;n+=s.slice(0,1)==="/"?s.slice(1):s;break}default:t("abort",400);return}let r=503;So(i+n).then(s=>{const l=s.status;if(l!==200){setTimeout(()=>{t(Hp(l)?"abort":"next",l)});return}return r=501,s.json()}).then(s=>{if(typeof s!="object"||s===null){setTimeout(()=>{s===404?t("abort",s):t("next",r)});return}setTimeout(()=>{t("success",s)})}).catch(()=>{t("next",r)})},qp={prepare:Yp,send:Jp};function Ml(i,e){switch(i){case"local":case"session":mr[i]=e;break;case"all":for(const t in mr)mr[t]=e;break}}const Fa="data-style";let Th="";function wh(i){Th=i}function Il(i,e){let t=Array.from(i.childNodes).find(n=>n.hasAttribute&&n.hasAttribute(Fa));t||(t=document.createElement("style"),t.setAttribute(Fa,Fa),i.appendChild(t)),t.textContent=":host{display:inline-block;vertical-align:"+(e?"-0.125em":"0")+"}span,svg{display:block}"+Th}function Ph(){Pl("",qp),fh(!0);let i;try{i=window}catch{}if(i){if(Ch(),i.IconifyPreload!==void 0){const t=i.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!wl(r))&&console.error(n)}catch{console.error(n)}})}if(i.IconifyProviders!==void 0){const t=i.IconifyProviders;if(typeof t=="object"&&t!==null)for(const n in t){const r="IconifyProviders["+n+"] is invalid.";try{const s=t[n];if(typeof s!="object"||!s||s.resources===void 0)continue;El(n,s)||console.error(r)}catch{console.error(r)}}}}return{enableCache:t=>Ml(t,!0),disableCache:t=>Ml(t,!1),iconExists:vp,getIcon:bp,listIcons:pp,addIcon:hh,addCollection:wl,calculateSize:dc,buildIcon:kh,loadIcons:$c,loadIcon:Ip,addAPIProvider:El,appendCustomStyle:wh,_api:{getAPIConfig:Io,setAPIModule:Pl,sendAPIQuery:gh,setFetch:zp,getFetch:Wp,listAPIProviders:Pp}}}function Eh(i,e){let t=i.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const n in e)t+=" "+n+'="'+e[n]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+t+">"+i+"</svg>"}function Kp(i){return i.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Qp(i){return"data:image/svg+xml,"+Kp(i)}function Zp(i){return'url("'+Qp(i)+'")'}const mc={"background-color":"currentColor"},Oh={"background-color":"transparent"},Ll={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},Nl={"-webkit-mask":mc,mask:mc,background:Oh};for(const i in Nl){const e=Nl[i];for(const t in Ll)e[i+"-"+t]=Ll[t]}function Fl(i){return i?i+(i.match(/^[-0-9.]+$/)?"px":""):"inherit"}function $p(i,e,t){const n=document.createElement("span");let r=i.body;r.indexOf("<a")!==-1&&(r+="<!-- "+Date.now()+" -->");const s=i.attributes,l=Eh(r,{...s,width:e.width+"",height:e.height+""}),a=Zp(l),o=n.style,c={"--svg":a,width:Fl(s.width),height:Fl(s.height),...t?mc:Oh};for(const f in c)o.setProperty(f,c[f]);return n}let ms;function ev(){try{ms=window.trustedTypes.createPolicy("iconify",{createHTML:i=>i})}catch{ms=null}}function tv(i){return ms===void 0&&ev(),ms?ms.createHTML(i):i}function iv(i){const e=document.createElement("span"),t=i.attributes;let n="";t.width||(n="width: inherit;"),t.height||(n+="height: inherit;"),n&&(t.style=n);const r=Eh(i.body,t);return e.innerHTML=tv(r),e.firstChild}function Bl(i,e){const t=e.icon.data,n=e.customisations,r=kh(t,n);n.preserveAspectRatio&&(r.attributes.preserveAspectRatio=n.preserveAspectRatio);const s=e.renderedMode;let l;switch(s){case"svg":l=iv(r);break;default:l=$p(r,{...Bs,...t},s==="mask")}const a=Array.from(i.childNodes).find(o=>{const c=o.tagName&&o.tagName.toUpperCase();return c==="SPAN"||c==="SVG"});a?l.tagName==="SPAN"&&a.tagName===l.tagName?a.setAttribute("style",l.getAttribute("style")):i.replaceChild(l,a):i.appendChild(l)}function Ul(i,e,t){const n=t&&(t.rendered?t:t.lastRender);return{rendered:!1,inline:e,icon:i,lastRender:n}}function nv(i="iconify-icon"){let e,t;try{e=window.customElements,t=window.HTMLElement}catch{return}if(!e||!t)return;const n=e.get(i);if(n)return n;const r=["icon","mode","inline","width","height","rotate","flip"],s=class extends t{constructor(){super();Qe(this,"_shadowRoot");Qe(this,"_state");Qe(this,"_checkQueued",!1);const o=this._shadowRoot=this.attachShadow({mode:"open"}),c=Na(this);Il(o,c),this._state=Ul({value:""},c),this._queueCheck()}static get observedAttributes(){return r.slice(0)}attributeChangedCallback(o){if(o==="inline"){const c=Na(this),f=this._state;c!==f.inline&&(f.inline=c,Il(this._shadowRoot,c))}else this._queueCheck()}get icon(){const o=this.getAttribute("icon");if(o&&o.slice(0,1)==="{")try{return JSON.parse(o)}catch{}return o}set icon(o){typeof o=="object"&&(o=JSON.stringify(o)),this.setAttribute("icon",o)}get inline(){return Na(this)}set inline(o){o?this.setAttribute("inline","true"):this.removeAttribute("inline")}restartAnimation(){const o=this._state;if(o.rendered){const c=this._shadowRoot;if(o.renderedMode==="svg")try{c.lastChild.setCurrentTime(0);return}catch{}Bl(c,o)}}get status(){const o=this._state;return o.rendered?"rendered":o.icon.data===null?"failed":"loading"}_queueCheck(){this._checkQueued||(this._checkQueued=!0,setTimeout(()=>{this._check()}))}_check(){if(!this._checkQueued)return;this._checkQueued=!1;const o=this._state,c=this.getAttribute("icon");if(c!==o.icon.value){this._iconChanged(c);return}if(!o.rendered)return;const f=this.getAttribute("mode"),u=kl(this);(o.attrMode!==f||lp(o.customisations,u))&&this._renderIcon(o.icon,u,f)}_iconChanged(o){const c=Np(o,(f,u,d)=>{const h=this._state;if(h.rendered||this.getAttribute("icon")!==f)return;const m={value:f,name:u,data:d};m.data?this._gotIconData(m):h.icon=m});c.data?this._gotIconData(c):this._state=Ul(c,this._state.inline,this._state)}_gotIconData(o){this._checkQueued=!1,this._renderIcon(o,kl(this),this.getAttribute("mode"))}_renderIcon(o,c,f){const u=Fp(o.data.body,f),d=this._state.inline;Bl(this._shadowRoot,this._state={rendered:!0,icon:o,inline:d,customisations:c,attrMode:f,renderedMode:u})}};r.forEach(a=>{a in s.prototype||Object.defineProperty(s.prototype,a,{get:function(){return this.getAttribute(a)},set:function(o){o!==null?this.setAttribute(a,o):this.removeAttribute(a)}})});const l=Ph();for(const a in l)s[a]=s.prototype[a]=l[a];return e.define(i,s),s}nv()||Ph();function jl(i){let e,t;return{c(){e=ve("iconify-icon"),as(e,"icon",t=i[2]+":"+i[1]),as(e,"width","100%"),as(e,"height","100%")},m(n,r){$(n,e,r)},p(n,r){r&6&&t!==(t=n[2]+":"+n[1])&&as(e,"icon",t)},d(n){n&&K(e)}}}function rv(i){let e,t=i[3]&&jl(i);return{c(){t&&t.c(),e=Rt()},m(n,r){t&&t.m(n,r),$(n,e,r)},p(n,r){n[3]?t?t.p(n,r):(t=jl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&K(e),t&&t.d(n)}}}function sv(i){let e,t;const n=[{componentName:i[0]},{components:i[5]},i[6],{cssProps:i[4]}];let r={$$slots:{default:[rv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&113?ut(n,[l&1&&{componentName:s[0]},l&32&&{components:s[5]},l&64&&tt(s[6]),l&16&&{cssProps:s[4]}]):{};l&1038&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}wh('svg [stroke-width="2"] { stroke-width: 1.5; }');function ov(i,e,t){let n;const r=["componentName","color","name","pack","size"];let s=Xe(e,r),{componentName:l="icon"}=e,{color:a=void 0}=e,{name:o=void 0}=e,{pack:c="tabler"}=e,{size:f=void 0}=e;const u=[{component:ht(),except:[]},...e.components??[]];let d=!1;return Ui(()=>{t(3,d=!0)}),i.$$set=h=>{t(9,e=Ce(Ce({},e),je(h))),t(6,s=Xe(e,r)),"componentName"in h&&t(0,l=h.componentName),"color"in h&&t(7,a=h.color),"name"in h&&t(1,o=h.name),"pack"in h&&t(2,c=h.pack),"size"in h&&t(8,f=h.size)},i.$$.update=()=>{i.$$.dirty&384&&t(4,n={color:a,size:f})},e=je(e),[l,o,c,d,n,u,s,a,f]}class av extends Ye{constructor(e){super(),He(this,e,ov,sv,Ve,{componentName:0,color:7,name:1,pack:2,size:8})}}const yt=av;function cv(i){let e;const t=i[8].default,n=gt(t,i,i[9],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&512)&&vt(n,t,r,r[9],e?pt(t,r[9],s,null):bt(r[9]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function lv(i){let e,t;const n=[{components:i[2]},{tag:"span"},i[3],{cssProps:i[0]},i[1]];let r={$$slots:{default:[cv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&15?ut(n,[l&4&&{components:s[2]},n[1],l&8&&tt(s[3]),l&1&&{cssProps:s[0]},l&2&&tt(s[1])]):{};l&512&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function uv(i,e,t){const n=["componentName","color","shape","size"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="avatar"}=e,{color:o=void 0}=e,{shape:c=void 0}=e,{size:f=void 0}=e;const u=[{component:ht(),except:[]},...e.components??[]];let d={},h={};return i.$$set=m=>{t(10,e=Ce(Ce({},e),je(m))),t(3,r=Xe(e,n)),"componentName"in m&&t(4,a=m.componentName),"color"in m&&t(5,o=m.color),"shape"in m&&t(6,c=m.shape),"size"in m&&t(7,f=m.size),"$$scope"in m&&t(9,l=m.$$scope)},i.$$.update=()=>{i.$$.dirty&240&&(t(0,d={color:o,size:f,shape:c}),t(1,h={componentName:a}))},e=je(e),[d,h,u,r,a,o,c,f,s,l]}class fv extends Ye{constructor(e){super(),He(this,e,uv,lv,Ve,{componentName:4,color:5,shape:6,size:7})}}const hv=fv;function dv(i){let e;const t=i[19].default,n=gt(t,i,i[22],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&4194304)&&vt(n,t,r,r[22],e?pt(t,r[22],s,null):bt(r[22]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function mv(i){let e,t,n;const r=[{components:i[3]},i[4],{cssProps:i[1]},i[2]];function s(a){i[20](a)}let l={$$slots:{default:[dv]},$$scope:{ctx:i}};for(let a=0;a<r.length;a+=1)l=Ce(l,r[a]);return i[0]!==void 0&&(l.element=i[0]),e=new Ke({props:l}),Fe.push(()=>nt(e,"element",s)),e.$on("click",i[21]),{c(){V(e.$$.fragment)},m(a,o){U(e,a,o),n=!0},p(a,[o]){const c=o&30?ut(r,[o&8&&{components:a[3]},o&16&&tt(a[4]),o&2&&{cssProps:a[1]},o&4&&tt(a[2])]):{};o&4194304&&(c.$$scope={dirty:o,ctx:a}),!t&&o&1&&(t=!0,c.element=a[0],lt(()=>t=!1)),e.$set(c)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){E(e.$$.fragment,a),n=!1},d(a){j(e,a)}}}function gv(i,e,t){let n;const r=["active","color","componentName","disabled","ghost","href","link","loading","outline","shape","size","target","type"];let s=Xe(e,r),{$$slots:l={},$$scope:a}=e,{active:o=void 0}=e,{color:c=void 0}=e,{componentName:f="button"}=e,{disabled:u=void 0}=e,{ghost:d=void 0}=e,{href:h=void 0}=e,{link:m=void 0}=e,{loading:p=void 0}=e,{outline:g=void 0}=e,{shape:v=void 0}=e,{size:b=void 0}=e,{target:y=void 0}=e,{type:_=void 0}=e;const S=[{component:ht(),except:[]},...e.components??[]];let C={},k={},w;function A(z){w=z,t(0,w)}function I(z){Xc.call(this,i,z)}return i.$$set=z=>{t(23,e=Ce(Ce({},e),je(z))),t(4,s=Xe(e,r)),"active"in z&&t(5,o=z.active),"color"in z&&t(6,c=z.color),"componentName"in z&&t(7,f=z.componentName),"disabled"in z&&t(8,u=z.disabled),"ghost"in z&&t(9,d=z.ghost),"href"in z&&t(10,h=z.href),"link"in z&&t(11,m=z.link),"loading"in z&&t(12,p=z.loading),"outline"in z&&t(13,g=z.outline),"shape"in z&&t(14,v=z.shape),"size"in z&&t(15,b=z.size),"target"in z&&t(16,y=z.target),"type"in z&&t(17,_=z.type),"$$scope"in z&&t(22,a=z.$$scope)},i.$$.update=()=>{i.$$.dirty&1&&t(18,n=!((w==null?void 0:w.textContent)??!0)),i.$$.dirty&524256&&(t(1,C={active:o,color:c,disabled:u,ghost:d,icon:n,link:m,loading:p,outline:g,shape:v,size:b}),t(2,k={componentName:f,href:h,role:"button",tag:h?"a":"button",target:y,type:_??"button"}))},e=je(e),[w,C,k,S,s,o,c,f,u,d,h,m,p,g,v,b,y,_,n,l,A,I,a]}class pv extends Ye{constructor(e){super(),He(this,e,gv,mv,Ve,{active:5,color:6,componentName:7,disabled:8,ghost:9,href:10,link:11,loading:12,outline:13,shape:14,size:15,target:16,type:17})}}const rt=pv;function vv(i){let e;const t=i[5].default,n=gt(t,i,i[6],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&64)&&vt(n,t,r,r[6],e?pt(t,r[6],s,null):bt(r[6]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function bv(i){let e,t;const n=[{components:i[2]},i[3],{cssProps:i[1]},{componentName:i[0]}];let r={$$slots:{default:[vv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&15?ut(n,[l&4&&{components:s[2]},l&8&&tt(s[3]),l&2&&{cssProps:s[1]},l&1&&{componentName:s[0]}]):{};l&64&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function yv(i,e,t){const n=["componentName","light"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="card-header"}=e,{light:o=void 0}=e;const c=[{component:ht(),except:[]},...e.components??[]];let f={};return i.$$set=u=>{t(7,e=Ce(Ce({},e),je(u))),t(3,r=Xe(e,n)),"componentName"in u&&t(0,a=u.componentName),"light"in u&&t(4,o=u.light),"$$scope"in u&&t(6,l=u.$$scope)},i.$$.update=()=>{i.$$.dirty&16&&t(1,f={light:o})},e=je(e),[a,f,c,r,o,s,l]}class _v extends Ye{constructor(e){super(),He(this,e,yv,bv,Ve,{componentName:0,light:4})}}const Lo=_v;function Cv(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Sv(i){let e,t;const n=[{components:i[1]},i[2],{componentName:i[0]}];let r={$$slots:{default:[Cv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&2&&{components:s[1]},l&4&&tt(s[2]),l&1&&{componentName:s[0]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function kv(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="card-title"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class Tv extends Ye{constructor(e){super(),He(this,e,kv,Sv,Ve,{componentName:0})}}const No=Tv;function Vl(i){let e,t;return e=new Ke({props:{componentName:i[0]+"-status",cssProps:i[5]}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.componentName=n[0]+"-status"),r&32&&(s.cssProps=n[5]),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function zl(i){let e,t;return e=new Lo({props:{$$slots:{default:[Pv]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&262146&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function wv(i){let e;return{c(){e=et(i[1])},m(t,n){$(t,e,n)},p(t,n){n&2&&ui(e,t[1])},d(t){t&&K(e)}}}function Pv(i){let e,t;return e=new No({props:{$$slots:{default:[wv]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&262146&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Ev(i){let e,t,n,r=i[2]&&Vl(i),s=i[1]&&zl(i);const l=i[17].default,a=gt(l,i,i[18],null);return{c(){r&&r.c(),e=ue(),s&&s.c(),t=ue(),a&&a.c()},m(o,c){r&&r.m(o,c),$(o,e,c),s&&s.m(o,c),$(o,t,c),a&&a.m(o,c),n=!0},p(o,c){o[2]?r?(r.p(o,c),c&4&&T(r,1)):(r=Vl(o),r.c(),T(r,1),r.m(e.parentNode,e)):r&&(Je(),E(r,1,1,()=>{r=null}),qe()),o[1]?s?(s.p(o,c),c&2&&T(s,1)):(s=zl(o),s.c(),T(s,1),s.m(t.parentNode,t)):s&&(Je(),E(s,1,1,()=>{s=null}),qe()),a&&a.p&&(!n||c&262144)&&vt(a,l,o,o[18],n?pt(l,o[18],c,null):bt(o[18]),null)},i(o){n||(T(r),T(s),T(a,o),n=!0)},o(o){E(r),E(s),E(a,o),n=!1},d(o){o&&(K(e),K(t)),r&&r.d(o),s&&s.d(o),a&&a.d(o)}}}function Ov(i){let e,t;const n=[{components:i[6]},i[7],{cssProps:i[3]},i[4]];let r={$$slots:{default:[Ev]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&216?ut(n,[l&64&&{components:s[6]},l&128&&tt(s[7]),l&8&&{cssProps:s[3]},l&16&&tt(s[4])]):{};l&262183&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function xv(i,e,t){const n=["componentName","title","stacked","statusColor","statusPosition","statusSize","status","bgColor","borderless","rotate","state","size"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="card"}=e,{title:o=void 0}=e,{stacked:c=void 0}=e,{statusColor:f="primary"}=e,{statusPosition:u="top"}=e,{statusSize:d="md"}=e,{status:h=void 0}=e,{bgColor:m=void 0}=e,{borderless:p=void 0}=e,{rotate:g=void 0}=e,{state:v=void 0}=e,{size:b=void 0}=e;const y=[{component:ht(),except:[]},...e.components??[]];let _={},S={},C={};return i.$$set=k=>{t(19,e=Ce(Ce({},e),je(k))),t(7,r=Xe(e,n)),"componentName"in k&&t(0,a=k.componentName),"title"in k&&t(1,o=k.title),"stacked"in k&&t(8,c=k.stacked),"statusColor"in k&&t(9,f=k.statusColor),"statusPosition"in k&&t(10,u=k.statusPosition),"statusSize"in k&&t(11,d=k.statusSize),"status"in k&&t(2,h=k.status),"bgColor"in k&&t(12,m=k.bgColor),"borderless"in k&&t(13,p=k.borderless),"rotate"in k&&t(14,g=k.rotate),"state"in k&&t(15,v=k.state),"size"in k&&t(16,b=k.size),"$$scope"in k&&t(18,l=k.$$scope)},i.$$.update=()=>{i.$$.dirty&130817&&(t(3,_={stacked:c,bgColor:m,borderless:p,rotate:g,state:v,size:b}),t(4,S={componentName:a}),t(5,C={size:d,position:u,color:f}))},e=je(e),[a,o,h,_,S,C,y,r,c,f,u,d,m,p,g,v,b,s,l]}class Av extends Ye{constructor(e){super(),He(this,e,xv,Ov,Ve,{componentName:0,title:1,stacked:8,statusColor:9,statusPosition:10,statusSize:11,status:2,bgColor:12,borderless:13,rotate:14,state:15,size:16})}}const js=Av;function Dv(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Rv(i){let e,t;const n=[{components:i[1]},i[2],{componentName:i[0]}];let r={$$slots:{default:[Dv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&2&&{components:s[1]},l&4&&tt(s[2]),l&1&&{componentName:s[0]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Mv(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="card-body"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class Iv extends Ye{constructor(e){super(),He(this,e,Mv,Rv,Ve,{componentName:0})}}const Vs=Iv,Lv="modulepreload",Nv=function(i){return"/call/"+i},Wl={},el=function(e,t,n){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=Nv(s),s in Wl)return;Wl[s]=!0;const l=s.endsWith(".css"),a=l?'[rel="stylesheet"]':"";if(!!n)for(let f=r.length-1;f>=0;f--){const u=r[f];if(u.href===s&&(!l||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":Lv,l||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),l)return new Promise((f,u)=>{c.addEventListener("load",f),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})};function Fv(i){let e;const t=i[8].default,n=gt(t,i,i[9],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&512)&&vt(n,t,r,r[9],e?pt(t,r[9],s,null):bt(r[9]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Bv(i){let e,t;const n=[{components:i[2]},i[3],{cssProps:i[0]},i[1]];let r={$$slots:{default:[Fv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&15?ut(n,[l&4&&{components:s[2]},l&8&&tt(s[3]),l&1&&{cssProps:s[0]},l&2&&tt(s[1])]):{};l&512&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Uv(i,e,t){const n=["componentName","color","direction","alignment"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="divider"}=e,{color:o=void 0}=e,{direction:c=void 0}=e,{alignment:f=void 0}=e;const u=[{component:ht(),except:[]},...e.components??[]];let d={},h={};return i.$$set=m=>{t(10,e=Ce(Ce({},e),je(m))),t(3,r=Xe(e,n)),"componentName"in m&&t(4,a=m.componentName),"color"in m&&t(5,o=m.color),"direction"in m&&t(6,c=m.direction),"alignment"in m&&t(7,f=m.alignment),"$$scope"in m&&t(9,l=m.$$scope)},i.$$.update=()=>{i.$$.dirty&240&&(t(0,d={alignment:f,color:o,direction:c}),t(1,h={componentName:a}))},e=je(e),[d,h,u,r,a,o,c,f,s,l]}class jv extends Ye{constructor(e){super(),He(this,e,Uv,Bv,Ve,{componentName:4,color:5,direction:6,alignment:7})}}const Vv=jv;function Xl(i){let e,t,n,r,s,l;return e=new Ke({props:{componentName:"dot-indicator-circle"}}),n=new Ke({props:{componentName:"dot-indicator-circle"}}),s=new Ke({props:{componentName:"dot-indicator-circle"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment),r=ue(),V(s.$$.fragment)},m(a,o){U(e,a,o),$(a,t,o),U(n,a,o),$(a,r,o),U(s,a,o),l=!0},i(a){l||(T(e.$$.fragment,a),T(n.$$.fragment,a),T(s.$$.fragment,a),l=!0)},o(a){E(e.$$.fragment,a),E(n.$$.fragment,a),E(s.$$.fragment,a),l=!1},d(a){a&&(K(t),K(r)),j(e,a),j(n,a),j(s,a)}}}function zv(i){let e,t,n=i[0]&&Xl();return{c(){n&&n.c(),e=Rt()},m(r,s){n&&n.m(r,s),$(r,e,s),t=!0},p(r,s){r[0]?n?s&1&&T(n,1):(n=Xl(),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),E(n,1,1,()=>{n=null}),qe())},i(r){t||(T(n),t=!0)},o(r){E(n),t=!1},d(r){r&&K(e),n&&n.d(r)}}}function Wv(i){let e,t;const n=[{components:i[3]},i[4],{cssProps:i[1]},i[2]];let r={$$slots:{default:[zv]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&30?ut(n,[l&8&&{components:s[3]},l&16&&tt(s[4]),l&2&&{cssProps:s[1]},l&4&&tt(s[2])]):{};l&1025&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Xv(i,e,t){const n=["animated","color","componentName","indicator","tag"];let r=Xe(e,n),{animated:s=void 0}=e,{color:l=void 0}=e,{componentName:a="dot"}=e,{indicator:o=void 0}=e,{tag:c="span"}=e;const f=[{component:ht(),except:[]},...e.components??[]];let u={},d={};return i.$$set=h=>{t(9,e=Ce(Ce({},e),je(h))),t(4,r=Xe(e,n)),"animated"in h&&t(5,s=h.animated),"color"in h&&t(6,l=h.color),"componentName"in h&&t(7,a=h.componentName),"indicator"in h&&t(0,o=h.indicator),"tag"in h&&t(8,c=h.tag)},i.$$.update=()=>{i.$$.dirty&481&&(t(1,u={animated:s,color:l,indicator:o}),t(2,d={tag:c,componentName:a}))},e=je(e),[o,u,d,f,r,s,l,a,c]}class Hv extends Ye{constructor(e){super(),He(this,e,Xv,Wv,Ve,{animated:5,color:6,componentName:7,indicator:0,tag:8})}}const Yv=Hv,Gv=i=>({}),Hl=i=>({}),Jv=i=>({}),Yl=i=>({});function qv(i){let e,t,n,r;const s=[{components:i[6]},{tag:"textarea"},i[8],i[4],{cssProps:i[5]}];function l(c){i[24](c)}function a(c){i[25](c)}let o={};for(let c=0;c<s.length;c+=1)o=Ce(o,s[c]);return i[1]!==void 0&&(o.id=i[1]),i[0]!==void 0&&(o.value=i[0]),e=new Ke({props:o}),Fe.push(()=>nt(e,"id",l)),Fe.push(()=>nt(e,"value",a)),{c(){V(e.$$.fragment)},m(c,f){U(e,c,f),r=!0},p(c,f){const u=f&368?ut(s,[f&64&&{components:c[6]},s[1],f&256&&tt(c[8]),f&16&&tt(c[4]),f&32&&{cssProps:c[5]}]):{};!t&&f&2&&(t=!0,u.id=c[1],lt(()=>t=!1)),!n&&f&1&&(n=!0,u.value=c[0],lt(()=>n=!1)),e.$set(u)},i(c){r||(T(e.$$.fragment,c),r=!0)},o(c){E(e.$$.fragment,c),r=!1},d(c){j(e,c)}}}function Kv(i){let e,t;const n=[{components:i[6]},{componentName:i[2]+"-wrapper"},i[8],{cssProps:{size:i[3]}}];let r={$$slots:{default:[$v]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,l){const a=l&332?ut(n,[l&64&&{components:s[6]},l&4&&{componentName:s[2]+"-wrapper"},l&256&&tt(s[8]),l&8&&{cssProps:{size:s[3]}}]):{};l&67109047&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Gl(i){let e,t;return e=new Ke({props:{tag:"span",componentName:i[2]+"-icon",$$slots:{default:[Qv]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-icon"),r&67108864&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Qv(i){let e;const t=i[21].start,n=gt(t,i,i[26],Yl);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&67108864)&&vt(n,t,r,r[26],e?pt(t,r[26],s,Jv):bt(r[26]),Yl)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Jl(i){let e,t;return e=new Ke({props:{tag:"span",componentName:i[2]+"-icon",$$slots:{default:[Zv]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-icon"),r&67108864&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Zv(i){let e;const t=i[21].end,n=gt(t,i,i[26],Hl);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&67108864)&&vt(n,t,r,r[26],e?pt(t,r[26],s,Gv):bt(r[26]),Hl)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function $v(i){let e,t,n,r,s,l,a,o=i[7].start&&Gl(i);const c=[{tag:"textarea"},i[4],{cssProps:i[5]}];function f(m){i[22](m)}function u(m){i[23](m)}let d={};for(let m=0;m<c.length;m+=1)d=Ce(d,c[m]);i[1]!==void 0&&(d.id=i[1]),i[0]!==void 0&&(d.value=i[0]),t=new Ke({props:d}),Fe.push(()=>nt(t,"id",f)),Fe.push(()=>nt(t,"value",u));let h=i[7].end&&Jl(i);return{c(){o&&o.c(),e=ue(),V(t.$$.fragment),s=ue(),h&&h.c(),l=Rt()},m(m,p){o&&o.m(m,p),$(m,e,p),U(t,m,p),$(m,s,p),h&&h.m(m,p),$(m,l,p),a=!0},p(m,p){m[7].start?o?(o.p(m,p),p&128&&T(o,1)):(o=Gl(m),o.c(),T(o,1),o.m(e.parentNode,e)):o&&(Je(),E(o,1,1,()=>{o=null}),qe());const g=p&48?ut(c,[c[0],p&16&&tt(m[4]),p&32&&{cssProps:m[5]}]):{};!n&&p&2&&(n=!0,g.id=m[1],lt(()=>n=!1)),!r&&p&1&&(r=!0,g.value=m[0],lt(()=>r=!1)),t.$set(g),m[7].end?h?(h.p(m,p),p&128&&T(h,1)):(h=Jl(m),h.c(),T(h,1),h.m(l.parentNode,l)):h&&(Je(),E(h,1,1,()=>{h=null}),qe())},i(m){a||(T(o),T(t.$$.fragment,m),T(h),a=!0)},o(m){E(o),E(t.$$.fragment,m),E(h),a=!1},d(m){m&&(K(e),K(s),K(l)),o&&o.d(m),j(t,m),h&&h.d(m)}}}function e0(i){let e,t,n,r;const s=[Kv,qv],l=[];function a(o,c){return o[7].start||o[7].end?0:1}return e=a(i),t=l[e]=s[e](i),{c(){t.c(),n=Rt()},m(o,c){l[e].m(o,c),$(o,n,c),r=!0},p(o,[c]){let f=e;e=a(o),e===f?l[e].p(o,c):(Je(),E(l[f],1,1,()=>{l[f]=null}),qe(),t=l[e],t?t.p(o,c):(t=l[e]=s[e](o),t.c()),T(t,1),t.m(n.parentNode,n))},i(o){r||(T(t),r=!0)},o(o){E(t),r=!1},d(o){o&&K(n),l[e].d(o)}}}function t0(i,e,t){const n=["componentName","disabled","borderRounded","borderFlush","placeholder","readonly","rows","name","size","state","type","value","id","minlength","maxlength","cols"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e;const a=jc(s);let{componentName:o="textarea"}=e,{disabled:c=void 0}=e,{borderRounded:f=void 0}=e,{borderFlush:u=void 0}=e,{placeholder:d=void 0}=e,{readonly:h=void 0}=e,{rows:m=void 0}=e,{name:p=void 0}=e,{size:g=void 0}=e,{state:v=void 0}=e,{type:b=void 0}=e,{value:y=void 0}=e,{id:_=void 0}=e,{minlength:S=void 0}=e,{maxlength:C=void 0}=e,{cols:k=void 0}=e,w={},A={};const I=[{component:ht(),except:[]},...e.components??[]];function z(Z){_=Z,t(1,_)}function H(Z){y=Z,t(0,y)}function Q(Z){_=Z,t(1,_)}function ee(Z){y=Z,t(0,y)}return i.$$set=Z=>{t(27,e=Ce(Ce({},e),je(Z))),t(8,r=Xe(e,n)),"componentName"in Z&&t(2,o=Z.componentName),"disabled"in Z&&t(9,c=Z.disabled),"borderRounded"in Z&&t(10,f=Z.borderRounded),"borderFlush"in Z&&t(11,u=Z.borderFlush),"placeholder"in Z&&t(12,d=Z.placeholder),"readonly"in Z&&t(13,h=Z.readonly),"rows"in Z&&t(14,m=Z.rows),"name"in Z&&t(15,p=Z.name),"size"in Z&&t(3,g=Z.size),"state"in Z&&t(16,v=Z.state),"type"in Z&&t(17,b=Z.type),"value"in Z&&t(0,y=Z.value),"id"in Z&&t(1,_=Z.id),"minlength"in Z&&t(18,S=Z.minlength),"maxlength"in Z&&t(19,C=Z.maxlength),"cols"in Z&&t(20,k=Z.cols),"$$scope"in Z&&t(26,l=Z.$$scope)},i.$$.update=()=>{i.$$.dirty&2096652&&(t(5,A={size:g,state:v,borderRounded:f,borderFlush:u}),t(4,w={componentName:o,placeholder:d,disabled:c,readonly:h,type:b,rows:m,name:p,minlength:S,maxlength:C,cols:k}))},e=je(e),[y,_,o,g,w,A,I,a,r,c,f,u,d,h,m,p,v,b,S,C,k,s,z,H,Q,ee,l]}class i0 extends Ye{constructor(e){super(),He(this,e,t0,e0,Ve,{componentName:2,disabled:9,borderRounded:10,borderFlush:11,placeholder:12,readonly:13,rows:14,name:15,size:3,state:16,type:17,value:0,id:1,minlength:18,maxlength:19,cols:20})}}const n0=i0;function r0(i){let e;const t=i[7].default,n=gt(t,i,i[8],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&256)&&vt(n,t,r,r[8],e?pt(t,r[8],s,null):bt(r[8]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function s0(i){let e,t;const n=[{tag:"label"},{components:i[3]},i[4],{for:i[0]},{cssProps:i[2]},i[1]];let r={$$slots:{default:[r0]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&31?ut(n,[n[0],l&8&&{components:s[3]},l&16&&tt(s[4]),l&1&&{for:s[0]},l&4&&{cssProps:s[2]},l&2&&tt(s[1])]):{};l&256&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function o0(i,e,t){const n=["componentName","required","for"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="label"}=e,{required:o=void 0}=e,{for:c=void 0}=e;const f=[{component:ht(),except:[]},...e.components??[]];let u={},d={};return i.$$set=h=>{t(9,e=Ce(Ce({},e),je(h))),t(4,r=Xe(e,n)),"componentName"in h&&t(5,a=h.componentName),"required"in h&&t(6,o=h.required),"for"in h&&t(0,c=h.for),"$$scope"in h&&t(8,l=h.$$scope)},i.$$.update=()=>{i.$$.dirty&96&&(t(2,d={required:o}),t(1,u={componentName:a}))},e=je(e),[c,u,d,f,r,a,o,s,l]}class a0 extends Ye{constructor(e){super(),He(this,e,o0,s0,Ve,{componentName:5,required:6,for:0})}}const xh=a0,c0=i=>({}),ql=i=>({}),l0=i=>({}),Kl=i=>({});function u0(i){let e,t,n,r,s;const l=[i[9],{tag:"input"},{components:i[6]},i[4],{cssProps:i[5]}];function a(u){i[32](u)}function o(u){i[33](u)}function c(u){i[34](u)}let f={};for(let u=0;u<l.length;u+=1)f=Ce(f,l[u]);return i[0]!==void 0&&(f.value=i[0]),i[3]!==void 0&&(f.element=i[3]),i[1]!==void 0&&(f.id=i[1]),e=new Ke({props:f}),Fe.push(()=>nt(e,"value",a)),Fe.push(()=>nt(e,"element",o)),Fe.push(()=>nt(e,"id",c)),{c(){V(e.$$.fragment)},m(u,d){U(e,u,d),s=!0},p(u,d){const h=d[0]&624?ut(l,[d[0]&512&&tt(u[9]),l[1],d[0]&64&&{components:u[6]},d[0]&16&&tt(u[4]),d[0]&32&&{cssProps:u[5]}]):{};!t&&d[0]&1&&(t=!0,h.value=u[0],lt(()=>t=!1)),!n&&d[0]&8&&(n=!0,h.element=u[3],lt(()=>n=!1)),!r&&d[0]&2&&(r=!0,h.id=u[1],lt(()=>r=!1)),e.$set(h)},i(u){s||(T(e.$$.fragment,u),s=!0)},o(u){E(e.$$.fragment,u),s=!1},d(u){j(e,u)}}}function f0(i){let e,t;const n=[{components:i[6]},{componentName:i[2]+"-wrapper"},i[9],{cssProps:i[7]}];let r={$$slots:{default:[m0]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,l){const a=l[0]&708?ut(n,[l[0]&64&&{components:s[6]},l[0]&4&&{componentName:s[2]+"-wrapper"},l[0]&512&&tt(s[9]),l[0]&128&&{cssProps:s[7]}]):{};l[0]&319|l[1]&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ql(i){let e,t;return e=new Ke({props:{tag:"span",componentName:i[2]+"-icon",$$slots:{default:[h0]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&4&&(s.componentName=n[2]+"-icon"),r[1]&16&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function h0(i){let e;const t=i[28].start,n=gt(t,i,i[35],Kl);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s[1]&16)&&vt(n,t,r,r[35],e?pt(t,r[35],s,l0):bt(r[35]),Kl)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Zl(i){let e,t;return e=new Ke({props:{tag:"span",componentName:i[2]+"-icon",$$slots:{default:[d0]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&4&&(s.componentName=n[2]+"-icon"),r[1]&16&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function d0(i){let e;const t=i[28].end,n=gt(t,i,i[35],ql);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s[1]&16)&&vt(n,t,r,r[35],e?pt(t,r[35],s,c0):bt(r[35]),ql)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function m0(i){let e,t,n,r,s,l,a,o,c=i[8].start&&Ql(i);const f=[{tag:"input"},i[4],{cssProps:i[5]}];function u(g){i[29](g)}function d(g){i[30](g)}function h(g){i[31](g)}let m={};for(let g=0;g<f.length;g+=1)m=Ce(m,f[g]);i[0]!==void 0&&(m.value=i[0]),i[3]!==void 0&&(m.element=i[3]),i[1]!==void 0&&(m.id=i[1]),t=new Ke({props:m}),Fe.push(()=>nt(t,"value",u)),Fe.push(()=>nt(t,"element",d)),Fe.push(()=>nt(t,"id",h));let p=i[8].end&&Zl(i);return{c(){c&&c.c(),e=ue(),V(t.$$.fragment),l=ue(),p&&p.c(),a=Rt()},m(g,v){c&&c.m(g,v),$(g,e,v),U(t,g,v),$(g,l,v),p&&p.m(g,v),$(g,a,v),o=!0},p(g,v){g[8].start?c?(c.p(g,v),v[0]&256&&T(c,1)):(c=Ql(g),c.c(),T(c,1),c.m(e.parentNode,e)):c&&(Je(),E(c,1,1,()=>{c=null}),qe());const b=v[0]&48?ut(f,[f[0],v[0]&16&&tt(g[4]),v[0]&32&&{cssProps:g[5]}]):{};!n&&v[0]&1&&(n=!0,b.value=g[0],lt(()=>n=!1)),!r&&v[0]&8&&(r=!0,b.element=g[3],lt(()=>r=!1)),!s&&v[0]&2&&(s=!0,b.id=g[1],lt(()=>s=!1)),t.$set(b),g[8].end?p?(p.p(g,v),v[0]&256&&T(p,1)):(p=Zl(g),p.c(),T(p,1),p.m(a.parentNode,a)):p&&(Je(),E(p,1,1,()=>{p=null}),qe())},i(g){o||(T(c),T(t.$$.fragment,g),T(p),o=!0)},o(g){E(c),E(t.$$.fragment,g),E(p),o=!1},d(g){g&&(K(e),K(l),K(a)),c&&c.d(g),j(t,g),p&&p.d(g)}}}function g0(i){let e,t,n,r;const s=[f0,u0],l=[];function a(o,c){return o[8].start||o[8].end?0:1}return e=a(i),t=l[e]=s[e](i),{c(){t.c(),n=Rt()},m(o,c){l[e].m(o,c),$(o,n,c),r=!0},p(o,c){let f=e;e=a(o),e===f?l[e].p(o,c):(Je(),E(l[f],1,1,()=>{l[f]=null}),qe(),t=l[e],t?t.p(o,c):(t=l[e]=s[e](o),t.c()),T(t,1),t.m(n.parentNode,n))},i(o){r||(T(t),r=!0)},o(o){E(t),r=!1},d(o){o&&K(n),l[e].d(o)}}}function p0(i,e,t){const n=["componentName","disabled","borderRounded","borderFlush","mask","maskOptions","placeholder","readonly","required","size","state","type","value","name","id","min","max","minlength","maxlength","pattern","step"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e;const a=jc(s);let{componentName:o="input"}=e,{disabled:c=void 0}=e,{borderRounded:f=void 0}=e,{borderFlush:u=void 0}=e,{mask:d=void 0}=e,{maskOptions:h=void 0}=e,{placeholder:m=void 0}=e,{readonly:p=void 0}=e,{required:g=void 0}=e,{size:v=void 0}=e,{state:b=void 0}=e,{type:y=void 0}=e,{value:_=void 0}=e,{name:S=void 0}=e,{id:C=void 0}=e,{min:k=void 0}=e,{max:w=void 0}=e,{minlength:A=void 0}=e,{maxlength:I=void 0}=e,{pattern:z=void 0}=e,{step:H=void 0}=e;const Q=[{component:ht(),except:[]},...e.components??[]];let ee;Ui(async()=>{const P=await el(()=>import("./inputmask-4201d55f.js").then(W=>W.i),[]);if(ee!==void 0&&d){var x=new P.default(d,h);x.mask(ee)}return()=>{ee!==void 0&&d&&P.default.remove(ee)}});let Z={componentName:o,placeholder:m,disabled:c,readonly:p,type:y},he={state:b,borderRounded:f,borderFlush:u},_e={size:v};function we(P){_=P,t(0,_)}function O(P){ee=P,t(3,ee)}function N(P){C=P,t(1,C)}function L(P){_=P,t(0,_)}function D(P){ee=P,t(3,ee)}function B(P){C=P,t(1,C)}return i.$$set=P=>{t(36,e=Ce(Ce({},e),je(P))),t(9,r=Xe(e,n)),"componentName"in P&&t(2,o=P.componentName),"disabled"in P&&t(10,c=P.disabled),"borderRounded"in P&&t(11,f=P.borderRounded),"borderFlush"in P&&t(12,u=P.borderFlush),"mask"in P&&t(13,d=P.mask),"maskOptions"in P&&t(14,h=P.maskOptions),"placeholder"in P&&t(15,m=P.placeholder),"readonly"in P&&t(16,p=P.readonly),"required"in P&&t(17,g=P.required),"size"in P&&t(18,v=P.size),"state"in P&&t(19,b=P.state),"type"in P&&t(20,y=P.type),"value"in P&&t(0,_=P.value),"name"in P&&t(21,S=P.name),"id"in P&&t(1,C=P.id),"min"in P&&t(22,k=P.min),"max"in P&&t(23,w=P.max),"minlength"in P&&t(24,A=P.minlength),"maxlength"in P&&t(25,I=P.maxlength),"pattern"in P&&t(26,z=P.pattern),"step"in P&&t(27,H=P.step),"$$scope"in P&&t(35,l=P.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&268409860&&(t(5,he={size:v,state:b,borderRounded:f,borderFlush:u}),t(4,Z={componentName:o,placeholder:m,disabled:c,readonly:p,required:g,type:y,name:S,min:k,max:w,minlength:A,maxlength:I,pattern:z,step:H}))},e=je(e),[_,C,o,ee,Z,he,Q,_e,a,r,c,f,u,d,h,m,p,g,v,b,y,S,k,w,A,I,z,H,s,we,O,N,L,D,B,l]}let v0=class extends Ye{constructor(e){super(),He(this,e,p0,g0,Ve,{componentName:2,disabled:10,borderRounded:11,borderFlush:12,mask:13,maskOptions:14,placeholder:15,readonly:16,required:17,size:18,state:19,type:20,value:0,name:21,id:1,min:22,max:23,minlength:24,maxlength:25,pattern:26,step:27},null,[-1,-1])}};const gc=v0;var Qn;(function(i){i.Range="range",i.Steps="steps",i.Positions="positions",i.Count="count",i.Values="values"})(Qn||(Qn={}));var ti;(function(i){i[i.None=-1]="None",i[i.NoValue=0]="NoValue",i[i.LargeValue=1]="LargeValue",i[i.SmallValue=2]="SmallValue"})(ti||(ti={}));function b0(i){return ko(i)&&typeof i.from=="function"}function ko(i){return typeof i=="object"&&typeof i.to=="function"}function $l(i){i.parentElement.removeChild(i)}function pc(i){return i!=null}function eu(i){i.preventDefault()}function y0(i){return i.filter(function(e){return this[e]?!1:this[e]=!0},{})}function _0(i,e){return Math.round(i/e)*e}function C0(i,e){var t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.documentElement,s=Ah(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(s.x=0),e?t.top+s.y-r.clientTop:t.left+s.x-r.clientLeft}function Fi(i){return typeof i=="number"&&!isNaN(i)&&isFinite(i)}function tu(i,e,t){t>0&&(qt(i,e),setTimeout(function(){$s(i,e)},t))}function iu(i){return Math.max(Math.min(i,100),0)}function Fo(i){return Array.isArray(i)?i:[i]}function S0(i){i=String(i);var e=i.split(".");return e.length>1?e[1].length:0}function qt(i,e){i.classList&&!/\s/.test(e)?i.classList.add(e):i.className+=" "+e}function $s(i,e){i.classList&&!/\s/.test(e)?i.classList.remove(e):i.className=i.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function k0(i,e){return i.classList?i.classList.contains(e):new RegExp("\\b"+e+"\\b").test(i.className)}function Ah(i){var e=window.pageXOffset!==void 0,t=(i.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:t?i.documentElement.scrollLeft:i.body.scrollLeft,r=e?window.pageYOffset:t?i.documentElement.scrollTop:i.body.scrollTop;return{x:n,y:r}}function T0(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function w0(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("test",null,e)}catch{}return i}function P0(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function tl(i,e){return 100/(e-i)}function vc(i,e,t){return e*100/(i[t+1]-i[t])}function E0(i,e){return vc(i,i[0]<0?e+Math.abs(i[0]):e-i[0],0)}function O0(i,e){return e*(i[1]-i[0])/100+i[0]}function xs(i,e){for(var t=1;i>=e[t];)t+=1;return t}function x0(i,e,t){if(t>=i.slice(-1)[0])return 100;var n=xs(t,i),r=i[n-1],s=i[n],l=e[n-1],a=e[n];return l+E0([r,s],t)/tl(l,a)}function A0(i,e,t){if(t>=100)return i.slice(-1)[0];var n=xs(t,e),r=i[n-1],s=i[n],l=e[n-1],a=e[n];return O0([r,s],(t-l)*tl(l,a))}function D0(i,e,t,n){if(n===100)return n;var r=xs(n,i),s=i[r-1],l=i[r];return t?n-s>(l-s)/2?l:s:e[r-1]?i[r-1]+_0(n-i[r-1],e[r-1]):n}var Dh=function(){function i(e,t,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=t;var r,s=[];for(Object.keys(e).forEach(function(l){s.push([Fo(e[l]),l])}),s.sort(function(l,a){return l[0][0]-a[0][0]}),r=0;r<s.length;r++)this.handleEntryPoint(s[r][1],s[r][0]);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)this.handleStepPoint(r,this.xNumSteps[r])}return i.prototype.getDistance=function(e){for(var t=[],n=0;n<this.xNumSteps.length-1;n++)t[n]=vc(this.xVal,e,n);return t},i.prototype.getAbsoluteDistance=function(e,t,n){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!n&&e===this.xPct[r+1]&&r++,t===null&&(t=[]);var s,l=1,a=t[r],o=0,c=0,f=0,u=0;for(n?s=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):s=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);a>0;)o=this.xPct[r+1+u]-this.xPct[r+u],t[r+u]*l+100-s*100>100?(c=o*s,l=(a-100*s)/t[r+u],s=1):(c=t[r+u]*o/100*l,l=0),n?(f=f-c,this.xPct.length+u>=1&&u--):(f=f+c,this.xPct.length-u>=1&&u++),a=t[r+u]*l;return e+f},i.prototype.toStepping=function(e){return e=x0(this.xVal,this.xPct,e),e},i.prototype.fromStepping=function(e){return A0(this.xVal,this.xPct,e)},i.prototype.getStep=function(e){return e=D0(this.xPct,this.xSteps,this.snap,e),e},i.prototype.getDefaultStep=function(e,t,n){var r=xs(e,this.xPct);return(e===100||t&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/n},i.prototype.getNearbySteps=function(e){var t=xs(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},i.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(S0);return Math.max.apply(null,e)},i.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},i.prototype.convert=function(e){return this.getStep(this.toStepping(e))},i.prototype.handleEntryPoint=function(e,t){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!Fi(n)||!Fi(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(t[0]);var r=Number(t[1]);n?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},i.prototype.handleStepPoint=function(e,t){if(t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=vc([this.xVal[e],this.xVal[e+1]],t,0)/tl(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(n.toFixed(3))-1),s=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=s}},i}(),nu={to:function(i){return i===void 0?"":i.toFixed(2)},from:Number},Rh={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},qn={tooltips:".__tooltips",aria:".__aria"};function R0(i,e){if(!Fi(e))throw new Error("noUiSlider: 'step' is not numeric.");i.singleStep=e}function M0(i,e){if(!Fi(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");i.keyboardPageMultiplier=e}function I0(i,e){if(!Fi(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");i.keyboardMultiplier=e}function L0(i,e){if(!Fi(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");i.keyboardDefaultStep=e}function N0(i,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");i.spectrum=new Dh(e,i.snap||!1,i.singleStep)}function F0(i,e){if(e=Fo(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");i.handles=e.length,i.start=e}function B0(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");i.snap=e}function U0(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");i.animate=e}function j0(i,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");i.animationDuration=e}function V0(i,e){var t=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<i.handles;n++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==i.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}i.connect=t}function z0(i,e){switch(e){case"horizontal":i.ort=0;break;case"vertical":i.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function Mh(i,e){if(!Fi(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(i.margin=i.spectrum.getDistance(e))}function W0(i,e){if(!Fi(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(i.limit=i.spectrum.getDistance(e),!i.limit||i.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function X0(i,e){var t;if(!Fi(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||Fi(e[0])||Fi(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),i.padding=[i.spectrum.getDistance(e[0]),i.spectrum.getDistance(e[1])],t=0;t<i.spectrum.xNumSteps.length-1;t++)if(i.padding[0][t]<0||i.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],r=i.spectrum.xVal[0],s=i.spectrum.xVal[i.spectrum.xVal.length-1];if(n/(s-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function H0(i,e){switch(e){case"ltr":i.dir=0;break;case"rtl":i.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Y0(i,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,s=e.indexOf("snap")>=0,l=e.indexOf("hover")>=0,a=e.indexOf("unconstrained")>=0,o=e.indexOf("drag-all")>=0,c=e.indexOf("smooth-steps")>=0;if(r){if(i.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");Mh(i,i.start[1]-i.start[0])}if(a&&(i.margin||i.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");i.events={tap:t||s,drag:n,dragAll:o,smoothSteps:c,fixed:r,snap:s,hover:l,unconstrained:a}}function G0(i,e){if(e!==!1)if(e===!0||ko(e)){i.tooltips=[];for(var t=0;t<i.handles;t++)i.tooltips.push(e)}else{if(e=Fo(e),e.length!==i.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!ko(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),i.tooltips=e}}function J0(i,e){if(e.length!==i.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");i.handleAttributes=e}function q0(i,e){if(!ko(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");i.ariaFormat=e}function K0(i,e){if(!b0(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");i.format=e}function Q0(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");i.keyboardSupport=e}function Z0(i,e){i.documentElement=e}function $0(i,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");i.cssPrefix=e}function eb(i,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof i.cssPrefix=="string"?(i.cssClasses={},Object.keys(e).forEach(function(t){i.cssClasses[t]=i.cssPrefix+e[t]})):i.cssClasses=e}function Ih(i){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:nu,format:nu},t={step:{r:!1,t:R0},keyboardPageMultiplier:{r:!1,t:M0},keyboardMultiplier:{r:!1,t:I0},keyboardDefaultStep:{r:!1,t:L0},start:{r:!0,t:F0},connect:{r:!0,t:V0},direction:{r:!0,t:H0},snap:{r:!1,t:B0},animate:{r:!1,t:U0},animationDuration:{r:!1,t:j0},range:{r:!0,t:N0},orientation:{r:!1,t:z0},margin:{r:!1,t:Mh},limit:{r:!1,t:W0},padding:{r:!1,t:X0},behaviour:{r:!0,t:Y0},ariaFormat:{r:!1,t:q0},format:{r:!1,t:K0},tooltips:{r:!1,t:G0},keyboardSupport:{r:!0,t:Q0},documentElement:{r:!1,t:Z0},cssPrefix:{r:!0,t:$0},cssClasses:{r:!0,t:eb},handleAttributes:{r:!1,t:J0}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Rh,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};i.format&&!i.ariaFormat&&(i.ariaFormat=i.format),Object.keys(t).forEach(function(o){if(!pc(i[o])&&n[o]===void 0){if(t[o].r)throw new Error("noUiSlider: '"+o+"' is required.");return}t[o].t(e,pc(i[o])?i[o]:n[o])}),e.pips=i.pips;var r=document.createElement("div"),s=r.style.msTransform!==void 0,l=r.style.transform!==void 0;e.transformRule=l?"transform":s?"msTransform":"webkitTransform";var a=[["left","top"],["right","bottom"]];return e.style=a[e.dir][e.ort],e}function tb(i,e,t){var n=T0(),r=P0(),s=r&&w0(),l=i,a,o,c,f,u,d=e.spectrum,h=[],m=[],p=[],g=0,v={},b=i.ownerDocument,y=e.documentElement||b.documentElement,_=b.body,S=b.dir==="rtl"||e.ort===1?0:100;function C(F,X){var ie=b.createElement("div");return X&&qt(ie,X),F.appendChild(ie),ie}function k(F,X){var ie=C(F,e.cssClasses.origin),be=C(ie,e.cssClasses.handle);if(C(be,e.cssClasses.touchArea),be.setAttribute("data-handle",String(X)),e.keyboardSupport&&(be.setAttribute("tabindex","0"),be.addEventListener("keydown",function(Pe){return fe(Pe,X)})),e.handleAttributes!==void 0){var Ee=e.handleAttributes[X];Object.keys(Ee).forEach(function(Pe){be.setAttribute(Pe,Ee[Pe])})}return be.setAttribute("role","slider"),be.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),X===0?qt(be,e.cssClasses.handleLower):X===e.handles-1&&qt(be,e.cssClasses.handleUpper),ie.handle=be,ie}function w(F,X){return X?C(F,e.cssClasses.connect):!1}function A(F,X){var ie=C(X,e.cssClasses.connects);o=[],c=[],c.push(w(ie,F[0]));for(var be=0;be<e.handles;be++)o.push(k(X,be)),p[be]=be,c.push(w(ie,F[be+1]))}function I(F){qt(F,e.cssClasses.target),e.dir===0?qt(F,e.cssClasses.ltr):qt(F,e.cssClasses.rtl),e.ort===0?qt(F,e.cssClasses.horizontal):qt(F,e.cssClasses.vertical);var X=getComputedStyle(F).direction;return X==="rtl"?qt(F,e.cssClasses.textDirectionRtl):qt(F,e.cssClasses.textDirectionLtr),C(F,e.cssClasses.base)}function z(F,X){return!e.tooltips||!e.tooltips[X]?!1:C(F.firstChild,e.cssClasses.tooltip)}function H(){return l.hasAttribute("disabled")}function Q(F){var X=o[F];return X.hasAttribute("disabled")}function ee(F){F!=null?(o[F].setAttribute("disabled",""),o[F].handle.removeAttribute("tabindex")):(l.setAttribute("disabled",""),o.forEach(function(X){X.handle.removeAttribute("tabindex")}))}function Z(F){F!=null?(o[F].removeAttribute("disabled"),o[F].handle.setAttribute("tabindex","0")):(l.removeAttribute("disabled"),o.forEach(function(X){X.removeAttribute("disabled"),X.handle.setAttribute("tabindex","0")}))}function he(){u&&(Be("update"+qn.tooltips),u.forEach(function(F){F&&$l(F)}),u=null)}function _e(){he(),u=o.map(z),ge("update"+qn.tooltips,function(F,X,ie){if(!(!u||!e.tooltips)&&u[X]!==!1){var be=F[X];e.tooltips[X]!==!0&&(be=e.tooltips[X].to(ie[X])),u[X].innerHTML=be}})}function we(){Be("update"+qn.aria),ge("update"+qn.aria,function(F,X,ie,be,Ee){p.forEach(function(Pe){var We=o[Pe],De=le(m,Pe,0,!0,!0,!0),mt=le(m,Pe,100,!0,!0,!0),ct=Ee[Pe],St=String(e.ariaFormat.to(ie[Pe]));De=d.fromStepping(De).toFixed(1),mt=d.fromStepping(mt).toFixed(1),ct=d.fromStepping(ct).toFixed(1),We.children[0].setAttribute("aria-valuemin",De),We.children[0].setAttribute("aria-valuemax",mt),We.children[0].setAttribute("aria-valuenow",ct),We.children[0].setAttribute("aria-valuetext",St)})})}function O(F){if(F.mode===Qn.Range||F.mode===Qn.Steps)return d.xVal;if(F.mode===Qn.Count){if(F.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var X=F.values-1,ie=100/X,be=[];X--;)be[X]=X*ie;return be.push(100),N(be,F.stepped)}return F.mode===Qn.Positions?N(F.values,F.stepped):F.mode===Qn.Values?F.stepped?F.values.map(function(Ee){return d.fromStepping(d.getStep(d.toStepping(Ee)))}):F.values:[]}function N(F,X){return F.map(function(ie){return d.fromStepping(X?d.getStep(ie):ie)})}function L(F){function X(ct,St){return Number((ct+St).toFixed(7))}var ie=O(F),be={},Ee=d.xVal[0],Pe=d.xVal[d.xVal.length-1],We=!1,De=!1,mt=0;return ie=y0(ie.slice().sort(function(ct,St){return ct-St})),ie[0]!==Ee&&(ie.unshift(Ee),We=!0),ie[ie.length-1]!==Pe&&(ie.push(Pe),De=!0),ie.forEach(function(ct,St){var _t,st,wt,Mt=ct,Ot=ie[St+1],xt,Vi,zi,ur,Sr,fr,kr,Tr=F.mode===Qn.Steps;for(Tr&&(_t=d.xNumSteps[St]),_t||(_t=Ot-Mt),Ot===void 0&&(Ot=Mt),_t=Math.max(_t,1e-7),st=Mt;st<=Ot;st=X(st,_t)){for(xt=d.toStepping(st),Vi=xt-mt,Sr=Vi/(F.density||1),fr=Math.round(Sr),kr=Vi/fr,wt=1;wt<=fr;wt+=1)zi=mt+wt*kr,be[zi.toFixed(5)]=[d.fromStepping(zi),0];ur=ie.indexOf(st)>-1?ti.LargeValue:Tr?ti.SmallValue:ti.NoValue,!St&&We&&st!==Ot&&(ur=0),st===Ot&&De||(be[xt.toFixed(5)]=[st,ur]),mt=xt}}),be}function D(F,X,ie){var be,Ee,Pe=b.createElement("div"),We=(be={},be[ti.None]="",be[ti.NoValue]=e.cssClasses.valueNormal,be[ti.LargeValue]=e.cssClasses.valueLarge,be[ti.SmallValue]=e.cssClasses.valueSub,be),De=(Ee={},Ee[ti.None]="",Ee[ti.NoValue]=e.cssClasses.markerNormal,Ee[ti.LargeValue]=e.cssClasses.markerLarge,Ee[ti.SmallValue]=e.cssClasses.markerSub,Ee),mt=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],ct=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];qt(Pe,e.cssClasses.pips),qt(Pe,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function St(st,wt){var Mt=wt===e.cssClasses.value,Ot=Mt?mt:ct,xt=Mt?We:De;return wt+" "+Ot[e.ort]+" "+xt[st]}function _t(st,wt,Mt){if(Mt=X?X(wt,Mt):Mt,Mt!==ti.None){var Ot=C(Pe,!1);Ot.className=St(Mt,e.cssClasses.marker),Ot.style[e.style]=st+"%",Mt>ti.NoValue&&(Ot=C(Pe,!1),Ot.className=St(Mt,e.cssClasses.value),Ot.setAttribute("data-value",String(wt)),Ot.style[e.style]=st+"%",Ot.innerHTML=String(ie.to(wt)))}}return Object.keys(F).forEach(function(st){_t(st,F[st][0],F[st][1])}),Pe}function B(){f&&($l(f),f=null)}function P(F){B();var X=L(F),ie=F.filter,be=F.format||{to:function(Ee){return String(Math.round(Ee))}};return f=l.appendChild(D(X,ie,be)),f}function x(){var F=a.getBoundingClientRect(),X="offset"+["Width","Height"][e.ort];return e.ort===0?F.width||a[X]:F.height||a[X]}function W(F,X,ie,be){var Ee=function(We){var De=Y(We,be.pageOffset,be.target||X);if(!De||H()&&!be.doNotReject||k0(l,e.cssClasses.tap)&&!be.doNotReject||F===n.start&&De.buttons!==void 0&&De.buttons>1||be.hover&&De.buttons)return!1;s||De.preventDefault(),De.calcPoint=De.points[e.ort],ie(De,be)},Pe=[];return F.split(" ").forEach(function(We){X.addEventListener(We,Ee,s?{passive:!0}:!1),Pe.push([We,Ee])}),Pe}function Y(F,X,ie){var be=F.type.indexOf("touch")===0,Ee=F.type.indexOf("mouse")===0,Pe=F.type.indexOf("pointer")===0,We=0,De=0;if(F.type.indexOf("MSPointer")===0&&(Pe=!0),F.type==="mousedown"&&!F.buttons&&!F.touches)return!1;if(be){var mt=function(_t){var st=_t.target;return st===ie||ie.contains(st)||F.composed&&F.composedPath().shift()===ie};if(F.type==="touchstart"){var ct=Array.prototype.filter.call(F.touches,mt);if(ct.length>1)return!1;We=ct[0].pageX,De=ct[0].pageY}else{var St=Array.prototype.find.call(F.changedTouches,mt);if(!St)return!1;We=St.pageX,De=St.pageY}}return X=X||Ah(b),(Ee||Pe)&&(We=F.clientX+X.x,De=F.clientY+X.y),F.pageOffset=X,F.points=[We,De],F.cursor=Ee||Pe,F}function ce(F){var X=F-C0(a,e.ort),ie=X*100/x();return ie=iu(ie),e.dir?100-ie:ie}function ne(F){var X=100,ie=!1;return o.forEach(function(be,Ee){if(!Q(Ee)){var Pe=m[Ee],We=Math.abs(Pe-F),De=We===100&&X===100,mt=We<X,ct=We<=X&&F>Pe;(mt||ct||De)&&(ie=Ee,X=We)}}),ie}function me(F,X){F.type==="mouseout"&&F.target.nodeName==="HTML"&&F.relatedTarget===null&&q(F,X)}function pe(F,X){if(navigator.appVersion.indexOf("MSIE 9")===-1&&F.buttons===0&&X.buttonsProperty!==0)return q(F,X);var ie=(e.dir?-1:1)*(F.calcPoint-X.startCalcPoint),be=ie*100/X.baseSize;ze(ie>0,be,X.locations,X.handleNumbers,X.connect)}function q(F,X){X.handle&&($s(X.handle,e.cssClasses.active),g-=1),X.listeners.forEach(function(ie){y.removeEventListener(ie[0],ie[1])}),g===0&&($s(l,e.cssClasses.drag),it(),F.cursor&&(_.style.cursor="",_.removeEventListener("selectstart",eu))),e.events.smoothSteps&&(X.handleNumbers.forEach(function(ie){dt(ie,m[ie],!0,!0,!1,!1)}),X.handleNumbers.forEach(function(ie){Te("update",ie)})),X.handleNumbers.forEach(function(ie){Te("change",ie),Te("set",ie),Te("end",ie)})}function se(F,X){if(!X.handleNumbers.some(Q)){var ie;if(X.handleNumbers.length===1){var be=o[X.handleNumbers[0]];ie=be.children[0],g+=1,qt(ie,e.cssClasses.active)}F.stopPropagation();var Ee=[],Pe=W(n.move,y,pe,{target:F.target,handle:ie,connect:X.connect,listeners:Ee,startCalcPoint:F.calcPoint,baseSize:x(),pageOffset:F.pageOffset,handleNumbers:X.handleNumbers,buttonsProperty:F.buttons,locations:m.slice()}),We=W(n.end,y,q,{target:F.target,handle:ie,listeners:Ee,doNotReject:!0,handleNumbers:X.handleNumbers}),De=W("mouseout",y,me,{target:F.target,handle:ie,listeners:Ee,doNotReject:!0,handleNumbers:X.handleNumbers});Ee.push.apply(Ee,Pe.concat(We,De)),F.cursor&&(_.style.cursor=getComputedStyle(F.target).cursor,o.length>1&&qt(l,e.cssClasses.drag),_.addEventListener("selectstart",eu,!1)),X.handleNumbers.forEach(function(mt){Te("start",mt)})}}function J(F){F.stopPropagation();var X=ce(F.calcPoint),ie=ne(X);ie!==!1&&(e.events.snap||tu(l,e.cssClasses.tap,e.animationDuration),dt(ie,X,!0,!0),it(),Te("slide",ie,!0),Te("update",ie,!0),e.events.snap?se(F,{handleNumbers:[ie]}):(Te("change",ie,!0),Te("set",ie,!0)))}function de(F){var X=ce(F.calcPoint),ie=d.getStep(X),be=d.fromStepping(ie);Object.keys(v).forEach(function(Ee){Ee.split(".")[0]==="hover"&&v[Ee].forEach(function(Pe){Pe.call(xi,be)})})}function fe(F,X){if(H()||Q(X))return!1;var ie=["Left","Right"],be=["Down","Up"],Ee=["PageDown","PageUp"],Pe=["Home","End"];e.dir&&!e.ort?ie.reverse():e.ort&&!e.dir&&(be.reverse(),Ee.reverse());var We=F.key.replace("Arrow",""),De=We===Ee[0],mt=We===Ee[1],ct=We===be[0]||We===ie[0]||De,St=We===be[1]||We===ie[1]||mt,_t=We===Pe[0],st=We===Pe[1];if(!ct&&!St&&!_t&&!st)return!0;F.preventDefault();var wt;if(St||ct){var Mt=ct?0:1,Ot=Ci(X),xt=Ot[Mt];if(xt===null)return!1;xt===!1&&(xt=d.getDefaultStep(m[X],ct,e.keyboardDefaultStep)),mt||De?xt*=e.keyboardPageMultiplier:xt*=e.keyboardMultiplier,xt=Math.max(xt,1e-7),xt=(ct?-1:1)*xt,wt=h[X]+xt}else st?wt=e.spectrum.xVal[e.spectrum.xVal.length-1]:wt=e.spectrum.xVal[0];return dt(X,d.toStepping(wt),!0,!0),Te("slide",X),Te("update",X),Te("change",X),Te("set",X),!1}function oe(F){F.fixed||o.forEach(function(X,ie){W(n.start,X.children[0],se,{handleNumbers:[ie]})}),F.tap&&W(n.start,a,J,{}),F.hover&&W(n.move,a,de,{hover:!0}),F.drag&&c.forEach(function(X,ie){if(!(X===!1||ie===0||ie===c.length-1)){var be=o[ie-1],Ee=o[ie],Pe=[X],We=[be,Ee],De=[ie-1,ie];qt(X,e.cssClasses.draggable),F.fixed&&(Pe.push(be.children[0]),Pe.push(Ee.children[0])),F.dragAll&&(We=o,De=p),Pe.forEach(function(mt){W(n.start,mt,se,{handles:We,handleNumbers:De,connect:X})})}})}function ge(F,X){v[F]=v[F]||[],v[F].push(X),F.split(".")[0]==="update"&&o.forEach(function(ie,be){Te("update",be)})}function Se(F){return F===qn.aria||F===qn.tooltips}function Be(F){var X=F&&F.split(".")[0],ie=X?F.substring(X.length):F;Object.keys(v).forEach(function(be){var Ee=be.split(".")[0],Pe=be.substring(Ee.length);(!X||X===Ee)&&(!ie||ie===Pe)&&(!Se(Pe)||ie===Pe)&&delete v[be]})}function Te(F,X,ie){Object.keys(v).forEach(function(be){var Ee=be.split(".")[0];F===Ee&&v[be].forEach(function(Pe){Pe.call(xi,h.map(e.format.to),X,h.slice(),ie||!1,m.slice(),xi)})})}function le(F,X,ie,be,Ee,Pe,We){var De;return o.length>1&&!e.events.unconstrained&&(be&&X>0&&(De=d.getAbsoluteDistance(F[X-1],e.margin,!1),ie=Math.max(ie,De)),Ee&&X<o.length-1&&(De=d.getAbsoluteDistance(F[X+1],e.margin,!0),ie=Math.min(ie,De))),o.length>1&&e.limit&&(be&&X>0&&(De=d.getAbsoluteDistance(F[X-1],e.limit,!1),ie=Math.min(ie,De)),Ee&&X<o.length-1&&(De=d.getAbsoluteDistance(F[X+1],e.limit,!0),ie=Math.max(ie,De))),e.padding&&(X===0&&(De=d.getAbsoluteDistance(0,e.padding[0],!1),ie=Math.max(ie,De)),X===o.length-1&&(De=d.getAbsoluteDistance(100,e.padding[1],!0),ie=Math.min(ie,De))),We||(ie=d.getStep(ie)),ie=iu(ie),ie===F[X]&&!Pe?!1:ie}function Ie(F,X){var ie=e.ort;return(ie?X:F)+", "+(ie?F:X)}function ze(F,X,ie,be,Ee){var Pe=ie.slice(),We=be[0],De=e.events.smoothSteps,mt=[!F,F],ct=[F,!F];be=be.slice(),F&&be.reverse(),be.length>1?be.forEach(function(_t,st){var wt=le(Pe,_t,Pe[_t]+X,mt[st],ct[st],!1,De);wt===!1?X=0:(X=wt-Pe[_t],Pe[_t]=wt)}):mt=ct=[!0];var St=!1;be.forEach(function(_t,st){St=dt(_t,ie[_t]+X,mt[st],ct[st],!1,De)||St}),St&&(be.forEach(function(_t){Te("update",_t),Te("slide",_t)}),Ee!=null&&Te("drag",We))}function $e(F,X){return e.dir?100-F-X:F}function ft(F,X){m[F]=X,h[F]=d.fromStepping(X);var ie=$e(X,0)-S,be="translate("+Ie(ie+"%","0")+")";o[F].style[e.transformRule]=be,at(F),at(F+1)}function it(){p.forEach(function(F){var X=m[F]>50?-1:1,ie=3+(o.length+X*F);o[F].style.zIndex=String(ie)})}function dt(F,X,ie,be,Ee,Pe){return Ee||(X=le(m,F,X,ie,be,!1,Pe)),X===!1?!1:(ft(F,X),!0)}function at(F){if(c[F]){var X=0,ie=100;F!==0&&(X=m[F-1]),F!==c.length-1&&(ie=m[F]);var be=ie-X,Ee="translate("+Ie($e(X,be)+"%","0")+")",Pe="scale("+Ie(be/100,"1")+")";c[F].style[e.transformRule]=Ee+" "+Pe}}function Wt(F,X){return F===null||F===!1||F===void 0||(typeof F=="number"&&(F=String(F)),F=e.format.from(F),F!==!1&&(F=d.toStepping(F)),F===!1||isNaN(F))?m[X]:F}function Ut(F,X,ie){var be=Fo(F),Ee=m[0]===void 0;X=X===void 0?!0:X,e.animate&&!Ee&&tu(l,e.cssClasses.tap,e.animationDuration),p.forEach(function(De){dt(De,Wt(be[De],De),!0,!1,ie)});var Pe=p.length===1?0:1;if(Ee&&d.hasNoSize()&&(ie=!0,m[0]=0,p.length>1)){var We=100/(p.length-1);p.forEach(function(De){m[De]=De*We})}for(;Pe<p.length;++Pe)p.forEach(function(De){dt(De,m[De],!0,!0,ie)});it(),p.forEach(function(De){Te("update",De),be[De]!==null&&X&&Te("set",De)})}function Xt(F){Ut(e.start,F)}function ji(F,X,ie,be){if(F=Number(F),!(F>=0&&F<p.length))throw new Error("noUiSlider: invalid handle number, got: "+F);dt(F,Wt(X,F),!0,!0,be),Te("update",F),ie&&Te("set",F)}function xe(F){if(F===void 0&&(F=!1),F)return h.length===1?h[0]:h.slice(0);var X=h.map(e.format.to);return X.length===1?X[0]:X}function Re(){for(Be(qn.aria),Be(qn.tooltips),Object.keys(e.cssClasses).forEach(function(F){$s(l,e.cssClasses[F])});l.firstChild;)l.removeChild(l.firstChild);delete l.noUiSlider}function Ci(F){var X=m[F],ie=d.getNearbySteps(X),be=h[F],Ee=ie.thisStep.step,Pe=null;if(e.snap)return[be-ie.stepBefore.startValue||null,ie.stepAfter.startValue-be||null];Ee!==!1&&be+Ee>ie.stepAfter.startValue&&(Ee=ie.stepAfter.startValue-be),be>ie.thisStep.startValue?Pe=ie.thisStep.step:ie.stepBefore.step===!1?Pe=!1:Pe=be-ie.stepBefore.highestStep,X===100?Ee=null:X===0&&(Pe=null);var We=d.countStepDecimals();return Ee!==null&&Ee!==!1&&(Ee=Number(Ee.toFixed(We))),Pe!==null&&Pe!==!1&&(Pe=Number(Pe.toFixed(We))),[Pe,Ee]}function Gn(){return p.map(Ci)}function hn(F,X){var ie=xe(),be=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];be.forEach(function(Pe){F[Pe]!==void 0&&(t[Pe]=F[Pe])});var Ee=Ih(t);be.forEach(function(Pe){F[Pe]!==void 0&&(e[Pe]=Ee[Pe])}),d=Ee.spectrum,e.margin=Ee.margin,e.limit=Ee.limit,e.padding=Ee.padding,e.pips?P(e.pips):B(),e.tooltips?_e():he(),m=[],Ut(pc(F.start)?F.start:ie,X)}function Jn(){a=I(l),A(e.connect,a),oe(e.events),Ut(e.start),e.pips&&P(e.pips),e.tooltips&&_e(),we()}Jn();var xi={destroy:Re,steps:Gn,on:ge,off:Be,get:xe,set:Ut,setHandle:ji,reset:Xt,disable:ee,enable:Z,__moveHandles:function(F,X,ie){ze(F,X,m,ie)},options:t,updateOptions:hn,target:l,removePips:B,removeTooltips:he,getPositions:function(){return m.slice()},getTooltips:function(){return u},getOrigins:function(){return o},pips:P};return xi}function ib(i,e){if(!i||!i.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+i);if(i.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=Ih(e),n=tb(i,t,e);return i.noUiSlider=n,n}const nb={__spectrum:Dh,cssClasses:Rh,create:ib};function rb(i){let e,t,n,r;const s=i[10].default,l=gt(s,i,i[12],null);return{c(){e=ve("div"),n=ue(),l&&l.c(),te(e,"class",t=Ze("slider",{color:i[1]}))},m(a,o){$(a,e,o),i[11](e),$(a,n,o),l&&l.m(a,o),r=!0},p(a,o){(!r||o&2&&t!==(t=Ze("slider",{color:a[1]})))&&te(e,"class",t),l&&l.p&&(!r||o&4096)&&vt(l,s,a,a[12],r?pt(s,a[12],o,null):bt(a[12]),null)},i(a){r||(T(l,a),r=!0)},o(a){E(l,a),r=!1},d(a){a&&(K(e),K(n)),i[11](null),l&&l.d(a)}}}function sb(i){let e,t;return e=new Ke({props:{components:i[3],componentName:i[0]+"-wrapper",$$slots:{default:[rb]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,[r]){const s={};r&1&&(s.componentName=n[0]+"-wrapper"),r&4102&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function ob(i,e,t){let n,{$$slots:r={},$$scope:s}=e,{componentName:l="slider"}=e,{color:a=void 0}=e,{min:o=void 0}=e,{max:c=void 0}=e,{step:f=void 0}=e,{name:u=void 0}=e,{connect:d=void 0}=e;const h=[{component:ht(),except:[]},...e.components??[]];let m=[],p,g;function v(C){const k=m.length;return m=[...m,C],Jt(y,n[k]=C.value,n),k}function b(C){m=m.filter((k,w)=>w!==C)}const y=Nt([]);Ct(i,y,C=>t(15,n=C)),Ui(()=>{if(!p)return;u&&p.setAttribute("name",u);const C={start:m.map(k=>k.value),tooltips:m.map(k=>k.tooltip??!1),connect:[d??!1,...m.map(k=>k.connect??!1)],step:f,cssPrefix:"",cssClasses:{active:Ze(l+"-active"),background:Ze(l+"-background"),base:Ze(l+"-base"),connect:Ze(l+"-connect"),connects:Ze(l+"-connects"),drag:Ze(l+"-drag"),draggable:Ze(l+"-draggable"),handle:Ze(l+"-handle"),handleLower:Ze(l+"-handle-lower"),handleUpper:Ze(l+"-handle-upper"),horizontal:Ze(l+"-horizontal"),ltr:Ze(l+"-ltr"),marker:Ze(l+"-marker"),markerHorizontal:Ze(l+"-marker-horizontal"),markerLarge:Ze(l+"-marker-large"),markerNormal:Ze(l+"-marker-normal"),markerSub:Ze(l+"-marker-sub"),markerVertical:Ze(l+"-marker-vertical"),origin:Ze(l+"-origin"),pips:Ze(l+"-pips"),pipsHorizontal:Ze(l+"-pips-horizontal"),pipsVertical:Ze(l+"-pips-vertical"),rtl:Ze(l+"-rtl"),tap:Ze(l+"-tap"),target:Ze(l+"-target"),textDirectionLtr:Ze(l+"-text-direction-ltr"),tooltip:Ze(l+"-tooltip"),textDirectionRtl:Ze(l+"-text-direction-rtl"),touchArea:Ze(l+"-touchArea"),value:Ze(l+"-value"),valueHorizontal:Ze(l+"-value-horizontal"),valueLarge:Ze(l+"-value-large"),valueNormal:Ze(l+"-value-normal"),valueSub:Ze(l+"-value-sub"),valueVertical:Ze(l+"-value-vertical"),vertical:Ze(l+"-vertical")},range:{min:o??0,max:c??100}};g=nb.create(p,C),g.on("update",(k,w)=>{Jt(y,n[w]=+k[w],n)})}),Xf(()=>{g&&g.destroy()});function _(C,k){g.setHandle(C,k)}Hf("SLIDER",{register:v,unregister:b,setValue:_,values:y});function S(C){Fe[C?"unshift":"push"](()=>{p=C,t(2,p)})}return i.$$set=C=>{t(19,e=Ce(Ce({},e),je(C))),"componentName"in C&&t(0,l=C.componentName),"color"in C&&t(1,a=C.color),"min"in C&&t(5,o=C.min),"max"in C&&t(6,c=C.max),"step"in C&&t(7,f=C.step),"name"in C&&t(8,u=C.name),"connect"in C&&t(9,d=C.connect),"$$scope"in C&&t(12,s=C.$$scope)},e=je(e),[l,a,p,h,y,o,c,f,u,d,r,S,s]}let ab=class extends Ye{constructor(e){super(),He(this,e,ob,sb,Ve,{componentName:0,color:1,min:5,max:6,step:7,name:8,connect:9})}};const cb=ab;function lb(i){let e,t;return e=new Ke({props:{tag:"input",type:"hidden",components:i[2],name:i[1],value:i[0]}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,[r]){const s={};r&2&&(s.name=n[1]),r&1&&(s.value=n[0]),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function ub(i,e,t){let n,{value:r=0}=e,{connect:s=!1}=e,{tooltip:l=!1}=e,{name:a=void 0}=e;const o=[{component:ht(),except:[]},...e.components??[]],{register:c,unregister:f,values:u,setValue:d}=Yf("SLIDER");Ct(i,u,p=>t(7,n=p));let h;Ui(()=>{t(6,h=c({connect:s,value:r,tooltip:l}))}),Xf(()=>{h&&f(h)});const m=p=>typeof p<"u";return i.$$set=p=>{t(12,e=Ce(Ce({},e),je(p))),"value"in p&&t(0,r=p.value),"connect"in p&&t(4,s=p.connect),"tooltip"in p&&t(5,l=p.tooltip),"name"in p&&t(1,a=p.name)},i.$$.update=()=>{i.$$.dirty&192&&m(h)&&m(n[h])&&t(0,r=n[h]),i.$$.dirty&65&&m(h)&&m(r)&&d(h,r)},e=je(e),[r,a,o,u,s,l,h,n]}class fb extends Ye{constructor(e){super(),He(this,e,ub,lb,Ve,{value:0,connect:4,tooltip:5,name:1})}}const hb=fb;function db(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function mb(i){let e,t;const n=[i[2],{componentName:i[0]},{components:i[1]}];let r={$$slots:{default:[db]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&4&&tt(s[2]),l&1&&{componentName:s[0]},l&2&&{components:s[1]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function gb(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="modal-title"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class pb extends Ye{constructor(e){super(),He(this,e,gb,mb,Ve,{componentName:0})}}const vb=pb;function bb(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function yb(i){let e,t;const n=[i[2],{componentName:i[0]},{components:i[1]}];let r={$$slots:{default:[bb]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&4&&tt(s[2]),l&1&&{componentName:s[0]},l&2&&{components:s[1]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function _b(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="modal-header"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class Cb extends Ye{constructor(e){super(),He(this,e,_b,yb,Ve,{componentName:0})}}const Sb=Cb,kb=i=>({}),ru=i=>({});function su(i){let e,t;return e=new Sb({props:{$$slots:{default:[wb]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&2097184&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Tb(i){let e;return{c(){e=et(i[5])},m(t,n){$(t,e,n)},p(t,n){n&32&&ui(e,t[5])},d(t){t&&K(e)}}}function wb(i){let e,t;return e=new vb({props:{$$slots:{default:[Tb]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&2097184&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function ou(i){let e,t;return e=new rt({props:{"aria-label":"X",type:"button",componentName:i[2]+"-close"}}),e.$on("click",i[19]),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-close"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Pb(i){let e,t,n=i[4]&&ou(i);return{c(){n&&n.c(),e=Rt()},m(r,s){n&&n.m(r,s),$(r,e,s),t=!0},p(r,s){r[4]?n?(n.p(r,s),s&16&&T(n,1)):(n=ou(r),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),E(n,1,1,()=>{n=null}),qe())},i(r){t||(T(n),t=!0)},o(r){E(n),t=!1},d(r){r&&K(e),n&&n.d(r)}}}function Eb(i){let e,t,n,r=i[5]&&su(i);const s=i[18].default,l=gt(s,i,i[21],null),a=i[18].close,o=gt(a,i,i[21],ru),c=o||Pb(i);return{c(){r&&r.c(),e=ue(),l&&l.c(),t=ue(),c&&c.c()},m(f,u){r&&r.m(f,u),$(f,e,u),l&&l.m(f,u),$(f,t,u),c&&c.m(f,u),n=!0},p(f,u){f[5]?r?(r.p(f,u),u&32&&T(r,1)):(r=su(f),r.c(),T(r,1),r.m(e.parentNode,e)):r&&(Je(),E(r,1,1,()=>{r=null}),qe()),l&&l.p&&(!n||u&2097152)&&vt(l,s,f,f[21],n?pt(s,f[21],u,null):bt(f[21]),null),o?o.p&&(!n||u&2097152)&&vt(o,a,f,f[21],n?pt(a,f[21],u,kb):bt(f[21]),ru):c&&c.p&&(!n||u&20)&&c.p(f,n?u:-1)},i(f){n||(T(r),T(l,f),T(c,f),n=!0)},o(f){E(r),E(l,f),E(c,f),n=!1},d(f){f&&(K(e),K(t)),r&&r.d(f),l&&l.d(f),c&&c.d(f)}}}function Ob(i){let e,t;return e=new Ke({props:{componentName:i[2]+"-content",$$slots:{default:[Eb]},$$scope:{ctx:i}}}),e.$on("click",i[11]),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-content"),r&2097204&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function xb(i){let e,t;return e=new Ke({props:{componentName:i[2]+"-container",$$slots:{default:[Ob]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-container"),r&2097204&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function au(i){let e,t;return e=new Ke({props:{componentName:i[2]+"-backdrop",cssProps:{absolute:i[3]},show:i[0]}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.componentName=n[2]+"-backdrop"),r&8&&(s.cssProps={absolute:n[3]}),r&1&&(s.show=n[0]),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Ab(i){let e,t,n,r,s;const l=[i[12],{componentName:i[2]},{cssProps:i[8]},{components:i[9]},{tabindex:"0"},{role:"dialog"},{show:i[0]}];function a(f){i[20](f)}let o={$$slots:{default:[xb]},$$scope:{ctx:i}};for(let f=0;f<l.length;f+=1)o=Ce(o,l[f]);i[7]!==void 0&&(o.element=i[7]),e=new Ke({props:o}),Fe.push(()=>nt(e,"element",a)),e.$on("click",i[10]);let c=i[1]&&au(i);return{c(){V(e.$$.fragment),n=ue(),c&&c.c(),r=Rt()},m(f,u){U(e,f,u),$(f,n,u),c&&c.m(f,u),$(f,r,u),s=!0},p(f,[u]){const d=u&4869?ut(l,[u&4096&&tt(f[12]),u&4&&{componentName:f[2]},u&256&&{cssProps:f[8]},u&512&&{components:f[9]},l[4],l[5],u&1&&{show:f[0]}]):{};u&2097204&&(d.$$scope={dirty:u,ctx:f}),!t&&u&128&&(t=!0,d.element=f[7],lt(()=>t=!1)),e.$set(d),f[1]?c?(c.p(f,u),u&2&&T(c,1)):(c=au(f),c.c(),T(c,1),c.m(r.parentNode,r)):c&&(Je(),E(c,1,1,()=>{c=null}),qe())},i(f){s||(T(e.$$.fragment,f),T(c),s=!0)},o(f){E(e.$$.fragment,f),E(c),s=!1},d(f){f&&(K(n),K(r)),j(e,f),c&&c.d(f)}}}function Db(i,e,t){const n=["autoClose","backdrop","componentName","absolute","dismissible","show","placement","scrollable","size","title","close"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e;const a=Gr(),o=[{component:ht(),except:["close"]},...e.components??[]];let{autoClose:c=void 0}=e,{backdrop:f=!0}=e,{componentName:u="modal"}=e,{absolute:d=void 0}=e,{dismissible:h=void 0}=e,{show:m=void 0}=e,{placement:p="top"}=e,{scrollable:g=void 0}=e,{size:v="md"}=e,{title:b=void 0}=e;const y=()=>{t(0,m=!1),a("close")},_=H=>{m&&C&&c&&H.key==="Escape"&&!H.defaultPrevented&&y()},S=H=>{m&&C&&c&&!H.defaultPrevented&&y()};let C,k;const w=H=>{H.stopPropagation()};Ui(()=>{if(el(()=>import("./focus-trap.esm-4d3da9a7.js"),[]).then(H=>{t(17,k=H.createFocusTrap(C,{escapeDeactivates:!1}))}),document&&c)return document.addEventListener("keyup",_,!0),()=>{document.removeEventListener("keyup",_,!0)}});let A={};const I=()=>y();function z(H){C=H,t(7,C)}return i.$$set=H=>{t(24,e=Ce(Ce({},e),je(H))),t(12,r=Xe(e,n)),"autoClose"in H&&t(13,c=H.autoClose),"backdrop"in H&&t(1,f=H.backdrop),"componentName"in H&&t(2,u=H.componentName),"absolute"in H&&t(3,d=H.absolute),"dismissible"in H&&t(4,h=H.dismissible),"show"in H&&t(0,m=H.show),"placement"in H&&t(14,p=H.placement),"scrollable"in H&&t(15,g=H.scrollable),"size"in H&&t(16,v=H.size),"title"in H&&t(5,b=H.title),"$$scope"in H&&t(21,l=H.$$scope)},i.$$.update=()=>{i.$$.dirty&9&&typeof window<"u"&&!d&&(m?document.body.classList.add(Ze("body-modal-show")??""):document.body.classList.contains(Ze("body-modal-show")??"")&&document.body.classList.remove(Ze("body-modal-show")??"")),i.$$.dirty&131075&&k&&f&&setTimeout(()=>{try{m?k.activate():k.deactivate()}catch(H){console.log("erro: ",H)}},500),i.$$.dirty&114696&&t(8,A={placement:p,scrollable:g,size:v,absolute:d})},e=je(e),[m,f,u,d,h,b,y,C,A,o,S,w,r,c,p,g,v,k,s,I,z,l]}class Rb extends Ye{constructor(e){super(),He(this,e,Db,Ab,Ve,{autoClose:13,backdrop:1,componentName:2,absolute:3,dismissible:4,show:0,placement:14,scrollable:15,size:16,title:5,close:6})}get close(){return this.$$.ctx[6]}}const Mb=Rb;function Ib(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Lb(i){let e,t;const n=[i[2],{componentName:i[0]},{components:i[1]}];let r={$$slots:{default:[Ib]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&4&&tt(s[2]),l&1&&{componentName:s[0]},l&2&&{components:s[1]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Nb(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="modal-body"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class Fb extends Ye{constructor(e){super(),He(this,e,Nb,Lb,Ve,{componentName:0})}}const Bb=Fb;function Ub(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function jb(i){let e,t;const n=[i[2],{componentName:i[0]},{components:i[1]}];let r={$$slots:{default:[Ub]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&4&&tt(s[2]),l&1&&{componentName:s[0]},l&2&&{components:s[1]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Vb(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="modal-footer"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class zb extends Ye{constructor(e){super(),He(this,e,Vb,jb,Ve,{componentName:0})}}const Wb=zb;function Xb(i){let e;const t=i[13].default,n=gt(t,i,i[15],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&32768)&&vt(n,t,r,r[15],e?pt(t,r[15],s,null):bt(r[15]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function cu(i){let e,t;return e=new Ke({props:{componentName:i[1]+"-backdrop",show:i[0]}}),e.$on("click",i[8]),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&2&&(s.componentName=n[1]+"-backdrop"),r&1&&(s.show=n[0]),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function lu(i){let e,t,n=i[2]&&uu(i);return{c(){n&&n.c(),e=Rt()},m(r,s){n&&n.m(r,s),$(r,e,s),t=!0},p(r,s){r[2]?n?(n.p(r,s),s&4&&T(n,1)):(n=uu(r),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),E(n,1,1,()=>{n=null}),qe())},i(r){t||(T(n),t=!0)},o(r){E(n),t=!1},d(r){r&&K(e),n&&n.d(r)}}}function uu(i){let e,t;return e=new Ke({props:{componentName:i[1]+"-no-scroll"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&2&&(s.componentName=n[1]+"-no-scroll"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Hb(i){let e,t,n,r,s,l;const a=[i[7],i[9],{cssProps:i[5]},{componentName:i[1]},{tabindex:"0"},{show:i[0]}];function o(d){i[14](d)}let c={$$slots:{default:[Xb]},$$scope:{ctx:i}};for(let d=0;d<a.length;d+=1)c=Ce(c,a[d]);i[4]!==void 0&&(c.element=i[4]),e=new Ke({props:c}),Fe.push(()=>nt(e,"element",o));let f=i[3]&&cu(i),u=i[0]&&lu(i);return{c(){V(e.$$.fragment),n=ue(),f&&f.c(),r=ue(),u&&u.c(),s=Rt()},m(d,h){U(e,d,h),$(d,n,h),f&&f.m(d,h),$(d,r,h),u&&u.m(d,h),$(d,s,h),l=!0},p(d,h){const m=h&675?ut(a,[h&128&&tt(d[7]),h&512&&tt(d[9]),h&32&&{cssProps:d[5]},h&2&&{componentName:d[1]},a[4],h&1&&{show:d[0]}]):{};h&32768&&(m.$$scope={dirty:h,ctx:d}),!t&&h&16&&(t=!0,m.element=d[4],lt(()=>t=!1)),e.$set(m),d[3]?f?(f.p(d,h),h&8&&T(f,1)):(f=cu(d),f.c(),T(f,1),f.m(r.parentNode,r)):f&&(Je(),E(f,1,1,()=>{f=null}),qe()),d[0]?u?(u.p(d,h),h&1&&T(u,1)):(u=lu(d),u.c(),T(u,1),u.m(s.parentNode,s)):u&&(Je(),E(u,1,1,()=>{u=null}),qe())},i(d){l||(T(e.$$.fragment,d),T(f),T(u),l=!0)},o(d){E(e.$$.fragment,d),E(f),E(u),l=!1},d(d){d&&(K(n),K(r),K(s)),j(e,d),f&&f.d(d),u&&u.d(d)}}}function Yb(i){let e,t;return e=new Ke({props:{components:i[6],componentName:i[1]+"-wrapper",$$slots:{default:[Hb]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,[r]){const s={};r&2&&(s.componentName=n[1]+"-wrapper"),r&33343&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Gb(i,e,t){const n=["componentName","placement","noScroll","backdrop","autoClose","show"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="offcanvas"}=e,{placement:o="start"}=e,{noScroll:c=void 0}=e,{backdrop:f=void 0}=e,{autoClose:u=void 0}=e,{show:d=void 0}=e;const h=Gr(),m=[{component:ht(),except:["close"]},...e.components??[]],p=()=>{t(0,d=!1),h("close")};Hf("OFFCANVAS",{close:p});let g,v,b={componentName:a,...r},y={placement:o};const _=k=>{d&&g&&u&&k.key==="Escape"&&!k.defaultPrevented&&p()},S=k=>{d&&g&&u&&!g.contains(k.target)&&!k.defaultPrevented&&p()};Ui(()=>{if(el(()=>import("./focus-trap.esm-4d3da9a7.js"),[]).then(k=>{t(12,v=k.createFocusTrap(g,{escapeDeactivates:!1}))}),document&&u)return document.addEventListener("keyup",_,!0),document.addEventListener("click",S,!0),()=>{document.removeEventListener("keyup",_,!0),document.removeEventListener("click",S,!0)}});function C(k){g=k,t(4,g)}return i.$$set=k=>{t(19,e=Ce(Ce({},e),je(k))),t(9,r=Xe(e,n)),"componentName"in k&&t(1,a=k.componentName),"placement"in k&&t(10,o=k.placement),"noScroll"in k&&t(2,c=k.noScroll),"backdrop"in k&&t(3,f=k.backdrop),"autoClose"in k&&t(11,u=k.autoClose),"show"in k&&t(0,d=k.show),"$$scope"in k&&t(15,l=k.$$scope)},i.$$.update=()=>{i.$$.dirty&4105&&v&&f&&setTimeout(()=>{try{d?v.activate():v.deactivate()}catch{}},500),i.$$.dirty&1024&&t(5,y={placement:o})},e=je(e),[d,a,c,f,g,y,m,b,S,r,o,u,v,s,C,l]}class Jb extends Ye{constructor(e){super(),He(this,e,Gb,Yb,Ve,{componentName:1,placement:10,noScroll:2,backdrop:3,autoClose:11,show:0})}}const qb=Jb;function Kb(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function Qb(i){let e,t;const n=[i[2],{componentName:i[0]},{components:i[1]}];let r={$$slots:{default:[Kb]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&4&&tt(s[2]),l&1&&{componentName:s[0]},l&2&&{components:s[1]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Zb(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="offcanvas-body"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class $b extends Ye{constructor(e){super(),He(this,e,Zb,Qb,Ve,{componentName:0})}}const ey=$b;function ty(i){let e;const t=i[5].default,n=gt(t,i,i[6],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&64)&&vt(n,t,r,r[6],e?pt(t,r[6],s,null):bt(r[6]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function iy(i){let e,t;return e=new Ke({props:{componentName:i[0]+"-title",$$slots:{default:[ny]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.componentName=n[0]+"-title"),r&66&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function ny(i){let e;return{c(){e=et(i[1])},m(t,n){$(t,e,n)},p(t,n){n&2&&ui(e,t[1])},d(t){t&&K(e)}}}function ry(i){let e,t,n,r,s;const l=[iy,ty],a=[];function o(c,f){return c[1]?0:1}return e=o(i),t=a[e]=l[e](i),r=new rt({props:{componentName:i[0]+"-btn","aria-label":"Close"}}),r.$on("click",i[3]),{c(){t.c(),n=ue(),V(r.$$.fragment)},m(c,f){a[e].m(c,f),$(c,n,f),U(r,c,f),s=!0},p(c,f){let u=e;e=o(c),e===u?a[e].p(c,f):(Je(),E(a[u],1,1,()=>{a[u]=null}),qe(),t=a[e],t?t.p(c,f):(t=a[e]=l[e](c),t.c()),T(t,1),t.m(n.parentNode,n));const d={};f&1&&(d.componentName=c[0]+"-btn"),r.$set(d)},i(c){s||(T(t),T(r.$$.fragment,c),s=!0)},o(c){E(t),E(r.$$.fragment,c),s=!1},d(c){c&&K(n),a[e].d(c),j(r,c)}}}function sy(i){let e,t;const n=[i[4],{componentName:i[0]},{components:i[2]}];let r={$$slots:{default:[ry]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&21?ut(n,[l&16&&tt(s[4]),l&1&&{componentName:s[0]},l&4&&{components:s[2]}]):{};l&67&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function oy(i,e,t){const n=["componentName","title"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="offcanvas-header"}=e,{title:o=void 0}=e;const c=Yf("OFFCANVAS"),f=[{component:ht(),except:[]},...e.components??[]],u=()=>{c&&c.close&&c.close()};return i.$$set=d=>{t(8,e=Ce(Ce({},e),je(d))),t(4,r=Xe(e,n)),"componentName"in d&&t(0,a=d.componentName),"title"in d&&t(1,o=d.title),"$$scope"in d&&t(6,l=d.$$scope)},e=je(e),[a,o,f,u,r,s,l]}class ay extends Ye{constructor(e){super(),He(this,e,oy,sy,Ve,{componentName:0,title:1})}}const cy=ay;function ly(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function uy(i){let e,t;const n=[{components:i[1]},i[2],{componentName:i[0]}];let r={$$slots:{default:[ly]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&2&&{components:s[1]},l&4&&tt(s[2]),l&1&&{componentName:s[0]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function fy(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="popover-header"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class hy extends Ye{constructor(e){super(),He(this,e,fy,uy,Ve,{componentName:0})}}const Lh=hy;function fu(i){let e,t;return e=new Lh({props:{$$slots:{default:[dy]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&513&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function dy(i){let e;return{c(){e=et(i[0])},m(t,n){$(t,e,n)},p(t,n){n&1&&ui(e,t[0])},d(t){t&&K(e)}}}function my(i){let e,t,n=i[0]&&fu(i);const r=i[8].default,s=gt(r,i,i[9],null);return{c(){n&&n.c(),e=ue(),s&&s.c()},m(l,a){n&&n.m(l,a),$(l,e,a),s&&s.m(l,a),t=!0},p(l,a){l[0]?n?(n.p(l,a),a&1&&T(n,1)):(n=fu(l),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),E(n,1,1,()=>{n=null}),qe()),s&&s.p&&(!t||a&512)&&vt(s,r,l,l[9],t?pt(r,l[9],a,null):bt(l[9]),null)},i(l){t||(T(n),T(s,l),t=!0)},o(l){E(n),E(s,l),t=!1},d(l){l&&K(e),n&&n.d(l),s&&s.d(l)}}}function gy(i){let e,t;const n=[{components:i[2]},i[3],i[1]];let r={$$slots:{default:[my]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new sh({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&14?ut(n,[l&4&&{components:s[2]},l&8&&tt(s[3]),l&2&&tt(s[1])]):{};l&513&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function py(i,e,t){let n;const r=["componentName","arrow","popupOffset","title","trigger"];let s=Xe(e,r),{$$slots:l={},$$scope:a}=e,{componentName:o="popover"}=e,{arrow:c=!0}=e,{popupOffset:f=8}=e,{title:u=void 0}=e,{trigger:d="click"}=e;const h=[{component:ht(),except:[]},...e.components??[]];return i.$$set=m=>{t(10,e=Ce(Ce({},e),je(m))),t(3,s=Xe(e,r)),"componentName"in m&&t(4,o=m.componentName),"arrow"in m&&t(5,c=m.arrow),"popupOffset"in m&&t(6,f=m.popupOffset),"title"in m&&t(0,u=m.title),"trigger"in m&&t(7,d=m.trigger),"$$scope"in m&&t(9,a=m.$$scope)},i.$$.update=()=>{i.$$.dirty&240&&t(1,n={componentName:o,arrow:c,trigger:d,popupOffset:f})},e=je(e),[u,n,h,s,o,c,f,d,l,a]}class vy extends Ye{constructor(e){super(),He(this,e,py,gy,Ve,{componentName:4,arrow:5,popupOffset:6,title:0,trigger:7})}}const Nh=vy;function by(i){let e;const t=i[3].default,n=gt(t,i,i[4],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&16)&&vt(n,t,r,r[4],e?pt(t,r[4],s,null):bt(r[4]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function yy(i){let e,t;const n=[{components:i[1]},i[2],{componentName:i[0]}];let r={$$slots:{default:[by]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&7?ut(n,[l&2&&{components:s[1]},l&4&&tt(s[2]),l&1&&{componentName:s[0]}]):{};l&16&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function _y(i,e,t){const n=["componentName"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="popover-body"}=e;const o=[{component:ht(),except:[]},...e.components??[]];return i.$$set=c=>{t(5,e=Ce(Ce({},e),je(c))),t(2,r=Xe(e,n)),"componentName"in c&&t(0,a=c.componentName),"$$scope"in c&&t(4,l=c.$$scope)},e=je(e),[a,o,r,s,l]}class Cy extends Ye{constructor(e){super(),He(this,e,_y,yy,Ve,{componentName:0})}}const Fh=Cy;function Sy(i){let e;const t=i[7].default,n=gt(t,i,i[8],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&256)&&vt(n,t,r,r[8],e?pt(t,r[8],s,null):bt(r[8]),null)},i(r){e||(T(n,r),e=!0)},o(r){E(n,r),e=!1},d(r){n&&n.d(r)}}}function ky(i){let e,t;const n=[{components:i[2]},{tag:"span"},i[3],{cssProps:i[1]},i[0]];let r={$$slots:{default:[Sy]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new Ke({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&15?ut(n,[l&4&&{components:s[2]},n[1],l&8&&tt(s[3]),l&2&&{cssProps:s[1]},l&1&&tt(s[0])]):{};l&256&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ty(i,e,t){const n=["componentName","color","lite"];let r=Xe(e,n),{$$slots:s={},$$scope:l}=e,{componentName:a="status"}=e,{color:o=void 0}=e,{lite:c=void 0}=e;const f=[{component:ht(),except:[]},...e.components??[]];let u={},d={};return i.$$set=h=>{t(9,e=Ce(Ce({},e),je(h))),t(3,r=Xe(e,n)),"componentName"in h&&t(4,a=h.componentName),"color"in h&&t(5,o=h.color),"lite"in h&&t(6,c=h.lite),"$$scope"in h&&t(8,l=h.$$scope)},i.$$.update=()=>{i.$$.dirty&112&&(t(1,d={color:o,lite:c}),t(0,u={componentName:a}))},e=je(e),[u,d,f,r,a,o,c,s,l]}class wy extends Ye{constructor(e){super(),He(this,e,Ty,ky,Ve,{componentName:4,color:5,lite:6})}}const Py=wy;function hu(i){let e;return{c(){e=et(i[1])},m(t,n){$(t,e,n)},p(t,n){n&2&&ui(e,t[1])},d(t){t&&K(e)}}}function Ey(i){let e,t=i[1]&&hu(i);return{c(){t&&t.c(),e=Rt()},m(n,r){t&&t.m(n,r),$(n,e,r)},p(n,r){n[1]?t?t.p(n,r):(t=hu(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&K(e),t&&t.d(n)}}}function Oy(i){let e;const t=i[8].default,n=gt(t,i,i[9],null),r=n||Ey(i);return{c(){r&&r.c()},m(s,l){r&&r.m(s,l),e=!0},p(s,l){n?n.p&&(!e||l&512)&&vt(n,t,s,s[9],e?pt(t,s[9],l,null):bt(s[9]),null):r&&r.p&&(!e||l&2)&&r.p(s,e?l:-1)},i(s){e||(T(r,s),e=!0)},o(s){E(r,s),e=!1},d(s){r&&r.d(s)}}}function xy(i){let e,t;return e=new Ke({props:{componentName:i[0]+"-inner",$$slots:{default:[Oy]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.componentName=n[0]+"-inner"),r&514&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Ay(i){let e,t;const n=[{components:i[3]},i[4],i[2]];let r={$$slots:{default:[xy]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=Ce(r,n[s]);return e=new sh({props:r}),{c(){V(e.$$.fragment)},m(s,l){U(e,s,l),t=!0},p(s,[l]){const a=l&28?ut(n,[l&8&&{components:s[3]},l&16&&tt(s[4]),l&4&&tt(s[2])]):{};l&515&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){E(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Dy(i,e,t){let n;const r=["componentName","arrow","popupOffset","trigger","text"];let s=Xe(e,r),{$$slots:l={},$$scope:a}=e,{componentName:o="tooltip"}=e,{arrow:c=!0}=e,{popupOffset:f=0}=e,{trigger:u="hover"}=e,{text:d=void 0}=e;const h=[{component:ht(),except:[]},...e.components??[]];return i.$$set=m=>{t(10,e=Ce(Ce({},e),je(m))),t(4,s=Xe(e,r)),"componentName"in m&&t(0,o=m.componentName),"arrow"in m&&t(5,c=m.arrow),"popupOffset"in m&&t(6,f=m.popupOffset),"trigger"in m&&t(7,u=m.trigger),"text"in m&&t(1,d=m.text),"$$scope"in m&&t(9,a=m.$$scope)},i.$$.update=()=>{i.$$.dirty&225&&t(2,n={componentName:o,arrow:c,trigger:u,popupOffset:f})},e=je(e),[o,d,n,h,s,c,f,u,l,a]}class Ry extends Ye{constructor(e){super(),He(this,e,Dy,Ay,Ve,{componentName:0,arrow:5,popupOffset:6,trigger:7,text:1})}}const Pt=Ry;function My(i,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if(n!=="default"&&!(n in i)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(i)}var Iy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ly(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bh={exports:{}};(function(i){(function(e,t){i.exports?i.exports=t():e.log=t()})(Iy,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(p,g){var v=p[g];if(typeof v.bind=="function")return v.bind(p);try{return Function.prototype.bind.call(v,p)}catch{return function(){return Function.prototype.apply.apply(v,[p,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(p){return p==="debug"&&(p="log"),typeof console===t?!1:p==="trace"&&n?l:console[p]!==void 0?s(console,p):console.log!==void 0?s(console,"log"):e}function o(p,g){for(var v=0;v<r.length;v++){var b=r[v];this[b]=v<p?e:this.methodFactory(b,p,g)}this.log=this.debug}function c(p,g,v){return function(){typeof console!==t&&(o.call(this,g,v),this[p].apply(this,arguments))}}function f(p,g,v){return a(p)||c.apply(this,arguments)}function u(p,g,v){var b=this,y;g=g??"WARN";var _="loglevel";typeof p=="string"?_+=":"+p:typeof p=="symbol"&&(_=void 0);function S(A){var I=(r[A]||"silent").toUpperCase();if(!(typeof window===t||!_)){try{window.localStorage[_]=I;return}catch{}try{window.document.cookie=encodeURIComponent(_)+"="+I+";"}catch{}}}function C(){var A;if(!(typeof window===t||!_)){try{A=window.localStorage[_]}catch{}if(typeof A===t)try{var I=window.document.cookie,z=I.indexOf(encodeURIComponent(_)+"=");z!==-1&&(A=/^([^;]+)/.exec(I.slice(z))[1])}catch{}return b.levels[A]===void 0&&(A=void 0),A}}function k(){if(!(typeof window===t||!_)){try{window.localStorage.removeItem(_);return}catch{}try{window.document.cookie=encodeURIComponent(_)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}b.name=p,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=v||f,b.getLevel=function(){return y},b.setLevel=function(A,I){if(typeof A=="string"&&b.levels[A.toUpperCase()]!==void 0&&(A=b.levels[A.toUpperCase()]),typeof A=="number"&&A>=0&&A<=b.levels.SILENT){if(y=A,I!==!1&&S(A),o.call(b,A,p),typeof console===t&&A<b.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+A},b.setDefaultLevel=function(A){g=A,C()||b.setLevel(A,!1)},b.resetLevel=function(){b.setLevel(g,!1),k()},b.enableAll=function(A){b.setLevel(b.levels.TRACE,A)},b.disableAll=function(A){b.setLevel(b.levels.SILENT,A)};var w=C();w==null&&(w=g),b.setLevel(w,!1)}var d=new u,h={};d.getLogger=function(g){if(typeof g!="symbol"&&typeof g!="string"||g==="")throw new TypeError("You must supply a name when creating a logger.");var v=h[g];return v||(v=h[g]=new u(g,d.getLevel(),d.methodFactory)),v};var m=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=m),d},d.getLoggers=function(){return h},d.default=d,d})})(Bh);var Uh=Bh.exports,bc;(function(i){i[i.trace=0]="trace",i[i.debug=1]="debug",i[i.info=2]="info",i[i.warn=3]="warn",i[i.error=4]="error",i[i.silent=5]="silent"})(bc||(bc={}));const G=Uh.getLogger("livekit");G.setDefaultLevel(bc.info);Uh.getLogger("lk-e2ee");function hi(i,e){if(!i)throw new Error(e)}const Ny=34028234663852886e22,Fy=-34028234663852886e22,By=4294967295,Uy=2147483647,jy=-2147483648;function eo(i){if(typeof i!="number")throw new Error("invalid int 32: "+typeof i);if(!Number.isInteger(i)||i>Uy||i<jy)throw new Error("invalid int 32: "+i)}function yc(i){if(typeof i!="number")throw new Error("invalid uint 32: "+typeof i);if(!Number.isInteger(i)||i>By||i<0)throw new Error("invalid uint 32: "+i)}function jh(i){if(typeof i!="number")throw new Error("invalid float 32: "+typeof i);if(Number.isFinite(i)&&(i>Ny||i<Fy))throw new Error("invalid float 32: "+i)}const Vh=Symbol("@bufbuild/protobuf/enum-type");function Vy(i){const e=i[Vh];return hi(e,"missing enum type on enum object"),e}function zh(i,e,t,n){i[Vh]=Wh(e,t.map(r=>({no:r.no,name:r.name,localName:i[r.no]})))}function Wh(i,e,t){const n=Object.create(null),r=Object.create(null),s=[];for(const l of e){const a=Xh(l);s.push(a),n[l.name]=a,r[l.no]=a}return{typeName:i,values:s,findName(l){return n[l]},findNumber(l){return r[l]}}}function zy(i,e,t){const n={};for(const r of e){const s=Xh(r);n[s.localName]=s.no,n[s.no]=s.localName}return zh(n,i,e),n}function Xh(i){return"localName"in i?i:Object.assign(Object.assign({},i),{localName:i.name})}class Le{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType(),r=n.runtime.bin,s=r.makeReadOptions(t);return r.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,t){const n=this.getType(),r=n.runtime.json,s=r.makeReadOptions(t);return r.readMessage(n,e,s,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(r){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(r instanceof Error?r.message:String(r)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType(),n=t.runtime.bin,r=n.makeWriteOptions(e),s=r.writerFactory();return n.writeMessage(this,s,r),s.finish()}toJson(e){const t=this.getType(),n=t.runtime.json,r=n.makeWriteOptions(e);return n.writeMessage(this,r)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Wy(i,e,t,n){var r;const s=(r=n==null?void 0:n.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),l={[s]:function(a){i.util.initFields(this),i.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(l.prototype,new Le),Object.assign(l,{runtime:i,typeName:e,fields:i.util.newFieldList(t),fromBinary(a,o){return new l().fromBinary(a,o)},fromJson(a,o){return new l().fromJson(a,o)},fromJsonString(a,o){return new l().fromJsonString(a,o)},equals(a,o){return i.util.equals(l,a,o)}}),l}function Xy(i,e,t,n){return{syntax:i,json:e,bin:t,util:n,makeMessageType(r,s,l){return Wy(this,r,s,l)},makeEnum:zy,makeEnumType:Wh,getEnumType:Vy}}var ye;(function(i){i[i.DOUBLE=1]="DOUBLE",i[i.FLOAT=2]="FLOAT",i[i.INT64=3]="INT64",i[i.UINT64=4]="UINT64",i[i.INT32=5]="INT32",i[i.FIXED64=6]="FIXED64",i[i.FIXED32=7]="FIXED32",i[i.BOOL=8]="BOOL",i[i.STRING=9]="STRING",i[i.BYTES=12]="BYTES",i[i.UINT32=13]="UINT32",i[i.SFIXED32=15]="SFIXED32",i[i.SFIXED64=16]="SFIXED64",i[i.SINT32=17]="SINT32",i[i.SINT64=18]="SINT64"})(ye||(ye={}));function Hy(){let i=0,e=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(i|=(r&127)<<n,!(r&128))return this.assertBounds(),[i,e]}let t=this.buf[this.pos++];if(i|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[i,e];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<n,!(r&128))return this.assertBounds(),[i,e]}throw new Error("invalid varint")}function Ba(i,e,t){for(let s=0;s<28;s=s+7){const l=i>>>s,a=!(!(l>>>7)&&e==0),o=(a?l|128:l)&255;if(t.push(o),!a)return}const n=i>>>28&15|(e&7)<<4,r=!!(e>>3);if(t.push((r?n|128:n)&255),!!r){for(let s=3;s<31;s=s+7){const l=e>>>s,a=!!(l>>>7),o=(a?l|128:l)&255;if(t.push(o),!a)return}t.push(e>>>31&1)}}const to=4294967296;function du(i){const e=i[0]==="-";e&&(i=i.slice(1));const t=1e6;let n=0,r=0;function s(l,a){const o=Number(i.slice(l,a));r*=t,n=n*t+o,n>=to&&(r=r+(n/to|0),n=n%to)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?Yh(n,r):il(n,r)}function Yy(i,e){let t=il(i,e);const n=t.hi&2147483648;n&&(t=Yh(t.lo,t.hi));const r=Hh(t.lo,t.hi);return n?"-"+r:r}function Hh(i,e){if({lo:i,hi:e}=Gy(i,e),e<=2097151)return String(to*e+i);const t=i&16777215,n=(i>>>24|e<<8)&16777215,r=e>>16&65535;let s=t+n*6777216+r*6710656,l=n+r*8147497,a=r*2;const o=1e7;return s>=o&&(l+=Math.floor(s/o),s%=o),l>=o&&(a+=Math.floor(l/o),l%=o),a.toString()+mu(l)+mu(s)}function Gy(i,e){return{lo:i>>>0,hi:e>>>0}}function il(i,e){return{lo:i|0,hi:e|0}}function Yh(i,e){return e=~e,i?i=~i+1:e+=1,il(i,e)}const mu=i=>{const e=String(i);return"0000000".slice(e.length)+e};function gu(i,e){if(i>=0){for(;i>127;)e.push(i&127|128),i=i>>>7;e.push(i)}else{for(let t=0;t<9;t++)e.push(i&127|128),i=i>>7;e.push(1)}}function Jy(){let i=this.buf[this.pos++],e=i&127;if(!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<7,!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<14,!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<21,!(i&128))return this.assertBounds(),e;i=this.buf[this.pos++],e|=(i&15)<<28;for(let t=5;i&128&&t<10;t++)i=this.buf[this.pos++];if(i&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function qy(){const i=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof i.getBigInt64=="function"&&typeof i.getBigUint64=="function"&&typeof i.setBigInt64=="function"&&typeof i.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),l=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(o){const c=typeof o=="bigint"?o:BigInt(o);if(c>s||c<r)throw new Error("int64 invalid: ".concat(o));return c},uParse(o){const c=typeof o=="bigint"?o:BigInt(o);if(c>a||c<l)throw new Error("uint64 invalid: ".concat(o));return c},enc(o){return i.setBigInt64(0,this.parse(o),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},uEnc(o){return i.setBigInt64(0,this.uParse(o),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},dec(o,c){return i.setInt32(0,o,!0),i.setInt32(4,c,!0),i.getBigInt64(0,!0)},uDec(o,c){return i.setInt32(0,o,!0),i.setInt32(4,c,!0),i.getBigUint64(0,!0)}}}const t=r=>hi(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),n=r=>hi(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),t(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),t(r),du(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),n(r),du(r)},dec(r,s){return Yy(r,s)},uDec(r,s){return Hh(r,s)}}}const ot=qy();var Ft;(function(i){i[i.Varint=0]="Varint",i[i.Bit64=1]="Bit64",i[i.LengthDelimited=2]="LengthDelimited",i[i.StartGroup=3]="StartGroup",i[i.EndGroup=4]="EndGroup",i[i.Bit32=5]="Bit32"})(Ft||(Ft={}));class Ky{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let t=new Uint8Array(e),n=0;for(let r=0;r<this.chunks.length;r++)t.set(this.chunks[r],n),n+=this.chunks[r].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(yc(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return eo(e),gu(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){jh(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){yc(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){eo(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return eo(e),e=(e<<1^e>>31)>>>0,gu(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=ot.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=ot.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=ot.enc(e);return Ba(t.lo,t.hi,this.buf),this}sint64(e){let t=ot.enc(e),n=t.hi>>31,r=t.lo<<1^n,s=(t.hi<<1|t.lo>>>31)^n;return Ba(r,s,this.buf),this}uint64(e){let t=ot.uEnc(e);return Ba(t.lo,t.hi,this.buf),this}}class Qy{constructor(e,t){this.varint64=Hy,this.uint32=Jy,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=e&7;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case Ft.Varint:for(;this.buf[this.pos++]&128;);break;case Ft.Bit64:this.pos+=4;case Ft.Bit32:this.pos+=4;break;case Ft.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Ft.StartGroup:let r;for(;(r=this.tag()[1])!==Ft.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return ot.dec(...this.varint64())}uint64(){return ot.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(e&1);return e=(e>>>1|(t&1)<<31)^n,t=t>>>1^n,ot.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return ot.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return ot.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function _c(i,e){return e instanceof Le||!i.fieldWrapper?e:i.fieldWrapper.wrapField(e)}ye.DOUBLE,ye.FLOAT,ye.INT64,ye.UINT64,ye.INT32,ye.UINT32,ye.BOOL,ye.STRING,ye.BYTES;function Kn(i,e,t){if(e===t)return!0;if(i==ye.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}switch(i){case ye.UINT64:case ye.FIXED64:case ye.INT64:case ye.SFIXED64:case ye.SINT64:return e==t}return!1}function Cc(i){switch(i){case ye.BOOL:return!1;case ye.UINT64:case ye.FIXED64:case ye.INT64:case ye.SFIXED64:case ye.SINT64:return ot.zero;case ye.DOUBLE:case ye.FLOAT:return 0;case ye.BYTES:return new Uint8Array(0);case ye.STRING:return"";default:return 0}}function Gh(i,e){const t=e===void 0;let n=Ft.Varint,r=e===0;switch(i){case ye.STRING:r=t||!e.length,n=Ft.LengthDelimited;break;case ye.BOOL:r=e===!1;break;case ye.DOUBLE:n=Ft.Bit64;break;case ye.FLOAT:n=Ft.Bit32;break;case ye.INT64:r=t||e==0;break;case ye.UINT64:r=t||e==0;break;case ye.FIXED64:r=t||e==0,n=Ft.Bit64;break;case ye.BYTES:r=t||!e.byteLength,n=Ft.LengthDelimited;break;case ye.FIXED32:n=Ft.Bit32;break;case ye.SFIXED32:n=Ft.Bit32;break;case ye.SFIXED64:r=t||e==0,n=Ft.Bit64;break;case ye.SINT64:r=t||e==0;break}const s=ye[i].toLowerCase();return[n,s,t||r]}const Or=Symbol("@bufbuild/protobuf/unknown-fields"),pu={readUnknownFields:!0,readerFactory:i=>new Qy(i)},vu={writeUnknownFields:!0,writerFactory:()=>new Ky};function Zy(i){return i?Object.assign(Object.assign({},pu),i):pu}function $y(i){return i?Object.assign(Object.assign({},vu),i):vu}function e_(){return{makeReadOptions:Zy,makeWriteOptions:$y,listUnknownFields(i){var e;return(e=i[Or])!==null&&e!==void 0?e:[]},discardUnknownFields(i){delete i[Or]},writeUnknownFields(i,e){const n=i[Or];if(n)for(const r of n)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(i,e,t,n){const r=i;Array.isArray(r[Or])||(r[Or]=[]),r[Or].push({no:e,wireType:t,data:n})},readMessage(i,e,t,n){const r=i.getType(),s=t===void 0?e.len:e.pos+t;for(;e.pos<s;){const[l,a]=e.tag(),o=r.fields.find(l);if(!o){const d=e.skip(a);n.readUnknownFields&&this.onUnknownField(i,l,a,d);continue}let c=i,f=o.repeated,u=o.localName;switch(o.oneof&&(c=c[o.oneof.localName],c.case!=u&&delete c.value,c.case=u,u="value"),o.kind){case"scalar":case"enum":const d=o.kind=="enum"?ye.INT32:o.T;if(f){let g=c[u];if(a==Ft.LengthDelimited&&d!=ye.STRING&&d!=ye.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)g.push(gs(e,d))}else g.push(gs(e,d))}else c[u]=gs(e,d);break;case"message":const h=o.T;f?c[u].push(io(e,new h,n)):c[u]instanceof Le?io(e,c[u],n):(c[u]=io(e,new h,n),h.fieldWrapper&&!o.oneof&&!o.repeated&&(c[u]=h.fieldWrapper.unwrapField(c[u])));break;case"map":let[m,p]=t_(o,e,n);c[u][m]=p;break}}}}}function io(i,e,t){return e.getType().runtime.bin.readMessage(e,i,i.uint32(),t),e}function t_(i,e,t){const n=e.uint32(),r=e.pos+n;let s,l;for(;e.pos<r;){let[a]=e.tag();switch(a){case 1:s=gs(e,i.K);break;case 2:switch(i.V.kind){case"scalar":l=gs(e,i.V.T);break;case"enum":l=e.int32();break;case"message":l=io(e,new i.V.T,t);break}break}}if(s===void 0){let a=Cc(i.K);s=i.K==ye.BOOL?a.toString():a}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),l===void 0)switch(i.V.kind){case"scalar":l=Cc(i.V.T);break;case"enum":l=0;break;case"message":l=new i.V.T;break}return[s,l]}function gs(i,e){switch(e){case ye.STRING:return i.string();case ye.BOOL:return i.bool();case ye.DOUBLE:return i.double();case ye.FLOAT:return i.float();case ye.INT32:return i.int32();case ye.INT64:return i.int64();case ye.UINT64:return i.uint64();case ye.FIXED64:return i.fixed64();case ye.BYTES:return i.bytes();case ye.FIXED32:return i.fixed32();case ye.SFIXED32:return i.sfixed32();case ye.SFIXED64:return i.sfixed64();case ye.SINT64:return i.sint64();case ye.UINT32:return i.uint32();case ye.SINT32:return i.sint32()}}function i_(i,e,t,n,r){i.tag(t.no,Ft.LengthDelimited),i.fork();let s=n;switch(t.K){case ye.INT32:case ye.FIXED32:case ye.UINT32:case ye.SFIXED32:case ye.SINT32:s=Number.parseInt(n);break;case ye.BOOL:hi(n=="true"||n=="false"),s=n=="true";break}switch(ps(i,t.K,1,s,!0),t.V.kind){case"scalar":ps(i,t.V.T,2,r,!0);break;case"enum":ps(i,ye.INT32,2,r,!0);break;case"message":Sc(i,e,t.V.T,2,r);break}i.join()}function Sc(i,e,t,n,r){if(r!==void 0){const s=_c(t,r);i.tag(n,Ft.LengthDelimited).bytes(s.toBinary(e))}}function ps(i,e,t,n,r){let[s,l,a]=Gh(e,n);(!a||r)&&i.tag(t,s)[l](n)}function n_(i,e,t,n){if(!n.length)return;i.tag(t,Ft.LengthDelimited).fork();let[,r]=Gh(e);for(let s=0;s<n.length;s++)i[r](n[s]);i.join()}function r_(){return Object.assign(Object.assign({},e_()),{writeMessage(i,e,t){const n=i.getType();for(const r of n.fields.byNumber()){let s,l=r.repeated,a=r.localName;if(r.oneof){const o=i[r.oneof.localName];if(o.case!==a)continue;s=o.value}else s=i[a];switch(r.kind){case"scalar":case"enum":let o=r.kind=="enum"?ye.INT32:r.T;if(l)if(r.packed)n_(e,o,r.no,s);else for(const c of s)ps(e,o,r.no,c,!0);else s!==void 0&&ps(e,o,r.no,s,!!r.oneof||r.opt);break;case"message":if(l)for(const c of s)Sc(e,t,r.T,r.no,c);else Sc(e,t,r.T,r.no,s);break;case"map":for(const[c,f]of Object.entries(s))i_(e,t,r,c,f);break}}return t.writeUnknownFields&&this.writeUnknownFields(i,e),e}})}let pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Bo=[];for(let i=0;i<pn.length;i++)Bo[pn[i].charCodeAt(0)]=i;Bo["-".charCodeAt(0)]=pn.indexOf("+");Bo["_".charCodeAt(0)]=pn.indexOf("/");const Jh={dec(i){let e=i.length*3/4;i[i.length-2]=="="?e-=2:i[i.length-1]=="="&&(e-=1);let t=new Uint8Array(e),n=0,r=0,s,l=0;for(let a=0;a<i.length;a++){if(s=Bo[i.charCodeAt(a)],s===void 0)switch(i[a]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:l=s,r=1;break;case 1:t[n++]=l<<2|(s&48)>>4,l=s,r=2;break;case 2:t[n++]=(l&15)<<4|(s&60)>>2,l=s,r=3;break;case 3:t[n++]=(l&3)<<6|s,r=0;break}}if(r==1)throw Error("invalid base64 string.");return t.subarray(0,n)},enc(i){let e="",t=0,n,r=0;for(let s=0;s<i.length;s++)switch(n=i[s],t){case 0:e+=pn[n>>2],r=(n&3)<<4,t=1;break;case 1:e+=pn[r|n>>4],r=(n&15)<<2,t=2;break;case 2:e+=pn[r|n>>6],e+=pn[n&63],t=0;break}return t&&(e+=pn[r],e+="=",t==1&&(e+="=")),e}},bu={ignoreUnknownFields:!1},yu={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function s_(i){return i?Object.assign(Object.assign({},bu),i):bu}function o_(i){return i?Object.assign(Object.assign({},yu),i):yu}function a_(i){const e=i(c_,_u);return{makeReadOptions:s_,makeWriteOptions:o_,readMessage(t,n,r,s){if(n==null||Array.isArray(n)||typeof n!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(this.debug(n)));s=s??new t;const l={};for(const[a,o]of Object.entries(n)){const c=t.fields.findJsonName(a);if(!c){if(!r.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let f=c.localName,u=s;if(c.oneof){if(o===null&&c.kind=="scalar")continue;const d=l[c.oneof.localName];if(d)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(d,'", "').concat(a,'"'));l[c.oneof.localName]=a,u=u[c.oneof.localName]={case:f},f="value"}if(c.repeated){if(o===null)continue;if(!Array.isArray(o))throw new Error("cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(o)));const d=u[f];for(const h of o){if(h===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h)));let m;switch(c.kind){case"message":m=c.T.fromJson(h,r);break;case"enum":if(m=Ua(c.T,h,r.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=es(c.T,h)}catch(p){let g="cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}d.push(m)}}else if(c.kind=="map"){if(o===null)continue;if(Array.isArray(o)||typeof o!="object")throw new Error("cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(o)));const d=u[f];for(const[h,m]of Object.entries(o)){if(m===null)throw new Error("cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: map value null"));let p;switch(c.V.kind){case"message":p=c.V.T.fromJson(m,r);break;case"enum":if(p=Ua(c.V.T,m,r.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=es(c.V.T,m)}catch(g){let v="cannot decode map value for field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(o));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}break}try{d[es(c.K,c.K==ye.BOOL?h=="true"?!0:h=="false"?!1:h:h).toString()]=p}catch(g){let v="cannot decode map key for field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(o));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}}}else switch(c.kind){case"message":const d=c.T;if(o===null&&d.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(t.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}u[f]instanceof Le?u[f].fromJson(o,r):(u[f]=d.fromJson(o,r),d.fieldWrapper&&!c.oneof&&(u[f]=d.fieldWrapper.unwrapField(u[f])));break;case"enum":const h=Ua(c.T,o,r.ignoreUnknownFields);h!==void 0&&(u[f]=h);break;case"scalar":try{u[f]=es(c.T,o)}catch(m){let p="cannot decode field ".concat(t.typeName,".").concat(c.name," from JSON: ").concat(this.debug(o));throw m instanceof Error&&m.message.length>0&&(p+=": ".concat(m.message)),new Error(p)}break}}return s},writeMessage(t,n){const r=t.getType(),s={};let l;try{for(const a of r.fields.byMember()){let o;if(a.kind=="oneof"){const c=t[a.localName];if(c.value===void 0)continue;if(l=a.findField(c.case),!l)throw"oneof case not found: "+c.case;o=e(l,c.value,n)}else l=a,o=e(l,t[l.localName],n);o!==void 0&&(s[n.useProtoFieldName?l.name:l.jsonName]=o)}}catch(a){const o=l?"cannot encode field ".concat(r.typeName,".").concat(l.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),c=a instanceof Error?a.message:String(a);throw new Error(o+(c.length>0?": ".concat(c):""))}return s},readScalar:es,writeScalar:_u,debug:qh}}function qh(i){if(i===null)return"null";switch(typeof i){case"object":return Array.isArray(i)?"array":"object";case"string":return i.length>100?"string":'"'.concat(i.split('"').join('\\"'),'"');default:return String(i)}}function es(i,e){switch(i){case ye.DOUBLE:case ye.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const t=Number(e);if(Number.isNaN(t)||!Number.isFinite(t))break;return i==ye.FLOAT&&jh(t),t;case ye.INT32:case ye.FIXED32:case ye.SFIXED32:case ye.SINT32:case ye.UINT32:if(e===null)return 0;let n;if(typeof e=="number"?n=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(n=Number(e)),n===void 0)break;return i==ye.UINT32?yc(n):eo(n),n;case ye.INT64:case ye.SFIXED64:case ye.SINT64:if(e===null)return ot.zero;if(typeof e!="number"&&typeof e!="string")break;return ot.parse(e);case ye.FIXED64:case ye.UINT64:if(e===null)return ot.zero;if(typeof e!="number"&&typeof e!="string")break;return ot.uParse(e);case ye.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case ye.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ye.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return Jh.dec(e)}throw new Error}function Ua(i,e,t){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const n=i.findName(e);if(n||t)return n==null?void 0:n.no;break}throw new Error("cannot decode enum ".concat(i.typeName," from JSON: ").concat(qh(e)))}function c_(i,e,t,n){var r;if(e===void 0)return e;if(e===0&&!t)return;if(n)return e;if(i.typeName=="google.protobuf.NullValue")return null;const s=i.findNumber(e);return(r=s==null?void 0:s.name)!==null&&r!==void 0?r:e}function _u(i,e,t){if(e!==void 0)switch(i){case ye.INT32:case ye.SFIXED32:case ye.SINT32:case ye.FIXED32:case ye.UINT32:return hi(typeof e=="number"),e!=0||t?e:void 0;case ye.FLOAT:case ye.DOUBLE:return hi(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||t?e:void 0;case ye.STRING:return hi(typeof e=="string"),e.length>0||t?e:void 0;case ye.BOOL:return hi(typeof e=="boolean"),e||t?e:void 0;case ye.UINT64:case ye.FIXED64:case ye.INT64:case ye.SFIXED64:case ye.SINT64:return hi(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),t||e!=0?e.toString(10):void 0;case ye.BYTES:return hi(e instanceof Uint8Array),t||e.byteLength>0?Jh.enc(e):void 0}}function l_(){return a_((i,e)=>function(n,r,s){if(n.kind=="map"){const l={};switch(n.V.kind){case"scalar":for(const[o,c]of Object.entries(r)){const f=e(n.V.T,c,!0);hi(f!==void 0),l[o.toString()]=f}break;case"message":for(const[o,c]of Object.entries(r))l[o.toString()]=c.toJson(s);break;case"enum":const a=n.V.T;for(const[o,c]of Object.entries(r)){hi(c===void 0||typeof c=="number");const f=i(a,c,!0,s.enumAsInteger);hi(f!==void 0),l[o.toString()]=f}break}return s.emitDefaultValues||Object.keys(l).length>0?l:void 0}else if(n.repeated){const l=[];switch(n.kind){case"scalar":for(let a=0;a<r.length;a++)l.push(e(n.T,r[a],!0));break;case"enum":for(let a=0;a<r.length;a++)l.push(i(n.T,r[a],!0,s.enumAsInteger));break;case"message":for(let a=0;a<r.length;a++)l.push(_c(n.T,r[a]).toJson(s));break}return s.emitDefaultValues||l.length>0?l:void 0}else switch(n.kind){case"scalar":return e(n.T,r,!!n.oneof||n.opt||s.emitDefaultValues);case"enum":return i(n.T,r,!!n.oneof||n.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return r!==void 0?_c(n.T,r).toJson(s):void 0}})}function u_(){return{setEnumType:zh,initPartial(i,e){if(i===void 0)return;const t=e.getType();for(const n of t.fields.byMember()){const r=n.localName,s=e,l=i;if(l[r]!==void 0)switch(n.kind){case"oneof":const a=l[r].case;if(a===void 0)continue;const o=n.findField(a);let c=l[r].value;o&&o.kind=="message"&&!(c instanceof o.T)?c=new o.T(c):o&&o.kind==="scalar"&&o.T===ye.BYTES&&(c=ts(c)),s[r]={case:a,value:c};break;case"scalar":case"enum":let f=l[r];n.T===ye.BYTES&&(f=n.repeated?f.map(ts):ts(f)),s[r]=f;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===ye.BYTES)for(const[h,m]of Object.entries(l[r]))s[r][h]=ts(m);else Object.assign(s[r],l[r]);break;case"message":const d=n.V.T;for(const h of Object.keys(l[r])){let m=l[r][h];d.fieldWrapper||(m=new d(m)),s[r][h]=m}break}break;case"message":const u=n.T;if(n.repeated)s[r]=l[r].map(d=>d instanceof u?d:new u(d));else if(l[r]!==void 0){const d=l[r];u.fieldWrapper?u.typeName==="google.protobuf.BytesValue"?s[r]=ts(d):s[r]=d:s[r]=d instanceof u?d:new u(d)}break}}},equals(i,e,t){return e===t?!0:!e||!t?!1:i.fields.byMember().every(n=>{const r=e[n.localName],s=t[n.localName];if(n.repeated){if(r.length!==s.length)return!1;switch(n.kind){case"message":return r.every((l,a)=>n.T.equals(l,s[a]));case"scalar":return r.every((l,a)=>Kn(n.T,l,s[a]));case"enum":return r.every((l,a)=>Kn(ye.INT32,l,s[a]))}throw new Error("repeated cannot contain ".concat(n.kind))}switch(n.kind){case"message":return n.T.equals(r,s);case"enum":return Kn(ye.INT32,r,s);case"scalar":return Kn(n.T,r,s);case"oneof":if(r.case!==s.case)return!1;const l=n.findField(r.case);if(l===void 0)return!0;switch(l.kind){case"message":return l.T.equals(r.value,s.value);case"enum":return Kn(ye.INT32,r.value,s.value);case"scalar":return Kn(l.T,r.value,s.value)}throw new Error("oneof cannot contain ".concat(l.kind));case"map":const a=Object.keys(r).concat(Object.keys(s));switch(n.V.kind){case"message":const o=n.V.T;return a.every(f=>o.equals(r[f],s[f]));case"enum":return a.every(f=>Kn(ye.INT32,r[f],s[f]));case"scalar":const c=n.V.T;return a.every(f=>Kn(c,r[f],s[f]))}break}})},clone(i){const e=i.getType(),t=new e,n=t;for(const r of e.fields.byMember()){const s=i[r.localName];let l;if(r.repeated)l=s.map(Xs);else if(r.kind=="map"){l=n[r.localName];for(const[a,o]of Object.entries(s))l[a]=Xs(o)}else r.kind=="oneof"?l=r.findField(s.case)?{case:s.case,value:Xs(s.value)}:{case:void 0}:l=Xs(s);n[r.localName]=l}return t}}}function Xs(i){if(i===void 0)return i;if(i instanceof Le)return i.clone();if(i instanceof Uint8Array){const e=new Uint8Array(i.byteLength);return e.set(i),e}return i}function ts(i){return i instanceof Uint8Array?i:new Uint8Array(i)}class f_{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const n of this.list())t[n.jsonName]=t[n.name]=n;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const n of this.list())t[n.no]=n;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Kh(i,e){const t=Qh(i);return e?t:v_(p_(t))}function h_(i){return Kh(i,!1)}const d_=Qh;function Qh(i){let e=!1;const t=[];for(let n=0;n<i.length;n++){let r=i.charAt(n);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),t.push(r);break}}return t.join("")}const m_=new Set(["constructor","toString","toJSON","valueOf"]),g_=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Zh=i=>"".concat(i,"$"),p_=i=>g_.has(i)?Zh(i):i,v_=i=>m_.has(i)?Zh(i):i;class b_{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=h_(e)}addField(e){hi(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}const R=Xy("proto3",l_(),r_(),Object.assign(Object.assign({},u_()),{newFieldList(i){return new f_(i,y_)},initFields(i){for(const e of i.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,n=i;if(e.repeated){n[t]=[];continue}switch(e.kind){case"oneof":n[t]={case:void 0};break;case"enum":n[t]=0;break;case"map":n[t]={};break;case"scalar":n[t]=Cc(e.T);break}}}}));function y_(i){var e,t,n;const r=[];let s;for(const l of typeof i=="function"?i():i){const a=l;if(a.localName=Kh(l.name,l.oneof!==void 0),a.jsonName=(e=l.jsonName)!==null&&e!==void 0?e:d_(l.name),a.repeated=(t=l.repeated)!==null&&t!==void 0?t:!1,a.packed=(n=l.packed)!==null&&n!==void 0?n:l.kind=="enum"||l.kind=="scalar"&&l.T!=ye.BYTES&&l.T!=ye.STRING,l.oneof!==void 0){const o=typeof l.oneof=="string"?l.oneof:l.oneof.name;(!s||s.name!=o)&&(s=new b_(o)),a.oneof=s,s.addField(a)}r.push(a)}return r}class Qt extends Le{constructor(e){super(),this.seconds=ot.zero,this.nanos=0,R.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(R.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=ot.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const r=(this.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?n="."+r.substring(0,3)+"Z":r.substring(6)==="000"?n="."+r.substring(0,6)+"Z":n="."+r+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Qt.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Qt({seconds:ot.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Qt().fromBinary(e,t)}static fromJson(e,t){return new Qt().fromJson(e,t)}static fromJsonString(e,t){return new Qt().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Qt,e,t)}}Qt.runtime=R;Qt.typeName="google.protobuf.Timestamp";Qt.fields=R.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var kc;(function(i){i[i.DEFAULT_AC=0]="DEFAULT_AC",i[i.OPUS=1]="OPUS",i[i.AAC=2]="AAC"})(kc||(kc={}));R.util.setEnumType(kc,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Tc;(function(i){i[i.DEFAULT_VC=0]="DEFAULT_VC",i[i.H264_BASELINE=1]="H264_BASELINE",i[i.H264_MAIN=2]="H264_MAIN",i[i.H264_HIGH=3]="H264_HIGH",i[i.VP8=4]="VP8"})(Tc||(Tc={}));R.util.setEnumType(Tc,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Zt;(function(i){i[i.AUDIO=0]="AUDIO",i[i.VIDEO=1]="VIDEO",i[i.DATA=2]="DATA"})(Zt||(Zt={}));R.util.setEnumType(Zt,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Bt;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.CAMERA=1]="CAMERA",i[i.MICROPHONE=2]="MICROPHONE",i[i.SCREEN_SHARE=3]="SCREEN_SHARE",i[i.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Bt||(Bt={}));R.util.setEnumType(Bt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var zt;(function(i){i[i.LOW=0]="LOW",i[i.MEDIUM=1]="MEDIUM",i[i.HIGH=2]="HIGH",i[i.OFF=3]="OFF"})(zt||(zt={}));R.util.setEnumType(zt,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var rr;(function(i){i[i.POOR=0]="POOR",i[i.GOOD=1]="GOOD",i[i.EXCELLENT=2]="EXCELLENT"})(rr||(rr={}));R.util.setEnumType(rr,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"}]);var Bi;(function(i){i[i.UNSET=0]="UNSET",i[i.DISABLED=1]="DISABLED",i[i.ENABLED=2]="ENABLED"})(Bi||(Bi={}));R.util.setEnumType(Bi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Wn;(function(i){i[i.UNKNOWN_REASON=0]="UNKNOWN_REASON",i[i.CLIENT_INITIATED=1]="CLIENT_INITIATED",i[i.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",i[i.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",i[i.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",i[i.ROOM_DELETED=5]="ROOM_DELETED",i[i.STATE_MISMATCH=6]="STATE_MISMATCH",i[i.JOIN_FAILURE=7]="JOIN_FAILURE"})(Wn||(Wn={}));R.util.setEnumType(Wn,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Si;(function(i){i[i.RR_UNKNOWN=0]="RR_UNKNOWN",i[i.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",i[i.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",i[i.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",i[i.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Si||(Si={}));R.util.setEnumType(Si,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var As;(function(i){i[i.SE_UNKNOWN=0]="SE_UNKNOWN",i[i.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",i[i.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(As||(As={}));R.util.setEnumType(As,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Jr=class cs extends Le{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=ot.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new cs().fromBinary(e,t)}static fromJson(e,t){return new cs().fromJson(e,t)}static fromJsonString(e,t){return new cs().fromJsonString(e,t)}static equals(e,t){return R.util.equals(cs,e,t)}};Jr.runtime=R;Jr.typeName="livekit.Room";Jr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Di,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:12,name:"playout_delay",kind:"message",T:yn}]);class Di extends Le{constructor(e){super(),this.mime="",this.fmtpLine="",R.util.initPartial(e,this)}static fromBinary(e,t){return new Di().fromBinary(e,t)}static fromJson(e,t){return new Di().fromJson(e,t)}static fromJsonString(e,t){return new Di().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Di,e,t)}}Di.runtime=R;Di.typeName="livekit.Codec";Di.fields=R.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class yn extends Le{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new yn().fromBinary(e,t)}static fromJson(e,t){return new yn().fromJson(e,t)}static fromJsonString(e,t){return new yn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(yn,e,t)}}yn.runtime=R;yn.typeName="livekit.PlayoutDelay";yn.fields=R.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class _n extends Le{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new _n().fromBinary(e,t)}static fromJson(e,t){return new _n().fromJson(e,t)}static fromJsonString(e,t){return new _n().fromJsonString(e,t)}static equals(e,t){return R.util.equals(_n,e,t)}}_n.runtime=R;_n.typeName="livekit.ParticipantPermission";_n.fields=R.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:R.getEnumType(Bt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8}]);class yi extends Le{constructor(e){super(),this.sid="",this.identity="",this.state=br.JOINING,this.tracks=[],this.metadata="",this.joinedAt=ot.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new yi().fromBinary(e,t)}static fromJson(e,t){return new yi().fromJson(e,t)}static fromJsonString(e,t){return new yi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(yi,e,t)}}yi.runtime=R;yi.typeName="livekit.ParticipantInfo";yi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(br)},{no:4,name:"tracks",kind:"message",T:di,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:_n},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var br;(function(i){i[i.JOINING=0]="JOINING",i[i.JOINED=1]="JOINED",i[i.ACTIVE=2]="ACTIVE",i[i.DISCONNECTED=3]="DISCONNECTED"})(br||(br={}));R.util.setEnumType(br,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class $n extends Le{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,t){return new $n().fromBinary(e,t)}static fromJson(e,t){return new $n().fromJson(e,t)}static fromJsonString(e,t){return new $n().fromJsonString(e,t)}static equals(e,t){return R.util.equals($n,e,t)}}$n.runtime=R;$n.typeName="livekit.Encryption";$n.fields=R.util.newFieldList(()=>[]);var ai;(function(i){i[i.NONE=0]="NONE",i[i.GCM=1]="GCM",i[i.CUSTOM=2]="CUSTOM"})(ai||(ai={}));R.util.setEnumType(ai,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Cn extends Le{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Cn().fromBinary(e,t)}static fromJson(e,t){return new Cn().fromJson(e,t)}static fromJsonString(e,t){return new Cn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Cn,e,t)}}Cn.runtime=R;Cn.typeName="livekit.SimulcastCodecInfo";Cn.fields=R.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ci,repeated:!0}]);class di extends Le{constructor(e){super(),this.sid="",this.type=Zt.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Bt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=ai.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,t){return new di().fromBinary(e,t)}static fromJson(e,t){return new di().fromJson(e,t)}static fromJsonString(e,t){return new di().fromJsonString(e,t)}static equals(e,t){return R.util.equals(di,e,t)}}di.runtime=R;di.typeName="livekit.TrackInfo";di.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:R.getEnumType(Zt)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:R.getEnumType(Bt)},{no:10,name:"layers",kind:"message",T:ci,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Cn,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:R.getEnumType(ai)},{no:17,name:"stream",kind:"scalar",T:9}]);class ci extends Le{constructor(e){super(),this.quality=zt.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new ci().fromBinary(e,t)}static fromJson(e,t){return new ci().fromJson(e,t)}static fromJsonString(e,t){return new ci().fromJsonString(e,t)}static equals(e,t){return R.util.equals(ci,e,t)}}ci.runtime=R;ci.typeName="livekit.VideoLayer";ci.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(zt)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Hi extends Le{constructor(e){super(),this.kind=Yt.RELIABLE,this.value={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,t){return new Hi().fromBinary(e,t)}static fromJson(e,t){return new Hi().fromJson(e,t)}static fromJsonString(e,t){return new Hi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Hi,e,t)}}Hi.runtime=R;Hi.typeName="livekit.DataPacket";Hi.fields=R.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:R.getEnumType(Yt)},{no:2,name:"user",kind:"message",T:Gi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Sn,oneof:"value"}]);var Yt;(function(i){i[i.RELIABLE=0]="RELIABLE",i[i.LOSSY=1]="LOSSY"})(Yt||(Yt={}));R.util.setEnumType(Yt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Sn extends Le{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Sn().fromBinary(e,t)}static fromJson(e,t){return new Sn().fromJson(e,t)}static fromJsonString(e,t){return new Sn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Sn,e,t)}}Sn.runtime=R;Sn.typeName="livekit.ActiveSpeakerUpdate";Sn.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Yi,repeated:!0}]);class Yi extends Le{constructor(e){super(),this.sid="",this.level=0,this.active=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new Yi().fromBinary(e,t)}static fromJson(e,t){return new Yi().fromJson(e,t)}static fromJsonString(e,t){return new Yi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Yi,e,t)}}Yi.runtime=R;Yi.typeName="livekit.SpeakerInfo";Yi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Gi extends Le{constructor(e){super(),this.participantSid="",this.payload=new Uint8Array(0),this.destinationSids=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Gi().fromBinary(e,t)}static fromJson(e,t){return new Gi().fromJson(e,t)}static fromJsonString(e,t){return new Gi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Gi,e,t)}}Gi.runtime=R;Gi.typeName="livekit.UserPacket";Gi.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Ji extends Le{constructor(e){super(),this.participantSid="",this.trackSids=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Ji().fromBinary(e,t)}static fromJson(e,t){return new Ji().fromJson(e,t)}static fromJsonString(e,t){return new Ji().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ji,e,t)}}Ji.runtime=R;Ji.typeName="livekit.ParticipantTracks";Ji.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class kn extends Le{constructor(e){super(),this.edition=Xr.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",R.util.initPartial(e,this)}static fromBinary(e,t){return new kn().fromBinary(e,t)}static fromJson(e,t){return new kn().fromJson(e,t)}static fromJsonString(e,t){return new kn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(kn,e,t)}}kn.runtime=R;kn.typeName="livekit.ServerInfo";kn.fields=R.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:R.getEnumType(Xr)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Xr;(function(i){i[i.Standard=0]="Standard",i[i.Cloud=1]="Cloud"})(Xr||(Xr={}));R.util.setEnumType(Xr,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Tn extends Le{constructor(e){super(),this.sdk=Hr.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",R.util.initPartial(e,this)}static fromBinary(e,t){return new Tn().fromBinary(e,t)}static fromJson(e,t){return new Tn().fromJson(e,t)}static fromJsonString(e,t){return new Tn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Tn,e,t)}}Tn.runtime=R;Tn.typeName="livekit.ClientInfo";Tn.fields=R.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:R.getEnumType(Hr)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Hr;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.JS=1]="JS",i[i.SWIFT=2]="SWIFT",i[i.ANDROID=3]="ANDROID",i[i.FLUTTER=4]="FLUTTER",i[i.GO=5]="GO",i[i.UNITY=6]="UNITY",i[i.REACT_NATIVE=7]="REACT_NATIVE",i[i.RUST=8]="RUST"})(Hr||(Hr={}));R.util.setEnumType(Hr,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"}]);class qi extends Le{constructor(e){super(),this.resumeConnection=Bi.UNSET,this.forceRelay=Bi.UNSET,R.util.initPartial(e,this)}static fromBinary(e,t){return new qi().fromBinary(e,t)}static fromJson(e,t){return new qi().fromJson(e,t)}static fromJsonString(e,t){return new qi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(qi,e,t)}}qi.runtime=R;qi.typeName="livekit.ClientConfiguration";qi.fields=R.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:Ki},{no:2,name:"screen",kind:"message",T:Ki},{no:3,name:"resume_connection",kind:"enum",T:R.getEnumType(Bi)},{no:4,name:"disabled_codecs",kind:"message",T:wn},{no:5,name:"force_relay",kind:"enum",T:R.getEnumType(Bi)}]);class Ki extends Le{constructor(e){super(),this.hardwareEncoder=Bi.UNSET,R.util.initPartial(e,this)}static fromBinary(e,t){return new Ki().fromBinary(e,t)}static fromJson(e,t){return new Ki().fromJson(e,t)}static fromJsonString(e,t){return new Ki().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ki,e,t)}}Ki.runtime=R;Ki.typeName="livekit.VideoConfiguration";Ki.fields=R.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:R.getEnumType(Bi)}]);class wn extends Le{constructor(e){super(),this.codecs=[],this.publish=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new wn().fromBinary(e,t)}static fromJson(e,t){return new wn().fromJson(e,t)}static fromJsonString(e,t){return new wn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(wn,e,t)}}wn.runtime=R;wn.typeName="livekit.DisabledCodecs";wn.fields=R.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Di,repeated:!0},{no:2,name:"publish",kind:"message",T:Di,repeated:!0}]);class er extends Le{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=ot.zero,this.headerBytes=ot.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=ot.zero,this.headerBytesDuplicate=ot.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=ot.zero,this.headerBytesPadding=ot.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,this.sampleRate=0,this.driftMs=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new er().fromBinary(e,t)}static fromJson(e,t){return new er().fromJson(e,t)}static fromJsonString(e,t){return new er().fromJsonString(e,t)}static equals(e,t){return R.util.equals(er,e,t)}}er.runtime=R;er.typeName="livekit.RTPStats";er.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Qt},{no:2,name:"end_time",kind:"message",T:Qt},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Qt},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Qt},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Qt},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Qt},{no:42,name:"sample_rate",kind:"scalar",T:1},{no:43,name:"drift_ms",kind:"scalar",T:1}]);class tr extends Le{constructor(e){super(),this.unixMicro=ot.zero,this.ticks=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new tr().fromBinary(e,t)}static fromJson(e,t){return new tr().fromJson(e,t)}static fromJsonString(e,t){return new tr().fromJsonString(e,t)}static equals(e,t){return R.util.equals(tr,e,t)}}tr.runtime=R;tr.typeName="livekit.TimedVersion";tr.fields=R.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const is=7e3,__=[0,300,2*2*300,3*3*300,4*4*300,is,is,is,is,is];class C_{constructor(e){this._retryDelays=e!==void 0?[...e]:__}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function re(i,e,t,n){function r(s){return s instanceof t?s:new t(function(l){l(s)})}return new(t||(t=Promise))(function(s,l){function a(f){try{c(n.next(f))}catch(u){l(u)}}function o(f){try{c(n.throw(f))}catch(u){l(u)}}function c(f){f.done?s(f.value):r(f.value).then(a,o)}c((n=n.apply(i,e||[])).next())})}function Cu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ar(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Cu=="function"?Cu(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(l){return new Promise(function(a,o){l=i[s](l),r(a,o,l.done,l.value)})}}function r(s,l,a,o){Promise.resolve(o).then(function(c){s({value:c,done:a})},l)}}var nl={exports:{}},Br=typeof Reflect=="object"?Reflect:null,Su=Br&&typeof Br.apply=="function"?Br.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},no;Br&&typeof Br.ownKeys=="function"?no=Br.ownKeys:Object.getOwnPropertySymbols?no=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:no=function(e){return Object.getOwnPropertyNames(e)};function S_(i){console&&console.warn&&console.warn(i)}var $h=Number.isNaN||function(e){return e!==e};function Tt(){Tt.init.call(this)}nl.exports=Tt;nl.exports.once=P_;Tt.EventEmitter=Tt;Tt.prototype._events=void 0;Tt.prototype._eventsCount=0;Tt.prototype._maxListeners=void 0;var ku=10;function Uo(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(Tt,"defaultMaxListeners",{enumerable:!0,get:function(){return ku},set:function(i){if(typeof i!="number"||i<0||$h(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");ku=i}});Tt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||$h(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ed(i){return i._maxListeners===void 0?Tt.defaultMaxListeners:i._maxListeners}Tt.prototype.getMaxListeners=function(){return ed(this)};Tt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var l;if(t.length>0&&(l=t[0]),l instanceof Error)throw l;var a=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw a.context=l,a}var o=s[e];if(o===void 0)return!1;if(typeof o=="function")Su(o,this,t);else for(var c=o.length,f=sd(o,c),n=0;n<c;++n)Su(f[n],this,t);return!0};function td(i,e,t,n){var r,s,l;if(Uo(t),s=i._events,s===void 0?(s=i._events=Object.create(null),i._eventsCount=0):(s.newListener!==void 0&&(i.emit("newListener",e,t.listener?t.listener:t),s=i._events),l=s[e]),l===void 0)l=s[e]=t,++i._eventsCount;else if(typeof l=="function"?l=s[e]=n?[t,l]:[l,t]:n?l.unshift(t):l.push(t),r=ed(i),r>0&&l.length>r&&!l.warned){l.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=i,a.type=e,a.count=l.length,S_(a)}return i}Tt.prototype.addListener=function(e,t){return td(this,e,t,!1)};Tt.prototype.on=Tt.prototype.addListener;Tt.prototype.prependListener=function(e,t){return td(this,e,t,!0)};function k_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function id(i,e,t){var n={fired:!1,wrapFn:void 0,target:i,type:e,listener:t},r=k_.bind(n);return r.listener=t,n.wrapFn=r,r}Tt.prototype.once=function(e,t){return Uo(t),this.on(e,id(this,e,t)),this};Tt.prototype.prependOnceListener=function(e,t){return Uo(t),this.prependListener(e,id(this,e,t)),this};Tt.prototype.removeListener=function(e,t){var n,r,s,l,a;if(Uo(t),r=this._events,r===void 0)return this;if(n=r[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,l=n.length-1;l>=0;l--)if(n[l]===t||n[l].listener===t){a=n[l].listener,s=l;break}if(s<0)return this;s===0?n.shift():T_(n,s),n.length===1&&(r[e]=n[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Tt.prototype.off=Tt.prototype.removeListener;Tt.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),l;for(r=0;r<s.length;++r)l=s[r],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function nd(i,e,t){var n=i._events;if(n===void 0)return[];var r=n[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?w_(r):sd(r,r.length)}Tt.prototype.listeners=function(e){return nd(this,e,!0)};Tt.prototype.rawListeners=function(e){return nd(this,e,!1)};Tt.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):rd.call(i,e)};Tt.prototype.listenerCount=rd;function rd(i){var e=this._events;if(e!==void 0){var t=e[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Tt.prototype.eventNames=function(){return this._eventsCount>0?no(this._events):[]};function sd(i,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=i[n];return t}function T_(i,e){for(;e+1<i.length;e++)i[e]=i[e+1];i.pop()}function w_(i){for(var e=new Array(i.length),t=0;t<e.length;++t)e[t]=i[t].listener||i[t];return e}function P_(i,e){return new Promise(function(t,n){function r(l){i.removeListener(e,s),n(l)}function s(){typeof i.removeListener=="function"&&i.removeListener("error",r),t([].slice.call(arguments))}od(i,e,s,{once:!0}),e!=="error"&&E_(i,r,{once:!0})})}function E_(i,e,t){typeof i.on=="function"&&od(i,"error",e,t)}function od(i,e,t,n){if(typeof i.on=="function")n.once?i.once(e,t):i.on(e,t);else if(typeof i.addEventListener=="function")i.addEventListener(e,function r(s){n.once&&i.removeEventListener(e,r),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}var fn=nl.exports;let ad=!0,cd=!0;function ro(i,e,t){const n=i.match(e);return n&&n.length>=t&&parseInt(n[t],10)}function Cr(i,e,t){if(!i.RTCPeerConnection)return;const n=i.RTCPeerConnection.prototype,r=n.addEventListener;n.addEventListener=function(l,a){if(l!==e)return r.apply(this,arguments);const o=c=>{const f=t(c);f&&(a.handleEvent?a.handleEvent(f):a(f))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,o),r.apply(this,[l,o])};const s=n.removeEventListener;n.removeEventListener=function(l,a){if(l!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const o=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[l,o])},Object.defineProperty(n,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function O_(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(ad=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function x_(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(cd=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function ld(){if(typeof window=="object"){if(ad)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function rl(i,e){cd&&console.warn(i+" is deprecated, please use "+e+" instead.")}function A_(i){const e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=i;if(t.mozGetUserMedia)e.browser="firefox",e.version=ro(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=ro(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(i.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=ro(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Tu(i){return Object.prototype.toString.call(i)==="[object Object]"}function ud(i){return Tu(i)?Object.keys(i).reduce(function(e,t){const n=Tu(i[t]),r=n?ud(i[t]):i[t],s=n&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[t]:r})},{}):i}function wc(i,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(n=>{n.endsWith("Id")?wc(i,i.get(e[n]),t):n.endsWith("Ids")&&e[n].forEach(r=>{wc(i,i.get(r),t)})}))}function wu(i,e,t){const n=t?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return i.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&s.push(l)}),s.forEach(l=>{i.forEach(a=>{a.type===n&&a.trackId===l.id&&wc(i,a,r)})}),r}const Pu=ld;function fd(i,e){const t=i&&i.navigator;if(!t.mediaDevices)return;const n=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const o={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const f=typeof a[c]=="object"?a[c]:{ideal:a[c]};f.exact!==void 0&&typeof f.exact=="number"&&(f.min=f.max=f.exact);const u=function(d,h){return d?d+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(f.ideal!==void 0){o.optional=o.optional||[];let d={};typeof f.ideal=="number"?(d[u("min",c)]=f.ideal,o.optional.push(d),d={},d[u("max",c)]=f.ideal,o.optional.push(d)):(d[u("",c)]=f.ideal,o.optional.push(d))}f.exact!==void 0&&typeof f.exact!="number"?(o.mandatory=o.mandatory||{},o.mandatory[u("",c)]=f.exact):["min","max"].forEach(d=>{f[d]!==void 0&&(o.mandatory=o.mandatory||{},o.mandatory[u(d,c)]=f[d])})}),a.advanced&&(o.optional=(o.optional||[]).concat(a.advanced)),o},r=function(a,o){if(e.version>=61)return o(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const c=function(f,u,d){u in f&&!(d in f)&&(f[d]=f[u],delete f[u])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=n(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const f=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!f)){delete a.video.facingMode;let u;if(c.exact==="environment"||c.ideal==="environment"?u=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(u=["front"]),u)return t.mediaDevices.enumerateDevices().then(d=>{d=d.filter(m=>m.kind==="videoinput");let h=d.find(m=>u.some(p=>m.label.toLowerCase().includes(p)));return!h&&d.length&&u.includes("back")&&(h=d[d.length-1]),h&&(a.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=n(a.video),Pu("chrome: "+JSON.stringify(a)),o(a)})}a.video=n(a.video)}return Pu("chrome: "+JSON.stringify(a)),o(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(a,o,c){r(a,f=>{t.webkitGetUserMedia(f,o,u=>{c&&c(s(u))})})};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){const a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(o){return r(o,c=>a(c).then(f=>{if(c.audio&&!f.getAudioTracks().length||c.video&&!f.getVideoTracks().length)throw f.getTracks().forEach(u=>{u.stop()}),new DOMException("","NotFoundError");return f},f=>Promise.reject(s(f))))}}}function D_(i,e){if(!(i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices)&&i.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}i.navigator.mediaDevices.getDisplayMedia=function(n){return e(n).then(r=>{const s=n.video&&n.video.width,l=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:a||3}},s&&(n.video.mandatory.maxWidth=s),l&&(n.video.mandatory.maxHeight=l),i.navigator.mediaDevices.getUserMedia(n)})}}}function hd(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function dd(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",r=>{let s;i.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===r.track.id):s={track:r.track};const l=new Event("track");l.track=r.track,l.receiver=s,l.transceiver={receiver:s},l.streams=[n.stream],this.dispatchEvent(l)}),n.stream.getTracks().forEach(r=>{let s;i.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===r.id):s={track:r};const l=new Event("track");l.track=r,l.receiver=s,l.transceiver={receiver:s},l.streams=[n.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Cr(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function md(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(a,o){let c=r.apply(this,arguments);return c||(c=e(this,a),this._senders.push(c)),c};const s=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const o=this._senders.indexOf(a);o!==-1&&this._senders.splice(o,1)}}const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(l=>{this._senders.push(e(this,l))})};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(l=>{const a=this._senders.find(o=>o.track===l);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function gd(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[n,r,s]=arguments;if(arguments.length>0&&typeof n=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof n!="function"))return e.apply(this,[]);const l=function(o){const c={};return o.result().forEach(u=>{const d={id:u.id,timestamp:u.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[u.type]||u.type};u.names().forEach(h=>{d[h]=u.stat(h)}),c[d.id]=d}),c},a=function(o){return new Map(Object.keys(o).map(c=>[c,o[c]]))};if(arguments.length>=2){const o=function(c){r(a(l(c)))};return e.apply(this,[o,n])}return new Promise((o,c)=>{e.apply(this,[function(f){o(a(l(f)))},c])}).then(r,s)}}function pd(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(l=>l._pc=this),s});const n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){const s=n.apply(this,arguments);return s._pc=this,s}),i.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(l=>wu(l,s.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r}),Cr(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>wu(s,r.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const n=arguments[0];let r,s,l;return this.getSenders().forEach(a=>{a.track===n&&(r?l=!0:r=a)}),this.getReceivers().forEach(a=>(a.track===n&&(s?l=!0:s=a),a.track===n)),l||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function vd(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(l,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(o)===-1&&this._shimmedLocalStreams[a.id].push(o):this._shimmedLocalStreams[a.id]=[a,o],o};const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(c=>{if(this.getSenders().find(u=>u.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();t.apply(this,arguments);const o=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[l.id]=[l].concat(o)};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],n.apply(this,arguments)};const r=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const o=this._shimmedLocalStreams[a].indexOf(l);o!==-1&&this._shimmedLocalStreams[a].splice(o,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),r.apply(this,arguments)}}function bd(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return vd(i);const t=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const f=t.apply(this);return this._reverseStreams=this._reverseStreams||{},f.map(u=>this._reverseStreams[u.id])};const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(f){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.getTracks().forEach(u=>{if(this.getSenders().find(h=>h.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[f.id]){const u=new i.MediaStream(f.getTracks());this._streams[f.id]=u,this._reverseStreams[u.id]=f,f=u}n.apply(this,[f])};const r=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(f){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[f.id]||f]),delete this._reverseStreams[this._streams[f.id]?this._streams[f.id].id:f.id],delete this._streams[f.id]},i.RTCPeerConnection.prototype.addTrack=function(f,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(p=>p===f))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(p=>p.track===f))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const m=this._streams[u.id];if(m)m.addTrack(f),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const p=new i.MediaStream([f]);this._streams[u.id]=p,this._reverseStreams[p.id]=u,this.addStream(p)}return this.getSenders().find(p=>p.track===f)};function s(c,f){let u=f.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{const h=c._reverseStreams[d],m=c._streams[h.id];u=u.replace(new RegExp(m.id,"g"),h.id)}),new RTCSessionDescription({type:f.type,sdp:u})}function l(c,f){let u=f.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{const h=c._reverseStreams[d],m=c._streams[h.id];u=u.replace(new RegExp(h.id,"g"),m.id)}),new RTCSessionDescription({type:f.type,sdp:u})}["createOffer","createAnswer"].forEach(function(c){const f=i.RTCPeerConnection.prototype[c],u={[c](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?f.apply(this,[m=>{const p=s(this,m);d[0].apply(null,[p])},m=>{d[1]&&d[1].apply(null,m)},arguments[2]]):f.apply(this,arguments).then(m=>s(this,m))}};i.RTCPeerConnection.prototype[c]=u[c]});const a=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=l(this,arguments[0]),a.apply(this,arguments))};const o=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const c=o.get.apply(this);return c.type===""?c:s(this,c)}}),i.RTCPeerConnection.prototype.removeTrack=function(f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!f._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(f._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(p=>f.track===p)&&(d=this._streams[h])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(f.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Pc(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=i.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new(t==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};i.RTCPeerConnection.prototype[t]=r[t]})}function yd(i,e){Cr(i,"negotiationneeded",t=>{const n=t.target;if(!((e.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}var Eu=Object.freeze({__proto__:null,fixNegotiationNeeded:yd,shimAddTrackRemoveTrack:bd,shimAddTrackRemoveTrackWithNative:vd,shimGetDisplayMedia:D_,shimGetSendersWithDtmf:md,shimGetStats:gd,shimGetUserMedia:fd,shimMediaStream:hd,shimOnTrack:dd,shimPeerConnection:Pc,shimSenderReceiverGetStats:pd});function _d(i,e){const t=i&&i.navigator,n=i&&i.MediaStreamTrack;if(t.getUserMedia=function(r,s,l){rl("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(r).then(s,l)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const r=function(l,a,o){a in l&&!(o in l)&&(l[o]=l[a],delete l[a])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),r(l.audio,"autoGainControl","mozAutoGainControl"),r(l.audio,"noiseSuppression","mozNoiseSuppression")),s(l)},n&&n.prototype.getSettings){const l=n.prototype.getSettings;n.prototype.getSettings=function(){const a=l.apply(this,arguments);return r(a,"mozAutoGainControl","autoGainControl"),r(a,"mozNoiseSuppression","noiseSuppression"),a}}if(n&&n.prototype.applyConstraints){const l=n.prototype.applyConstraints;n.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a,"autoGainControl","mozAutoGainControl"),r(a,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[a])}}}}function R_(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(n)})}function Cd(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ec(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=i.RTCPeerConnection.prototype[r],l={[r](){return arguments[0]=new(r==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};i.RTCPeerConnection.prototype[r]=l[r]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[s,l,a]=arguments;return n.apply(this,[s||null]).then(o=>{if(e.version<53&&!l)try{o.forEach(c=>{c.type=t[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;o.forEach((f,u)=>{o.set(u,Object.assign({},f,{type:t[f.type]||f.type}))})}return o}).then(l,a)}}function Sd(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const t=i.RTCPeerConnection.prototype.addTrack;t&&(i.RTCPeerConnection.prototype.addTrack=function(){const r=t.apply(this,arguments);return r._pc=this,r}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function kd(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n}),Cr(i,"track",t=>(t.receiver._pc=t.srcElement,t)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Td(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){rl("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function wd(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function Pd(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const r=n.length>0;r&&n.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:l}=s,a=l.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=n,l.sendEncodings=n,this.setParametersPromises.push(l.setParameters(a).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return s})}function Ed(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Od(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function xd(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Ou=Object.freeze({__proto__:null,shimAddTransceiver:Pd,shimCreateAnswer:xd,shimCreateOffer:Od,shimGetDisplayMedia:R_,shimGetParameters:Ed,shimGetUserMedia:_d,shimOnTrack:Cd,shimPeerConnection:Ec,shimRTCDataChannel:wd,shimReceiverGetStats:kd,shimRemoveStream:Td,shimSenderGetStats:Sd});function Ad(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(r=>e.call(this,r,n)),n.getVideoTracks().forEach(r=>e.call(this,r,n))},i.RTCPeerConnection.prototype.addTrack=function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const r=t.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function Dd(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(s)>=0)return;n._remoteStreams.push(s);const l=new Event("addstream");l.stream=s,n.dispatchEvent(l)})}),e.apply(n,arguments)}}}function Rd(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(c,f){const u=arguments.length>=2?arguments[2]:arguments[0],d=t.apply(this,[u]);return f?(d.then(c,f),Promise.resolve()):d},e.createAnswer=function(c,f){const u=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[u]);return f?(d.then(c,f),Promise.resolve()):d};let a=function(o,c,f){const u=r.apply(this,[o]);return f?(u.then(c,f),Promise.resolve()):u};e.setLocalDescription=a,a=function(o,c,f){const u=s.apply(this,[o]);return f?(u.then(c,f),Promise.resolve()):u},e.setRemoteDescription=a,a=function(o,c,f){const u=l.apply(this,[o]);return f?(u.then(c,f),Promise.resolve()):u},e.addIceCandidate=a}function Md(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,n=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=r=>n(Id(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,r,s){e.mediaDevices.getUserMedia(n).then(r,s)}).bind(e))}function Id(i){return i&&i.video!==void 0?Object.assign({},i,{video:ud(i.video)}):i}function Ld(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(n,r){if(n&&n.iceServers){const s=[];for(let l=0;l<n.iceServers.length;l++){let a=n.iceServers[l];a.urls===void 0&&a.url?(rl("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(n.iceServers[l])}n.iceServers=s}return new e(n,r)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Nd(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Fd(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const r=this.getTransceivers().find(l=>l.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):n.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const s=this.getTransceivers().find(l=>l.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):n.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Bd(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var xu=Object.freeze({__proto__:null,shimAudioContext:Bd,shimCallbacksAPI:Rd,shimConstraints:Id,shimCreateOfferLegacy:Fd,shimGetUserMedia:Md,shimLocalStreamsAPI:Ad,shimRTCIceServerUrls:Ld,shimRemoteStreamsAPI:Dd,shimTrackEventTransceiver:Nd}),Ud={exports:{}};(function(i){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(n=>n.trim())},e.splitSections=function(t){return t.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(t){const n=e.splitSections(t);return n&&n[0]},e.getMediaSections=function(t){const n=e.splitSections(t);return n.shift(),n},e.matchPrefix=function(t,n){return e.splitLines(t).filter(r=>r.indexOf(n)===0)},e.parseCandidate=function(t){let n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");const r={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let s=8;s<n.length;s+=2)switch(n[s]){case"raddr":r.relatedAddress=n[s+1];break;case"rport":r.relatedPort=parseInt(n[s+1],10);break;case"tcptype":r.tcpType=n[s+1];break;case"ufrag":r.ufrag=n[s+1],r.usernameFragment=n[s+1];break;default:r[n[s]]===void 0&&(r[n[s]]=n[s+1]);break}return r},e.writeCandidate=function(t){const n=[];n.push(t.foundation);const r=t.component;r==="rtp"?n.push(1):r==="rtcp"?n.push(2):n.push(r),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);const s=t.type;return n.push("typ"),n.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let n=t.substring(9).split(" ");const r={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),r.name=n[0],r.clockRate=parseInt(n[1],10),r.channels=n.length===3?parseInt(n[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(t){let n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);const r=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(t){const n=t.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const n={};let r;const s=t.substring(t.indexOf(" ")+1).split(";");for(let l=0;l<s.length;l++)r=s[l].trim().split("="),n[r[0].trim()]=r[1];return n},e.writeFmtp=function(t){let n="",r=t.payloadType;if(t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(l=>{t.parameters[l]!==void 0?s.push(l+"="+t.parameters[l]):s.push(l)}),n+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return n},e.parseRtcpFb=function(t){const n=t.substring(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},e.writeRtcpFb=function(t){let n="",r=t.payloadType;return t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{n+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),n},e.parseSsrcMedia=function(t){const n=t.indexOf(" "),r={ssrc:parseInt(t.substring(7,n),10)},s=t.indexOf(":",n);return s>-1?(r.attribute=t.substring(n+1,s),r.value=t.substring(s+1)):r.attribute=t.substring(n+1),r},e.parseSsrcGroup=function(t){const n=t.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(r=>parseInt(r,10))}},e.getMid=function(t){const n=e.matchPrefix(t,"a=mid:")[0];if(n)return n.substring(6)},e.parseFingerprint=function(t){const n=t.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},e.getDtlsParameters=function(t,n){return{role:"auto",fingerprints:e.matchPrefix(t+n,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,n){let r="a=setup:"+n+`\r
`;return t.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(t){const n=t.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const n=t.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,n){return e.matchPrefix(t+n,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,n){const r=e.matchPrefix(t+n,"a=ice-ufrag:")[0],s=e.matchPrefix(t+n,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let n="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(n+=`a=ice-lite\r
`),n},e.parseRtpParameters=function(t){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(t)[0].split(" ");n.profile=s[2];for(let a=3;a<s.length;a++){const o=s[a],c=e.matchPrefix(t,"a=rtpmap:"+o+" ")[0];if(c){const f=e.parseRtpMap(c),u=e.matchPrefix(t,"a=fmtp:"+o+" ");switch(f.parameters=u.length?e.parseFmtp(u[0]):{},f.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+o+" ").map(e.parseRtcpFb),n.codecs.push(f),f.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(f.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(a=>{n.headerExtensions.push(e.parseExtmap(a))});const l=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return n.codecs.forEach(a=>{l.forEach(o=>{a.rtcpFeedback.find(f=>f.type===o.type&&f.parameter===o.parameter)||a.rtcpFeedback.push(o)})}),n},e.writeRtpDescription=function(t,n){let r="";r+="m="+t+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(l=>{r+=e.writeRtpMap(l),r+=e.writeFmtp(l),r+=e.writeRtcpFb(l)});let s=0;return n.codecs.forEach(l=>{l.maxptime>s&&(s=l.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(l=>{r+=e.writeExtmap(l)}),r},e.parseRtpEncodingParameters=function(t){const n=[],r=e.parseRtpParameters(t),s=r.fecMechanisms.indexOf("RED")!==-1,l=r.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(t,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname"),o=a.length>0&&a[0].ssrc;let c;const f=e.matchPrefix(t,"a=ssrc-group:FID").map(d=>d.substring(17).split(" ").map(m=>parseInt(m,10)));f.length>0&&f[0].length>1&&f[0][0]===o&&(c=f[0][1]),r.codecs.forEach(d=>{if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){let h={ssrc:o,codecPayloadType:parseInt(d.parameters.apt,10)};o&&c&&(h.rtx={ssrc:c}),n.push(h),s&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:o,mechanism:l?"red+ulpfec":"red"},n.push(h))}}),n.length===0&&o&&n.push({ssrc:o});let u=e.matchPrefix(t,"b=");return u.length&&(u[0].indexOf("b=TIAS:")===0?u=parseInt(u[0].substring(7),10):u[0].indexOf("b=AS:")===0?u=parseInt(u[0].substring(5),10)*1e3*.95-50*40*8:u=void 0,n.forEach(d=>{d.maxBitrate=u})),n},e.parseRtcpParameters=function(t){const n={},r=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=s.length>0,n.compound=s.length===0;const l=e.matchPrefix(t,"a=rtcp-mux");return n.mux=l.length>0,n},e.writeRtcpParameters=function(t){let n="";return t.reducedSize&&(n+=`a=rtcp-rsize\r
`),t.mux&&(n+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(n+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),n},e.parseMsid=function(t){let n;const r=e.matchPrefix(t,"a=msid:");if(r.length===1)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const s=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(s.length>0)return n=s[0].value.split(" "),{stream:n[0],track:n[1]}},e.parseSctpDescription=function(t){const n=e.parseMLine(t),r=e.matchPrefix(t,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const l=e.matchPrefix(t,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:n.fmt,maxMessageSize:s};const a=e.matchPrefix(t,"a=sctpmap:");if(a.length>0){const o=a[0].substring(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,n){let r=[];return t.protocol!=="DTLS/SCTP"?r=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:r=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&r.push("a=max-message-size:"+n.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,n,r){let s;const l=n!==void 0?n:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,n){const r=e.splitLines(t);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return n?e.getDirection(n):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const r=e.splitLines(t)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(t){const r=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const n=e.splitLines(t);for(let r=0;r<n.length;r++)if(n[r].length<2||n[r].charAt(1)!=="=")return!1;return!0},i.exports=e})(Ud);var jd=Ud.exports,Ur=Ly(jd),M_=My({__proto__:null,default:Ur},[jd]);function so(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const r=new e(n),s=Ur.parseCandidate(n.candidate);for(const l in s)l in r||Object.defineProperty(r,l,{value:s[l]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(n)},i.RTCIceCandidate.prototype=e.prototype,Cr(i,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new i.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Oc(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||Cr(i,"icecandidate",e=>{if(e.candidate){const t=Ur.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function oo(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(a){if(!a||!a.sdp)return!1;const o=Ur.splitSections(a.sdp);return o.shift(),o.some(c=>{const f=Ur.parseMLine(c);return f&&f.kind==="application"&&f.protocol.indexOf("SCTP")!==-1})},n=function(a){const o=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(o===null||o.length<2)return-1;const c=parseInt(o[1],10);return c!==c?-1:c},r=function(a){let o=65536;return e.browser==="firefox"&&(e.version<57?a===-1?o=16384:o=2147483637:e.version<60?o=e.version===57?65535:65536:o=2147483637),o},s=function(a,o){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const f=Ur.matchPrefix(a.sdp,"a=max-message-size:");return f.length>0?c=parseInt(f[0].substring(19),10):e.browser==="firefox"&&o!==-1&&(c=2147483637),c},l=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:o}=this.getConfiguration();o==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const o=n(arguments[0]),c=r(o),f=s(arguments[0],o);let u;c===0&&f===0?u=Number.POSITIVE_INFINITY:c===0||f===0?u=Math.max(c,f):u=Math.min(c,f);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return u}}),this._sctp=d}return l.apply(this,arguments)}}function ao(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(n,r){const s=n.send;n.send=function(){const a=arguments[0],o=a.length||a.size||a.byteLength;if(n.readyState==="open"&&r.sctp&&o>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(n,arguments)}}const t=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const r=t.apply(this,arguments);return e(r,this),r},Cr(i,"datachannel",n=>(e(n.channel,n.target),n))}function xc(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const l=new Event("connectionstatechange",r);s.dispatchEvent(l)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Ac(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(l=>l.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&r instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return t.apply(this,arguments)}}function co(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function lo(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return t.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?t.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>t.apply(this,[l]))})}var I_=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ac,shimAddIceCandidateNullOrEmpty:co,shimConnectionState:xc,shimMaxMessageSize:oo,shimParameterlessSetLocalDescription:lo,shimRTCIceCandidate:so,shimRTCIceCandidateRelayProtocol:Oc,shimSendThrowTypeError:ao});function L_(){let{window:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=ld,n=A_(i),r={browserDetails:n,commonShim:I_,extractVersion:ro,disableLog:O_,disableWarnings:x_,sdp:M_};switch(n.browser){case"chrome":if(!Eu||!Pc||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),r;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),r;t("adapter.js shimming chrome."),r.browserShim=Eu,co(i,n),lo(i),fd(i,n),hd(i),Pc(i,n),dd(i),bd(i,n),md(i),gd(i),pd(i),yd(i,n),so(i),Oc(i),xc(i),oo(i,n),ao(i),Ac(i,n);break;case"firefox":if(!Ou||!Ec||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),r;t("adapter.js shimming firefox."),r.browserShim=Ou,co(i,n),lo(i),_d(i,n),Ec(i,n),Cd(i),Td(i),Sd(i),kd(i),wd(i),Pd(i),Ed(i),Od(i),xd(i),so(i),xc(i),oo(i,n),ao(i);break;case"safari":if(!xu||!e.shimSafari)return t("Safari shim is not included in this adapter release."),r;t("adapter.js shimming safari."),r.browserShim=xu,co(i,n),lo(i),Ld(i),Fd(i),Rd(i),Ad(i),Dd(i),Nd(i),Md(i),Bd(i),so(i),Oc(i),oo(i,n),ao(i),Ac(i,n);break;default:t("Unsupported browser!");break}return r}L_({window:typeof window>"u"?void 0:window});var mi;(function(i){i[i.PUBLISHER=0]="PUBLISHER",i[i.SUBSCRIBER=1]="SUBSCRIBER"})(mi||(mi={}));R.util.setEnumType(mi,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var yr;(function(i){i[i.ACTIVE=0]="ACTIVE",i[i.PAUSED=1]="PAUSED"})(yr||(yr={}));R.util.setEnumType(yr,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var To;(function(i){i[i.UDP=0]="UDP",i[i.TCP=1]="TCP",i[i.TLS=2]="TLS"})(To||(To={}));R.util.setEnumType(To,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Pn extends Le{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,t){return new Pn().fromBinary(e,t)}static fromJson(e,t){return new Pn().fromJson(e,t)}static fromJsonString(e,t){return new Pn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Pn,e,t)}}Pn.runtime=R;Pn.typeName="livekit.SignalRequest";Pn.fields=R.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:li,oneof:"message"},{no:2,name:"answer",kind:"message",T:li,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Mi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ri,oneof:"message"},{no:5,name:"mute",kind:"message",T:Ii,oneof:"message"},{no:6,name:"subscription",kind:"message",T:wi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Zi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Pi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:$i,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:rn,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:sn,oneof:"message"},{no:13,name:"simulate",kind:"message",T:si,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:en,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:an,oneof:"message"}]);class Qi extends Le{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,t){return new Qi().fromBinary(e,t)}static fromJson(e,t){return new Qi().fromJson(e,t)}static fromJsonString(e,t){return new Qi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Qi,e,t)}}Qi.runtime=R;Qi.typeName="livekit.SignalResponse";Qi.fields=R.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:En,oneof:"message"},{no:2,name:"answer",kind:"message",T:li,oneof:"message"},{no:3,name:"offer",kind:"message",T:li,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Mi,oneof:"message"},{no:5,name:"update",kind:"message",T:An,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Li,oneof:"message"},{no:8,name:"leave",kind:"message",T:Pi,oneof:"message"},{no:9,name:"mute",kind:"message",T:Ii,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Dn,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Rn,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:In,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Nn,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Bn,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Un,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:xn,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:On,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:jn,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:zn,oneof:"message"}]);class Ti extends Le{constructor(e){super(),this.codec="",this.cid="",this.enableSimulcastLayers=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new Ti().fromBinary(e,t)}static fromJson(e,t){return new Ti().fromJson(e,t)}static fromJsonString(e,t){return new Ti().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ti,e,t)}}Ti.runtime=R;Ti.typeName="livekit.SimulcastCodec";Ti.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:3,name:"enable_simulcast_layers",kind:"scalar",T:8}]);class Ri extends Le{constructor(e){super(),this.cid="",this.name="",this.type=Zt.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Bt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=ai.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,t){return new Ri().fromBinary(e,t)}static fromJson(e,t){return new Ri().fromJson(e,t)}static fromJsonString(e,t){return new Ri().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ri,e,t)}}Ri.runtime=R;Ri.typeName="livekit.AddTrackRequest";Ri.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:R.getEnumType(Zt)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:R.getEnumType(Bt)},{no:9,name:"layers",kind:"message",T:ci,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Ti,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:R.getEnumType(ai)},{no:15,name:"stream",kind:"scalar",T:9}]);class Mi extends Le{constructor(e){super(),this.candidateInit="",this.target=mi.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,t){return new Mi().fromBinary(e,t)}static fromJson(e,t){return new Mi().fromJson(e,t)}static fromJsonString(e,t){return new Mi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Mi,e,t)}}Mi.runtime=R;Mi.typeName="livekit.TrickleRequest";Mi.fields=R.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:R.getEnumType(mi)}]);class Ii extends Le{constructor(e){super(),this.sid="",this.muted=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new Ii().fromBinary(e,t)}static fromJson(e,t){return new Ii().fromJson(e,t)}static fromJsonString(e,t){return new Ii().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ii,e,t)}}Ii.runtime=R;Ii.typeName="livekit.MuteTrackRequest";Ii.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class En extends Le{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),R.util.initPartial(e,this)}static fromBinary(e,t){return new En().fromBinary(e,t)}static fromJson(e,t){return new En().fromJson(e,t)}static fromJsonString(e,t){return new En().fromJsonString(e,t)}static equals(e,t){return R.util.equals(En,e,t)}}En.runtime=R;En.typeName="livekit.JoinResponse";En.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Jr},{no:2,name:"participant",kind:"message",T:yi},{no:3,name:"other_participants",kind:"message",T:yi,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:tn,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:qi},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:kn},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class On extends Le{constructor(e){super(),this.iceServers=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new On().fromBinary(e,t)}static fromJson(e,t){return new On().fromJson(e,t)}static fromJsonString(e,t){return new On().fromJsonString(e,t)}static equals(e,t){return R.util.equals(On,e,t)}}On.runtime=R;On.typeName="livekit.ReconnectResponse";On.fields=R.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:tn,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:qi}]);class Li extends Le{constructor(e){super(),this.cid="",R.util.initPartial(e,this)}static fromBinary(e,t){return new Li().fromBinary(e,t)}static fromJson(e,t){return new Li().fromJson(e,t)}static fromJsonString(e,t){return new Li().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Li,e,t)}}Li.runtime=R;Li.typeName="livekit.TrackPublishedResponse";Li.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:di}]);class xn extends Le{constructor(e){super(),this.trackSid="",R.util.initPartial(e,this)}static fromBinary(e,t){return new xn().fromBinary(e,t)}static fromJson(e,t){return new xn().fromJson(e,t)}static fromJsonString(e,t){return new xn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(xn,e,t)}}xn.runtime=R;xn.typeName="livekit.TrackUnpublishedResponse";xn.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class li extends Le{constructor(e){super(),this.type="",this.sdp="",R.util.initPartial(e,this)}static fromBinary(e,t){return new li().fromBinary(e,t)}static fromJson(e,t){return new li().fromJson(e,t)}static fromJsonString(e,t){return new li().fromJsonString(e,t)}static equals(e,t){return R.util.equals(li,e,t)}}li.runtime=R;li.typeName="livekit.SessionDescription";li.fields=R.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class An extends Le{constructor(e){super(),this.participants=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new An().fromBinary(e,t)}static fromJson(e,t){return new An().fromJson(e,t)}static fromJsonString(e,t){return new An().fromJsonString(e,t)}static equals(e,t){return R.util.equals(An,e,t)}}An.runtime=R;An.typeName="livekit.ParticipantUpdate";An.fields=R.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:yi,repeated:!0}]);class wi extends Le{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new wi().fromBinary(e,t)}static fromJson(e,t){return new wi().fromJson(e,t)}static fromJsonString(e,t){return new wi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(wi,e,t)}}wi.runtime=R;wi.typeName="livekit.UpdateSubscription";wi.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Ji,repeated:!0}]);class Zi extends Le{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=zt.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new Zi().fromBinary(e,t)}static fromJson(e,t){return new Zi().fromJson(e,t)}static fromJsonString(e,t){return new Zi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Zi,e,t)}}Zi.runtime=R;Zi.typeName="livekit.UpdateTrackSettings";Zi.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:R.getEnumType(zt)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class Pi extends Le{constructor(e){super(),this.canReconnect=!1,this.reason=Wn.UNKNOWN_REASON,R.util.initPartial(e,this)}static fromBinary(e,t){return new Pi().fromBinary(e,t)}static fromJson(e,t){return new Pi().fromJson(e,t)}static fromJsonString(e,t){return new Pi().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Pi,e,t)}}Pi.runtime=R;Pi.typeName="livekit.LeaveRequest";Pi.fields=R.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:R.getEnumType(Wn)}]);class $i extends Le{constructor(e){super(),this.trackSid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new $i().fromBinary(e,t)}static fromJson(e,t){return new $i().fromJson(e,t)}static fromJsonString(e,t){return new $i().fromJsonString(e,t)}static equals(e,t){return R.util.equals($i,e,t)}}$i.runtime=R;$i.typeName="livekit.UpdateVideoLayers";$i.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ci,repeated:!0}]);class en extends Le{constructor(e){super(),this.metadata="",this.name="",R.util.initPartial(e,this)}static fromBinary(e,t){return new en().fromBinary(e,t)}static fromJson(e,t){return new en().fromJson(e,t)}static fromJsonString(e,t){return new en().fromJsonString(e,t)}static equals(e,t){return R.util.equals(en,e,t)}}en.runtime=R;en.typeName="livekit.UpdateParticipantMetadata";en.fields=R.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class tn extends Le{constructor(e){super(),this.urls=[],this.username="",this.credential="",R.util.initPartial(e,this)}static fromBinary(e,t){return new tn().fromBinary(e,t)}static fromJson(e,t){return new tn().fromJson(e,t)}static fromJsonString(e,t){return new tn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(tn,e,t)}}tn.runtime=R;tn.typeName="livekit.ICEServer";tn.fields=R.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Dn extends Le{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Dn().fromBinary(e,t)}static fromJson(e,t){return new Dn().fromJson(e,t)}static fromJsonString(e,t){return new Dn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Dn,e,t)}}Dn.runtime=R;Dn.typeName="livekit.SpeakersChanged";Dn.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Yi,repeated:!0}]);class Rn extends Le{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,t){return new Rn().fromBinary(e,t)}static fromJson(e,t){return new Rn().fromJson(e,t)}static fromJsonString(e,t){return new Rn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Rn,e,t)}}Rn.runtime=R;Rn.typeName="livekit.RoomUpdate";Rn.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Jr}]);class Mn extends Le{constructor(e){super(),this.participantSid="",this.quality=rr.POOR,this.score=0,R.util.initPartial(e,this)}static fromBinary(e,t){return new Mn().fromBinary(e,t)}static fromJson(e,t){return new Mn().fromJson(e,t)}static fromJsonString(e,t){return new Mn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Mn,e,t)}}Mn.runtime=R;Mn.typeName="livekit.ConnectionQualityInfo";Mn.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:R.getEnumType(rr)},{no:3,name:"score",kind:"scalar",T:2}]);class In extends Le{constructor(e){super(),this.updates=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new In().fromBinary(e,t)}static fromJson(e,t){return new In().fromJson(e,t)}static fromJsonString(e,t){return new In().fromJsonString(e,t)}static equals(e,t){return R.util.equals(In,e,t)}}In.runtime=R;In.typeName="livekit.ConnectionQualityUpdate";In.fields=R.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Mn,repeated:!0}]);class Ln extends Le{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=yr.ACTIVE,R.util.initPartial(e,this)}static fromBinary(e,t){return new Ln().fromBinary(e,t)}static fromJson(e,t){return new Ln().fromJson(e,t)}static fromJsonString(e,t){return new Ln().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ln,e,t)}}Ln.runtime=R;Ln.typeName="livekit.StreamStateInfo";Ln.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(yr)}]);class Nn extends Le{constructor(e){super(),this.streamStates=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Nn().fromBinary(e,t)}static fromJson(e,t){return new Nn().fromJson(e,t)}static fromJsonString(e,t){return new Nn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Nn,e,t)}}Nn.runtime=R;Nn.typeName="livekit.StreamStateUpdate";Nn.fields=R.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Ln,repeated:!0}]);class Ni extends Le{constructor(e){super(),this.quality=zt.LOW,this.enabled=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new Ni().fromBinary(e,t)}static fromJson(e,t){return new Ni().fromJson(e,t)}static fromJsonString(e,t){return new Ni().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Ni,e,t)}}Ni.runtime=R;Ni.typeName="livekit.SubscribedQuality";Ni.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(zt)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Fn extends Le{constructor(e){super(),this.codec="",this.qualities=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Fn().fromBinary(e,t)}static fromJson(e,t){return new Fn().fromJson(e,t)}static fromJsonString(e,t){return new Fn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Fn,e,t)}}Fn.runtime=R;Fn.typeName="livekit.SubscribedCodec";Fn.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Ni,repeated:!0}]);class Bn extends Le{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new Bn().fromBinary(e,t)}static fromJson(e,t){return new Bn().fromJson(e,t)}static fromJsonString(e,t){return new Bn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Bn,e,t)}}Bn.runtime=R;Bn.typeName="livekit.SubscribedQualityUpdate";Bn.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Ni,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Fn,repeated:!0}]);class nn extends Le{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",R.util.initPartial(e,this)}static fromBinary(e,t){return new nn().fromBinary(e,t)}static fromJson(e,t){return new nn().fromJson(e,t)}static fromJsonString(e,t){return new nn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(nn,e,t)}}nn.runtime=R;nn.typeName="livekit.TrackPermission";nn.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class rn extends Le{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new rn().fromBinary(e,t)}static fromJson(e,t){return new rn().fromJson(e,t)}static fromJsonString(e,t){return new rn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(rn,e,t)}}rn.runtime=R;rn.typeName="livekit.SubscriptionPermission";rn.fields=R.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:nn,repeated:!0}]);class Un extends Le{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,R.util.initPartial(e,this)}static fromBinary(e,t){return new Un().fromBinary(e,t)}static fromJson(e,t){return new Un().fromJson(e,t)}static fromJsonString(e,t){return new Un().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Un,e,t)}}Un.runtime=R;Un.typeName="livekit.SubscriptionPermissionUpdate";Un.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class sn extends Le{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new sn().fromBinary(e,t)}static fromJson(e,t){return new sn().fromJson(e,t)}static fromJsonString(e,t){return new sn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(sn,e,t)}}sn.runtime=R;sn.typeName="livekit.SyncState";sn.fields=R.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:li},{no:2,name:"subscription",kind:"message",T:wi},{no:3,name:"publish_tracks",kind:"message",T:Li,repeated:!0},{no:4,name:"data_channels",kind:"message",T:on,repeated:!0},{no:5,name:"offer",kind:"message",T:li}]);class on extends Le{constructor(e){super(),this.label="",this.id=0,this.target=mi.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,t){return new on().fromBinary(e,t)}static fromJson(e,t){return new on().fromJson(e,t)}static fromJsonString(e,t){return new on().fromJsonString(e,t)}static equals(e,t){return R.util.equals(on,e,t)}}on.runtime=R;on.typeName="livekit.DataChannelInfo";on.fields=R.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:R.getEnumType(mi)}]);class si extends Le{constructor(e){super(),this.scenario={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,t){return new si().fromBinary(e,t)}static fromJson(e,t){return new si().fromJson(e,t)}static fromJsonString(e,t){return new si().fromJsonString(e,t)}static equals(e,t){return R.util.equals(si,e,t)}}si.runtime=R;si.typeName="livekit.SimulateScenario";si.fields=R.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:R.getEnumType(To),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]);class an extends Le{constructor(e){super(),this.timestamp=ot.zero,this.rtt=ot.zero,R.util.initPartial(e,this)}static fromBinary(e,t){return new an().fromBinary(e,t)}static fromJson(e,t){return new an().fromJson(e,t)}static fromJsonString(e,t){return new an().fromJsonString(e,t)}static equals(e,t){return R.util.equals(an,e,t)}}an.runtime=R;an.typeName="livekit.Ping";an.fields=R.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class jn extends Le{constructor(e){super(),this.lastPingTimestamp=ot.zero,this.timestamp=ot.zero,R.util.initPartial(e,this)}static fromBinary(e,t){return new jn().fromBinary(e,t)}static fromJson(e,t){return new jn().fromJson(e,t)}static fromJsonString(e,t){return new jn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(jn,e,t)}}jn.runtime=R;jn.typeName="livekit.Pong";jn.fields=R.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class ir extends Le{constructor(e){super(),this.regions=[],R.util.initPartial(e,this)}static fromBinary(e,t){return new ir().fromBinary(e,t)}static fromJson(e,t){return new ir().fromJson(e,t)}static fromJsonString(e,t){return new ir().fromJsonString(e,t)}static equals(e,t){return R.util.equals(ir,e,t)}}ir.runtime=R;ir.typeName="livekit.RegionSettings";ir.fields=R.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Vn,repeated:!0}]);class Vn extends Le{constructor(e){super(),this.region="",this.url="",this.distance=ot.zero,R.util.initPartial(e,this)}static fromBinary(e,t){return new Vn().fromBinary(e,t)}static fromJson(e,t){return new Vn().fromJson(e,t)}static fromJsonString(e,t){return new Vn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(Vn,e,t)}}Vn.runtime=R;Vn.typeName="livekit.RegionInfo";Vn.fields=R.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class zn extends Le{constructor(e){super(),this.trackSid="",this.err=As.SE_UNKNOWN,R.util.initPartial(e,this)}static fromBinary(e,t){return new zn().fromBinary(e,t)}static fromJson(e,t){return new zn().fromJson(e,t)}static fromJsonString(e,t){return new zn().fromJsonString(e,t)}static equals(e,t){return R.util.equals(zn,e,t)}}zn.runtime=R;zn.typeName="livekit.SubscriptionResponse";zn.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:R.getEnumType(As)}]);class qr extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class It extends qr{constructor(e,t,n){super(1,e),this.status=n,this.reason=t}}class sl extends qr{constructor(e){super(21,e??"device is unsupported")}}class Xi extends qr{constructor(e){super(20,e??"track is invalid")}}class N_ extends qr{constructor(e){super(10,e??"unsupported server")}}class Kt extends qr{constructor(e){super(12,e??"unexpected connection state")}}class Dc extends qr{constructor(e){super(13,e??"unable to negotiate")}}var wo;(function(i){i.PermissionDenied="PermissionDenied",i.NotFound="NotFound",i.DeviceInUse="DeviceInUse",i.Other="Other"})(wo||(wo={}));(function(i){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?i.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?i.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?i.DeviceInUse:i.Other}i.getFailure=e})(wo||(wo={}));class $t{}$t.setTimeout=function(){return setTimeout(...arguments)};$t.setInterval=function(){return setInterval(...arguments)};$t.clearTimeout=function(){return clearTimeout(...arguments)};$t.clearInterval=function(){return clearInterval(...arguments)};const F_=/version\/(\d+(\.?_?\d+)+)/i;let ja;function Kr(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof i>"u"&&typeof navigator>"u")return;const t=(i??navigator.userAgent).toLowerCase();if(ja===void 0||e){const n=B_.find(r=>{let{test:s}=r;return s.test(t)});ja=n==null?void 0:n.describe(t)}return ja}const B_=[{test:/firefox|iceweasel|fxios/i,describe(i){return{name:"Firefox",version:Va(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,i),os:i.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(i){return{name:"Chrome",version:Va(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,i),os:i.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(i){return{name:"Safari",version:Va(F_,i),os:i.includes("mobile/")?"iOS":"macOS"}}}];function Va(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=e.match(i);return n&&n.length>=t&&n[t]||""}var U_="1.13.4";const j_=U_,V_=9;class Et{constructor(e,t,n,r,s){this.width=e,this.height=t,this.encoding={maxBitrate:n,maxFramerate:r,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const z_=["vp8","h264"],Vd=["vp8","h264","vp9","av1"];function W_(i){return!!z_.find(e=>e===i)}function Au(i,e){return(i==null?void 0:i.toLowerCase().replace(/audio\/|video\//y,""))===(e==null?void 0:e.toLowerCase().replace(/audio\/|video\//y,""))}var Po;(function(i){i.telephone={maxBitrate:12e3},i.speech={maxBitrate:2e4},i.music={maxBitrate:32e3},i.musicStereo={maxBitrate:48e3},i.musicHighQuality={maxBitrate:64e3},i.musicHighQualityStereo={maxBitrate:96e3}})(Po||(Po={}));const Yr={h90:new Et(160,90,9e4,20),h180:new Et(320,180,16e4,20),h216:new Et(384,216,18e4,20),h360:new Et(640,360,45e4,20),h540:new Et(960,540,8e5,25),h720:new Et(1280,720,17e5,30),h1080:new Et(1920,1080,3e6,30),h1440:new Et(2560,1440,5e6,30),h2160:new Et(3840,2160,8e6,30)},Rc={h120:new Et(160,120,7e4,20),h180:new Et(240,180,125e3,20),h240:new Et(320,240,14e4,20),h360:new Et(480,360,33e4,20),h480:new Et(640,480,5e5,20),h540:new Et(720,540,6e5,25),h720:new Et(960,720,13e5,30),h1080:new Et(1440,1080,23e5,30),h1440:new Et(1920,1440,38e5,30)},ol={h360fps3:new Et(640,360,2e5,3,"medium"),h720fps5:new Et(1280,720,4e5,5,"medium"),h720fps15:new Et(1280,720,15e5,15,"medium"),h720fps30:new Et(1280,720,2e6,30,"medium"),h1080fps15:new Et(1920,1080,25e5,15,"medium"),h1080fps30:new Et(1920,1080,4e6,30,"medium")};var Ae;(function(i){i.Connected="connected",i.Reconnecting="reconnecting",i.Reconnected="reconnected",i.Disconnected="disconnected",i.ConnectionStateChanged="connectionStateChanged",i.StateChanged="connectionStateChanged",i.MediaDevicesChanged="mediaDevicesChanged",i.ParticipantConnected="participantConnected",i.ParticipantDisconnected="participantDisconnected",i.TrackPublished="trackPublished",i.TrackSubscribed="trackSubscribed",i.TrackSubscriptionFailed="trackSubscriptionFailed",i.TrackUnpublished="trackUnpublished",i.TrackUnsubscribed="trackUnsubscribed",i.TrackMuted="trackMuted",i.TrackUnmuted="trackUnmuted",i.LocalTrackPublished="localTrackPublished",i.LocalTrackUnpublished="localTrackUnpublished",i.LocalAudioSilenceDetected="localAudioSilenceDetected",i.ActiveSpeakersChanged="activeSpeakersChanged",i.ParticipantMetadataChanged="participantMetadataChanged",i.ParticipantNameChanged="participantNameChanged",i.RoomMetadataChanged="roomMetadataChanged",i.DataReceived="dataReceived",i.ConnectionQualityChanged="connectionQualityChanged",i.TrackStreamStateChanged="trackStreamStateChanged",i.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",i.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",i.AudioPlaybackStatusChanged="audioPlaybackChanged",i.MediaDevicesError="mediaDevicesError",i.ParticipantPermissionsChanged="participantPermissionsChanged",i.SignalConnected="signalConnected",i.RecordingStatusChanged="recordingStatusChanged",i.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",i.EncryptionError="encryptionError",i.DCBufferStatusChanged="dcBufferStatusChanged",i.ActiveDeviceChanged="activeDeviceChanged"})(Ae||(Ae={}));var Ne;(function(i){i.TrackPublished="trackPublished",i.TrackSubscribed="trackSubscribed",i.TrackSubscriptionFailed="trackSubscriptionFailed",i.TrackUnpublished="trackUnpublished",i.TrackUnsubscribed="trackUnsubscribed",i.TrackMuted="trackMuted",i.TrackUnmuted="trackUnmuted",i.LocalTrackPublished="localTrackPublished",i.LocalTrackUnpublished="localTrackUnpublished",i.ParticipantMetadataChanged="participantMetadataChanged",i.ParticipantNameChanged="participantNameChanged",i.DataReceived="dataReceived",i.IsSpeakingChanged="isSpeakingChanged",i.ConnectionQualityChanged="connectionQualityChanged",i.TrackStreamStateChanged="trackStreamStateChanged",i.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",i.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",i.MediaDevicesError="mediaDevicesError",i.ParticipantPermissionsChanged="participantPermissionsChanged",i.PCTrackAdded="pcTrackAdded"})(Ne||(Ne={}));var Ue;(function(i){i.TransportsCreated="transportsCreated",i.Connected="connected",i.Disconnected="disconnected",i.Resuming="resuming",i.Resumed="resumed",i.Restarting="restarting",i.Restarted="restarted",i.SignalResumed="signalResumed",i.SignalRestarted="signalRestarted",i.Closing="closing",i.MediaTrackAdded="mediaTrackAdded",i.ActiveSpeakersUpdate="activeSpeakersUpdate",i.DataPacketReceived="dataPacketReceived",i.RTPVideoMapUpdate="rtpVideoMapUpdate",i.DCBufferStatusChanged="dcBufferStatusChanged",i.ParticipantUpdate="participantUpdate",i.RoomUpdate="roomUpdate",i.SpeakersChanged="speakersChanged",i.StreamStateChanged="streamStateChanged",i.ConnectionQualityUpdate="connectionQualityUpdate",i.SubscriptionError="subscriptionError",i.SubscriptionPermissionUpdate="subscriptionPermissionUpdate"})(Ue||(Ue={}));var Me;(function(i){i.Message="message",i.Muted="muted",i.Unmuted="unmuted",i.Restarted="restarted",i.Ended="ended",i.Subscribed="subscribed",i.Unsubscribed="unsubscribed",i.UpdateSettings="updateSettings",i.UpdateSubscription="updateSubscription",i.AudioPlaybackStarted="audioPlaybackStarted",i.AudioPlaybackFailed="audioPlaybackFailed",i.AudioSilenceDetected="audioSilenceDetected",i.VisibilityChanged="visibilityChanged",i.VideoDimensionsChanged="videoDimensionsChanged",i.ElementAttached="elementAttached",i.ElementDetached="elementDetached",i.UpstreamPaused="upstreamPaused",i.UpstreamResumed="upstreamResumed",i.SubscriptionPermissionChanged="subscriptionPermissionChanged",i.SubscriptionStatusChanged="subscriptionStatusChanged",i.SubscriptionFailed="subscriptionFailed"})(Me||(Me={}));const X_=5e3,ns=[];class ke extends fn.EventEmitter{constructor(e,t){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=ke.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),X_):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=ke.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===ke.Kind.Video&&(t="video"),this.attachedElements.length===0&&ke.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(ns.forEach(r=>{r.parentElement===null&&!e&&(e=r)}),e&&ns.splice(ns.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),Dr(this.mediaStreamTrack,e);const n=e.srcObject.getTracks();return n.some(r=>r.kind==="audio")&&e.play().then(()=>{this.emit(Me.AudioPlaybackStarted)}).catch(r=>{r.name==="NotAllowedError"?this.emit(Me.AudioPlaybackFailed,r):G.warn("could not playback audio",r),e&&n.some(s=>s.kind==="video")&&r.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(Me.ElementAttached,e),e}detach(e){try{if(e){jr(this.mediaStreamTrack,e);const n=this.attachedElements.indexOf(e);return n>=0&&(this.attachedElements.splice(n,1),this.recycleElement(e),this.emit(Me.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(n=>{jr(this.mediaStreamTrack,n),t.push(n),this.recycleElement(n),this.emit(Me.ElementDetached,n)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),ns.forEach(n=>{n.parentElement||(t=!1)}),t&&ns.push(e)}}handleAppVisibilityChanged(){return re(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){gi()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){gi()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Dr(i,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let n;i.kind==="audio"?n=t.getAudioTracks():n=t.getVideoTracks(),n.includes(i)||(n.forEach(r=>{t.removeTrack(r)}),t.addTrack(i)),e.autoplay=!0,e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Vo()||Ds())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function jr(i,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(i),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(i){let e;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(e=i.Kind||(i.Kind={}));let t;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(t=i.Source||(i.Source={}));let n;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(n=i.StreamState||(i.StreamState={}));function r(c){switch(c){case e.Audio:return Zt.AUDIO;case e.Video:return Zt.VIDEO;default:return Zt.DATA}}i.kindToProto=r;function s(c){switch(c){case Zt.AUDIO:return e.Audio;case Zt.VIDEO:return e.Video;default:return e.Unknown}}i.kindFromProto=s;function l(c){switch(c){case t.Camera:return Bt.CAMERA;case t.Microphone:return Bt.MICROPHONE;case t.ScreenShare:return Bt.SCREEN_SHARE;case t.ScreenShareAudio:return Bt.SCREEN_SHARE_AUDIO;default:return Bt.UNKNOWN}}i.sourceToProto=l;function a(c){switch(c){case Bt.CAMERA:return t.Camera;case Bt.MICROPHONE:return t.Microphone;case Bt.SCREEN_SHARE:return t.ScreenShare;case Bt.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}i.sourceFromProto=a;function o(c){switch(c){case yr.ACTIVE:return n.Active;case yr.PAUSED:return n.Paused;default:return n.Unknown}}i.streamStateFromProto=o})(ke||(ke={}));function zd(i,e,t){const n=Object.assign({},i);return n.audio===!0&&(n.audio={}),n.video===!0&&(n.video={}),n.audio&&Mc(n.audio,e),n.video&&Mc(n.video,t),n}function Mc(i,e){return Object.keys(e).forEach(t=>{i[t]===void 0&&(i[t]=e[t])}),i}function jo(i){const e={};if(i.video)if(typeof i.video=="object"){const t={},n=t,r=i.video;Object.keys(r).forEach(s=>{switch(s){case"resolution":Mc(n,r.resolution);break;default:n[s]=r[s]}}),e.video=t}else e.video=i.video;else e.video=!1;return i.audio?typeof i.audio=="object"?e.audio=i.audio:e.audio=!0:e.audio=!1,e}function H_(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return re(this,void 0,void 0,function*(){const t=Wd();if(t){const n=t.createAnalyser();n.fftSize=2048;const r=n.frequencyBinCount,s=new Uint8Array(r);t.createMediaStreamSource(new MediaStream([i.mediaStreamTrack])).connect(n),yield gr(e),n.getByteTimeDomainData(s);const a=s.some(o=>o!==128&&o!==0);return t.close(),!a}return!1})}function Wd(){const i=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(i)return new i({latencyHint:"interactive"})}function Y_(i){return i===ke.Source.Microphone?"audioinput":i===ke.Source.Camera?"videoinput":void 0}function G_(i){var e,t;let n=(e=i.video)!==null&&e!==void 0?e:!0;return i.resolution&&(n=typeof n=="boolean"?{}:n,Vo()?n=Object.assign(Object.assign({},n),{width:{max:i.resolution.width},height:{max:i.resolution.height},frameRate:i.resolution.frameRate}):n=Object.assign(Object.assign({},n),{width:{ideal:i.resolution.width},height:{ideal:i.resolution.height},frameRate:i.resolution.frameRate})),{audio:(t=i.audio)!==null&&t!==void 0?t:!1,video:n,controller:i.controller,selfBrowserSurface:i.selfBrowserSurface,surfaceSwitching:i.surfaceSwitching,systemAudio:i.systemAudio}}const J_="|",Du="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function q_(i){const e=i.split(J_);return e.length>1?[e[0],i.substr(e[0].length+1)]:[i,""]}function gr(i){return re(this,void 0,void 0,function*(){return new Promise(e=>setTimeout(e,i))})}function Ru(){return"addTransceiver"in RTCPeerConnection.prototype}function Mu(){return"addTrack"in RTCPeerConnection.prototype}function K_(){if(!("getCapabilities"in RTCRtpSender))return!1;const i=RTCRtpSender.getCapabilities("video");let e=!1;if(i){for(const t of i.codecs)if(t.mimeType==="video/AV1"){e=!0;break}}return e}function Q_(){if(!("getCapabilities"in RTCRtpSender))return!1;const i=RTCRtpSender.getCapabilities("video");let e=!1;if(i){for(const t of i.codecs)if(t.mimeType==="video/VP9"){e=!0;break}}return e}function vs(i){return i==="av1"||i==="vp9"}function Ic(i){return document?(i||(i=document.createElement("audio")),"setSinkId"in i):!1}const Z_={Chrome:"100",Safari:"15",Firefox:"100"};function $_(i){if(!gi()||!("setCodecPreferences"in i))return!1;const e=Kr();if(!(e!=null&&e.name)||!e.version)return!1;const t=Z_[e.name];return t?Gd(e.version,t)>=0:!1}function Ds(){var i;return((i=Kr())===null||i===void 0?void 0:i.name)==="Firefox"}function e1(){var i;return((i=Kr())===null||i===void 0?void 0:i.name)==="Chrome"}function Vo(){var i;return((i=Kr())===null||i===void 0?void 0:i.name)==="Safari"}function Xd(){return gi()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function gi(){return typeof document<"u"}function _r(){return navigator.product=="ReactNative"}function Lc(i){return i.hostname.endsWith(".livekit.cloud")||i.hostname.endsWith(".livekit.run")}function Hd(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Yd(){if(!_r())return;let i=Hd();if(i)return i.platform}function Iu(){if(gi())return window.devicePixelRatio;if(_r()){let i=Hd();if(i)return i.devicePixelRatio}return 1}function Gd(i,e){const t=i.split("."),n=e.split("."),r=Math.min(t.length,n.length);for(let s=0;s<r;++s){const l=parseInt(t[s],10),a=parseInt(n[s],10);if(l>a)return 1;if(l<a)return-1;if(s===r-1&&l===a)return 0}return i===""&&e!==""?-1:e===""?1:t.length==n.length?0:t.length<n.length?-1:1}function t1(i){for(const e of i)e.target.handleResize(e)}function i1(i){for(const e of i)e.target.handleVisibilityChanged(e)}let za=null;const Lu=()=>(za||(za=new ResizeObserver(t1)),za);let Wa=null;const Nu=()=>(Wa||(Wa=new IntersectionObserver(i1,{root:null,rootMargin:"0px"})),Wa);function n1(){var i;const e=new Tn({sdk:Hr.JS,protocol:V_,version:j_});return _r()&&(e.os=(i=Yd())!==null&&i!==void 0?i:""),e}function Fu(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=document.createElement("canvas");r.width=i,r.height=e;const s=r.getContext("2d");s==null||s.fillRect(0,0,r.width,r.height),n&&s&&(s.beginPath(),s.arc(i/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const l=r.captureStream(),[a]=l.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=t,a}let rs;function Xa(){if(!rs){const i=new AudioContext,e=i.createOscillator(),t=i.createGain();t.gain.setValueAtTime(0,0);const n=i.createMediaStreamDestination();if(e.connect(t),t.connect(n),e.start(),[rs]=n.stream.getAudioTracks(),!rs)throw Error("Could not get empty media stream audio track");rs.enabled=!1}return rs.clone()}class Jd{constructor(e,t){this.onFinally=t,this.promise=new Promise((n,r)=>re(this,void 0,void 0,function*(){this.resolve=n,this.reject=r,e&&(yield e(n,r))})).finally(()=>{var n;return(n=this.onFinally)===null||n===void 0?void 0:n.call(this)})}}class Xn{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(r=>e=()=>{this._locks-=1,r()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}function r1(i){return Vd.includes(i)}function pr(i){if(typeof i=="string")return i;if(Array.isArray(i))return i[0];if(i.exact)return Array.isArray(i.exact)?i.exact[0]:i.exact;if(i.ideal)return Array.isArray(i.ideal)?i.ideal[0]:i.ideal;throw Error("could not unwrap constraint")}function s1(i){return i.startsWith("http")?i.replace(/^(http)/,"ws"):i}function Bu(i){return i.startsWith("ws")?i.replace(/^(ws)/,"http"):i}var bs;(function(i){i[i.WAITING=0]="WAITING",i[i.RUNNING=1]="RUNNING",i[i.COMPLETED=2]="COMPLETED"})(bs||(bs={}));class o1{constructor(){this.pendingTasks=new Map,this.taskMutex=new Xn,this.nextTaskIndex=0}run(e){return re(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:bs.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=bs.RUNNING,yield e()}finally{t.status=bs.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return re(this,void 0,void 0,function*(){return this.run(()=>re(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const a1=["syncState","trickle","offer","answer","simulate","leave"];function c1(i){const e=a1.indexOf(i.case)>=0;return G.trace("request allowed to bypass queue:",{canPass:e,req:i}),e}class al{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.isConnected=!1,this.isReconnecting=!1,this.useJSON=e,this.requestQueue=new o1,this.queuedRequests=[],this.closingLock=new Xn}join(e,t,n,r){return re(this,void 0,void 0,function*(){return this.isConnected=!1,this.options=n,yield this.connect(e,t,n,r)})}reconnect(e,t,n,r){return re(this,void 0,void 0,function*(){if(!this.options){G.warn("attempted to reconnect without signal options being set, ignoring");return}return this.isReconnecting=!0,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:r}))})}connect(e,t,n,r){this.connectOptions=n,e=s1(e),e=e.replace(/\/$/,""),e+="/rtc";const s=n1(),l=l1(t,s,n);return new Promise((a,o)=>re(this,void 0,void 0,function*(){const c=()=>re(this,void 0,void 0,function*(){this.close(),clearTimeout(f),o(new It("room connection has been cancelled (signal)"))}),f=setTimeout(()=>{this.close(),o(new It("room connection has timed out (signal)"))},n.websocketTimeout);r!=null&&r.aborted&&c(),r==null||r.addEventListener("abort",c),G.debug("connecting to ".concat(e+l)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+l),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(f)},this.ws.onerror=u=>re(this,void 0,void 0,function*(){if(!this.isConnected){clearTimeout(f);try{const d=yield fetch("http".concat(e.substring(2),"/validate").concat(l));if(d.status.toFixed(0).startsWith("4")){const h=yield d.text();o(new It(h,0,d.status))}else o(new It("Internal error",2,d.status))}catch{o(new It("server was not reachable",1))}return}this.handleWSError(u)}),this.ws.onmessage=u=>re(this,void 0,void 0,function*(){var d,h,m,p;let g;if(typeof u.data=="string"){const v=JSON.parse(u.data);g=Qi.fromJson(v)}else if(u.data instanceof ArrayBuffer)g=Qi.fromBinary(new Uint8Array(u.data));else{G.error("could not decode websocket message: ".concat(typeof u.data));return}if(!this.isConnected){let v=!1;if(((d=g.message)===null||d===void 0?void 0:d.case)==="join"?(this.isConnected=!0,r==null||r.removeEventListener("abort",c),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(G.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),a(g.message.value)):n.reconnect?(this.isConnected=!0,r==null||r.removeEventListener("abort",c),this.startPingInterval(),((h=g.message)===null||h===void 0?void 0:h.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),v=!0)):n.reconnect||o(new It("did not receive join response, got ".concat((p=g.message)===null||p===void 0?void 0:p.case," instead"))),!v)return}this.signalLatency&&(yield gr(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=u=>{G.warn("websocket closed",{ev:u}),this.handleOnClose(u.reason)}}))}close(){return re(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();try{if(this.isConnected=!1,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const t=new Promise(n=>{this.ws?this.ws.onclose=()=>{n()}:n()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([t,gr(250)])),this.ws=void 0}}finally{this.clearPingInterval(),e()}})}sendOffer(e){G.debug("sending offer",e),this.sendRequest({case:"offer",value:Eo(e)})}sendAnswer(e){return G.debug("sending answer"),this.sendRequest({case:"answer",value:Eo(e)})}sendIceCandidate(e,t){return G.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new Mi({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Ii({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new en({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new $i({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new rn({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:ot.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new an({timestamp:ot.parse(Date.now()),rtt:ot.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Pi({canReconnect:!1,reason:Wn.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return re(this,void 0,void 0,function*(){if(!t&&!c1(e)&&this.isReconnecting){this.queuedRequests.push(()=>re(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield gr(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){G.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case));return}const r=new Pn({message:e});try{this.useJSON?this.ws.send(r.toJsonString()):this.ws.send(r.toBinary())}catch(s){G.error("error sending signal message",{error:s})}})}handleSignalResponse(e){var t,n;const r=e.message;if(r==null){G.debug("received unsupported message");return}if(r.case==="answer"){const s=Uu(r.value);this.onAnswer&&this.onAnswer(s)}else if(r.case==="offer"){const s=Uu(r.value);this.onOffer&&this.onOffer(s)}else if(r.case==="trickle"){const s=JSON.parse(r.value.candidateInit);this.onTrickle&&this.onTrickle(s,r.value.target)}else r.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=r.value.participants)!==null&&t!==void 0?t:[]):r.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.value):r.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((n=r.value.speakers)!==null&&n!==void 0?n:[]):r.case==="leave"?this.onLeave&&this.onLeave(r.value):r.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.value.sid,r.value.muted):r.case==="roomUpdate"?this.onRoomUpdate&&r.value.room&&this.onRoomUpdate(r.value.room):r.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(r.value):r.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.value):r.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.value):r.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.value):r.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(r.value):r.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.value):r.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(r.value):r.case==="pong"?this.resetPingTimeout():r.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(r.value.lastPingTimestamp.toString()),this.resetPingTimeout()):G.debug("unsupported message",r)}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}this.isReconnecting=!1}handleOnClose(e){return re(this,void 0,void 0,function*(){if(!this.isConnected)return;const t=this.onClose;yield this.close(),G.debug("websocket connection closed: ".concat(e)),t&&t(e)})}handleWSError(e){G.error("websocket error",e)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){G.warn("ping timeout duration not set");return}this.pingTimeout=$t.setTimeout(()=>{G.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&$t.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){G.warn("ping interval duration not set");return}G.debug("start ping interval"),this.pingInterval=$t.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){G.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&$t.clearInterval(this.pingInterval)}}function Uu(i){const e={type:"offer",sdp:i.sdp};switch(i.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=i.type;break}return e}function Eo(i){return new li({sdp:i.sdp,type:i.type})}function l1(i,e,t){var n;const r=new URLSearchParams;return r.set("access_token",i),t.reconnect&&(r.set("reconnect","1"),t.sid&&r.set("sid",t.sid)),r.set("auto_subscribe",t.autoSubscribe?"1":"0"),r.set("sdk",_r()?"reactnative":"js"),r.set("version",e.version),r.set("protocol",e.protocol.toString()),e.deviceModel&&r.set("device_model",e.deviceModel),e.os&&r.set("os",e.os),e.osVersion&&r.set("os_version",e.osVersion),e.browser&&r.set("browser",e.browser),e.browserVersion&&r.set("browser_version",e.browserVersion),t.publishOnly!==void 0&&r.set("publish",t.publishOnly),t.adaptiveStream&&r.set("adaptive_stream","1"),t.reconnectReason&&r.set("reconnect_reason",t.reconnectReason.toString()),!((n=navigator.connection)===null||n===void 0)&&n.type&&r.set("network",navigator.connection.type),"?".concat(r.toString())}const u1=10,Hs="lk_e2ee",f1="LKFrameEncryptionKey",h1={sharedKey:!1,ratchetSalt:f1,ratchetWindowSize:8,failureTolerance:u1};var sr;(function(i){i.SetKey="setKey",i.RatchetRequest="ratchetRequest",i.KeyRatcheted="keyRatcheted"})(sr||(sr={}));var ju;(function(i){i.KeyRatcheted="keyRatcheted"})(ju||(ju={}));var nr;(function(i){i.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",i.EncryptionError="encryptionError"})(nr||(nr={}));var Vu;(function(i){i.Error="cryptorError"})(Vu||(Vu={}));function d1(){return m1()||Nc()}function Nc(){return typeof window.RTCRtpScriptTransform<"u"}function m1(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function g1(i){const e=i.split("/")[1].toLowerCase();if(!Vd.includes(e))throw Error("Video codec not supported: ".concat(e));return e}class jT extends fn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,n)=>{G.debug("key ratcheted event received",{material:t,keyIndex:n})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},h1),e),this.on(sr.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,n){const r={key:e,participantIdentity:t,keyIndex:n};this.keyInfoMap.set("".concat(t??"shared","-").concat(n??0),r),this.emit(sr.SetKey,r)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(sr.RatchetRequest,e,t)}}function cl(i,e,t){var n,r,s;e===void 0&&(e=50),t===void 0&&(t={});var l=(n=t.isImmediate)!=null&&n,a=(r=t.callback)!=null&&r,o=t.maxWait,c=Date.now(),f=[];function u(){if(o!==void 0){var h=Date.now()-c;if(h+e>=o)return o-h}return e}var d=function(){var h=[].slice.call(arguments),m=this;return new Promise(function(p,g){var v=l&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,c=Date.now(),!l){var y=i.apply(m,h);a&&a(y),f.forEach(function(_){return(0,_.resolve)(y)}),f=[]}},u()),v){var b=i.apply(m,h);return a&&a(b),p(b)}f.push({resolve:p,reject:g})})};return d.cancel=function(h){s!==void 0&&clearTimeout(s),f.forEach(function(m){return(0,m.reject)(h)}),f=[]},d}const zu="default";class oi{static getInstance(){return this.instance===void 0&&(this.instance=new oi),this.instance}getDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var n;return re(this,void 0,void 0,function*(){if(((n=oi.userMediaPromiseMap)===null||n===void 0?void 0:n.size)>0){G.debug("awaiting getUserMedia promise");try{e?yield oi.userMediaPromiseMap.get(e):yield Promise.all(oi.userMediaPromiseMap.values())}catch{G.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(t&&!(Vo()&&this.hasDeviceInUse(e))&&(r.length===0||r.some(l=>{const a=l.label==="",o=e?l.kind===e:!0;return a&&o}))){const l={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(l);r=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(o=>{o.stop()})}return e&&(r=r.filter(s=>s.kind===e)),r})}normalizeDeviceId(e,t,n){return re(this,void 0,void 0,function*(){if(t!==zu)return t;const s=(yield this.getDevices(e)).find(l=>l.groupId===n&&l.deviceId!==zu);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?oi.userMediaPromiseMap.has(e):oi.userMediaPromiseMap.size>0}}oi.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];oi.userMediaPromiseMap=new Map;const p1=1e3;class Rs extends ke{get constraints(){return this._constraints}constructor(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(e,t),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>G.debug("track mute bounce got cancelled by an unmute event")),this.debouncedTrackMuteHandler=cl(()=>re(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>re(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(Me.Ended,this)},this.reacquireTrack=!1,this.providedByUser=r,this.muteLock=new Xn,this.pauseUpstreamLock=new Xn,this.processorLock=new Xn,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==ke.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return re(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(r=>{jr(this._mediaStreamTrack,r)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let n;if(this.processor&&e&&this.processorElement){if(G.debug("restarting processor"),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Dr(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),n=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(n??e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(r=>{Dr(n??e,r)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p1;return re(this,void 0,void 0,function*(){if(this.kind===ke.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");const t=Date.now();for(;Date.now()-t<e;){const n=this.dimensions;if(n)return n;yield gr(50)}throw new Xi("unable to get track dimensions after timeout")})}getDeviceId(){return re(this,void 0,void 0,function*(){if(this.source===ke.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),n=this.kind===ke.Kind.Audio?"audioinput":"videoinput";return oi.getInstance().normalizeDeviceId(n,e,t)})}mute(){return re(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return re(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return re(this,void 0,void 0,function*(){if(!this.sender)throw new Xi("unable to replace an unpublished track");return G.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this})}restart(e){return re(this,void 0,void 0,function*(){e||(e=this._constraints),G.debug("restarting track with constraints",e);const t={audio:!1,video:!1};this.kind===ke.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach(s=>{jr(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const r=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return r.addEventListener("ended",this.handleEnded),G.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(r),this._constraints=e,this.emit(Me.Restarted,this),this})}setTrackMuted(e){G.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Me.Muted:Me.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return re(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Xd()&&(G.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(G.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return re(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){G.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(Me.UpstreamPaused,this);const t=Kr();if((t==null?void 0:t.name)==="Safari"&&Gd(t.version,"12.0")<0)throw new sl("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return re(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){G.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(Me.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return re(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var n,r;return re(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(G.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(n=this.processorElement)!==null&&n!==void 0?n:document.createElement(this.kind),this.processorElement.muted=!0,Dr(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch(a=>G.error("failed to play processor element",{error:a}));const l={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(l),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&t&&(jr(this._mediaStreamTrack,a),Dr(this.processor.processedTrack,a));yield(r=this.sender)===null||r===void 0?void 0:r.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,t;return re(this,void 0,void 0,function*(){this.processor&&(G.debug("stopping processor"),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(t=this.processorElement)===null||t===void 0||t.remove(),this.processorElement=void 0,yield this.restart())})}}class v1 extends fn.EventEmitter{constructor(e){super(),this.onWorkerMessage=t=>{var n,r;const{kind:s,data:l}=t.data;switch(s){case"error":G.error(l.error.message),this.emit(nr.EncryptionError,l.error);break;case"initAck":l.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==l.enabled&&l.participantIdentity===((n=this.room)===null||n===void 0?void 0:n.localParticipant.identity))this.emit(nr.ParticipantEncryptionStatusChanged,l.enabled,this.room.localParticipant),this.encryptionEnabled=l.enabled;else if(l.participantIdentity){const a=(r=this.room)===null||r===void 0?void 0:r.getParticipantByIdentity(l.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(l.participantIdentity));this.emit(nr.ParticipantEncryptionStatusChanged,l.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(sr.KeyRatcheted,l.material,l.keyIndex);break}},this.onWorkerError=t=>{G.error("e2ee worker encountered an error:",{error:t.error}),this.emit(nr.EncryptionError,t.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!d1())throw new sl("tried to setup end-to-end encryption on an unsupported browser");if(G.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(G.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){G.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?G.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Ue.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Ae.TrackPublished,(n,r)=>this.setParticipantCryptorEnabled(n.trackInfo.encryption!==ai.NONE,r.identity)),e.on(Ae.ConnectionStateChanged,n=>{n===kt.Connected&&e.participants.forEach(r=>{r.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==ai.NONE,r.identity)})})}).on(Ae.TrackUnsubscribed,(n,r,s)=>{var l;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:n.mediaStreamID}};(l=this.worker)===null||l===void 0||l.postMessage(a)}).on(Ae.TrackSubscribed,(n,r,s)=>{this.setupE2EEReceiver(n,s.identity,r.trackInfo)}).on(Ae.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach(n=>{this.postKey(n)})}),e.localParticipant.on(Ne.LocalTrackPublished,n=>re(this,void 0,void 0,function*(){this.setupE2EESender(n.track,n.track.sender)})),t.on(sr.SetKey,n=>this.postKey(n)).on(sr.RatchetRequest,(n,r)=>this.postRatchetRequest(n,r))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:r}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const l={kind:"setKey",data:{participantIdentity:n,isPublisher:n===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:t,keyIndex:r}};this.worker.postMessage(l)}postEnable(e,t){if(this.worker){const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(n!=null&&n.mimeType)||n.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?g1(n.mimeType):void 0)}}setupE2EESender(e,t){if(!(e instanceof Rs)||!t){t||G.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,n,r){return re(this,void 0,void 0,function*(){if(this.worker){if(Nc()){const s={kind:"decode",participantIdentity:n,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Hs in e&&r){const o={kind:"updateCodec",data:{trackId:t,codec:r,participantIdentity:n}};this.worker.postMessage(o);return}let s=e.writableStream,l=e.readableStream;if(!s||!l){const o=e.createEncodedStreams();e.writableStream=o.writable,s=o.writable,e.readableStream=o.readable,l=o.readable}const a={kind:"decode",data:{readableStream:l,writableStream:s,trackId:t,codec:r,participantIdentity:n}};this.worker.postMessage(a,[l,s])}e[Hs]=!0}})}handleSender(e,t,n){var r;if(!(Hs in e||!this.worker)){if(!(!((r=this.room)===null||r===void 0)&&r.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Nc()){G.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{G.info("initialize encoded streams");const s=e.createEncodedStreams(),l={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(l,[s.readable,s.writable])}e[Hs]=!0}}}var qd={},Kd={exports:{}},Wu=Kd.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(i){return i.encoding?"rtpmap:%d %s/%s/%s":i.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(i){return i.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(i){return i.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(i){return"extmap:%d"+(i.direction?"/%s":"%v")+(i["encrypt-uri"]?" %s":"%v")+" %s"+(i.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(i){return i.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(i){var e="candidate:%s %d %s %d %s %d typ %s";return e+=i.raddr!=null?" raddr %s rport %d":"%v%v",e+=i.tcptype!=null?" tcptype %s":"%v",i.generation!=null&&(e+=" generation %d"),e+=i["network-id"]!=null?" network-id %d":"%v",e+=i["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(i){var e="ssrc:%d";return i.attribute!=null&&(e+=" %s",i.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(i){return i.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(i){return i.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(i){return"imageattr:%s %s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(i){return"simulcast:%s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(i){return"ts-refclk:%s"+(i.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(i){var e="mediaclk:";return e+=i.id!=null?"id=%s %s":"%v%s",e+=i.mediaClockValue!=null?"=%s":"",e+=i.rateNumerator!=null?" rate=%s":"",e+=i.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Wu).forEach(function(i){var e=Wu[i];e.forEach(function(t){t.reg||(t.reg=/(.*)/),t.format||(t.format="%s")})});var Qd=Kd.exports;(function(i){var e=function(a){return String(Number(a))===a?Number(a):a},t=function(a,o,c,f){if(f&&!c)o[f]=e(a[1]);else for(var u=0;u<c.length;u+=1)a[u+1]!=null&&(o[c[u]]=e(a[u+1]))},n=function(a,o,c){var f=a.name&&a.names;a.push&&!o[a.push]?o[a.push]=[]:f&&!o[a.name]&&(o[a.name]={});var u=a.push?{}:f?o[a.name]:o;t(c.match(a.reg),u,a.names,a.name),a.push&&o[a.push].push(u)},r=Qd,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);i.parse=function(a){var o={},c=[],f=o;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(u){var d=u[0],h=u.slice(2);d==="m"&&(c.push({rtp:[],fmtp:[]}),f=c[c.length-1]);for(var m=0;m<(r[d]||[]).length;m+=1){var p=r[d][m];if(p.reg.test(h))return n(p,f,h)}}),o.media=c,o};var l=function(a,o){var c=o.split(/=(.+)/,2);return c.length===2?a[c[0]]=e(c[1]):c.length===1&&o.length>1&&(a[c[0]]=void 0),a};i.parseParams=function(a){return a.split(/;\s?/).reduce(l,{})},i.parseFmtpConfig=i.parseParams,i.parsePayloads=function(a){return a.toString().split(" ").map(Number)},i.parseRemoteCandidates=function(a){for(var o=[],c=a.split(" ").map(e),f=0;f<c.length;f+=3)o.push({component:c[f],ip:c[f+1],port:c[f+2]});return o},i.parseImageAttributes=function(a){return a.split(" ").map(function(o){return o.substring(1,o.length-1).split(",").reduce(l,{})})},i.parseSimulcastStreamList=function(a){return a.split(";").map(function(o){return o.split(",").map(function(c){var f,u=!1;return c[0]!=="~"?f=e(c):(f=e(c.substring(1,c.length)),u=!0),{scid:f,paused:u}})})}})(qd);var Ha=Qd,b1=/%[sdv%]/g,y1=function(i){var e=1,t=arguments,n=t.length;return i.replace(b1,function(r){if(e>=n)return r;var s=t[e];switch(e+=1,r){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},ss=function(i,e,t){var n=e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format,r=[i+"="+n];if(e.names)for(var s=0;s<e.names.length;s+=1){var l=e.names[s];e.name?r.push(t[e.name][l]):r.push(t[e.names[s]])}else r.push(t[e.name]);return y1.apply(null,r)},_1=["v","o","s","i","u","e","p","c","b","t","r","z","a"],C1=["i","c","b","a"],S1=function(i,e){e=e||{},i.version==null&&(i.version=0),i.name==null&&(i.name=" "),i.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var t=e.outerOrder||_1,n=e.innerOrder||C1,r=[];return t.forEach(function(s){Ha[s].forEach(function(l){l.name in i&&i[l.name]!=null?r.push(ss(s,l,i)):l.push in i&&i[l.push]!=null&&i[l.push].forEach(function(a){r.push(ss(s,l,a))})})}),i.media.forEach(function(s){r.push(ss("m",Ha.m[0],s)),n.forEach(function(l){Ha[l].forEach(function(a){a.name in s&&s[a.name]!=null?r.push(ss(l,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(o){r.push(ss(l,a,o))})})})}),r.join(`\r
`)+`\r
`},k1=qd,T1=S1,Ya=T1,ls=k1.parse;const Xu=.7,Vr={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class Hu extends fn.EventEmitter{get pc(){if(this._pc)return this._pc;throw new Kt("Expected peer connection to be available")}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=cl(n=>{this.emit(Vr.NegotiationStarted);try{this.createAndSendOffer()}catch(r){if(n)n(r);else throw r}},100),this._pc=e1()?new RTCPeerConnection(e,t):new RTCPeerConnection(e)}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return re(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var t;return re(this,void 0,void 0,function*(){let n;if(e.type==="offer"){let{stereoMids:r,nackMids:s}=P1(e);this.remoteStereoMids=r,this.remoteNackMids=s}else if(e.type==="answer"){const r=ls((t=e.sdp)!==null&&t!==void 0?t:"");r.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(l=>{if(!l.transceiver||s.mid!=l.transceiver.mid)return!1;let a=0;if(s.rtp.some(c=>c.codec.toUpperCase()===l.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let o=!1;for(const c of s.fmtp)if(c.payload===a){c.config=c.config.split(";").filter(f=>!f.includes("maxaveragebitrate")).join(";"),l.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(l.maxbr*1e3)),o=!0;break}return o||l.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(l.maxbr*1e3)}),!0})}),n=Ya(r)}yield this.setMungedSDP(e,n,!0),this.pendingCandidates.forEach(r=>{this.pc.addIceCandidate(r)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,this.createAndSendOffer()):e.type==="answer"&&(this.emit(Vr.NegotiationComplete),e.sdp&&ls(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(Vr.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var t;return re(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(G.debug("restarting ICE"),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this.pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this.pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){G.warn("could not createOffer with closed peer connection");return}G.debug("starting to negotiate");const n=yield this.pc.createOffer(e),r=ls((t=n.sdp)!==null&&t!==void 0?t:"");r.media.forEach(s=>{s.type==="audio"?Yu(s,[],[]):s.type==="video"&&(w1(s),this.trackBitrates.some(l=>{if(!s.msid||!l.cid||!s.msid.includes(l.cid))return!1;let a=0;if(s.rtp.some(c=>c.codec.toUpperCase()===l.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let o=!1;for(const c of s.fmtp)if(c.payload===a){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(l.maxbr*Xu)),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(l.maxbr)),o=!0;break}return o||s.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(l.maxbr*Xu,";x-google-max-bitrate=").concat(l.maxbr)}),!0}))}),yield this.setMungedSDP(n,Ya(r)),this.onOffer(n)})}createAndSetAnswer(){var e;return re(this,void 0,void 0,function*(){const t=yield this.pc.createAnswer(),n=ls((e=t.sdp)!==null&&e!==void 0?e:"");return n.media.forEach(r=>{r.type==="audio"&&Yu(r,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Ya(n)),t})}setTrackCodecBitrate(e){this.trackBitrates.push(e)}close(){this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)}setMungedSDP(e,t,n){return re(this,void 0,void 0,function*(){if(t){const r=e.sdp;e.sdp=t;try{G.debug("setting munged ".concat(n?"remote":"local"," description")),n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){G.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:s,sdp:t}),e.sdp=r}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(r){let s="unknown error";r instanceof Error?s=r.message:typeof r=="string"&&(s=r);const l={error:s,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(l.remoteSdp=this.pc.remoteDescription),G.error("unable to set ".concat(e.type),l),new Dc(s)}})}}function Yu(i,e,t){let n=0;i.rtp.some(r=>r.codec==="opus"?(n=r.payload,!0):!1),n>0&&(i.rtcpFb||(i.rtcpFb=[]),t.includes(i.mid)&&!i.rtcpFb.some(r=>r.payload===n&&r.type==="nack")&&i.rtcpFb.push({payload:n,type:"nack"}),e.includes(i.mid)&&i.fmtp.some(r=>r.payload===n?(r.config.includes("stereo=1")||(r.config+=";stereo=1"),!0):!1))}function w1(i){var e,t,n,r;const s=(t=(e=i.rtp[0])===null||e===void 0?void 0:e.codec)===null||t===void 0?void 0:t.toLowerCase();if(!vs(s))return;let l=0;((n=i.ext)===null||n===void 0?void 0:n.some(o=>o.uri===Du?!0:(o.value>l&&(l=o.value),!1)))||(r=i.ext)===null||r===void 0||r.push({value:l+1,uri:Du})}function P1(i){var e;const t=[],n=[],r=ls((e=i.sdp)!==null&&e!==void 0?e:"");let s=0;return r.media.forEach(l=>{var a;l.type==="audio"&&(l.rtp.some(o=>o.codec==="opus"?(s=o.payload,!0):!1),!((a=l.rtcpFb)===null||a===void 0)&&a.some(o=>o.payload===s&&o.type==="nack")&&n.push(l.mid),l.fmtp.some(o=>o.payload===s?(o.config.includes("sprop-stereo=1")&&t.push(l.mid),!0):!1))}),{stereoMids:t,nackMids:n}}const E1={audioBitrate:Po.music.maxBitrate,audioPreset:Po.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ol.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:!1},Zd={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},$d={resolution:Yr.h720.resolution},O1={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new C_,disconnectOnPageLeave:!0,expWebAudioMix:!1},em={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3},Gu="_lossy",Ju="_reliable",x1=2*1e3,qu="leave-reconnect";var pi;(function(i){i[i.New=0]="New",i[i.Connected=1]="Connected",i[i.Disconnected=2]="Disconnected",i[i.Reconnecting=3]="Reconnecting",i[i.Closed=4]="Closed"})(pi||(pi={}));class A1 extends fn.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=em.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=pi.New,this._isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=t=>{let{channel:n}=t;return re(this,void 0,void 0,function*(){if(n){if(n.label===Ju)this.reliableDCSub=n;else if(n.label===Gu)this.lossyDCSub=n;else return;G.debug("on data channel ".concat(n.id,", ").concat(n.label)),n.onmessage=this.handleDataMessage}})},this.handleDataMessage=t=>re(this,void 0,void 0,function*(){var n,r;const s=yield this.dataProcessLock.lock();try{let l;if(t.data instanceof ArrayBuffer)l=t.data;else if(t.data instanceof Blob)l=yield t.data.arrayBuffer();else{G.error("unsupported data type",t.data);return}const a=Hi.fromBinary(new Uint8Array(l));((n=a.value)===null||n===void 0?void 0:n.case)==="speaker"?this.emit(Ue.ActiveSpeakersUpdate,a.value.value.speakers):((r=a.value)===null||r===void 0?void 0:r.case)==="user"&&this.emit(Ue.DataPacketReceived,a.value.value,a.kind)}finally{s()}}),this.handleDataError=t=>{const r=t.currentTarget.maxRetransmits===0?"lossy":"reliable";if(t instanceof ErrorEvent&&t.error){const{error:s}=t.error;G.error("DataChannel error on ".concat(r,": ").concat(t.message),s)}else G.error("Unknown DataChannel error on ".concat(r),t)},this.handleBufferedAmountLow=t=>{const r=t.currentTarget.maxRetransmits===0?Yt.LOSSY:Yt.RELIABLE;this.updateAndEmitDCBufferStatus(r)},this.handleDisconnect=(t,n)=>{if(this._isClosed)return;G.warn("".concat(t," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const r=a=>{G.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(a,"ms. giving up")),this.emit(Ue.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let l=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(l===null){r(s);return}t===qu&&(l=0),G.debug("reconnecting in ".concat(l,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=$t.setTimeout(()=>this.attemptReconnect(n),l)},this.waitForRestarted=()=>new Promise((t,n)=>{this.pcState===pi.Connected&&t();const r=()=>{this.off(Ue.Disconnected,s),t()},s=()=>{this.off(Ue.Restarted,r),n()};this.once(Ue.Restarted,r),this.once(Ue.Disconnected,s)}),this.updateAndEmitDCBufferStatus=t=>{const n=this.isBufferStatusLow(t);typeof n<"u"&&n!==this.dcBufferStatus.get(t)&&(this.dcBufferStatus.set(t,n),this.emit(Ue.DCBufferStatusChanged,n,t))},this.isBufferStatusLow=t=>{const n=this.dataChannelForKind(t);if(n)return n.bufferedAmount<=n.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.isReconnecting&&(this.clearReconnectTimeout(),this.attemptReconnect(Si.RR_SIGNAL_DISCONNECTED))},this.client=new al,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Xn,this.dataProcessLock=new Xn,this.dcBufferStatus=new Map([[Yt.LOSSY,!0],[Yt.RELIABLE,!0]]),this.client.onParticipantUpdate=t=>this.emit(Ue.ParticipantUpdate,t),this.client.onConnectionQuality=t=>this.emit(Ue.ConnectionQualityUpdate,t),this.client.onRoomUpdate=t=>this.emit(Ue.RoomUpdate,t),this.client.onSubscriptionError=t=>this.emit(Ue.SubscriptionError,t),this.client.onSubscriptionPermissionUpdate=t=>this.emit(Ue.SubscriptionPermissionUpdate,t),this.client.onSpeakersChanged=t=>this.emit(Ue.SpeakersChanged,t),this.client.onStreamStateUpdate=t=>this.emit(Ue.StreamStateChanged,t)}join(e,t,n,r){return re(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,t,n,r);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.publisher||this.configure(s),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof It&&s.reason===1&&(G.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,r);throw s}})}close(){return re(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Ue.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return re(this,void 0,void 0,function*(){this.publisher&&this.publisher.pc.signalingState!=="closed"&&this.publisher.pc.getSenders().forEach(t=>{var n,r;try{!((n=this.publisher)===null||n===void 0)&&n.pc.removeTrack&&((r=this.publisher)===null||r===void 0||r.pc.removeTrack(t))}catch(s){G.warn("could not removeTrack",{error:s})}}),this.publisher&&(this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.hasPublished=!1,this.primaryPC=void 0;const e=t=>{t&&(t.close(),t.onbufferedamountlow=null,t.onclose=null,t.onclosing=null,t.onerror=null,t.onmessage=null,t.onopen=null)};e(this.lossyDC),e(this.lossyDCSub),e(this.reliableDC),e(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return re(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Xi("a track with the same ID has already been published");return new Promise((t,n)=>{const r=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],n(new It("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(r),t(s)},reject:()=>{clearTimeout(r),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){var t;if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return(t=this.publisher)===null||t===void 0||t.pc.removeTrack(e),!0}catch(n){G.warn("failed to remove track",{error:n,method:"removeTrack"})}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return re(this,void 0,void 0,function*(){if(this.primaryPC!==void 0)return D1(this.primaryPC)})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t,n;if(this.publisher||this.subscriber)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const r=this.makeRTCConfiguration(e);!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(G.debug("E2EE - setting up transports with insertable streams"),r.encodedInsertableStreams=!0);const s={optional:[{googDscp:!0}]};this.publisher=new Hu(r,s),this.subscriber=new Hu(r),this.emit(Ue.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=c=>{c.candidate&&(G.trace("adding ICE candidate for peer",c.candidate),this.client.sendIceCandidate(c.candidate,mi.PUBLISHER))},this.subscriber.pc.onicecandidate=c=>{c.candidate&&this.client.sendIceCandidate(c.candidate,mi.SUBSCRIBER)},this.publisher.onOffer=c=>{this.client.sendOffer(c)};let l=this.publisher.pc,a=this.subscriber.pc,o=e.subscriberPrimary;o&&(l=this.subscriber.pc,a=this.publisher.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=l,l.onconnectionstatechange=()=>re(this,void 0,void 0,function*(){if(G.debug("primary PC state changed ".concat(l.connectionState)),l.connectionState==="connected"){const c=this.pcState===pi.New;this.pcState=pi.Connected,c&&this.emit(Ue.Connected,e)}else l.connectionState==="failed"&&this.pcState===pi.Connected&&(this.pcState=pi.Disconnected,this.handleDisconnect("primary peerconnection",o?Si.RR_SUBSCRIBER_FAILED:Si.RR_PUBLISHER_FAILED))}),a.onconnectionstatechange=()=>re(this,void 0,void 0,function*(){G.debug("secondary PC state changed ".concat(a.connectionState)),a.connectionState==="failed"&&this.handleDisconnect("secondary peerconnection",o?Si.RR_PUBLISHER_FAILED:Si.RR_SUBSCRIBER_FAILED)}),this.subscriber.pc.ontrack=c=>{this.emit(Ue.MediaTrackAdded,c.track,c.streams[0],c.receiver)},this.createDataChannels()}setupSignalClientCallbacks(){this.client.onAnswer=e=>re(this,void 0,void 0,function*(){this.publisher&&(G.debug("received server answer",{RTCSdpType:e.type,signalingState:this.publisher.pc.signalingState.toString()}),yield this.publisher.setRemoteDescription(e))}),this.client.onTrickle=(e,t)=>{!this.publisher||!this.subscriber||(G.trace("got ICE candidate from peer",{candidate:e,target:t}),t===mi.PUBLISHER?this.publisher.addIceCandidate(e):this.subscriber.addIceCandidate(e))},this.client.onOffer=e=>re(this,void 0,void 0,function*(){if(!this.subscriber)return;G.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.pc.signalingState.toString()}),yield this.subscriber.setRemoteDescription(e);const t=yield this.subscriber.createAndSetAnswer();this.client.sendAnswer(t)}),this.client.onLocalTrackPublished=e=>{if(G.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid]){G.error("missing track resolver for ".concat(e.cid));return}const{resolve:t}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],t(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onClose=()=>{this.handleDisconnect("signal",Si.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.primaryPC=void 0,this.handleDisconnect(qu)):(this.emit(Ue.Disconnected,e==null?void 0:e.reason),this.close()),G.trace("leave request",{leave:e})}}makeRTCConfiguration(e){const t=Object.assign({},this.rtcConfig);if(e.iceServers&&!t.iceServers){const n=[];e.iceServers.forEach(r=>{const s={urls:r.urls};r.username&&(s.username=r.username),r.credential&&(s.credential=r.credential),n.push(s)}),t.iceServers=n}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Bi.ENABLED&&(t.iceTransportPolicy="relay"),t.sdpSemantics="unified-plan",t.continualGatheringPolicy="gather_continually",t}createDataChannels(){this.publisher&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.publisher.pc.createDataChannel(Gu,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(Ju,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,n){if(!("getCapabilities"in RTCRtpSender))return;const r=RTCRtpSender.getCapabilities(t);if(!r)return;G.debug("get capabilities",r);const s=[],l=[],a=[];r.codecs.forEach(o=>{const c=o.mimeType.toLowerCase();if(c==="audio/opus"){s.push(o);return}if(!(c==="video/".concat(n))){a.push(o);return}if(n==="h264"){o.sdpFmtpLine&&o.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(o):l.push(o);return}s.push(o)}),$_(e)&&e.setCodecPreferences(s.concat(l,a))}createSender(e,t,n){return re(this,void 0,void 0,function*(){if(Ru())return yield this.createTransceiverRTCRtpSender(e,t,n);if(Mu())return G.warn("using add-track fallback"),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Kt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,n,r){return re(this,void 0,void 0,function*(){if(Ru())return this.createSimulcastTransceiverSender(e,t,n,r);if(Mu())return G.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new Kt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,n){return re(this,void 0,void 0,function*(){if(!this.publisher)throw new Kt("publisher is closed");const r=[];e.mediaStream&&r.push(e.mediaStream);const s={direction:"sendonly",streams:r};n&&(s.sendEncodings=n);const l=yield this.publisher.pc.addTransceiver(e.mediaStreamTrack,s);return e.kind===ke.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(l,e.kind,t.videoCodec),e.codec=t.videoCodec),l.sender})}createSimulcastTransceiverSender(e,t,n,r){return re(this,void 0,void 0,function*(){if(!this.publisher)throw new Kt("publisher is closed");const s={direction:"sendonly"};r&&(s.sendEncodings=r);const l=yield this.publisher.pc.addTransceiver(t.mediaStreamTrack,s);if(n.videoCodec)return this.setPreferredCodec(l,e.kind,n.videoCodec),e.setSimulcastTrackSender(n.videoCodec,l.sender),l.sender})}createRTCRtpSender(e){return re(this,void 0,void 0,function*(){if(!this.publisher)throw new Kt("publisher is closed");return this.publisher.pc.addTrack(e)})}attemptReconnect(e){var t,n,r;return re(this,void 0,void 0,function*(){if(!this._isClosed&&!this.attemptingReconnect){(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===Bi.DISABLED||((r=(n=this.primaryPC)===null||n===void 0?void 0:n.signalingState)!==null&&r!==void 0?r:"closed")==="closed")&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let l=!0;s instanceof Kt?(G.debug("received unrecoverable error",{error:s}),l=!1):s instanceof Ys||(this.fullReconnectOnNext=!0),l?this.handleDisconnect("reconnect",Si.RR_UNKNOWN):(G.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(Ue.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){G.warn("encountered error in reconnect policy",{error:t})}return null}restartConnection(e){var t,n,r;return re(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Kt("could not reconnect, url or token not saved");G.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(Ue.Restarting),this.client.isConnected&&(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw G.warn("attempted connection restart, without signal options present"),new Ys;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(l){throw l instanceof It&&l.reason===0?new Kt("could not reconnect, token might be expired"):new Ys}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(Ue.SignalRestarted,s),yield this.waitForPCReconnected(),(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(Ue.Restarted)}catch(s){const l=yield(n=this.regionUrlProvider)===null||n===void 0?void 0:n.getNextBestRegionUrl();if(l){yield this.restartConnection(l);return}else throw(r=this.regionUrlProvider)===null||r===void 0||r.resetAttempts(),s}})}resumeConnection(e){var t;return re(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Kt("could not reconnect, url or token not saved");if(!this.publisher||!this.subscriber)throw new Kt("publisher and subscriber connections unset");G.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(Ue.Resuming);try{this.setupSignalClientCallbacks();const n=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(n){const r=this.makeRTCConfiguration(n);this.publisher.pc.setConfiguration(r),this.subscriber.pc.setConfiguration(r)}}catch(n){let r="";throw n instanceof Error&&(r=n.message),n instanceof It&&n.reason===0?new Kt("could not reconnect, token might be expired"):new Ys(r)}if(this.emit(Ue.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0})),yield this.waitForPCReconnected(),this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Ue.Resumed)})}waitForPCInitialConnection(e,t){return re(this,void 0,void 0,function*(){if(this.pcState!==pi.Connected){if(this.pcState!==pi.New)throw new Kt("Expected peer connection to be new on initial connection");return new Promise((n,r)=>{const s=()=>{G.warn("closing engine"),$t.clearTimeout(a),r(new It("room connection has been cancelled",3))};t!=null&&t.signal.aborted&&s(),t==null||t.signal.addEventListener("abort",s);const l=()=>{$t.clearTimeout(a),t==null||t.signal.removeEventListener("abort",s),n()},a=$t.setTimeout(()=>{this.off(Ue.Connected,l),r(new It("could not establish pc connection"))},e??this.peerConnectionTimeout);this.once(Ue.Connected,l)})}})}waitForPCReconnected(){var e,t;return re(this,void 0,void 0,function*(){const n=Date.now();let r=n;for(this.pcState=pi.Reconnecting,G.debug("waiting for peer connection to reconnect");r-n<this.peerConnectionTimeout&&this.primaryPC!==void 0;){if(r-n>x1&&((e=this.primaryPC)===null||e===void 0?void 0:e.connectionState)==="connected"&&(!this.hasPublished||((t=this.publisher)===null||t===void 0?void 0:t.pc.connectionState)==="connected")&&(this.pcState=pi.Connected),this.pcState===pi.Connected)return;yield gr(100),r=Date.now()}throw new It("could not establish PC connection")})}sendDataPacket(e,t){return re(this,void 0,void 0,function*(){const n=e.toBinary();yield this.ensurePublisherConnected(t);const r=this.dataChannelForKind(t);r&&r.send(n),this.updateAndEmitDCBufferStatus(t)})}ensureDataTransportConnected(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var n,r,s;return re(this,void 0,void 0,function*(){const l=t?this.subscriber:this.publisher,a=t?"Subscriber":"Publisher";if(!l)throw new It("".concat(a," connection not set"));!t&&!(!((n=this.publisher)===null||n===void 0)&&n.isICEConnected)&&((r=this.publisher)===null||r===void 0?void 0:r.pc.iceConnectionState)!=="checking"&&this.negotiate();const o=this.dataChannelForKind(e,t);if((o==null?void 0:o.readyState)==="open")return;const c=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<c;){if(l.isICEConnected&&((s=this.dataChannelForKind(e,t))===null||s===void 0?void 0:s.readyState)==="open")return;yield gr(50)}throw new It("could not establish ".concat(a," connection, state: ").concat(l.pc.iceConnectionState))})}ensurePublisherConnected(e){return re(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.primaryPC||this.primaryPC.connectionState==="closed"||this.primaryPC.connectionState==="failed"||this.hasPublished&&this.subscriberPrimary&&(!this.publisher||this.publisher.pc.connectionState==="closed"||this.publisher.pc.connectionState==="failed")||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return new Promise((e,t)=>{if(!this.publisher){t(new Dc("publisher is not defined"));return}this.hasPublished=!0;const n=()=>{G.debug("engine disconnected while negotiation was ongoing"),s(),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Ue.Closing,n);const r=setTimeout(()=>{t("negotiation timed out"),this.handleDisconnect("negotiation",Si.RR_SIGNAL_DISCONNECTED)},this.peerConnectionTimeout),s=()=>{clearTimeout(r),this.off(Ue.Closing,n)};this.publisher.once(Vr.NegotiationStarted,()=>{var l;(l=this.publisher)===null||l===void 0||l.once(Vr.NegotiationComplete,()=>{s(),e()})}),this.publisher.once(Vr.RTPVideoPayloadTypes,l=>{const a=new Map;l.forEach(o=>{const c=o.codec.toLowerCase();r1(c)&&a.set(o.payload,c)}),this.emit(Ue.RTPVideoMapUpdate,a)}),this.publisher.negotiate(l=>{s(),t(l),l instanceof Dc&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Si.RR_UNKNOWN)})})}dataChannelForKind(e,t){if(t){if(e===Yt.LOSSY)return this.lossyDCSub;if(e===Yt.RELIABLE)return this.reliableDCSub}else{if(e===Yt.LOSSY)return this.lossyDC;if(e===Yt.RELIABLE)return this.reliableDC}}failNext(){this.shouldFailNext=!0}clearReconnectTimeout(){this.reconnectTimeout&&$t.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){gi()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){gi()&&window.removeEventListener("online",this.handleBrowserOnLine)}}function D1(i){var e;return re(this,void 0,void 0,function*(){let t="";const n=new Map,r=new Map;if((yield i.getStats()).forEach(a=>{switch(a.type){case"transport":t=a.selectedCandidatePairId;break;case"candidate-pair":t===""&&a.selected&&(t=a.id),n.set(a.id,a);break;case"remote-candidate":r.set(a.id,"".concat(a.address,":").concat(a.port));break}}),t==="")return;const l=(e=n.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(l!==void 0)return r.get(l)})}class Ys extends Error{}class Ku{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Lc(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return re(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(n=>!this.attemptedRegions.find(r=>r.url===n.url));if(t.length>0){const n=t[0];return this.attemptedRegions.push(n),G.debug("next region: ".concat(n.region)),n.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return re(this,void 0,void 0,function*(){const t=yield fetch("".concat(R1(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const n=yield t.json();return this.lastUpdateAt=Date.now(),n}else throw new It("Could not fetch region settings: ".concat(t.statusText),t.status===401?0:void 0,t.status)})}}function R1(i){return"".concat(i.protocol.replace("ws","http"),"//").concat(i.host,"/settings")}const ll=2e3;function zo(i,e){if(!e)return 0;let t,n;return"bytesReceived"in i?(t=i.bytesReceived,n=e.bytesReceived):"bytesSent"in i&&(t=i.bytesSent,n=e.bytesSent),t===void 0||n===void 0||i.timestamp===void 0||e.timestamp===void 0?0:(t-n)*8*1e3/(i.timestamp-e.timestamp)}class fi extends Rs{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3?arguments[3]:void 0;super(e,ke.Kind.Audio,t,n),this.stopOnMute=!1,this.monitorSender=()=>re(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(l){G.error("could not get audio sender stats",{error:l});return}s&&this.prevStats&&(this._currentBitrate=zo(s,this.prevStats)),this.prevStats=s}),this.audioContext=r,this.checkForSilence()}setDeviceId(e){return re(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||pr(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return re(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===ke.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(G.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return re(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{const n=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==pr(this._constraints.deviceId);return this.source===ke.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||n)&&!this.isUserProvided&&(G.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return re(this,void 0,void 0,function*(){let t;if(e){const n=jo({audio:e});typeof n.audio!="boolean"&&(t=n.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return re(this,void 0,void 0,function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n})}startMonitor(){gi()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},ll)))}setProcessor(e){var t;return re(this,void 0,void 0,function*(){const n=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const r={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};G.debug("setting up audio processor ".concat(e.name)),yield e.init(r),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack))}finally{n()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return re(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let n;return t.forEach(r=>{r.type==="outbound-rtp"&&(n={type:"audio",streamId:r.id,packetsSent:r.packetsSent,packetsLost:r.packetsLost,bytesSent:r.bytesSent,timestamp:r.timestamp,roundTripTime:r.roundTripTime,jitter:r.jitter})}),n})}checkForSilence(){return re(this,void 0,void 0,function*(){const e=yield H_(this);return e&&(this.isMuted||G.warn("silence detected on local audio track"),this.emit(Me.AudioSilenceDetected)),e})}}function tm(i,e){switch(i.kind){case"audio":return new fi(i,e,!1);case"video":return new vi(i,e,!1);default:throw new Xi("unsupported track type: ".concat(i.kind))}}const M1=Object.values(Yr),I1=Object.values(Rc),L1=Object.values(ol),N1=[Yr.h180,Yr.h360],F1=[Rc.h180,Rc.h360],B1=i=>[{scaleResolutionDownBy:2,fps:3}].map(t=>{var n;return new Et(Math.floor(i.width/t.scaleResolutionDownBy),Math.floor(i.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(i.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((n=i.encoding.maxFramerate)!==null&&n!==void 0?n:30)/t.fps)))),t.fps,i.encoding.priority)}),Fc=["q","h","f"];function im(i,e,t,n){var r,s;let l=n==null?void 0:n.videoEncoding;i&&(l=n==null?void 0:n.screenShareEncoding);const a=n==null?void 0:n.simulcast,o=n==null?void 0:n.scalabilityMode,c=n==null?void 0:n.videoCodec;if(!l&&!a&&!o||!e||!t)return[{}];l||(l=U1(i,e,t,c),G.debug("using video encoding",l));const f=new Et(e,t,l.maxBitrate,l.maxFramerate,l.priority);if(o&&vs(c)){G.debug("using svc with scalabilityMode ".concat(o));const h=new nm(o),m=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(o));for(let p=0;p<h.spatial;p+=1)m.push({rid:Fc[2-p],maxBitrate:l.maxBitrate/Math.pow(3,p),maxFramerate:f.encoding.maxFramerate});return m[0].scalabilityMode=o,G.debug("encodings",m),m}if(!a)return[l];let u=[];i?u=(r=$u(n==null?void 0:n.screenShareSimulcastLayers))!==null&&r!==void 0?r:Zu(i,f):u=(s=$u(n==null?void 0:n.videoSimulcastLayers))!==null&&s!==void 0?s:Zu(i,f);let d;if(u.length>0){const h=u[0];u.length>1&&([,d]=u);const m=Math.max(e,t);if(m>=960&&d)return Ga(e,t,[h,d,f]);if(m>=480)return Ga(e,t,[h,f])}return Ga(e,t,[f])}function Qu(i,e,t){var n,r,s,l;if(!t.backupCodec||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&G.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const a=i.mediaStreamTrack.getSettings(),o=(n=a.width)!==null&&n!==void 0?n:(r=i.dimensions)===null||r===void 0?void 0:r.width,c=(s=a.height)!==null&&s!==void 0?s:(l=i.dimensions)===null||l===void 0?void 0:l.height;return im(i.source===ke.Source.ScreenShare,o,c,t)}function U1(i,e,t,n){const r=j1(i,e,t);let{encoding:s}=r[0];const l=Math.max(e,t);for(let a=0;a<r.length;a+=1){const o=r[a];if(s=o.encoding,o.width>=l)break}if(n)switch(n){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function j1(i,e,t){if(i)return L1;const n=e>t?e/t:t/e;return Math.abs(n-16/9)<Math.abs(n-4/3)?M1:I1}function Zu(i,e){if(i)return B1(e);const{width:t,height:n}=e,r=t>n?t/n:n/t;return Math.abs(r-16/9)<Math.abs(r-4/3)?N1:F1}function Ga(i,e,t){const n=[];if(t.forEach((r,s)=>{if(s>=Fc.length)return;const l=Math.min(i,e),o={rid:Fc[s],scaleResolutionDownBy:Math.max(1,l/Math.min(r.width,r.height)),maxBitrate:r.encoding.maxBitrate};r.encoding.maxFramerate&&(o.maxFramerate=r.encoding.maxFramerate);const c=Ds()||s===0;r.encoding.priority&&c&&(o.priority=r.encoding.priority,o.networkPriority=r.encoding.priority),n.push(o)}),_r()&&Yd()==="ios"){let r;n.forEach(l=>{r?l.maxFramerate&&l.maxFramerate>r&&(r=l.maxFramerate):r=l.maxFramerate});let s=!0;n.forEach(l=>{var a;l.maxFramerate!=r&&(s&&(s=!1,G.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),G.info('Setting framerate of encoding "'.concat((a=l.rid)!==null&&a!==void 0?a:"",'" to ').concat(r)),l.maxFramerate=r)})}return n}function $u(i){if(i)return i.sort((e,t)=>{const{encoding:n}=e,{encoding:r}=t;return n.maxBitrate>r.maxBitrate?1:n.maxBitrate<r.maxBitrate?-1:n.maxBitrate===r.maxBitrate&&n.maxFramerate&&r.maxFramerate?n.maxFramerate>r.maxFramerate?1:-1:0})}class nm{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const V1=5e3;class vi extends Rs{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,ke.Kind.Video,t,n),this.simulcastCodecs=new Map,this.monitorSender=()=>re(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let r;try{r=yield this.getSenderStats()}catch(l){G.error("could not get audio sender stats",{error:l});return}const s=new Map(r.map(l=>[l.rid,l]));if(this.prevStats){let l=0;s.forEach((a,o)=>{var c;const f=(c=this.prevStats)===null||c===void 0?void 0:c.get(o);l+=zo(a,f)}),this._currentBitrate=l}this.prevStats=s}),this.senderLock=new Xn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!gi())return;const n=(t=this.sender)===null||t===void 0?void 0:t.getParameters();n&&(this.encodings=n.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},ll))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,n,r,s,l;return re(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,o=Ar(this.simulcastCodecs.values()),c;c=yield o.next(),t=c.done,!t;a=!0)s=c.value,a=!1,yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(null)}catch(f){n={error:f}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(n)throw n.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,n,r,s,l;return re(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,o=Ar(this.simulcastCodecs.values()),c;c=yield o.next(),t=c.done,!t;a=!0){s=c.value,a=!1;const f=s;yield(l=f.sender)===null||l===void 0?void 0:l.replaceTrack(f.mediaStreamTrack)}}catch(f){n={error:f}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(n)throw n.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return re(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===ke.Source.Camera&&!this.isUserProvided&&(G.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return re(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.source===ke.Source.Camera&&!this.isUserProvided&&(G.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return re(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach(r=>{var s;if(r.type==="outbound-rtp"){const l={type:"video",streamId:r.id,frameHeight:r.frameHeight,frameWidth:r.frameWidth,firCount:r.firCount,pliCount:r.pliCount,nackCount:r.nackCount,packetsSent:r.packetsSent,bytesSent:r.bytesSent,framesSent:r.framesSent,timestamp:r.timestamp,rid:(s=r.rid)!==null&&s!==void 0?s:r.id,retransmittedPacketsSent:r.retransmittedPacketsSent,qualityLimitationReason:r.qualityLimitationReason,qualityLimitationResolutionChanges:r.qualityLimitationResolutionChanges},a=n.get(r.remoteId);a&&(l.jitter=a.jitter,l.packetsLost=a.packetsLost,l.roundTripTime=a.roundTripTime),t.push(l)}}),t})}setPublishingQuality(e){const t=[];for(let n=zt.LOW;n<=zt.HIGH;n+=1)t.push(new Ni({quality:n,enabled:n<=e}));G.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(t)}setDeviceId(e){return re(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===pr(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||pr(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var t,n,r,s;return re(this,void 0,void 0,function*(){let l;if(e){const f=jo({video:e});typeof f.video!="boolean"&&(l=f.video)}yield this.restart(l);try{for(var a=!0,o=Ar(this.simulcastCodecs.values()),c;c=yield o.next(),t=c.done,!t;a=!0){s=c.value,a=!1;const f=s;f.sender&&(f.mediaStreamTrack=this.mediaStreamTrack.clone(),yield f.sender.replaceTrack(f.mediaStreamTrack))}}catch(f){n={error:f}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(n)throw n.error}}})}setProcessor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var r,s,l,a,o,c;return re(this,void 0,void 0,function*(){if(yield n.setProcessor.call(this,e,t),!((o=this.processor)===null||o===void 0)&&o.processedTrack)try{for(var f=!0,u=Ar(this.simulcastCodecs.values()),d;d=yield u.next(),r=d.done,!r;f=!0)a=d.value,f=!1,yield(c=a.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(h){s={error:h}}finally{try{!f&&!r&&(l=u.return)&&(yield l.call(u))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},V1))}setPublishingCodecs(e){var t,n,r,s,l,a,o;return re(this,void 0,void 0,function*(){if(G.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=Ar(e);r=yield n.next(),s=r.done,!s;t=!0){o=r.value,t=!1;const f=o;if(!this.codec||this.codec===f.codec)yield this.setPublishingLayers(f.qualities);else{const u=this.simulcastCodecs.get(f.codec);if(G.debug("try setPublishingCodec for ".concat(f.codec),u),!u||!u.sender){for(const d of f.qualities)if(d.enabled){c.push(f.codec);break}}else u.encodings&&(G.debug("try setPublishingLayersForSender ".concat(f.codec)),yield ef(u.sender,u.encodings,f.qualities,this.senderLock))}}}catch(f){l={error:f}}finally{try{!t&&!s&&(a=n.return)&&(yield a.call(n))}finally{if(l)throw l.error}}return c})}setPublishingLayers(e){return re(this,void 0,void 0,function*(){G.debug("setting publishing layers",e),!(!this.sender||!this.encodings)&&(yield ef(this.sender,this.encodings,e,this.senderLock))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return re(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Xd()&&this.isInBackground&&this.source===ke.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function ef(i,e,t,n){return re(this,void 0,void 0,function*(){const r=yield n.lock();G.debug("setPublishingLayersForSender",{sender:i,qualities:t,senderEncodings:e});try{const s=i.getParameters(),{encodings:l}=s;if(!l)return;if(l.length!==e.length){G.warn("cannot set publishing layers, encodings mismatch");return}let a=!1;!1&&l[0].scalabilityMode||l.forEach((c,f)=>{var u;let d=(u=c.rid)!==null&&u!==void 0?u:"";d===""&&(d="q");const h=rm(d),m=t.find(p=>p.quality===h);m&&c.active!==m.enabled&&(a=!0,c.active=m.enabled,G.debug("setting layer ".concat(m.quality," to ").concat(c.active?"enabled":"disabled")),Ds()&&(m.enabled?(c.scaleResolutionDownBy=e[f].scaleResolutionDownBy,c.maxBitrate=e[f].maxBitrate,c.maxFrameRate=e[f].maxFrameRate):(c.scaleResolutionDownBy=4,c.maxBitrate=10,c.maxFrameRate=2)))}),a&&(s.encodings=l,G.debug("setting encodings",s.encodings),yield i.setParameters(s))}finally{r()}})}function rm(i){switch(i){case"f":return zt.HIGH;case"h":return zt.MEDIUM;case"q":return zt.LOW;default:return zt.HIGH}}function tf(i,e,t,n){if(!t)return[new ci({quality:zt.HIGH,width:i,height:e,bitrate:0,ssrc:0})];if(n){const r=t[0].scalabilityMode,s=new nm(r),l=[];for(let a=0;a<s.spatial;a+=1)l.push(new ci({quality:zt.HIGH-a,width:Math.ceil(i/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return l}return t.map(r=>{var s,l,a;const o=(s=r.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let c=rm((l=r.rid)!==null&&l!==void 0?l:"");return new ci({quality:c,width:Math.ceil(i/o),height:Math.ceil(e/o),bitrate:(a=r.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class sm extends ke{constructor(e,t,n,r){super(e,n),this.sid=t,this.receiver=r}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Me.Muted:Me.Unmuted,this))}setMediaStream(e){this.mediaStream=e,e.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(Me.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return re(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),ll))}}class ys extends sm{constructor(e,t,n,r,s){super(e,t,ke.Kind.Audio,n),this.monitorReceiver=()=>re(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=zo(l,this.prevStats)),this.prevStats=l}),this.audioContext=r,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):n.volume=e;_r()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(_r())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return re(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Ic(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.elementVolume&&(e.volume=this.elementVolume),this.sinkId&&Ic(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(G.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach(r=>{n.connect(r),n=r}),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(Me.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(r=>{this.emit(Me.AudioPlaybackFailed,r)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return re(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(n=>{n.type==="inbound-rtp"&&(t={type:"audio",timestamp:n.timestamp,jitter:n.jitter,bytesReceived:n.bytesReceived,concealedSamples:n.concealedSamples,concealmentEvents:n.concealmentEvents,silentConcealedSamples:n.silentConcealedSamples,silentConcealmentEvents:n.silentConcealmentEvents,totalAudioEnergy:n.totalAudioEnergy,totalSamplesDuration:n.totalSamplesDuration})}),t})}}const Ja=100;class _s extends sm{constructor(e,t,n,r){super(e,t,ke.Kind.Video,n),this.elementInfos=[],this.monitorReceiver=()=>re(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=zo(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=cl(()=>{this.updateDimensions()},Ja),this.adaptiveStreamSettings=r}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?jr(this._mediaStreamTrack,t):Dr(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new z1(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):G.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream){G.warn("stopObservingElementInfo ignored");return}const t=this.elementInfos.filter(n=>n===e);for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter(n=>n!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return re(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(n=>{n.type==="inbound-rtp"&&(t={type:"video",framesDecoded:n.framesDecoded,framesDropped:n.framesDropped,framesReceived:n.framesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost,frameWidth:n.frameWidth,frameHeight:n.frameHeight,pliCount:n.pliCount,firCount:n.firCount,nackCount:n.nackCount,jitter:n.jitter,timestamp:n.timestamp,bytesReceived:n.bytesReceived,decoderImplementation:n.decoderImplementation})}),t})}stopObservingElement(e){const t=this.elementInfos.filter(n=>n.element===e);for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return re(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,t;const n=this.elementInfos.reduce((a,o)=>Math.max(a,o.visibilityChangedAt||0),0),r=!((t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&t!==void 0)||t?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),l=this.elementInfos.some(a=>a.visible)&&!r||s;if(this.lastVisible!==l){if(!l&&Date.now()-n<Ja){$t.setTimeout(()=>{this.updateVisibility()},Ja);return}this.lastVisible=l,this.emit(Me.VisibilityChanged,l,this)}}updateDimensions(){var e,t;let n=0,r=0;const s=this.getPixelDensity();for(const l of this.elementInfos){const a=l.width()*s,o=l.height()*s;a+o>n+r&&(n=a,r=o)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===n&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===r||(this.lastDimensions={width:n,height:r},this.emit(Me.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?Iu():t||(Iu()>2?2:1)}}class z1{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=n=>{var r;const{target:s,isIntersecting:l}=n;s===this.element&&(this.isIntersecting=l,this.visibilityChangedAt=Date.now(),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this))},this.onEnterPiP=()=>{var n;this.isPiP=!0,(n=this.handleVisibilityChanged)===null||n===void 0||n.call(this)},this.onLeavePiP=()=>{var n;this.isPiP=!1,(n=this.handleVisibilityChanged)===null||n===void 0||n.call(this)},this.element=e,this.isIntersecting=t??nf(e),this.isPiP=gi()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=nf(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Nu().observe(this.element),Lu().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;(e=Nu())===null||e===void 0||e.unobserve(this.element),(t=Lu())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function nf(i){let e=i.offsetTop,t=i.offsetLeft;const n=i.offsetWidth,r=i.offsetHeight,{hidden:s}=i,{opacity:l,display:a}=getComputedStyle(i);for(;i.offsetParent;)i=i.offsetParent,e+=i.offsetTop,t+=i.offsetLeft;return e<window.pageYOffset+window.innerHeight&&t<window.pageXOffset+window.innerWidth&&e+r>window.pageYOffset&&t+n>window.pageXOffset&&!s&&(l!==""?parseFloat(l)>0:!0)&&a!=="none"}class gn extends fn.EventEmitter{constructor(e,t,n){super(),this.metadataMuted=!1,this.encryption=ai.NONE,this.handleMuted=()=>{this.emit(Me.Muted)},this.handleUnmuted=()=>{this.emit(Me.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=ke.Source.Unknown}setTrack(e){this.track&&(this.track.off(Me.Muted,this.handleMuted),this.track.off(Me.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(Me.Muted,this.handleMuted),e.on(Me.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==ai.NONE}get audioTrack(){if(this.track instanceof fi||this.track instanceof ys)return this.track}get videoTrack(){if(this.track instanceof vi||this.track instanceof _s)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=ke.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===ke.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,G.debug("update publication info",{info:e})}}(function(i){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(i.SubscriptionStatus||(i.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(i.PermissionStatus||(i.PermissionStatus={}))})(gn||(gn={}));class Oo extends gn{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(Me.Ended)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&this.track.off(Me.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(Me.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return re(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return re(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return re(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return re(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var dr;(function(i){i.Excellent="excellent",i.Good="good",i.Poor="poor",i.Unknown="unknown"})(dr||(dr={}));function W1(i){switch(i){case rr.EXCELLENT:return dr.Excellent;case rr.GOOD:return dr.Good;case rr.POOR:return dr.Poor;default:return dr.Unknown}}class om extends fn.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}constructor(e,t,n,r){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=dr.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=r,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(ke.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(ke.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(ke.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,G.trace("update participant info",{info:e}),!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Ne.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Ne.ParticipantNameChanged,e)}setPermissions(e){var t,n,r,s,l;const a=this.permissions,o=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((n=this.permissions)===null||n===void 0?void 0:n.canSubscribe)||e.canPublishData!==((r=this.permissions)===null||r===void 0?void 0:r.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((l=this.permissions)===null||l===void 0?void 0:l.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,f)=>{var u;return c!==((u=this.permissions)===null||u===void 0?void 0:u.canPublishSources[f])});return this.permissions=e,o&&this.emit(Ne.ParticipantPermissionsChanged,a),o}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Ne.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=W1(e),t!==this._connectionQuality&&this.emit(Ne.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(t=>(t.track instanceof ys||t.track instanceof fi)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(Me.Muted,()=>{this.emit(Ne.TrackMuted,e)}),e.on(Me.Unmuted,()=>{this.emit(Ne.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case ke.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case ke.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function X1(i){var e,t,n;if(!i.participantSid&&!i.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new nn({participantIdentity:(e=i.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=i.participantSid)!==null&&t!==void 0?t:"",allTracks:(n=i.allowAll)!==null&&n!==void 0?n:!1,trackSids:i.allowedTrackSids||[]})}class am extends gn{constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=zt.HIGH,this.handleEnded=r=>{this.setTrack(void 0),this.emit(Me.Ended,r)},this.handleVisibilityChange=r=>{G.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(r),{trackSid:this.trackSid}),this.disabled=!r,this.emitTrackUpdate()},this.handleVideoDimensionsChange=r=>{G.debug("adaptivestream video dimensions ".concat(r.width,"x").concat(r.height),{trackSid:this.trackSid}),this.videoDimensions=r,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const r=new wi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Ji({participantSid:"",trackSids:[this.trackSid]})]});this.emit(Me.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return this.subscribed===!1?gn.SubscriptionStatus.Unsubscribed:super.isSubscribed?gn.SubscriptionStatus.Subscribed:gn.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?gn.PermissionStatus.Allowed:gn.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&(((t=this.videoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((n=this.videoDimensions)===null||n===void 0?void 0:n.height)===e.height||(this.track instanceof _s&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof _s&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,r=this.track;r!==e&&(r&&(r.off(Me.VideoDimensionsChanged,this.handleVideoDimensionsChange),r.off(Me.VisibilityChanged,this.handleVisibilityChange),r.off(Me.Ended,this.handleEnded),r.detach(),r.stopMonitor(),this.emit(Me.Unsubscribed,r)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(Me.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(Me.VisibilityChanged,this.handleVisibilityChange),e.on(Me.Ended,this.handleEnded),this.emit(Me.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(Me.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?Me.Muted:Me.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(Me.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(Me.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===ke.Kind.Video&&this.isAdaptiveStream?(G.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(G.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof _s&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Zi({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=zt.HIGH,this.emit(Me.UpdateSettings,e)}}class Ms extends om{static fromParticipantInfo(e,t){return new Ms(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,n,r,s){super(t,n||"",r,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(Me.UpdateSettings,t=>{G.debug("send update settings",t),this.signalClient.sendUpdateTrackSettings(t)}),e.on(Me.UpdateSubscription,t=>{t.participantTracks.forEach(n=>{n.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(Me.SubscriptionPermissionChanged,t=>{this.emit(Ne.TrackSubscriptionPermissionChanged,e,t)}),e.on(Me.SubscriptionStatusChanged,t=>{this.emit(Ne.TrackSubscriptionStatusChanged,e,t)}),e.on(Me.Subscribed,t=>{this.emit(Ne.TrackSubscribed,t,e)}),e.on(Me.Unsubscribed,t=>{this.emit(Ne.TrackUnsubscribed,t,e)}),e.on(Me.SubscriptionFailed,t=>{this.emit(Ne.TrackSubscriptionFailed,e.trackSid,t)})}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ke.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrack(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ke.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,r,s,l){let a=this.getTrackPublication(t);if(a||t.startsWith("TR")||this.tracks.forEach(f=>{!a&&e.kind===f.kind.toString()&&(a=f)}),!a){if(l===0){G.error("could not find published track",{participant:this.sid,trackSid:t}),this.emit(Ne.TrackSubscriptionFailed,t);return}l===void 0&&(l=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,n,r,s,l-1)},150);return}if(e.readyState==="ended"){G.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:t}),this.emit(Ne.TrackSubscriptionFailed,t);return}const o=e.kind==="video";let c;return o?c=new _s(e,t,r,s):c=new ys(e,t,r,this.audioContext,this.audioOutput),c.source=a.source,c.isMuted=a.isMuted,c.setMediaStream(n),c.start(),a.setTrack(c),this.volumeMap.has(a.source)&&c instanceof ys&&c.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach(r=>{var s;let l=this.getTrackPublication(r.sid);if(l)l.updateInfo(r);else{const a=ke.kindFromProto(r.type);if(!a)return;l=new am(a,r,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe),l.updateInfo(r),n.set(r.sid,l);const o=Array.from(this.tracks.values()).find(c=>c.source===(l==null?void 0:l.source));o&&l.source!==ke.Source.Unknown&&G.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(l.source),{oldTrack:o,newTrack:l,participant:this,participantInfo:e}),this.addTrackPublication(l)}t.set(r.sid,l)}),this.tracks.forEach(r=>{t.has(r.trackSid)||(G.trace("detected removed track on remote participant, unpublishing",{publication:r,participantSid:this.sid}),this.unpublishTrack(r.trackSid,!0))}),n.forEach(r=>{this.emit(Ne.TrackPublished,r)}),!0}unpublishTrack(e,t){const n=this.tracks.get(e);if(!n)return;const{track:r}=n;switch(r&&(r.stop(),n.setTrack(void 0)),this.tracks.delete(e),n.kind){case ke.Kind.Audio:this.audioTracks.delete(e);break;case ke.Kind.Video:this.videoTracks.delete(e);break}t&&this.emit(Ne.TrackUnpublished,n)}setAudioOutput(e){return re(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach(n=>{var r;n.track instanceof ys&&t.push(n.track.setSinkId((r=e.deviceId)!==null&&r!==void 0?r:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return G.trace("participant event",{participant:this.sid,event:e,args:n}),super.emit(e,...n)}}class rf extends om{constructor(e,t,n,r){super(e,t),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=ai.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Jd)},this.handleReconnected=()=>{var s,l;(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||l===void 0||l.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,l;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>G.warn(a)),(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||l===void 0||l.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{G.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>X1(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,l)=>{if(l===void 0&&(l=!0),!s.sid){G.error("could not update mute status for unpublished track",s);return}this.engine.updateMuteStatus(s.sid,l)},this.onTrackUpstreamPaused=s=>{G.debug("upstream paused"),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{G.debug("upstream resumed"),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>re(this,void 0,void 0,function*(){var l,a,o,c,f,u;if(!(!((f=this.roomOptions)===null||f===void 0)&&f.dynacast))return;const d=this.videoTracks.get(s.trackSid);if(!d){G.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:s.trackSid});return}if(s.subscribedCodecs.length>0){if(!d.videoTrack)return;const g=yield d.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var h=!0,m=Ar(g),p;p=yield m.next(),l=p.done,!l;h=!0){c=p.value,h=!1;const v=c;W_(v)&&(G.debug("publish ".concat(v," for ").concat(d.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(d.videoTrack,v,d.options))}}catch(v){a={error:v}}finally{try{!h&&!l&&(o=m.return)&&(yield o.call(m))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(u=d.videoTrack)===null||u===void 0?void 0:u.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const l=this.tracks.get(s.trackSid);if(!l){G.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:s.trackSid});return}this.unpublishTrack(l.track)},this.handleTrackEnded=s=>re(this,void 0,void 0,function*(){if(s.source===ke.Source.ScreenShare||s.source===ke.Source.ScreenShareAudio)G.debug("unpublishing local track due to TrackEnded",{track:s.sid}),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof fi||s instanceof vi)try{if(gi())try{const l=yield navigator==null?void 0:navigator.permissions.query({name:s.source===ke.Source.Camera?"camera":"microphone"});if(l&&l.state==="denied")throw G.warn("user has revoked access to ".concat(s.source)),l.onchange=()=>{l.state!=="denied"&&(s.isMuted||s.restartTrack(),l.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(G.debug("track ended, attempting to use a different device"),yield s.restartTrack())}catch{G.warn("could not restart track, muting instead"),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=n,this.roomOptions=r,this.setupEngine(n),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==ai.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.client.onRemoteMuteChanged=(t,n)=>{const r=this.tracks.get(t);!r||!r.track||(n?r.mute():r.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(Ue.Connected,this.handleReconnected).on(Ue.SignalRestarted,this.handleReconnected).on(Ue.SignalResumed,this.handleReconnected).on(Ue.Restarting,this.handleReconnecting).on(Ue.Resuming,this.handleReconnecting).on(Ue.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,(t=this.name)!==null&&t!==void 0?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata((t=this.metadata)!==null&&t!==void 0?t:"",e)}setCameraEnabled(e,t,n){return this.setTrackEnabled(ke.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(ke.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(ke.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(Ne.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return re(this,void 0,void 0,function*(){this.encryptionType=e?ai.GCM:ai.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,n,r){var s,l;return re(this,void 0,void 0,function*(){G.debug("setTrackEnabled",{source:e,enabled:t});let a=this.getTrack(e);if(t)if(a)yield a.unmute();else{let o;if(this.pendingPublishing.has(e)){G.info("skipping duplicate published source",{source:e});return}this.pendingPublishing.add(e);try{switch(e){case ke.Source.Camera:o=yield this.createTracks({video:(s=n)!==null&&s!==void 0?s:!0});break;case ke.Source.Microphone:o=yield this.createTracks({audio:(l=n)!==null&&l!==void 0?l:!0});break;case ke.Source.ScreenShare:o=yield this.createScreenTracks(Object.assign({},n));break;default:throw new Xi(e)}const c=[];for(const u of o)G.info("publishing track",{localTrack:u}),c.push(this.publishTrack(u,r));[a]=yield Promise.all(c)}catch(c){throw o==null||o.forEach(f=>{f.stop()}),c instanceof Error&&!(c instanceof Xi)&&this.emit(Ne.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===ke.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const o=this.getTrack(ke.Source.ScreenShareAudio);o&&o.track&&this.unpublishTrack(o.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return re(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(ke.Source.Camera)||this.pendingPublishing.has(ke.Source.Microphone))){this.pendingPublishing.add(ke.Source.Camera),this.pendingPublishing.add(ke.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(ke.Source.Camera),this.pendingPublishing.delete(ke.Source.Microphone)}}})}createTracks(e){var t,n;return re(this,void 0,void 0,function*(){const r=zd(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(n=this.roomOptions)===null||n===void 0?void 0:n.videoCaptureDefaults),s=jo(r);let l;try{l=yield navigator.mediaDevices.getUserMedia(s)}catch(a){throw a instanceof Error&&(s.audio&&(this.microphoneError=a),s.video&&(this.cameraError=a)),a}return s.audio&&(this.microphoneError=void 0),s.video&&(this.cameraError=void 0),l.getTracks().map(a=>{const o=a.kind==="audio";o?e.audio:e.video;let c;const f=o?s.audio:s.video;typeof f!="boolean"&&(c=f);const u=tm(a,c);return u.kind===ke.Kind.Video?u.source=ke.Source.Camera:u.kind===ke.Kind.Audio&&(u.source=ke.Source.Microphone),u.mediaStream=l,u})})}createScreenTracks(e){return re(this,void 0,void 0,function*(){if(e===void 0&&(e={}),e.resolution===void 0&&(e.resolution=ol.h1080fps15.resolution),navigator.mediaDevices.getDisplayMedia===void 0)throw new sl("getDisplayMedia not supported");const t=G_(e),n=yield navigator.mediaDevices.getDisplayMedia(t),r=n.getVideoTracks();if(r.length===0)throw new Xi("no video track found");const s=new vi(r[0],void 0,!1);s.source=ke.Source.ScreenShare;const l=[s];if(n.getAudioTracks().length>0){const a=new fi(n.getAudioTracks()[0],void 0,!1,this.audioContext);a.source=ke.Source.ScreenShareAudio,l.push(a)}return l})}publishTrack(e,t){var n,r,s,l;return re(this,void 0,void 0,function*(){yield(n=this.reconnectFuture)===null||n===void 0?void 0:n.promise,e instanceof Rs&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case ke.Source.Microphone:h="audioinput";break;case ke.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new fi(e,a,!0,this.audioContext);break;case"video":e=new vi(e,a,!0);break;default:throw new Xi("unsupported MediaStreamTrack kind ".concat(e.kind))}e instanceof fi&&e.setAudioContext(this.audioContext);let o;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(o=h)}),o)return G.warn("track has already been published, skipping"),o;const c="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,f=(r=t==null?void 0:t.forceStereo)!==null&&r!==void 0?r:c;f&&(t||(t={}),t.dtx===void 0&&G.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),t.red===void 0&&G.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=t.dtx)!==null&&s!==void 0||(t.dtx=!1),(l=t.red)!==null&&l!==void 0||(t.red=!1));const u=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);Vo()&&this.roomOptions.e2ee&&(G.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),u.simulcast=!1),u.source&&(e.source=u.source);const d=this.publish(e,u,f);this.pendingPublishPromises.set(e,d);try{return yield d}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,t,n){var r,s,l,a,o,c,f,u,d,h,m,p,g,v;return re(this,void 0,void 0,function*(){const b=Array.from(this.tracks.values()).find(I=>e instanceof Rs&&I.source===e.source);if(b&&e.source!==ke.Source.Unknown)try{throw Error("publishing a second track with the same source: ".concat(e.source))}catch(I){I instanceof Error&&G.warn(I.message,{oldTrack:b,newTrack:e,trace:I.stack})}t.stopMicTrackOnMute&&e instanceof fi&&(e.stopOnMute=!0),e.source===ke.Source.ScreenShare&&Ds()&&(t.simulcast=!1),t.videoCodec==="av1"&&!K_()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!Q_()&&(t.videoCodec=void 0),e.on(Me.Muted,this.onTrackMuted),e.on(Me.Unmuted,this.onTrackUnmuted),e.on(Me.Ended,this.handleTrackEnded),e.on(Me.UpstreamPaused,this.onTrackUpstreamPaused),e.on(Me.UpstreamResumed,this.onTrackUpstreamResumed);const y=new Ri({cid:e.mediaStreamTrack.id,name:t.name,type:ke.kindToProto(e.kind),muted:e.isMuted,source:ke.sourceToProto(e.source),disableDtx:!(!((r=t.dtx)!==null&&r!==void 0)||r),encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(!((s=t.red)!==null&&s!==void 0)||s)});let _,S;if(e.kind===ke.Kind.Video){let I={width:0,height:0};try{I=yield e.waitForDimensions()}catch{const H=(a=(l=this.roomOptions.videoCaptureDefaults)===null||l===void 0?void 0:l.resolution)!==null&&a!==void 0?a:Yr.h720.resolution;I={width:H.width,height:H.height},G.error("could not determine track dimensions, using defaults",I)}if(y.width=I.width,y.height=I.height,e instanceof vi)if(vs(t.videoCodec)&&(t.scalabilityMode=(o=t.scalabilityMode)!==null&&o!==void 0?o:"L3T3_KEY"),t.videoCodec&&t.backupCodec&&t.videoCodec!==t.backupCodec.codec){this.roomOptions.dynacast||(this.roomOptions.dynacast=!0);const z=Object.assign({},t);z.simulcast=!0,S=Qu(e,t.backupCodec.codec,z),y.simulcastCodecs=[new Ti({codec:t.videoCodec,cid:e.mediaStreamTrack.id,enableSimulcastLayers:!0}),new Ti({codec:t.backupCodec.codec,cid:"",enableSimulcastLayers:!0})]}else t.videoCodec&&(y.simulcastCodecs=[new Ti({codec:t.videoCodec,cid:e.mediaStreamTrack.id,enableSimulcastLayers:(c=t.simulcast)!==null&&c!==void 0?c:!1})]);_=im(e.source===ke.Source.ScreenShare,I.width,I.height,t),y.layers=tf(y.width,y.height,_,vs(t.videoCodec))}else e.kind===ke.Kind.Audio&&(_=[{maxBitrate:(u=(f=t.audioPreset)===null||f===void 0?void 0:f.maxBitrate)!==null&&u!==void 0?u:t.audioBitrate,priority:(h=(d=t.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&h!==void 0?h:"high",networkPriority:(p=(m=t.audioPreset)===null||m===void 0?void 0:m.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Kt("cannot publish track when not connected");const C=yield this.engine.addTrack(y);let k=!1,w=!1;if(C.codecs.forEach(I=>{Au(I.mimeType,t.videoCodec)?k=!0:t.backupCodec&&Au(I.mimeType,t.backupCodec.codec)&&(w=!0)}),y.simulcastCodecs.length>0){if(!k&&!w)throw Error("cannot publish track, codec not supported by server");if(!k&&t.backupCodec){const I=t.backupCodec;t=Object.assign({},t),G.debug("primary codec ".concat(t.videoCodec," not supported, fallback to ").concat(I.codec)),t.videoCodec=I.codec,t.videoEncoding=I.encoding,_=S}}const A=new Oo(e.kind,C,e);if(A.options=t,e.sid=C.sid,!this.engine.publisher)throw new Kt("publisher is closed");if(G.debug("publishing ".concat(e.kind," with encodings"),{encodings:_,trackInfo:C}),e.sender=yield this.engine.createSender(e,t,_),_)if(Ds()&&e.kind===ke.Kind.Audio){let I;for(const z of this.engine.publisher.pc.getTransceivers())if(z.sender===e.sender){I=z;break}I&&this.engine.publisher.setTrackCodecBitrate({transceiver:I,codec:"opus",maxbr:!((g=_[0])===null||g===void 0)&&g.maxBitrate?_[0].maxBitrate/1e3:0})}else e.codec&&vs(e.codec)&&(!((v=_[0])===null||v===void 0)&&v.maxBitrate)&&this.engine.publisher.setTrackCodecBitrate({cid:y.cid,codec:e.codec,maxbr:_[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof vi?e.startMonitor(this.engine.client):e instanceof fi&&e.startMonitor(),this.addTrackPublication(A),this.emit(Ne.LocalTrackPublished,A),A})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){var r;return re(this,void 0,void 0,function*(){let s;if(this.tracks.forEach(u=>{u.track&&u.track===e&&(s=u)}),!s)throw new Xi("track is not published");if(!(e instanceof vi))throw new Xi("track is not a video track");const l=Object.assign(Object.assign({},(r=this.roomOptions)===null||r===void 0?void 0:r.publishDefaults),n),a=Qu(e,t,l);if(!a){G.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const o=e.addSimulcastTrack(t,a),c=new Ri({cid:o.mediaStreamTrack.id,type:ke.kindToProto(e.kind),muted:e.isMuted,source:ke.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:l.videoCodec,cid:o.mediaStreamTrack.id,enableSimulcastLayers:l.simulcast}]});if(c.layers=tf(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new Kt("cannot publish track when not connected");const f=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,o,l,a),yield this.engine.negotiate(),G.debug("published ".concat(t," for track ").concat(e.sid),{encodings:a,trackInfo:f})})}unpublishTrack(e,t){var n,r;return re(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e);if(G.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!s||!s.track){G.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});return}e=s.track,e.off(Me.Muted,this.onTrackMuted),e.off(Me.Unmuted,this.onTrackUnmuted),e.off(Me.Ended,this.handleTrackEnded),e.off(Me.UpstreamPaused,this.onTrackUpstreamPaused),e.off(Me.UpstreamResumed,this.onTrackUpstreamResumed),t===void 0&&(t=(r=(n=this.roomOptions)===null||n===void 0?void 0:n.stopLocalTrackOnUnpublish)!==null&&r!==void 0?r:!0),t&&e.stop();let l=!1;const a=e.sender;if(e.sender=void 0,this.engine.publisher&&this.engine.publisher.pc.connectionState!=="closed"&&a)try{for(const o of this.engine.publisher.pc.getTransceivers())o.sender===a&&(o.direction="inactive",l=!0);if(this.engine.removeTrack(a)&&(l=!0),e instanceof vi){for(const[,o]of e.simulcastCodecs)o.sender&&(this.engine.removeTrack(o.sender)&&(l=!0),o.sender=void 0);e.simulcastCodecs.clear()}}catch(o){G.warn("failed to unpublish track",{error:o,method:"unpublishTrack"})}switch(this.tracks.delete(s.trackSid),s.kind){case ke.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case ke.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(Ne.LocalTrackUnpublished,s),s.setTrack(void 0),l&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return re(this,void 0,void 0,function*(){return(yield Promise.all(e.map(n=>this.unpublishTrack(n)))).filter(n=>n instanceof Oo)})}republishAllTracks(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return re(this,void 0,void 0,function*(){const n=[];this.tracks.forEach(r=>{r.track&&(e&&(r.options=Object.assign(Object.assign({},r.options),e)),n.push(r))}),yield Promise.all(n.map(r=>re(this,void 0,void 0,function*(){const s=r.track;yield this.unpublishTrack(s,!1),t&&!s.isMuted&&(s instanceof fi||s instanceof vi)&&!s.isUserProvided&&(G.debug("restarting existing track",{track:r.trackSid}),yield s.restartTrack()),yield this.publishTrack(s,r.options)})))})}publishData(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return re(this,void 0,void 0,function*(){const r=Array.isArray(n)?n:n==null?void 0:n.destination,s=[],l=Array.isArray(n)?void 0:n.topic;r!==void 0&&r.forEach(o=>{o instanceof Ms?s.push(o.sid):s.push(o)});const a=new Hi({kind:t,value:{case:"user",value:new Gi({participantSid:this.sid,payload:e,destinationSids:s,topic:l})}});yield this.engine.sendDataPacket(a,t)})}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isConnected&&this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(t=>{var n,r;const s=this.tracks.get(t.sid);if(s){const l=s.isMuted||((r=(n=s.track)===null||n===void 0?void 0:n.isUpstreamPaused)!==null&&r!==void 0?r:!1);l!==t.muted&&(G.debug("updating server mute state after reconcile",{sid:t.sid,muted:l}),this.engine.client.sendMuteTrack(t.sid,l))}}),!0)}getPublicationForTrack(e){let t;return this.tracks.forEach(n=>{const r=n.track;r&&(e instanceof MediaStreamTrack?(r instanceof fi||r instanceof vi)&&r.mediaStreamTrack===e&&(t=n):e===r&&(t=n))}),t}publishedTracksInfo(){const e=[];return this.tracks.forEach(t=>{t.track!==void 0&&e.push(new Li({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}dataChannelsInfo(){const e=[],t=(n,r)=>{(n==null?void 0:n.id)!==void 0&&n.id!==null&&e.push(new on({label:n.label,id:n.id,target:r}))};return t(this.engine.dataChannelForKind(Yt.LOSSY),mi.PUBLISHER),t(this.engine.dataChannelForKind(Yt.RELIABLE),mi.PUBLISHER),t(this.engine.dataChannelForKind(Yt.LOSSY,!0),mi.SUBSCRIBER),t(this.engine.dataChannelForKind(Yt.RELIABLE,!0),mi.SUBSCRIBER),e}}var kt;(function(i){i.Disconnected="disconnected",i.Connecting="connecting",i.Connected="connected",i.Reconnecting="reconnecting"})(kt||(kt={}));const H1=2*1e3;class cm extends fn.EventEmitter{constructor(e){var t,n;super(),t=this,this.state=kt.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.connect=(r,s,l)=>re(this,void 0,void 0,function*(){var a;const o=yield this.disconnectLock.lock();if(this.state===kt.Connected)return G.info("already connected to room ".concat(this.name)),o(),Promise.resolve();if(this.connectFuture)return o(),this.connectFuture.promise;this.setAndEmitConnectionState(kt.Connecting),((a=this.regionUrlProvider)===null||a===void 0?void 0:a.getServerUrl().toString())!==r&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Lc(new URL(r))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Ku(r,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(u=>{G.warn("could not fetch region settings",{error:u})}));const c=(u,d,h)=>re(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const p=new AbortController;this.abortController=p,o==null||o();try{yield this.attemptConnection(h??r,s,l,p),this.abortController=void 0,u()}catch(g){if(this.regionUrlProvider&&g instanceof It&&g.reason!==3&&g.reason!==0){let v=null;try{v=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(b){if(b instanceof It&&(b.status===401||b.reason===3)){d(b);return}}v?(G.info("Initial connection failed with ConnectionError: ".concat(g.message,". Retrying with another region: ").concat(v)),yield c(u,d,v)):d(g)}else d(g)}}),f=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Jd((u,d)=>{c(u,d,f)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(r,s,l,a,o,c)=>re(this,void 0,void 0,function*(){const f=yield l.join(r,s,{autoSubscribe:a.autoSubscribe,publishOnly:a.publishOnly,adaptiveStream:typeof o.adaptiveStream=="object"?!0:o.adaptiveStream,maxRetries:a.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:a.websocketTimeout},c.signal);let u=f.serverInfo;if(u||(u={version:f.serverVersion,region:f.serverRegion}),G.debug("connected to Livekit Server ".concat(Object.entries(u).map(d=>{let[h,m]=d;return"".concat(h,": ").concat(m)}).join(", "))),!f.serverVersion)throw new N_("unknown server version");return f.serverVersion==="0.15.1"&&this.options.dynacast&&(G.debug("disabling dynacast due to server version"),o.dynacast=!1),f}),this.applyJoinResponse=r=>{const s=r.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...r.otherParticipants]),r.room&&this.handleRoomUpdate(r.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(r.sifTrailer)},this.attemptConnection=(r,s,l,a)=>re(this,void 0,void 0,function*(){var o,c;this.state===kt.Reconnecting?(G.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),!((o=this.regionUrlProvider)===null||o===void 0)&&o.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},em),l),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const f=yield this.connectSignal(r,s,this.engine,this.connOptions,this.options,a);this.applyJoinResponse(f),this.setupLocalParticipantEvents(),this.emit(Ae.SignalConnected)}catch(f){this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish);const u=new It("could not establish signal connection");throw f instanceof Error&&(u.message="".concat(u.message,": ").concat(f.message)),f instanceof It&&(u.reason=f.reason,u.status=f.status),G.debug("error trying to establish signal connection",{error:f}),u}if(a.signal.aborted)throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),new It("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,a)}catch(f){throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f}gi()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),gi()&&(document.addEventListener("freeze",this.onPageLeave),(c=navigator.mediaDevices)===null||c===void 0||c.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(kt.Connected),this.emit(Ae.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return re(t,void 0,void 0,function*(){var s,l,a,o;const c=yield this.disconnectLock.lock();try{if(this.state===kt.Disconnected){G.debug("already disconnected");return}G.info("disconnect from room",{identity:this.localParticipant.identity}),(this.state===kt.Connecting||this.state===kt.Reconnecting)&&(G.warn("abort connection attempt"),(s=this.abortController)===null||s===void 0||s.abort(),(a=(l=this.connectFuture)===null||l===void 0?void 0:l.reject)===null||a===void 0||a.call(l,new It("Client initiated disconnect")),this.connectFuture=void 0),!((o=this.engine)===null||o===void 0)&&o.client.isConnected&&(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(r,Wn.CLIENT_INITIATED),this.engine=void 0}finally{c()}})},this.onPageLeave=()=>re(this,void 0,void 0,function*(){yield this.disconnect()}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const r of this.participants.values())this.handleParticipantDisconnected(r.sid,r);this.setAndEmitConnectionState(kt.Reconnecting)&&this.emit(Ae.Reconnecting)},this.handleSignalRestarted=r=>re(this,void 0,void 0,function*(){G.debug("signal reconnected to server",{region:r.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(r);try{const s=[];this.localParticipant.tracks.forEach(l=>{l.track&&s.push(l)}),yield Promise.all(s.map(l=>re(this,void 0,void 0,function*(){const a=l.track;this.localParticipant.unpublishTrack(a,!1),a.isMuted||((a instanceof fi||a instanceof vi)&&a.source!==ke.Source.ScreenShare&&a.source!==ke.Source.ScreenShareAudio&&!a.isUserProvided&&(G.debug("restarting existing track",{track:l.trackSid}),yield a.restartTrack()),G.debug("publishing new track",{track:l.trackSid}),yield this.localParticipant.publishTrack(a,l.options))})))}catch(s){G.error("error trying to re-publish tracks after reconnection",{error:s})}try{yield this.engine.waitForRestarted(),G.debug("fully reconnected to server",{region:r.serverRegion})}catch{return}this.setAndEmitConnectionState(kt.Connected),this.emit(Ae.Reconnected),this.registerConnectionReconcile(),this.participants.forEach(s=>{this.emit(Ae.ParticipantConnected,s)})}),this.handleParticipantUpdates=r=>{r.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const l=this.identityToSid.get(s.identity);l&&l!==s.sid&&this.handleParticipantDisconnected(l,this.participants.get(l));let a=this.participants.get(s.sid);const o=!a;s.state===br.DISCONNECTED?this.handleParticipantDisconnected(s.sid,a):(a=this.getOrCreateParticipant(s.sid,s),o||a.updateInfo(s))})},this.handleActiveSpeakersUpdate=r=>{const s=[],l={};r.forEach(a=>{if(l[a.sid]=!0,a.sid===this.localParticipant.sid)this.localParticipant.audioLevel=a.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const o=this.participants.get(a.sid);o&&(o.audioLevel=a.level,o.setIsSpeaking(!0),s.push(o))}}),l[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(a=>{l[a.sid]||(a.audioLevel=0,a.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(Ae.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=r=>{const s=new Map;this.activeSpeakers.forEach(a=>{s.set(a.sid,a)}),r.forEach(a=>{let o=this.participants.get(a.sid);a.sid===this.localParticipant.sid&&(o=this.localParticipant),o&&(o.audioLevel=a.level,o.setIsSpeaking(a.active),a.active?s.set(a.sid,o):s.delete(a.sid))});const l=Array.from(s.values());l.sort((a,o)=>o.audioLevel-a.audioLevel),this.activeSpeakers=l,this.emitWhenConnected(Ae.ActiveSpeakersChanged,l)},this.handleStreamStateUpdate=r=>{r.streamStates.forEach(s=>{const l=this.participants.get(s.participantSid);if(!l)return;const a=l.getTrackPublication(s.trackSid);!a||!a.track||(a.track.streamState=ke.streamStateFromProto(s.state),l.emit(Ne.TrackStreamStateChanged,a,a.track.streamState),this.emitWhenConnected(Ae.TrackStreamStateChanged,a,a.track.streamState,l))})},this.handleSubscriptionPermissionUpdate=r=>{const s=this.participants.get(r.participantSid);if(!s)return;const l=s.getTrackPublication(r.trackSid);l&&l.setAllowed(r.allowed)},this.handleSubscriptionError=r=>{const s=Array.from(this.participants.values()).find(a=>a.tracks.has(r.trackSid));if(!s)return;const l=s.getTrackPublication(r.trackSid);l&&l.setSubscriptionError(r.err)},this.handleDataPacket=(r,s)=>{const l=this.participants.get(r.participantSid);this.emit(Ae.DataReceived,r.payload,l,s,r.topic),l==null||l.emit(Ne.DataReceived,r.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Ae.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=r=>{G.warn("could not playback audio",r),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Ae.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>re(this,void 0,void 0,function*(){this.emit(Ae.MediaDevicesChanged)}),this.handleRoomUpdate=r=>{const s=this.roomInfo;this.roomInfo=r,s&&s.metadata!==r.metadata&&this.emitWhenConnected(Ae.RoomMetadataChanged,r.metadata),(s==null?void 0:s.activeRecording)!==r.activeRecording&&this.emitWhenConnected(Ae.RecordingStatusChanged,r.activeRecording)},this.handleConnectionQualityUpdate=r=>{r.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const l=this.participants.get(s.participantSid);l&&l.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=r=>{this.emit(Ae.ParticipantMetadataChanged,r,this.localParticipant)},this.onLocalParticipantNameChanged=r=>{this.emit(Ae.ParticipantNameChanged,r,this.localParticipant)},this.onLocalTrackMuted=r=>{this.emit(Ae.TrackMuted,r,this.localParticipant)},this.onLocalTrackUnmuted=r=>{this.emit(Ae.TrackUnmuted,r,this.localParticipant)},this.onLocalTrackPublished=r=>re(this,void 0,void 0,function*(){var s;this.emit(Ae.LocalTrackPublished,r,this.localParticipant),r.track instanceof fi&&(yield r.track.checkForSilence())&&this.emit(Ae.LocalAudioSilenceDetected,r);const l=yield(s=r.track)===null||s===void 0?void 0:s.getDeviceId(),a=Y_(r.source);a&&l&&l!==this.localParticipant.activeDeviceMap.get(a)&&(this.localParticipant.activeDeviceMap.set(a,l),this.emit(Ae.ActiveDeviceChanged,a,l))}),this.onLocalTrackUnpublished=r=>{this.emit(Ae.LocalTrackUnpublished,r,this.localParticipant)},this.onLocalConnectionQualityChanged=r=>{this.emit(Ae.ConnectionQualityChanged,r,this.localParticipant)},this.onMediaDevicesError=r=>{this.emit(Ae.MediaDevicesError,r)},this.onLocalParticipantPermissionsChanged=r=>{this.emit(Ae.ParticipantPermissionsChanged,r,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},O1),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},Zd),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},$d),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},E1),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Xn,this.localParticipant=new rf("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",pr(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",pr(this.options.audioCaptureDefaults.deviceId)),!((n=this.options.audioOutput)===null||n===void 0)&&n.deviceId&&this.switchActiveDevice("audiooutput",pr(this.options.audioOutput.deviceId)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return re(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new v1(this.options.e2ee),this.e2eeManager.on(nr.ParticipantEncryptionStatusChanged,(t,n)=>{n instanceof rf&&(this.isE2EEEnabled=t),this.emit(Ae.ParticipantEncryptionStatusChanged,t,n)}),this.e2eeManager.on(nr.EncryptionError,t=>this.emit(Ae.EncryptionError,t)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}get sid(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&t!==void 0?t:""}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new A1(this.options),this.engine.on(Ue.ParticipantUpdate,this.handleParticipantUpdates).on(Ue.RoomUpdate,this.handleRoomUpdate).on(Ue.SpeakersChanged,this.handleSpeakersChanged).on(Ue.StreamStateChanged,this.handleStreamStateUpdate).on(Ue.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Ue.SubscriptionError,this.handleSubscriptionError).on(Ue.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Ue.MediaTrackAdded,(e,t,n)=>{this.onTrackAdded(e,t,n)}).on(Ue.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Ue.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Ue.DataPacketReceived,this.handleDataPacket).on(Ue.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(kt.Reconnecting)&&this.emit(Ae.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())}).on(Ue.Resumed,()=>{this.setAndEmitConnectionState(kt.Connected),this.emit(Ae.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),Array.from(this.participants.values()).filter(t=>!this.cachedParticipantSids.includes(t.sid)).forEach(t=>this.emit(Ae.ParticipantConnected,t)),this.cachedParticipantSids=[]}).on(Ue.SignalResumed,()=>{this.state===kt.Reconnecting&&this.sendSyncState()}).on(Ue.Restarting,this.handleRestarting).on(Ue.SignalRestarted,this.handleSignalRestarted).on(Ue.DCBufferStatusChanged,(e,t)=>{this.emit(Ae.DCBufferStatusChanged,e,t)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return oi.getInstance().getDevices(e,t)}prepareConnection(e,t){return re(this,void 0,void 0,function*(){if(this.state===kt.Disconnected){G.debug("prepareConnection to ".concat(e));try{if(Lc(new URL(e))&&t){this.regionUrlProvider=new Ku(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===kt.Disconnected&&(this.regionUrl=n,yield fetch(Bu(n),{method:"HEAD"}),G.debug("prepared connection to ".concat(n)))}else yield fetch(Bu(e),{method:"HEAD"})}catch(n){G.warn("could not prepare connection",{error:n})}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);if(t)return this.participants.get(t)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return re(this,void 0,void 0,function*(){let n=()=>{},r;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":r=new si({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":r=new si({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":r=new si({scenario:{case:"serverLeave",value:!0}});break;case"migration":r=new si({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":r=new si({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),n=()=>re(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Pi({reason:Wn.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");r=new si({scenario:{case:"subscriberBandwidth",value:BigInt(t)}});break}r&&(this.engine.client.sendSimulateScenario(r),n())})}startAudio(){return re(this,void 0,void 0,function*(){const e=[],t=Kr();if(t&&t.os==="iOS"){const n="livekit-dummy-audio-el";let r=document.getElementById(n);if(!r){r=document.createElement("audio"),r.id=n,r.autoplay=!0,r.hidden=!0;const s=Xa();s.enabled=!0;const l=new MediaStream([s]);r.srcObject=l,document.addEventListener("visibilitychange",()=>{r&&(r.srcObject=document.hidden?null:l)}),document.body.append(r),this.once(Ae.Disconnected,()=>{r==null||r.remove()})}e.push(r)}this.participants.forEach(n=>{n.audioTracks.forEach(r=>{r.track&&r.track.attachedElements.forEach(s=>{e.push(s)})})});try{yield Promise.all([this.acquireAudioContext(),...e.map(n=>(n.muted=!1,n.play()))]),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}})}get canPlaybackAudio(){return this.audioEnabled}getActiveAudioOutputDevice(){var e,t;return(t=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&t!==void 0?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var r,s,l;return re(this,void 0,void 0,function*(){let a=!1,o=!0;const c=n?{exact:t}:t;if(e==="audioinput"){const f=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=f!==c;const u=Array.from(this.localParticipant.audioTracks.values()).filter(d=>d.source===ke.Source.Microphone);try{o=(yield Promise.all(u.map(d=>{var h;return(h=d.audioTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(d=>d===!0)}catch(d){throw this.options.audioCaptureDefaults.deviceId=f,d}}else if(e==="videoinput"){const f=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=f!==c;const u=Array.from(this.localParticipant.videoTracks.values()).filter(d=>d.source===ke.Source.Camera);try{o=(yield Promise.all(u.map(d=>{var h;return(h=d.videoTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(d=>d===!0)}catch(d){throw this.options.videoCaptureDefaults.deviceId=f,d}}else if(e==="audiooutput"){if(!Ic()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(r=(l=this.options).audioOutput)!==null&&r!==void 0||(l.audioOutput={});const f=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,a=f!==c;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map(u=>u.setAudioOutput({deviceId:t})))}catch(u){throw this.options.audioOutput.deviceId=f,u}}return a&&o&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(Ae.ActiveDeviceChanged,e,t)),o})}setupLocalParticipantEvents(){this.localParticipant.on(Ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Ne.TrackMuted,this.onLocalTrackMuted).on(Ne.TrackUnmuted,this.onLocalTrackUnmuted).on(Ne.LocalTrackPublished,this.onLocalTrackPublished).on(Ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Ne.MediaDevicesError,this.onMediaDevicesError).on(Ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===kt.Connecting||this.state===kt.Reconnecting){const c=()=>{this.onTrackAdded(e,t,n),f()},f=()=>{this.off(Ae.Reconnected,c),this.off(Ae.Connected,c),this.off(Ae.Disconnected,f)};this.once(Ae.Reconnected,c),this.once(Ae.Connected,c),this.once(Ae.Disconnected,f);return}if(this.state===kt.Disconnected){G.warn("skipping incoming track after Room disconnected");return}const r=q_(t.id),s=r[0];let l=r[1];if((!l||l==="")&&(l=e.id),s===this.localParticipant.sid){G.warn("tried to create RemoteParticipant for local participant");return}const a=this.participants.get(s);if(!a){G.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s));return}let o;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?o=this.options.adaptiveStream:o={}),a.addSubscribedMediaTrack(e,l,t,n,o)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.state!==kt.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(r=>{r.tracks.forEach(s=>{r.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(r=>{var s,l;r.track&&this.localParticipant.unpublishTrack(r.track,e),e&&((s=r.track)===null||s===void 0||s.detach(),(l=r.track)===null||l===void 0||l.stop())}),this.localParticipant.off(Ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Ne.TrackMuted,this.onLocalTrackMuted).off(Ne.TrackUnmuted,this.onLocalTrackUnmuted).off(Ne.LocalTrackPublished,this.onLocalTrackPublished).off(Ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Ne.MediaDevicesError,this.onMediaDevicesError).off(Ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),gi()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(n=navigator.mediaDevices)===null||n===void 0||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(kt.Disconnected),this.emit(Ae.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach(n=>{t.unpublishTrack(n.trackSid,!0)}),this.emit(Ae.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return re(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Wd())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(r){G.warn(r)}this.options.expWebAudioMix&&this.participants.forEach(r=>r.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const n=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(Ae.AudioPlaybackStatusChanged,n))})}createParticipant(e,t){let n;return t?n=Ms.fromParticipantInfo(this.engine.client,t):n=new Ms(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&n.setAudioContext(this.audioContext),n}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const n=this.createParticipant(e,t);return this.participants.set(e,n),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(Ae.ParticipantConnected,n),n.on(Ne.TrackPublished,r=>{this.emitWhenConnected(Ae.TrackPublished,r,n)}).on(Ne.TrackSubscribed,(r,s)=>{r.kind===ke.Kind.Audio&&(r.on(Me.AudioPlaybackStarted,this.handleAudioPlaybackStarted),r.on(Me.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(Ae.TrackSubscribed,r,s,n)}).on(Ne.TrackUnpublished,r=>{this.emit(Ae.TrackUnpublished,r,n)}).on(Ne.TrackUnsubscribed,(r,s)=>{this.emit(Ae.TrackUnsubscribed,r,s,n)}).on(Ne.TrackSubscriptionFailed,r=>{this.emit(Ae.TrackSubscriptionFailed,r,n)}).on(Ne.TrackMuted,r=>{this.emitWhenConnected(Ae.TrackMuted,r,n)}).on(Ne.TrackUnmuted,r=>{this.emitWhenConnected(Ae.TrackUnmuted,r,n)}).on(Ne.ParticipantMetadataChanged,r=>{this.emitWhenConnected(Ae.ParticipantMetadataChanged,r,n)}).on(Ne.ParticipantNameChanged,r=>{this.emitWhenConnected(Ae.ParticipantNameChanged,r,n)}).on(Ne.ConnectionQualityChanged,r=>{this.emitWhenConnected(Ae.ConnectionQualityChanged,r,n)}).on(Ne.ParticipantPermissionsChanged,r=>{this.emitWhenConnected(Ae.ParticipantPermissionsChanged,r,n)}).on(Ne.TrackSubscriptionStatusChanged,(r,s)=>{this.emitWhenConnected(Ae.TrackSubscriptionStatusChanged,r,s,n)}).on(Ne.TrackSubscriptionFailed,(r,s)=>{this.emit(Ae.TrackSubscriptionFailed,r,n,s)}).on(Ne.TrackSubscriptionPermissionChanged,(r,s)=>{this.emitWhenConnected(Ae.TrackSubscriptionPermissionChanged,r,s,n)}),t&&n.updateInfo(t),n}sendSyncState(){var e,t;if(this.engine.subscriber===void 0||this.engine.subscriber.pc.localDescription===null)return;const n=this.engine.subscriber.pc.localDescription,r=this.engine.subscriber.pc.remoteDescription,s=(t=(e=this.connOptions)===null||e===void 0?void 0:e.autoSubscribe)!==null&&t!==void 0?t:!0,l=new Array;this.participants.forEach(a=>{a.tracks.forEach(o=>{o.isDesired!==s&&l.push(o.trackSid)})}),this.engine.client.sendSyncState(new sn({answer:Eo({sdp:n.sdp,type:n.type}),offer:r?Eo({sdp:r.sdp,type:r.type}):void 0,subscription:new wi({trackSids:l,subscribe:!s,participantTracks:[]}),publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()}))}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof am&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=$t.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,G.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Wn.STATE_MISMATCH))):e=0},H1)}clearConnectionReconcile(){this.connectionReconcileInterval&&$t.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Ae.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===kt.Connected){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.emit(e,...n)}return!1}simulateParticipants(e){var t,n;return re(this,void 0,void 0,function*(){const r=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Jr({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:ot.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new yi({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Ae.SignalConnected),this.emit(Ae.Connected),this.setAndEmitConnectionState(kt.Connected),r.video){const l=new Oo(ke.Kind.Video,new di({source:Bt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Zt.AUDIO,name:"video-dummy"}),new vi(r.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Fu((t=160*s.aspectRatios[0])!==null&&t!==void 0?t:1,160,!0,!0)));this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ne.LocalTrackPublished,l)}if(r.audio){const l=new Oo(ke.Kind.Audio,new di({source:Bt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Zt.AUDIO}),new fi(r.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Xa()));this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ne.LocalTrackPublished,l)}for(let l=0;l<s.count-1;l+=1){let a=new yi({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:br.ACTIVE,tracks:[],joinedAt:ot.parse(Date.now())});const o=this.getOrCreateParticipant(a.identity,a);if(s.video){const c=Fu((n=160*s.aspectRatios[l%s.aspectRatios.length])!==null&&n!==void 0?n:1,160,!1,!0),f=new di({source:Bt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Zt.AUDIO});o.addSubscribedMediaTrack(c,f.sid,new MediaStream([c])),a.tracks=[...a.tracks,f]}if(s.audio){const c=Xa(),f=new di({source:Bt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Zt.AUDIO});o.addSubscribedMediaTrack(c,f.sid,new MediaStream([c])),a.tracks=[...a.tracks,f]}o.updateInfo(a)}})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e!==Ae.ActiveSpeakersChanged&&G.debug("room event ".concat(e),{event:e,args:n}),super.emit(e,...n)}}var Ai;(function(i){i[i.IDLE=0]="IDLE",i[i.RUNNING=1]="RUNNING",i[i.SKIPPED=2]="SKIPPED",i[i.SUCCESS=3]="SUCCESS",i[i.FAILED=4]="FAILED"})(Ai||(Ai={}));class Qr extends fn.EventEmitter{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Ai.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=t,this.name=this.constructor.name,this.room=new cm(n.roomOptions),this.connectOptions=n.connectOptions,n.errorsAsWarnings&&(this.errorsAsWarnings=n.errorsAsWarnings)}run(e){return re(this,void 0,void 0,function*(){if(this.status!==Ai.IDLE)throw Error("check is running already");this.setStatus(Ai.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==Ai.SKIPPED&&this.setStatus(this.isSuccess()?Ai.SUCCESS:Ai.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return re(this,void 0,void 0,function*(){return this.room.state===kt.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return re(this,void 0,void 0,function*(){this.room&&this.room.state!==kt.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Ai.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function lm(i){var e,t;return re(this,void 0,void 0,function*(){i??(i={}),(e=i.audio)!==null&&e!==void 0||(i.audio=!0),(t=i.video)!==null&&t!==void 0||(i.video=!0);const n=zd(i,Zd,$d),r=jo(n),s=navigator.mediaDevices.getUserMedia(r);i.audio&&(oi.userMediaPromiseMap.set("audioinput",s),s.catch(()=>oi.userMediaPromiseMap.delete("audioinput"))),i.video&&(oi.userMediaPromiseMap.set("videoinput",s),s.catch(()=>oi.userMediaPromiseMap.delete("videoinput")));const l=yield s;return l.getTracks().map(a=>{const o=a.kind==="audio";o?i.audio:i.video;let c;const f=o?r.audio:r.video;typeof f!="boolean"&&(c=f),c?c.deviceId=a.getSettings().deviceId:c={deviceId:a.getSettings().deviceId};const u=tm(a,c);return u.kind===ke.Kind.Video?u.source=ke.Source.Camera:u.kind===ke.Kind.Audio&&(u.source=ke.Source.Microphone),u.mediaStream=l,u})})}function Y1(i){return re(this,void 0,void 0,function*(){return(yield lm({audio:!1,video:i}))[0]})}function G1(i){return re(this,void 0,void 0,function*(){return(yield lm({audio:i,video:!1}))[0]})}class J1 extends Qr{get description(){return"Can publish audio"}perform(){var e;return re(this,void 0,void 0,function*(){const t=yield this.connect(),n=yield G1();t.localParticipant.publishTrack(n),yield new Promise(l=>setTimeout(l,3e3));const r=yield(e=n.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(l=>{l.type==="outbound-rtp"&&l.mediaType==="audio"&&(s=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class q1 extends Qr{get description(){return"Can publish video"}perform(){var e;return re(this,void 0,void 0,function*(){const t=yield this.connect(),n=yield Y1();t.localParticipant.publishTrack(n),yield new Promise(l=>setTimeout(l,3e3));const r=yield(e=n.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(l=>{l.type==="outbound-rtp"&&l.mediaType==="video"&&(s=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class K1 extends Qr{get description(){return"Resuming connection after interruption"}perform(){var e;return re(this,void 0,void 0,function*(){const t=yield this.connect();let n=!1,r=!1,s;const l=new Promise(o=>{setTimeout(o,5e3),s=o});t.on(Ae.Reconnecting,()=>{n=!0}).on(Ae.Reconnected,()=>{r=!0,s(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const a=t.engine.client.onClose;if(a&&a(""),yield l,n){if(!r||t.state!==kt.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Q1 extends Qr{get description(){return"Can connect via TURN"}perform(){var e,t;return re(this,void 0,void 0,function*(){const n=new al,r=yield n.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,l=!1,a=!1;for(let o of r.iceServers)for(let c of o.urls)c.startsWith("turn:")?(l=!0,a=!0):c.startsWith("turns:")&&(l=!0,a=!0,s=!0),c.startsWith("stun:")&&(a=!0);a?l&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield n.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||l?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(o=>setTimeout(o,0)))})}}class Z1 extends Qr{get description(){return"Establishing WebRTC connection"}perform(){return re(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Ae.SignalConnected,()=>{const n=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(r,s)=>{if(r.candidate){const l=new RTCIceCandidate(r);let a="".concat(l.protocol," ").concat(l.address,":").concat(l.port," ").concat(l.type);l.address&&($1(l.address)?a+=" (private)":l.protocol==="tcp"&&l.tcpType==="passive"?(e=!0,a+=" (passive)"):l.protocol==="udp"&&(t=!0)),this.appendMessage(a)}n&&n(r,s)},this.room.engine.subscriber&&(this.room.engine.subscriber.pc.onicecandidateerror=r=>{r instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(r.errorCode," ").concat(r.errorText," ").concat(r.url))})});try{yield this.connect(),G.info("now the room is connected")}catch(n){throw this.appendWarning("ports need to be open on firewall in order to connect."),n}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function $1(i){const e=i.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class eC extends Qr{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,t,n;return re(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let r=new al;const s=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Xr.Cloud&&(!((t=s.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((n=s.serverInfo)===null||n===void 0?void 0:n.region)),yield r.close()})}}class VT extends fn.EventEmitter{constructor(e,t){super(),this.checkResults=new Map,this.url=e,this.token=t}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Ai.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Ai.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return re(this,void 0,void 0,function*(){const t=this.getNextCheckId(),n=new e(this.url,this.token),r=l=>{this.updateCheck(t,l)};n.on("update",r);const s=yield n.run();return n.off("update",r),s})}checkWebsocket(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(eC)})}checkWebRTC(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(Z1)})}checkTURN(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(Q1)})}checkReconnect(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(K1)})}checkPublishAudio(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(J1)})}checkPublishVideo(){return re(this,void 0,void 0,function*(){return this.createAndRunCheck(q1)})}}var Wi={};const tC={},iC=Object.freeze(Object.defineProperty({__proto__:null,default:tC},Symbol.toStringTag,{value:"Module"})),qa=Tg(iC);(function(i){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var e=e||{version:"5.3.0"};if(i.fabric=e,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?e.document=document:e.document=document.implementation.createHTMLDocument(""),e.window=window;else{var t=qa,n=new t.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;e.document=n.document,e.jsdomImplForWrapper=qa.implForWrapper,e.nodeCanvas=qa.Canvas,e.window=n,DOMParser=e.window.DOMParser}e.isTouchSupported="ontouchstart"in e.window||"ontouchstart"in e.document||e.window&&e.window.navigator&&e.window.navigator.maxTouchPoints>0,e.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",e.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],e.DPI=96,e.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",e.commaWsp="(?:\\s+,?\\s*|,\\s*)",e.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,e.reNonWord=/[ \n\.,;!\?\-]/,e.fontPaths={},e.iMatrix=[1,0,0,1,0,0],e.svgNS="http://www.w3.org/2000/svg",e.perfLimitSizeTotal=2097152,e.maxCacheSideLimit=4096,e.minCacheSideLimit=256,e.charWidthsCache={},e.textureSize=2048,e.disableStyleCopyPaste=!1,e.enableGLFiltering=!0,e.devicePixelRatio=e.window.devicePixelRatio||e.window.webkitDevicePixelRatio||e.window.mozDevicePixelRatio||1,e.browserShadowBlurConstant=1,e.arcToSegmentsCache={},e.boundsOfCurveCache={},e.cachesBoundsOfCurve=!0,e.forceGLPutImageData=!1,e.initFilterBackend=function(){if(e.enableGLFiltering&&e.isWebglSupported&&e.isWebglSupported(e.textureSize))return console.log("max texture size: "+e.maxTextureSize),new e.WebglFilterBackend({tileSize:e.textureSize});if(e.Canvas2dFilterBackend)return new e.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=e),function(){function a(h,m){if(this.__eventListeners[h]){var p=this.__eventListeners[h];m?p[p.indexOf(m)]=!1:e.util.array.fill(p,!1)}}function o(h,m){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var p in h)this.on(p,h[p]);else this.__eventListeners[h]||(this.__eventListeners[h]=[]),this.__eventListeners[h].push(m);return this}function c(h,m){var p=(function(){m.apply(this,arguments),this.off(h,p)}).bind(this);this.on(h,p)}function f(h,m){if(arguments.length===1)for(var p in h)c.call(this,p,h[p]);else c.call(this,h,m);return this}function u(h,m){if(!this.__eventListeners)return this;if(arguments.length===0)for(h in this.__eventListeners)a.call(this,h);else if(arguments.length===1&&typeof arguments[0]=="object")for(var p in h)a.call(this,p,h[p]);else a.call(this,h,m);return this}function d(h,m){if(!this.__eventListeners)return this;var p=this.__eventListeners[h];if(!p)return this;for(var g=0,v=p.length;g<v;g++)p[g]&&p[g].call(this,m||{});return this.__eventListeners[h]=p.filter(function(b){return b!==!1}),this}e.Observable={fire:d,on:o,once:f,off:u}}(),e.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var a=0,o=arguments.length;a<o;a++)this._onObjectAdded(arguments[a]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(a,o,c){var f=this._objects;return c?f[o]=a:f.splice(o,0,a),this._onObjectAdded&&this._onObjectAdded(a),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var a=this._objects,o,c=!1,f=0,u=arguments.length;f<u;f++)o=a.indexOf(arguments[f]),o!==-1&&(c=!0,a.splice(o,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(a,o){for(var c=this.getObjects(),f=0,u=c.length;f<u;f++)a.call(o,c[f],f,c);return this},getObjects:function(a){return typeof a>"u"?this._objects.concat():this._objects.filter(function(o){return o.type===a})},item:function(a){return this._objects[a]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(a,o){return this._objects.indexOf(a)>-1?!0:o?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(a,!0)}):!1},complexity:function(){return this._objects.reduce(function(a,o){return a+=o.complexity?o.complexity():0,a},0)}},e.CommonMethods={_setOptions:function(a){for(var o in a)this.set(o,a[o])},_initGradient:function(a,o){a&&a.colorStops&&!(a instanceof e.Gradient)&&this.set(o,new e.Gradient(a))},_initPattern:function(a,o,c){a&&a.source&&!(a instanceof e.Pattern)?this.set(o,new e.Pattern(a,c)):c&&c()},_setObject:function(a){for(var o in a)this._set(o,a[o])},set:function(a,o){return typeof a=="object"?this._setObject(a):this._set(a,o),this},_set:function(a,o){this[a]=o},toggle:function(a){var o=this.get(a);return typeof o=="boolean"&&this.set(a,!o),this},get:function(a){return this[a]}},function(a){var o=Math.sqrt,c=Math.atan2,f=Math.pow,u=Math.PI/180,d=Math.PI/2;e.util={cos:function(h){if(h===0)return 1;h<0&&(h=-h);var m=h/d;switch(m){case 1:case 3:return 0;case 2:return-1}return Math.cos(h)},sin:function(h){if(h===0)return 0;var m=h/d,p=1;switch(h<0&&(p=-1),m){case 1:return p;case 2:return 0;case 3:return-p}return Math.sin(h)},removeFromArray:function(h,m){var p=h.indexOf(m);return p!==-1&&h.splice(p,1),h},getRandomInt:function(h,m){return Math.floor(Math.random()*(m-h+1))+h},degreesToRadians:function(h){return h*u},radiansToDegrees:function(h){return h/u},rotatePoint:function(h,m,p){var g=new e.Point(h.x-m.x,h.y-m.y),v=e.util.rotateVector(g,p);return new e.Point(v.x,v.y).addEquals(m)},rotateVector:function(h,m){var p=e.util.sin(m),g=e.util.cos(m),v=h.x*g-h.y*p,b=h.x*p+h.y*g;return{x:v,y:b}},createVector:function(h,m){return new e.Point(m.x-h.x,m.y-h.y)},calcAngleBetweenVectors:function(h,m){return Math.acos((h.x*m.x+h.y*m.y)/(Math.hypot(h.x,h.y)*Math.hypot(m.x,m.y)))},getHatVector:function(h){return new e.Point(h.x,h.y).multiply(1/Math.hypot(h.x,h.y))},getBisector:function(h,m,p){var g=e.util.createVector(h,m),v=e.util.createVector(h,p),b=e.util.calcAngleBetweenVectors(g,v),y=e.util.calcAngleBetweenVectors(e.util.rotateVector(g,b),v),_=b*(y===0?1:-1)/2;return{vector:e.util.getHatVector(e.util.rotateVector(g,_)),angle:b}},projectStrokeOnPoints:function(h,m,p){var g=[],v=m.strokeWidth/2,b=m.strokeUniform?new e.Point(1/m.scaleX,1/m.scaleY):new e.Point(1,1),y=function(_){var S=v/Math.hypot(_.x,_.y);return new e.Point(_.x*S*b.x,_.y*S*b.y)};return h.length<=1||h.forEach(function(_,S){var C=new e.Point(_.x,_.y),k,w;S===0?(w=h[S+1],k=p?y(e.util.createVector(w,C)).addEquals(C):h[h.length-1]):S===h.length-1?(k=h[S-1],w=p?y(e.util.createVector(k,C)).addEquals(C):h[0]):(k=h[S-1],w=h[S+1]);var A=e.util.getBisector(C,k,w),I=A.vector,z=A.angle,H,Q;if(m.strokeLineJoin==="miter"&&(H=-v/Math.sin(z/2),Q=new e.Point(I.x*H*b.x,I.y*H*b.y),Math.hypot(Q.x,Q.y)/v<=m.strokeMiterLimit)){g.push(C.add(Q)),g.push(C.subtract(Q));return}H=-v*Math.SQRT2,Q=new e.Point(I.x*H*b.x,I.y*H*b.y),g.push(C.add(Q)),g.push(C.subtract(Q))}),g},transformPoint:function(h,m,p){return p?new e.Point(m[0]*h.x+m[2]*h.y,m[1]*h.x+m[3]*h.y):new e.Point(m[0]*h.x+m[2]*h.y+m[4],m[1]*h.x+m[3]*h.y+m[5])},makeBoundingBoxFromPoints:function(h,m){if(m)for(var p=0;p<h.length;p++)h[p]=e.util.transformPoint(h[p],m);var g=[h[0].x,h[1].x,h[2].x,h[3].x],v=e.util.array.min(g),b=e.util.array.max(g),y=b-v,_=[h[0].y,h[1].y,h[2].y,h[3].y],S=e.util.array.min(_),C=e.util.array.max(_),k=C-S;return{left:v,top:S,width:y,height:k}},invertTransform:function(h){var m=1/(h[0]*h[3]-h[1]*h[2]),p=[m*h[3],-m*h[1],-m*h[2],m*h[0]],g=e.util.transformPoint({x:h[4],y:h[5]},p,!0);return p[4]=-g.x,p[5]=-g.y,p},toFixed:function(h,m){return parseFloat(Number(h).toFixed(m))},parseUnit:function(h,m){var p=/\D{0,2}$/.exec(h),g=parseFloat(h);switch(m||(m=e.Text.DEFAULT_SVG_FONT_SIZE),p[0]){case"mm":return g*e.DPI/25.4;case"cm":return g*e.DPI/2.54;case"in":return g*e.DPI;case"pt":return g*e.DPI/72;case"pc":return g*e.DPI/72*12;case"em":return g*m;default:return g}},falseFunction:function(){return!1},getKlass:function(h,m){return h=e.util.string.camelize(h.charAt(0).toUpperCase()+h.slice(1)),e.util.resolveNamespace(m)[h]},getSvgAttributes:function(h){var m=["instantiated_by_use","style","id","class"];switch(h){case"linearGradient":m=m.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":m=m.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":m=m.concat(["offset","stop-color","stop-opacity"]);break}return m},resolveNamespace:function(h){if(!h)return e;var m=h.split("."),p=m.length,g,v=a||e.window;for(g=0;g<p;++g)v=v[m[g]];return v},loadImage:function(h,m,p,g){if(!h){m&&m.call(p,h);return}var v=e.util.createImage(),b=function(){m&&m.call(p,v,!1),v=v.onload=v.onerror=null};v.onload=b,v.onerror=function(){e.log("Error loading "+v.src),m&&m.call(p,null,!0),v=v.onload=v.onerror=null},h.indexOf("data")!==0&&g!==void 0&&g!==null&&(v.crossOrigin=g),h.substring(0,14)==="data:image/svg"&&(v.onload=null,e.util.loadImageInDom(v,b)),v.src=h},loadImageInDom:function(h,m){var p=e.document.createElement("div");p.style.width=p.style.height="1px",p.style.left=p.style.top="-100%",p.style.position="absolute",p.appendChild(h),e.document.querySelector("body").appendChild(p),h.onload=function(){m(),p.parentNode.removeChild(p),p=null}},enlivenObjects:function(h,m,p,g){h=h||[];var v=[],b=0,y=h.length;function _(){++b===y&&m&&m(v.filter(function(S){return S}))}if(!y){m&&m(v);return}h.forEach(function(S,C){if(!S||!S.type){_();return}var k=e.util.getKlass(S.type,p);k.fromObject(S,function(w,A){A||(v[C]=w),g&&g(S,w,A),_()})})},enlivenObjectEnlivables:function(h,m,p){var g=e.Object.ENLIVEN_PROPS.filter(function(v){return!!h[v]});e.util.enlivenObjects(g.map(function(v){return h[v]}),function(v){var b={};g.forEach(function(y,_){b[y]=v[_],m&&(m[y]=v[_])}),p&&p(b)})},enlivenPatterns:function(h,m){h=h||[];function p(){++v===b&&m&&m(g)}var g=[],v=0,b=h.length;if(!b){m&&m(g);return}h.forEach(function(y,_){y&&y.source?new e.Pattern(y,function(S){g[_]=S,p()}):(g[_]=y,p())})},groupSVGElements:function(h,m,p){var g;return h&&h.length===1?(typeof p<"u"&&(h[0].sourcePath=p),h[0]):(m&&(m.width&&m.height?m.centerPoint={x:m.width/2,y:m.height/2}:(delete m.width,delete m.height)),g=new e.Group(h,m),typeof p<"u"&&(g.sourcePath=p),g)},populateWithProperties:function(h,m,p){if(p&&Array.isArray(p))for(var g=0,v=p.length;g<v;g++)p[g]in h&&(m[p[g]]=h[p[g]])},createCanvasElement:function(){return e.document.createElement("canvas")},copyCanvasElement:function(h){var m=e.util.createCanvasElement();return m.width=h.width,m.height=h.height,m.getContext("2d").drawImage(h,0,0),m},toDataURL:function(h,m,p){return h.toDataURL("image/"+m,p)},createImage:function(){return e.document.createElement("img")},multiplyTransformMatrices:function(h,m,p){return[h[0]*m[0]+h[2]*m[1],h[1]*m[0]+h[3]*m[1],h[0]*m[2]+h[2]*m[3],h[1]*m[2]+h[3]*m[3],p?0:h[0]*m[4]+h[2]*m[5]+h[4],p?0:h[1]*m[4]+h[3]*m[5]+h[5]]},qrDecompose:function(h){var m=c(h[1],h[0]),p=f(h[0],2)+f(h[1],2),g=o(p),v=(h[0]*h[3]-h[2]*h[1])/g,b=c(h[0]*h[2]+h[1]*h[3],p);return{angle:m/u,scaleX:g,scaleY:v,skewX:b/u,skewY:0,translateX:h[4],translateY:h[5]}},calcRotateMatrix:function(h){if(!h.angle)return e.iMatrix.concat();var m=e.util.degreesToRadians(h.angle),p=e.util.cos(m),g=e.util.sin(m);return[p,g,-g,p,0,0]},calcDimensionsMatrix:function(h){var m=typeof h.scaleX>"u"?1:h.scaleX,p=typeof h.scaleY>"u"?1:h.scaleY,g=[h.flipX?-m:m,0,0,h.flipY?-p:p,0,0],v=e.util.multiplyTransformMatrices,b=e.util.degreesToRadians;return h.skewX&&(g=v(g,[1,0,Math.tan(b(h.skewX)),1],!0)),h.skewY&&(g=v(g,[1,Math.tan(b(h.skewY)),0,1],!0)),g},composeMatrix:function(h){var m=[1,0,0,1,h.translateX||0,h.translateY||0],p=e.util.multiplyTransformMatrices;return h.angle&&(m=p(m,e.util.calcRotateMatrix(h))),(h.scaleX!==1||h.scaleY!==1||h.skewX||h.skewY||h.flipX||h.flipY)&&(m=p(m,e.util.calcDimensionsMatrix(h))),m},resetObjectTransform:function(h){h.scaleX=1,h.scaleY=1,h.skewX=0,h.skewY=0,h.flipX=!1,h.flipY=!1,h.rotate(0)},saveObjectTransform:function(h){return{scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,angle:h.angle,left:h.left,flipX:h.flipX,flipY:h.flipY,top:h.top}},isTransparent:function(h,m,p,g){g>0&&(m>g?m-=g:m=0,p>g?p-=g:p=0);var v=!0,b,y,_=h.getImageData(m,p,g*2||1,g*2||1),S=_.data.length;for(b=3;b<S&&(y=_.data[b],v=y<=0,v!==!1);b+=4);return _=null,v},parsePreserveAspectRatioAttribute:function(h){var m="meet",p="Mid",g="Mid",v=h.split(" "),b;return v&&v.length&&(m=v.pop(),m!=="meet"&&m!=="slice"?(b=m,m="meet"):v.length&&(b=v.pop())),p=b!=="none"?b.slice(1,4):"none",g=b!=="none"?b.slice(5,8):"none",{meetOrSlice:m,alignX:p,alignY:g}},clearFabricFontCache:function(h){h=(h||"").toLowerCase(),h?e.charWidthsCache[h]&&delete e.charWidthsCache[h]:e.charWidthsCache={}},limitDimsByArea:function(h,m){var p=Math.sqrt(m*h),g=Math.floor(m/p);return{x:Math.floor(p),y:g}},capValue:function(h,m,p){return Math.max(h,Math.min(m,p))},findScaleToFit:function(h,m){return Math.min(m.width/h.width,m.height/h.height)},findScaleToCover:function(h,m){return Math.max(m.width/h.width,m.height/h.height)},matrixToSVG:function(h){return"matrix("+h.map(function(m){return e.util.toFixed(m,e.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(h,m){var p=e.util.invertTransform(m),g=e.util.multiplyTransformMatrices(p,h.calcOwnMatrix());e.util.applyTransformToObject(h,g)},addTransformToObject:function(h,m){e.util.applyTransformToObject(h,e.util.multiplyTransformMatrices(m,h.calcOwnMatrix()))},applyTransformToObject:function(h,m){var p=e.util.qrDecompose(m),g=new e.Point(p.translateX,p.translateY);h.flipX=!1,h.flipY=!1,h.set("scaleX",p.scaleX),h.set("scaleY",p.scaleY),h.skewX=p.skewX,h.skewY=p.skewY,h.angle=p.angle,h.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(h,m,p){var g=h/2,v=m/2,b=[{x:-g,y:-v},{x:g,y:-v},{x:-g,y:v},{x:g,y:v}],y=e.util.calcDimensionsMatrix(p),_=e.util.makeBoundingBoxFromPoints(b,y);return{x:_.width,y:_.height}},mergeClipPaths:function(h,m){var p=h,g=m;p.inverted&&!g.inverted&&(p=m,g=h),e.util.applyTransformToObject(g,e.util.multiplyTransformMatrices(e.util.invertTransform(p.calcTransformMatrix()),g.calcTransformMatrix()));var v=p.inverted&&g.inverted;return v&&(p.inverted=g.inverted=!1),new e.Group([p],{clipPath:g,inverted:v})},hasStyleChanged:function(h,m,p){return p=p||!1,h.fill!==m.fill||h.stroke!==m.stroke||h.strokeWidth!==m.strokeWidth||h.fontSize!==m.fontSize||h.fontFamily!==m.fontFamily||h.fontWeight!==m.fontWeight||h.fontStyle!==m.fontStyle||h.textBackgroundColor!==m.textBackgroundColor||h.deltaY!==m.deltaY||p&&(h.overline!==m.overline||h.underline!==m.underline||h.linethrough!==m.linethrough)},stylesToArray:function(p,m){for(var p=e.util.object.clone(p,!0),g=m.split(`
`),v=-1,b={},y=[],_=0;_<g.length;_++){if(!p[_]){v+=g[_].length;continue}for(var S=0;S<g[_].length;S++){v++;var C=p[_][S];if(C&&Object.keys(C).length>0){var k=e.util.hasStyleChanged(b,C,!0);k?y.push({start:v,end:v+1,style:C}):y[y.length-1].end++}b=C||{}}}return y},stylesFromArray:function(h,m){if(!Array.isArray(h))return h;for(var p=m.split(`
`),g=-1,v=0,b={},y=0;y<p.length;y++)for(var _=0;_<p[y].length;_++)g++,h[v]&&h[v].start<=g&&g<h[v].end&&(b[y]=b[y]||{},b[y][_]=Object.assign({},h[v].style),g===h[v].end-1&&v++);return b}}}(i),function(){var a=Array.prototype.join,o={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function f(O,N,L,D,B,P,x,W,Y,ce,ne){var me=e.util.cos(O),pe=e.util.sin(O),q=e.util.cos(N),se=e.util.sin(N),J=L*B*q-D*P*se+x,de=D*B*q+L*P*se+W,fe=ce+Y*(-L*B*pe-D*P*me),oe=ne+Y*(-D*B*pe+L*P*me),ge=J+Y*(L*B*se+D*P*q),Se=de+Y*(D*B*se-L*P*q);return["C",fe,oe,ge,Se,J,de]}function u(O,N,L,D,B,P,x){var W=Math.PI,Y=x*W/180,ce=e.util.sin(Y),ne=e.util.cos(Y),me=0,pe=0;L=Math.abs(L),D=Math.abs(D);var q=-ne*O*.5-ce*N*.5,se=-ne*N*.5+ce*O*.5,J=L*L,de=D*D,fe=se*se,oe=q*q,ge=J*de-J*fe-de*oe,Se=0;if(ge<0){var Be=Math.sqrt(1-ge/(J*de));L*=Be,D*=Be}else Se=(B===P?-1:1)*Math.sqrt(ge/(J*fe+de*oe));var Te=Se*L*se/D,le=-Se*D*q/L,Ie=ne*Te-ce*le+O*.5,ze=ce*Te+ne*le+N*.5,$e=d(1,0,(q-Te)/L,(se-le)/D),ft=d((q-Te)/L,(se-le)/D,(-q-Te)/L,(-se-le)/D);P===0&&ft>0?ft-=2*W:P===1&&ft<0&&(ft+=2*W);for(var it=Math.ceil(Math.abs(ft/W*2)),dt=[],at=ft/it,Wt=8/3*Math.sin(at/4)*Math.sin(at/4)/Math.sin(at/2),Ut=$e+at,Xt=0;Xt<it;Xt++)dt[Xt]=f($e,Ut,ne,ce,L,D,Ie,ze,Wt,me,pe),me=dt[Xt][5],pe=dt[Xt][6],$e=Ut,Ut+=at;return dt}function d(O,N,L,D){var B=Math.atan2(N,O),P=Math.atan2(D,L);return P>=B?P-B:2*Math.PI-(B-P)}function h(O,N,L,D,B,P,x,W){var Y;if(e.cachesBoundsOfCurve&&(Y=a.call(arguments),e.boundsOfCurveCache[Y]))return e.boundsOfCurveCache[Y];var ce=Math.sqrt,ne=Math.min,me=Math.max,pe=Math.abs,q=[],se=[[],[]],J,de,fe,oe,ge,Se,Be,Te;de=6*O-12*L+6*B,J=-3*O+9*L-9*B+3*x,fe=3*L-3*O;for(var le=0;le<2;++le){if(le>0&&(de=6*N-12*D+6*P,J=-3*N+9*D-9*P+3*W,fe=3*D-3*N),pe(J)<1e-12){if(pe(de)<1e-12)continue;oe=-fe/de,0<oe&&oe<1&&q.push(oe);continue}Be=de*de-4*fe*J,!(Be<0)&&(Te=ce(Be),ge=(-de+Te)/(2*J),0<ge&&ge<1&&q.push(ge),Se=(-de-Te)/(2*J),0<Se&&Se<1&&q.push(Se))}for(var Ie,ze,$e=q.length,ft=$e,it;$e--;)oe=q[$e],it=1-oe,Ie=it*it*it*O+3*it*it*oe*L+3*it*oe*oe*B+oe*oe*oe*x,se[0][$e]=Ie,ze=it*it*it*N+3*it*it*oe*D+3*it*oe*oe*P+oe*oe*oe*W,se[1][$e]=ze;se[0][ft]=O,se[1][ft]=N,se[0][ft+1]=x,se[1][ft+1]=W;var dt=[{x:ne.apply(null,se[0]),y:ne.apply(null,se[1])},{x:me.apply(null,se[0]),y:me.apply(null,se[1])}];return e.cachesBoundsOfCurve&&(e.boundsOfCurveCache[Y]=dt),dt}function m(O,N,L){for(var D=L[1],B=L[2],P=L[3],x=L[4],W=L[5],Y=L[6],ce=L[7],ne=u(Y-O,ce-N,D,B,x,W,P),me=0,pe=ne.length;me<pe;me++)ne[me][1]+=O,ne[me][2]+=N,ne[me][3]+=O,ne[me][4]+=N,ne[me][5]+=O,ne[me][6]+=N;return ne}function p(O){var N=0,L=0,D=O.length,B=0,P=0,x,W,Y,ce=[],ne,me,pe;for(W=0;W<D;++W){switch(Y=!1,x=O[W].slice(0),x[0]){case"l":x[0]="L",x[1]+=N,x[2]+=L;case"L":N=x[1],L=x[2];break;case"h":x[1]+=N;case"H":x[0]="L",x[2]=L,N=x[1];break;case"v":x[1]+=L;case"V":x[0]="L",L=x[1],x[1]=N,x[2]=L;break;case"m":x[0]="M",x[1]+=N,x[2]+=L;case"M":N=x[1],L=x[2],B=x[1],P=x[2];break;case"c":x[0]="C",x[1]+=N,x[2]+=L,x[3]+=N,x[4]+=L,x[5]+=N,x[6]+=L;case"C":me=x[3],pe=x[4],N=x[5],L=x[6];break;case"s":x[0]="S",x[1]+=N,x[2]+=L,x[3]+=N,x[4]+=L;case"S":ne==="C"?(me=2*N-me,pe=2*L-pe):(me=N,pe=L),N=x[3],L=x[4],x[0]="C",x[5]=x[3],x[6]=x[4],x[3]=x[1],x[4]=x[2],x[1]=me,x[2]=pe,me=x[3],pe=x[4];break;case"q":x[0]="Q",x[1]+=N,x[2]+=L,x[3]+=N,x[4]+=L;case"Q":me=x[1],pe=x[2],N=x[3],L=x[4];break;case"t":x[0]="T",x[1]+=N,x[2]+=L;case"T":ne==="Q"?(me=2*N-me,pe=2*L-pe):(me=N,pe=L),x[0]="Q",N=x[1],L=x[2],x[1]=me,x[2]=pe,x[3]=N,x[4]=L;break;case"a":x[0]="A",x[6]+=N,x[7]+=L;case"A":Y=!0,ce=ce.concat(m(N,L,x)),N=x[6],L=x[7];break;case"z":case"Z":N=B,L=P;break}Y||ce.push(x),ne=x[0]}return ce}function g(O,N,L,D){return Math.sqrt((L-O)*(L-O)+(D-N)*(D-N))}function v(O){return O*O*O}function b(O){return 3*O*O*(1-O)}function y(O){return 3*O*(1-O)*(1-O)}function _(O){return(1-O)*(1-O)*(1-O)}function S(O,N,L,D,B,P,x,W){return function(Y){var ce=v(Y),ne=b(Y),me=y(Y),pe=_(Y);return{x:x*ce+B*ne+L*me+O*pe,y:W*ce+P*ne+D*me+N*pe}}}function C(O,N,L,D,B,P,x,W){return function(Y){var ce=1-Y,ne=3*ce*ce*(L-O)+6*ce*Y*(B-L)+3*Y*Y*(x-B),me=3*ce*ce*(D-N)+6*ce*Y*(P-D)+3*Y*Y*(W-P);return Math.atan2(me,ne)}}function k(O){return O*O}function w(O){return 2*O*(1-O)}function A(O){return(1-O)*(1-O)}function I(O,N,L,D,B,P){return function(x){var W=k(x),Y=w(x),ce=A(x);return{x:B*W+L*Y+O*ce,y:P*W+D*Y+N*ce}}}function z(O,N,L,D,B,P){return function(x){var W=1-x,Y=2*W*(L-O)+2*x*(B-L),ce=2*W*(D-N)+2*x*(P-D);return Math.atan2(ce,Y)}}function H(O,N,L){var D={x:N,y:L},B,P=0,x;for(x=1;x<=100;x+=1)B=O(x/100),P+=g(D.x,D.y,B.x,B.y),D=B;return P}function Q(O,N){for(var L=0,D=0,B=O.iterator,P={x:O.x,y:O.y},x,W,Y=.01,ce=O.angleFinder,ne;D<N&&Y>1e-4;)x=B(L),ne=L,W=g(P.x,P.y,x.x,x.y),W+D>N?(L-=Y,Y/=2):(P=x,L+=Y,D+=W);return x.angle=ce(ne),x}function ee(O){for(var N=0,L=O.length,D,B=0,P=0,x=0,W=0,Y=[],ce,ne,me,pe=0;pe<L;pe++){switch(D=O[pe],ne={x:B,y:P,command:D[0]},D[0]){case"M":ne.length=0,x=B=D[1],W=P=D[2];break;case"L":ne.length=g(B,P,D[1],D[2]),B=D[1],P=D[2];break;case"C":ce=S(B,P,D[1],D[2],D[3],D[4],D[5],D[6]),me=C(B,P,D[1],D[2],D[3],D[4],D[5],D[6]),ne.iterator=ce,ne.angleFinder=me,ne.length=H(ce,B,P),B=D[5],P=D[6];break;case"Q":ce=I(B,P,D[1],D[2],D[3],D[4]),me=z(B,P,D[1],D[2],D[3],D[4]),ne.iterator=ce,ne.angleFinder=me,ne.length=H(ce,B,P),B=D[3],P=D[4];break;case"Z":case"z":ne.destX=x,ne.destY=W,ne.length=g(B,P,x,W),B=x,P=W;break}N+=ne.length,Y.push(ne)}return Y.push({length:N,x:B,y:P}),Y}function Z(O,N,L){L||(L=ee(O));for(var D=0;N-L[D].length>0&&D<L.length-2;)N-=L[D].length,D++;var B=L[D],P=N/B.length,x=B.command,W=O[D],Y;switch(x){case"M":return{x:B.x,y:B.y,angle:0};case"Z":case"z":return Y=new e.Point(B.x,B.y).lerp(new e.Point(B.destX,B.destY),P),Y.angle=Math.atan2(B.destY-B.y,B.destX-B.x),Y;case"L":return Y=new e.Point(B.x,B.y).lerp(new e.Point(W[1],W[2]),P),Y.angle=Math.atan2(W[2]-B.y,W[1]-B.x),Y;case"C":return Q(B,N);case"Q":return Q(B,N)}}function he(O){var N=[],L=[],D,B,P=e.rePathCommand,x="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",W="("+x+")"+e.commaWsp,Y="([01])"+e.commaWsp+"?",ce=W+"?"+W+"?"+W+Y+Y+W+"?("+x+")",ne=new RegExp(ce,"g"),me,pe,q;if(!O||!O.match)return N;q=O.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var se=0,J,de=q.length;se<de;se++){D=q[se],pe=D.slice(1).trim(),L.length=0;var fe=D.charAt(0);if(J=[fe],fe.toLowerCase()==="a")for(var oe;oe=ne.exec(pe);)for(var ge=1;ge<oe.length;ge++)L.push(oe[ge]);else for(;me=P.exec(pe);)L.push(me[0]);for(var ge=0,Se=L.length;ge<Se;ge++)B=parseFloat(L[ge]),isNaN(B)||J.push(B);var Be=o[fe.toLowerCase()],Te=c[fe]||fe;if(J.length-1>Be)for(var le=1,Ie=J.length;le<Ie;le+=Be)N.push([fe].concat(J.slice(le,le+Be))),fe=Te;else N.push(J)}return N}function _e(O,N){var L=[],D,B=new e.Point(O[0].x,O[0].y),P=new e.Point(O[1].x,O[1].y),x=O.length,W=1,Y=0,ce=x>2;for(N=N||0,ce&&(W=O[2].x<P.x?-1:O[2].x===P.x?0:1,Y=O[2].y<P.y?-1:O[2].y===P.y?0:1),L.push(["M",B.x-W*N,B.y-Y*N]),D=1;D<x;D++){if(!B.eq(P)){var ne=B.midPointFrom(P);L.push(["Q",B.x,B.y,ne.x,ne.y])}B=O[D],D+1<O.length&&(P=O[D+1])}return ce&&(W=B.x>O[D-2].x?1:B.x===O[D-2].x?0:-1,Y=B.y>O[D-2].y?1:B.y===O[D-2].y?0:-1),L.push(["L",B.x+W*N,B.y+Y*N]),L}function we(O,N,L){return L&&(N=e.util.multiplyTransformMatrices(N,[1,0,0,1,-L.x,-L.y])),O.map(function(D){for(var B=D.slice(0),P={},x=1;x<D.length-1;x+=2)P.x=D[x],P.y=D[x+1],P=e.util.transformPoint(P,N),B[x]=P.x,B[x+1]=P.y;return B})}e.util.joinPath=function(O){return O.map(function(N){return N.join(" ")}).join(" ")},e.util.parsePath=he,e.util.makePathSimpler=p,e.util.getSmoothPathFromPoints=_e,e.util.getPathSegmentsInfo=ee,e.util.getBoundsOfCurve=h,e.util.getPointOnPath=Z,e.util.transformPath=we}(),function(){var a=Array.prototype.slice;function o(h,m){for(var p=a.call(arguments,2),g=[],v=0,b=h.length;v<b;v++)g[v]=p.length?h[v][m].apply(h[v],p):h[v][m].call(h[v]);return g}function c(h,m){return d(h,m,function(p,g){return p>=g})}function f(h,m){return d(h,m,function(p,g){return p<g})}function u(h,m){for(var p=h.length;p--;)h[p]=m;return h}function d(h,m,p){if(!(!h||h.length===0)){var g=h.length-1,v=m?h[g][m]:h[g];if(m)for(;g--;)p(h[g][m],v)&&(v=h[g][m]);else for(;g--;)p(h[g],v)&&(v=h[g]);return v}}e.util.array={fill:u,invoke:o,min:f,max:c}}(),function(){function a(c,f,u){if(u)if(!e.isLikelyNode&&f instanceof Element)c=f;else if(f instanceof Array){c=[];for(var d=0,h=f.length;d<h;d++)c[d]=a({},f[d],u)}else if(f&&typeof f=="object")for(var m in f)m==="canvas"||m==="group"?c[m]=null:f.hasOwnProperty(m)&&(c[m]=a({},f[m],u));else c=f;else for(var m in f)c[m]=f[m];return c}function o(c,f){return a({},c,f)}e.util.object={extend:a,clone:o},e.util.object.extend(e.util,e.Observable)}(),function(){function a(d){return d.replace(/-+(.)?/g,function(h,m){return m?m.toUpperCase():""})}function o(d,h){return d.charAt(0).toUpperCase()+(h?d.slice(1):d.slice(1).toLowerCase())}function c(d){return d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(d){var h=0,m,p=[];for(h=0,m;h<d.length;h++)(m=u(d,h))!==!1&&p.push(m);return p}function u(d,h){var m=d.charCodeAt(h);if(isNaN(m))return"";if(m<55296||m>57343)return d.charAt(h);if(55296<=m&&m<=56319){if(d.length<=h+1)throw"High surrogate without following low surrogate";var p=d.charCodeAt(h+1);if(56320>p||p>57343)throw"High surrogate without following low surrogate";return d.charAt(h)+d.charAt(h+1)}if(h===0)throw"Low surrogate without preceding high surrogate";var g=d.charCodeAt(h-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}e.util.string={camelize:a,capitalize:o,escapeXml:c,graphemeSplit:f}}(),function(){var a=Array.prototype.slice,o=function(){},c=function(){for(var m in{toString:1})if(m==="toString")return!1;return!0}(),f=function(m,p,g){for(var v in p)v in m.prototype&&typeof m.prototype[v]=="function"&&(p[v]+"").indexOf("callSuper")>-1?m.prototype[v]=function(b){return function(){var y=this.constructor.superclass;this.constructor.superclass=g;var _=p[b].apply(this,arguments);if(this.constructor.superclass=y,b!=="initialize")return _}}(v):m.prototype[v]=p[v],c&&(p.toString!==Object.prototype.toString&&(m.prototype.toString=p.toString),p.valueOf!==Object.prototype.valueOf&&(m.prototype.valueOf=p.valueOf))};function u(){}function d(m){for(var p=null,g=this;g.constructor.superclass;){var v=g.constructor.superclass.prototype[m];if(g[m]!==v){p=v;break}g=g.constructor.superclass.prototype}return p?arguments.length>1?p.apply(this,a.call(arguments,1)):p.call(this):console.log("tried to callSuper "+m+", method not found in prototype chain",this)}function h(){var m=null,p=a.call(arguments,0);typeof p[0]=="function"&&(m=p.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=m,g.subclasses=[],m&&(u.prototype=m.prototype,g.prototype=new u,m.subclasses.push(g));for(var v=0,b=p.length;v<b;v++)f(g,p[v],m);return g.prototype.initialize||(g.prototype.initialize=o),g.prototype.constructor=g,g.prototype.callSuper=d,g}e.util.createClass=h}(),function(){var a=!!e.document.createElement("div").attachEvent,o=["touchstart","touchmove","touchend"];e.util.addListener=function(f,u,d,h){f&&f.addEventListener(u,d,a?!1:h)},e.util.removeListener=function(f,u,d,h){f&&f.removeEventListener(u,d,a?!1:h)};function c(f){var u=f.changedTouches;return u&&u[0]?u[0]:f}e.util.getPointer=function(f){var u=f.target,d=e.util.getScrollLeftTop(u),h=c(f);return{x:h.clientX+d.left,y:h.clientY+d.top}},e.util.isTouchEvent=function(f){return o.indexOf(f.type)>-1||f.pointerType==="touch"}}(),function(){function a(h,m){var p=h.style;if(!p)return h;if(typeof m=="string")return h.style.cssText+=";"+m,m.indexOf("opacity")>-1?d(h,m.match(/opacity:\s*(\d?\.?\d*)/)[1]):h;for(var g in m)if(g==="opacity")d(h,m[g]);else{var v=g==="float"||g==="cssFloat"?typeof p.styleFloat>"u"?"cssFloat":"styleFloat":g;p.setProperty(v,m[g])}return h}var o=e.document.createElement("div"),c=typeof o.style.opacity=="string",f=typeof o.style.filter=="string",u=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,d=function(h){return h};c?d=function(h,m){return h.style.opacity=m,h}:f&&(d=function(h,m){var p=h.style;return h.currentStyle&&!h.currentStyle.hasLayout&&(p.zoom=1),u.test(p.filter)?(m=m>=.9999?"":"alpha(opacity="+m*100+")",p.filter=p.filter.replace(u,m)):p.filter+=" alpha(opacity="+m*100+")",h}),e.util.setStyle=a}(),function(){var a=Array.prototype.slice;function o(_){return typeof _=="string"?e.document.getElementById(_):_}var c,f=function(_){return a.call(_,0)};try{c=f(e.document.childNodes)instanceof Array}catch{}c||(f=function(_){for(var S=new Array(_.length),C=_.length;C--;)S[C]=_[C];return S});function u(_,S){var C=e.document.createElement(_);for(var k in S)k==="class"?C.className=S[k]:k==="for"?C.htmlFor=S[k]:C.setAttribute(k,S[k]);return C}function d(_,S){_&&(" "+_.className+" ").indexOf(" "+S+" ")===-1&&(_.className+=(_.className?" ":"")+S)}function h(_,S,C){return typeof S=="string"&&(S=u(S,C)),_.parentNode&&_.parentNode.replaceChild(S,_),S.appendChild(_),S}function m(_){for(var S=0,C=0,k=e.document.documentElement,w=e.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===e.document?(S=w.scrollLeft||k.scrollLeft||0,C=w.scrollTop||k.scrollTop||0):(S+=_.scrollLeft||0,C+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:S,top:C}}function p(_){var S,C=_&&_.ownerDocument,k={left:0,top:0},w={left:0,top:0},A,I={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return w;for(var z in I)w[I[z]]+=parseInt(g(_,z),10)||0;return S=C.documentElement,typeof _.getBoundingClientRect<"u"&&(k=_.getBoundingClientRect()),A=m(_),{left:k.left+A.left-(S.clientLeft||0)+w.left,top:k.top+A.top-(S.clientTop||0)+w.top}}var g;e.document.defaultView&&e.document.defaultView.getComputedStyle?g=function(_,S){var C=e.document.defaultView.getComputedStyle(_,null);return C?C[S]:void 0}:g=function(_,S){var C=_.style[S];return!C&&_.currentStyle&&(C=_.currentStyle[S]),C},function(){var _=e.document.documentElement.style,S="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function C(w){return typeof w.onselectstart<"u"&&(w.onselectstart=e.util.falseFunction),S?w.style[S]="none":typeof w.unselectable=="string"&&(w.unselectable="on"),w}function k(w){return typeof w.onselectstart<"u"&&(w.onselectstart=null),S?w.style[S]="":typeof w.unselectable=="string"&&(w.unselectable=""),w}e.util.makeElementUnselectable=C,e.util.makeElementSelectable=k}();function v(_){var S=e.jsdomImplForWrapper(_);return S._canvas||S._image}function b(_){if(e.isLikelyNode){var S=e.jsdomImplForWrapper(_);S&&(S._image=null,S._canvas=null,S._currentSrc=null,S._attributes=null,S._classList=null)}}function y(_,S){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=S}e.util.setImageSmoothing=y,e.util.getById=o,e.util.toArray=f,e.util.addClass=d,e.util.makeElement=u,e.util.wrapElement=h,e.util.getScrollLeftTop=m,e.util.getElementOffset=p,e.util.getNodeCanvas=v,e.util.cleanUpJsdomNode=b}(),function(){function a(f,u){return f+(/\?/.test(f)?"&":"?")+u}function o(){}function c(f,u){u||(u={});var d=u.method?u.method.toUpperCase():"GET",h=u.onComplete||function(){},m=new e.window.XMLHttpRequest,p=u.body||u.parameters;return m.onreadystatechange=function(){m.readyState===4&&(h(m),m.onreadystatechange=o)},d==="GET"&&(p=null,typeof u.parameters=="string"&&(f=a(f,u.parameters))),m.open(d,f,!0),(d==="POST"||d==="PUT")&&m.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),m.send(p),m}e.util.request=c}(),e.log=console.log,e.warn=console.warn,function(){var a=e.util.object.extend,o=e.util.object.clone,c=[];e.util.object.extend(c,{cancelAll:function(){var v=this.splice(0);return v.forEach(function(b){b.cancel()}),v},cancelByCanvas:function(v){if(!v)return[];var b=this.filter(function(y){return typeof y.target=="object"&&y.target.canvas===v});return b.forEach(function(y){y.cancel()}),b},cancelByTarget:function(v){var b=this.findAnimationsByTarget(v);return b.forEach(function(y){y.cancel()}),b},findAnimationIndex:function(v){return this.indexOf(this.findAnimation(v))},findAnimation:function(v){return this.find(function(b){return b.cancel===v})},findAnimationsByTarget:function(v){return v?this.filter(function(b){return b.target===v}):[]}});function f(){return!1}function u(v,b,y,_){return-y*Math.cos(v/_*(Math.PI/2))+y+b}function d(v){v||(v={});var b=!1,y,_=function(){var S=e.runningAnimations.indexOf(y);return S>-1&&e.runningAnimations.splice(S,1)[0]};return y=a(o(v),{cancel:function(){return b=!0,_()},currentValue:"startValue"in v?v.startValue:0,completionRate:0,durationRate:0}),e.runningAnimations.push(y),p(function(S){var C=S||+new Date,k=v.duration||500,w=C+k,A,I=v.onChange||f,z=v.abort||f,H=v.onComplete||f,Q=v.easing||u,ee="startValue"in v?v.startValue.length>0:!1,Z="startValue"in v?v.startValue:0,he="endValue"in v?v.endValue:100,_e=v.byValue||(ee?Z.map(function(we,O){return he[O]-Z[O]}):he-Z);v.onStart&&v.onStart(),function we(O){A=O||+new Date;var N=A>w?k:A-C,L=N/k,D=ee?Z.map(function(P,x){return Q(N,Z[x],_e[x],k)}):Q(N,Z,_e,k),B=Math.abs(ee?(D[0]-Z[0])/_e[0]:(D-Z)/_e);if(y.currentValue=ee?D.slice():D,y.completionRate=B,y.durationRate=L,!b){if(z(D,B,L)){_();return}if(A>w){y.currentValue=ee?he.slice():he,y.completionRate=1,y.durationRate=1,I(ee?he.slice():he,1,1),H(he,1,1),_();return}else I(D,B,L),p(we)}}(C)}),y.cancel}var h=e.window.requestAnimationFrame||e.window.webkitRequestAnimationFrame||e.window.mozRequestAnimationFrame||e.window.oRequestAnimationFrame||e.window.msRequestAnimationFrame||function(v){return e.window.setTimeout(v,1e3/60)},m=e.window.cancelAnimationFrame||e.window.clearTimeout;function p(){return h.apply(e.window,arguments)}function g(){return m.apply(e.window,arguments)}e.util.animate=d,e.util.requestAnimFrame=p,e.util.cancelAnimFrame=g,e.runningAnimations=c}(),function(){function a(c,f,u){var d="rgba("+parseInt(c[0]+u*(f[0]-c[0]),10)+","+parseInt(c[1]+u*(f[1]-c[1]),10)+","+parseInt(c[2]+u*(f[2]-c[2]),10);return d+=","+(c&&f?parseFloat(c[3]+u*(f[3]-c[3])):1),d+=")",d}function o(c,f,u,d){var h=new e.Color(c).getSource(),m=new e.Color(f).getSource(),p=d.onComplete,g=d.onChange;return d=d||{},e.util.animate(e.util.object.extend(d,{duration:u||500,startValue:h,endValue:m,byValue:m,easing:function(v,b,y,_){var S=d.colorEasing?d.colorEasing(v,_):1-Math.cos(v/_*(Math.PI/2));return a(b,y,S)},onComplete:function(v,b,y){if(p)return p(a(m,m,0),b,y)},onChange:function(v,b,y){if(g){if(Array.isArray(v))return g(a(v,v,0),b,y);g(v,b,y)}}}))}e.util.animateColor=o}(),function(){function a(O,N,L,D){return O<Math.abs(N)?(O=N,D=L/4):N===0&&O===0?D=L/(2*Math.PI)*Math.asin(1):D=L/(2*Math.PI)*Math.asin(N/O),{a:O,c:N,p:L,s:D}}function o(O,N,L){return O.a*Math.pow(2,10*(N-=1))*Math.sin((N*L-O.s)*(2*Math.PI)/O.p)}function c(O,N,L,D){return L*((O=O/D-1)*O*O+1)+N}function f(O,N,L,D){return O/=D/2,O<1?L/2*O*O*O+N:L/2*((O-=2)*O*O+2)+N}function u(O,N,L,D){return L*(O/=D)*O*O*O+N}function d(O,N,L,D){return-L*((O=O/D-1)*O*O*O-1)+N}function h(O,N,L,D){return O/=D/2,O<1?L/2*O*O*O*O+N:-L/2*((O-=2)*O*O*O-2)+N}function m(O,N,L,D){return L*(O/=D)*O*O*O*O+N}function p(O,N,L,D){return L*((O=O/D-1)*O*O*O*O+1)+N}function g(O,N,L,D){return O/=D/2,O<1?L/2*O*O*O*O*O+N:L/2*((O-=2)*O*O*O*O+2)+N}function v(O,N,L,D){return-L*Math.cos(O/D*(Math.PI/2))+L+N}function b(O,N,L,D){return L*Math.sin(O/D*(Math.PI/2))+N}function y(O,N,L,D){return-L/2*(Math.cos(Math.PI*O/D)-1)+N}function _(O,N,L,D){return O===0?N:L*Math.pow(2,10*(O/D-1))+N}function S(O,N,L,D){return O===D?N+L:L*(-Math.pow(2,-10*O/D)+1)+N}function C(O,N,L,D){return O===0?N:O===D?N+L:(O/=D/2,O<1?L/2*Math.pow(2,10*(O-1))+N:L/2*(-Math.pow(2,-10*--O)+2)+N)}function k(O,N,L,D){return-L*(Math.sqrt(1-(O/=D)*O)-1)+N}function w(O,N,L,D){return L*Math.sqrt(1-(O=O/D-1)*O)+N}function A(O,N,L,D){return O/=D/2,O<1?-L/2*(Math.sqrt(1-O*O)-1)+N:L/2*(Math.sqrt(1-(O-=2)*O)+1)+N}function I(O,N,L,D){var B=1.70158,P=0,x=L;if(O===0)return N;if(O/=D,O===1)return N+L;P||(P=D*.3);var W=a(x,L,P,B);return-o(W,O,D)+N}function z(O,N,L,D){var B=1.70158,P=0,x=L;if(O===0)return N;if(O/=D,O===1)return N+L;P||(P=D*.3);var W=a(x,L,P,B);return W.a*Math.pow(2,-10*O)*Math.sin((O*D-W.s)*(2*Math.PI)/W.p)+W.c+N}function H(O,N,L,D){var B=1.70158,P=0,x=L;if(O===0)return N;if(O/=D/2,O===2)return N+L;P||(P=D*(.3*1.5));var W=a(x,L,P,B);return O<1?-.5*o(W,O,D)+N:W.a*Math.pow(2,-10*(O-=1))*Math.sin((O*D-W.s)*(2*Math.PI)/W.p)*.5+W.c+N}function Q(O,N,L,D,B){return B===void 0&&(B=1.70158),L*(O/=D)*O*((B+1)*O-B)+N}function ee(O,N,L,D,B){return B===void 0&&(B=1.70158),L*((O=O/D-1)*O*((B+1)*O+B)+1)+N}function Z(O,N,L,D,B){return B===void 0&&(B=1.70158),O/=D/2,O<1?L/2*(O*O*(((B*=1.525)+1)*O-B))+N:L/2*((O-=2)*O*(((B*=1.525)+1)*O+B)+2)+N}function he(O,N,L,D){return L-_e(D-O,0,L,D)+N}function _e(O,N,L,D){return(O/=D)<1/2.75?L*(7.5625*O*O)+N:O<2/2.75?L*(7.5625*(O-=1.5/2.75)*O+.75)+N:O<2.5/2.75?L*(7.5625*(O-=2.25/2.75)*O+.9375)+N:L*(7.5625*(O-=2.625/2.75)*O+.984375)+N}function we(O,N,L,D){return O<D/2?he(O*2,0,L,D)*.5+N:_e(O*2-D,0,L,D)*.5+L*.5+N}e.util.ease={easeInQuad:function(O,N,L,D){return L*(O/=D)*O+N},easeOutQuad:function(O,N,L,D){return-L*(O/=D)*(O-2)+N},easeInOutQuad:function(O,N,L,D){return O/=D/2,O<1?L/2*O*O+N:-L/2*(--O*(O-2)-1)+N},easeInCubic:function(O,N,L,D){return L*(O/=D)*O*O+N},easeOutCubic:c,easeInOutCubic:f,easeInQuart:u,easeOutQuart:d,easeInOutQuart:h,easeInQuint:m,easeOutQuint:p,easeInOutQuint:g,easeInSine:v,easeOutSine:b,easeInOutSine:y,easeInExpo:_,easeOutExpo:S,easeInOutExpo:C,easeInCirc:k,easeOutCirc:w,easeInOutCirc:A,easeInElastic:I,easeOutElastic:z,easeInOutElastic:H,easeInBack:Q,easeOutBack:ee,easeInOutBack:Z,easeInBounce:he,easeOutBounce:_e,easeInOutBounce:we}}(),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.util.object.clone,u=o.util.toFixed,d=o.util.parseUnit,h=o.util.multiplyTransformMatrices,m=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],p=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],v=["symbol","g","a","svg","clipPath","defs"],b={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",S="clip-path";o.svgValidTagNamesRegEx=w(m),o.svgViewBoxElementsRegEx=w(p),o.svgInvalidAncestorsRegEx=w(g),o.svgValidParentsRegEx=w(v),o.cssRules={},o.gradientDefs={},o.clipPaths={};function C(P){return P in b?b[P]:P}function k(P,x,W,Y){var ce=Array.isArray(x),ne;if((P==="fill"||P==="stroke")&&x==="none")x="";else{if(P==="strokeUniform")return x==="non-scaling-stroke";if(P==="strokeDashArray")x==="none"?x=null:x=x.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(P==="transformMatrix")W&&W.transformMatrix?x=h(W.transformMatrix,o.parseTransformAttribute(x)):x=o.parseTransformAttribute(x);else if(P==="visible")x=x!=="none"&&x!=="hidden",W&&W.visible===!1&&(x=!1);else if(P==="opacity")x=parseFloat(x),W&&typeof W.opacity<"u"&&(x*=W.opacity);else if(P==="textAnchor")x=x==="start"?"left":x==="end"?"right":"center";else if(P==="charSpacing")ne=d(x,Y)/Y*1e3;else if(P==="paintFirst"){var me=x.indexOf("fill"),pe=x.indexOf("stroke"),x="fill";(me>-1&&pe>-1&&pe<me||me===-1&&pe>-1)&&(x="stroke")}else{if(P==="href"||P==="xlink:href"||P==="font")return x;if(P==="imageSmoothing")return x==="optimizeQuality";ne=ce?x.map(d):d(x,Y)}}return!ce&&isNaN(ne)?x:ne}function w(P){return new RegExp("^("+P.join("|")+")\\b","i")}function A(P){for(var x in y)if(!(typeof P[y[x]]>"u"||P[x]==="")){if(typeof P[x]>"u"){if(!o.Object.prototype[x])continue;P[x]=o.Object.prototype[x]}if(P[x].indexOf("url(")!==0){var W=new o.Color(P[x]);P[x]=W.setAlpha(u(W.getAlpha()*P[y[x]],2)).toRgba()}}return P}function I(P,x){var W,Y=[],ce,ne,me;for(ne=0,me=x.length;ne<me;ne++)W=x[ne],ce=P.getElementsByTagName(W),Y=Y.concat(Array.prototype.slice.call(ce));return Y}o.parseTransformAttribute=function(){function P(le,Ie){var ze=o.util.cos(Ie[0]),$e=o.util.sin(Ie[0]),ft=0,it=0;Ie.length===3&&(ft=Ie[1],it=Ie[2]),le[0]=ze,le[1]=$e,le[2]=-$e,le[3]=ze,le[4]=ft-(ze*ft-$e*it),le[5]=it-($e*ft+ze*it)}function x(le,Ie){var ze=Ie[0],$e=Ie.length===2?Ie[1]:Ie[0];le[0]=ze,le[3]=$e}function W(le,Ie,ze){le[ze]=Math.tan(o.util.degreesToRadians(Ie[0]))}function Y(le,Ie){le[4]=Ie[0],Ie.length===2&&(le[5]=Ie[1])}var ce=o.iMatrix,ne=o.reNum,me=o.commaWsp,pe="(?:(skewX)\\s*\\(\\s*("+ne+")\\s*\\))",q="(?:(skewY)\\s*\\(\\s*("+ne+")\\s*\\))",se="(?:(rotate)\\s*\\(\\s*("+ne+")(?:"+me+"("+ne+")"+me+"("+ne+"))?\\s*\\))",J="(?:(scale)\\s*\\(\\s*("+ne+")(?:"+me+"("+ne+"))?\\s*\\))",de="(?:(translate)\\s*\\(\\s*("+ne+")(?:"+me+"("+ne+"))?\\s*\\))",fe="(?:(matrix)\\s*\\(\\s*("+ne+")"+me+"("+ne+")"+me+"("+ne+")"+me+"("+ne+")"+me+"("+ne+")"+me+"("+ne+")\\s*\\))",oe="(?:"+fe+"|"+de+"|"+J+"|"+se+"|"+pe+"|"+q+")",ge="(?:"+oe+"(?:"+me+"*"+oe+")*)",Se="^\\s*(?:"+ge+"?)\\s*$",Be=new RegExp(Se),Te=new RegExp(oe,"g");return function(le){var Ie=ce.concat(),ze=[];if(!le||le&&!Be.test(le))return Ie;le.replace(Te,function(ft){var it=new RegExp(oe).exec(ft).filter(function(Wt){return!!Wt}),dt=it[1],at=it.slice(2).map(parseFloat);switch(dt){case"translate":Y(Ie,at);break;case"rotate":at[0]=o.util.degreesToRadians(at[0]),P(Ie,at);break;case"scale":x(Ie,at);break;case"skewX":W(Ie,at,2);break;case"skewY":W(Ie,at,1);break;case"matrix":Ie=at;break}ze.push(Ie.concat()),Ie=ce.concat()});for(var $e=ze[0];ze.length>1;)ze.shift(),$e=o.util.multiplyTransformMatrices($e,ze[0]);return $e}}();function z(P,x){var W,Y;P.replace(/;\s*$/,"").split(";").forEach(function(ce){var ne=ce.split(":");W=ne[0].trim().toLowerCase(),Y=ne[1].trim(),x[W]=Y})}function H(P,x){var W,Y;for(var ce in P)typeof P[ce]>"u"||(W=ce.toLowerCase(),Y=P[ce],x[W]=Y)}function Q(P,x){var W={};for(var Y in o.cssRules[x])if(ee(P,Y.split(" ")))for(var ce in o.cssRules[x][Y])W[ce]=o.cssRules[x][Y][ce];return W}function ee(P,x){var W,Y=!0;return W=he(P,x.pop()),W&&x.length&&(Y=Z(P,x)),W&&Y&&x.length===0}function Z(P,x){for(var W,Y=!0;P.parentNode&&P.parentNode.nodeType===1&&x.length;)Y&&(W=x.pop()),P=P.parentNode,Y=he(P,W);return x.length===0}function he(P,x){var W=P.nodeName,Y=P.getAttribute("class"),ce=P.getAttribute("id"),ne,me;if(ne=new RegExp("^"+W,"i"),x=x.replace(ne,""),ce&&x.length&&(ne=new RegExp("#"+ce+"(?![a-zA-Z\\-]+)","i"),x=x.replace(ne,"")),Y&&x.length)for(Y=Y.split(" "),me=Y.length;me--;)ne=new RegExp("\\."+Y[me]+"(?![a-zA-Z\\-]+)","i"),x=x.replace(ne,"");return x.length===0}function _e(P,x){var W;if(P.getElementById&&(W=P.getElementById(x)),W)return W;var Y,ce,ne,me=P.getElementsByTagName("*");for(ce=0,ne=me.length;ce<ne;ce++)if(Y=me[ce],x===Y.getAttribute("id"))return Y}function we(P){for(var x=I(P,["use","svg:use"]),W=0;x.length&&W<x.length;){var Y=x[W],ce=Y.getAttribute("xlink:href")||Y.getAttribute("href");if(ce===null)return;var ne=ce.slice(1),me=Y.getAttribute("x")||0,pe=Y.getAttribute("y")||0,q=_e(P,ne).cloneNode(!0),se=(q.getAttribute("transform")||"")+" translate("+me+", "+pe+")",J,de=x.length,fe,oe,ge,Se,Be=o.svgNS;if(N(q),/^svg$/i.test(q.nodeName)){var Te=q.ownerDocument.createElementNS(Be,"g");for(oe=0,ge=q.attributes,Se=ge.length;oe<Se;oe++)fe=ge.item(oe),Te.setAttributeNS(Be,fe.nodeName,fe.nodeValue);for(;q.firstChild;)Te.appendChild(q.firstChild);q=Te}for(oe=0,ge=Y.attributes,Se=ge.length;oe<Se;oe++)fe=ge.item(oe),!(fe.nodeName==="x"||fe.nodeName==="y"||fe.nodeName==="xlink:href"||fe.nodeName==="href")&&(fe.nodeName==="transform"?se=fe.nodeValue+" "+se:q.setAttribute(fe.nodeName,fe.nodeValue));q.setAttribute("transform",se),q.setAttribute("instantiated_by_use","1"),q.removeAttribute("id"),J=Y.parentNode,J.replaceChild(q,Y),x.length===de&&W++}}var O=new RegExp("^\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*$");function N(P){if(!o.svgViewBoxElementsRegEx.test(P.nodeName))return{};var x=P.getAttribute("viewBox"),W=1,Y=1,ce=0,ne=0,me,pe,q,se,J=P.getAttribute("width"),de=P.getAttribute("height"),fe=P.getAttribute("x")||0,oe=P.getAttribute("y")||0,ge=P.getAttribute("preserveAspectRatio")||"",Se=!x||!(x=x.match(O)),Be=!J||!de||J==="100%"||de==="100%",Te=Se&&Be,le={},Ie="",ze=0,$e=0;if(le.width=0,le.height=0,le.toBeParsed=Te,Se&&(fe||oe)&&P.parentNode&&P.parentNode.nodeName!=="#document"&&(Ie=" translate("+d(fe)+" "+d(oe)+") ",q=(P.getAttribute("transform")||"")+Ie,P.setAttribute("transform",q),P.removeAttribute("x"),P.removeAttribute("y")),Te)return le;if(Se)return le.width=d(J),le.height=d(de),le;if(ce=-parseFloat(x[1]),ne=-parseFloat(x[2]),me=parseFloat(x[3]),pe=parseFloat(x[4]),le.minX=ce,le.minY=ne,le.viewBoxWidth=me,le.viewBoxHeight=pe,Be?(le.width=me,le.height=pe):(le.width=d(J),le.height=d(de),W=le.width/me,Y=le.height/pe),ge=o.util.parsePreserveAspectRatioAttribute(ge),ge.alignX!=="none"&&(ge.meetOrSlice==="meet"&&(Y=W=W>Y?Y:W),ge.meetOrSlice==="slice"&&(Y=W=W>Y?W:Y),ze=le.width-me*W,$e=le.height-pe*W,ge.alignX==="Mid"&&(ze/=2),ge.alignY==="Mid"&&($e/=2),ge.alignX==="Min"&&(ze=0),ge.alignY==="Min"&&($e=0)),W===1&&Y===1&&ce===0&&ne===0&&fe===0&&oe===0)return le;if((fe||oe)&&P.parentNode.nodeName!=="#document"&&(Ie=" translate("+d(fe)+" "+d(oe)+") "),q=Ie+" matrix("+W+" 0 0 "+Y+" "+(ce*W+ze)+" "+(ne*Y+$e)+") ",P.nodeName==="svg"){for(se=P.ownerDocument.createElementNS(o.svgNS,"g");P.firstChild;)se.appendChild(P.firstChild);P.appendChild(se)}else se=P,se.removeAttribute("x"),se.removeAttribute("y"),q=se.getAttribute("transform")+q;return se.setAttribute("transform",q),le}function L(P,x){for(;P&&(P=P.parentNode);)if(P.nodeName&&x.test(P.nodeName.replace("svg:",""))&&!P.getAttribute("instantiated_by_use"))return!0;return!1}o.parseSVGDocument=function(P,x,W,Y){if(P){we(P);var ce=o.Object.__uid++,ne,me,pe=N(P),q=o.util.toArray(P.getElementsByTagName("*"));if(pe.crossOrigin=Y&&Y.crossOrigin,pe.svgUid=ce,q.length===0&&o.isLikelyNode){q=P.selectNodes('//*[name(.)!="svg"]');var se=[];for(ne=0,me=q.length;ne<me;ne++)se[ne]=q[ne];q=se}var J=q.filter(function(fe){return N(fe),o.svgValidTagNamesRegEx.test(fe.nodeName.replace("svg:",""))&&!L(fe,o.svgInvalidAncestorsRegEx)});if(!J||J&&!J.length){x&&x([],{});return}var de={};q.filter(function(fe){return fe.nodeName.replace("svg:","")==="clipPath"}).forEach(function(fe){var oe=fe.getAttribute("id");de[oe]=o.util.toArray(fe.getElementsByTagName("*")).filter(function(ge){return o.svgValidTagNamesRegEx.test(ge.nodeName.replace("svg:",""))})}),o.gradientDefs[ce]=o.getGradientDefs(P),o.cssRules[ce]=o.getCSSRules(P),o.clipPaths[ce]=de,o.parseElements(J,function(fe,oe){x&&(x(fe,pe,oe,q),delete o.gradientDefs[ce],delete o.cssRules[ce],delete o.clipPaths[ce])},f(pe),W,Y)}};function D(P,x){var W=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],Y="xlink:href",ce=x.getAttribute(Y).slice(1),ne=_e(P,ce);if(ne&&ne.getAttribute(Y)&&D(P,ne),W.forEach(function(pe){ne&&!x.hasAttribute(pe)&&ne.hasAttribute(pe)&&x.setAttribute(pe,ne.getAttribute(pe))}),!x.children.length)for(var me=ne.cloneNode(!0);me.firstChild;)x.appendChild(me.firstChild);x.removeAttribute(Y)}var B=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+o.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+o.reNum+"))?\\s+(.*)");c(o,{parseFontDeclaration:function(P,x){var W=P.match(B);if(W){var Y=W[1],ce=W[3],ne=W[4],me=W[5],pe=W[6];Y&&(x.fontStyle=Y),ce&&(x.fontWeight=isNaN(parseFloat(ce))?ce:parseFloat(ce)),ne&&(x.fontSize=d(ne)),pe&&(x.fontFamily=pe),me&&(x.lineHeight=me==="normal"?1:me)}},getGradientDefs:function(P){var x=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],W=I(P,x),Y,ce=0,ne={};for(ce=W.length;ce--;)Y=W[ce],Y.getAttribute("xlink:href")&&D(P,Y),ne[Y.getAttribute("id")]=Y;return ne},parseAttributes:function(P,x,W){if(P){var Y,ce={},ne,me;typeof W>"u"&&(W=P.getAttribute("svgUid")),P.parentNode&&o.svgValidParentsRegEx.test(P.parentNode.nodeName)&&(ce=o.parseAttributes(P.parentNode,x,W));var pe=x.reduce(function(ge,Se){return Y=P.getAttribute(Se),Y&&(ge[Se]=Y),ge},{}),q=c(Q(P,W),o.parseStyleAttribute(P));pe=c(pe,q),q[S]&&P.setAttribute(S,q[S]),ne=me=ce.fontSize||o.Text.DEFAULT_SVG_FONT_SIZE,pe[_]&&(pe[_]=ne=d(pe[_],me));var se,J,de={};for(var fe in pe)se=C(fe),J=k(se,pe[fe],ce,ne),de[se]=J;de&&de.font&&o.parseFontDeclaration(de.font,de);var oe=c(ce,de);return o.svgValidParentsRegEx.test(P.nodeName)?oe:A(oe)}},parseElements:function(P,x,W,Y,ce){new o.ElementsParser(P,x,W,Y,ce).parse()},parseStyleAttribute:function(P){var x={},W=P.getAttribute("style");return W&&(typeof W=="string"?z(W,x):H(W,x)),x},parsePointsAttribute:function(P){if(!P)return null;P=P.replace(/,/g," ").trim(),P=P.split(/\s+/);var x=[],W,Y;for(W=0,Y=P.length;W<Y;W+=2)x.push({x:parseFloat(P[W]),y:parseFloat(P[W+1])});return x},getCSSRules:function(P){var x=P.getElementsByTagName("style"),W,Y,ce={},ne;for(W=0,Y=x.length;W<Y;W++){var me=x[W].textContent;me=me.replace(/\/\*[\s\S]*?\*\//g,""),me.trim()!==""&&(ne=me.split("}"),ne=ne.filter(function(pe){return pe.trim()}),ne.forEach(function(pe){var q=pe.split("{"),se={},J=q[1].trim(),de=J.split(";").filter(function(Se){return Se.trim()});for(W=0,Y=de.length;W<Y;W++){var fe=de[W].split(":"),oe=fe[0].trim(),ge=fe[1].trim();se[oe]=ge}pe=q[0].trim(),pe.split(",").forEach(function(Se){Se=Se.replace(/^svg/i,"").trim(),Se!==""&&(ce[Se]?o.util.object.extend(ce[Se],se):ce[Se]=o.util.object.clone(se))})}))}return ce},loadSVGFromURL:function(P,x,W,Y){P=P.replace(/^\n\s*/,"").trim(),new o.util.request(P,{method:"get",onComplete:ce});function ce(ne){var me=ne.responseXML;if(!me||!me.documentElement)return x&&x(null),!1;o.parseSVGDocument(me.documentElement,function(pe,q,se,J){x&&x(pe,q,se,J)},W,Y)}},loadSVGFromString:function(P,x,W,Y){var ce=new o.window.DOMParser,ne=ce.parseFromString(P.trim(),"text/xml");o.parseSVGDocument(ne.documentElement,function(me,pe,q,se){x(me,pe,q,se)},W,Y)}})}(i),e.ElementsParser=function(a,o,c,f,u,d){this.elements=a,this.callback=o,this.options=c,this.reviver=f,this.svgUid=c&&c.svgUid||0,this.parsingOptions=u,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=d},function(a){a.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},a.createObjects=function(){var o=this;this.elements.forEach(function(c,f){c.setAttribute("svgUid",o.svgUid),o.createObject(c,f)})},a.findTag=function(o){return e[e.util.string.capitalize(o.tagName.replace("svg:",""))]},a.createObject=function(o,c){var f=this.findTag(o);if(f&&f.fromElement)try{f.fromElement(o,this.createCallback(c,o),this.options)}catch(u){e.log(u)}else this.checkIfDone()},a.createCallback=function(o,c){var f=this;return function(u){var d;f.resolveGradient(u,c,"fill"),f.resolveGradient(u,c,"stroke"),u instanceof e.Image&&u._originalElement&&(d=u.parsePreserveAspectRatioAttribute(c)),u._removeTransformMatrix(d),f.resolveClipPath(u,c),f.reviver&&f.reviver(c,u),f.instances[o]=u,f.checkIfDone()}},a.extractPropertyDefinition=function(o,c,f){var u=o[c],d=this.regexUrl;if(d.test(u)){d.lastIndex=0;var h=d.exec(u)[1];return d.lastIndex=0,e[f][this.svgUid][h]}},a.resolveGradient=function(o,c,f){var u=this.extractPropertyDefinition(o,f,"gradientDefs");if(u){var d=c.getAttribute(f+"-opacity"),h=e.Gradient.fromElement(u,o,d,this.options);o.set(f,h)}},a.createClipPathCallback=function(o,c){return function(f){f._removeTransformMatrix(),f.fillRule=f.clipRule,c.push(f)}},a.resolveClipPath=function(o,c){var f=this.extractPropertyDefinition(o,"clipPath","clipPaths"),u,d,h,m,p,g;if(f){m=[],h=e.util.invertTransform(o.calcTransformMatrix());for(var v=f[0].parentNode,b=c;b.parentNode&&b.getAttribute("clip-path")!==o.clipPath;)b=b.parentNode;b.parentNode.appendChild(v);for(var y=0;y<f.length;y++)u=f[y],d=this.findTag(u),d.fromElement(u,this.createClipPathCallback(o,m),this.options);m.length===1?f=m[0]:f=new e.Group(m),p=e.util.multiplyTransformMatrices(h,f.calcTransformMatrix()),f.clipPath&&this.resolveClipPath(f,b);var g=e.util.qrDecompose(p);f.flipX=!1,f.flipY=!1,f.set("scaleX",g.scaleX),f.set("scaleY",g.scaleY),f.angle=g.angle,f.skewX=g.skewX,f.skewY=0,f.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),o.clipPath=f}else delete o.clipPath},a.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(o){return o!=null}),this.callback(this.instances,this.elements))}}(e.ElementsParser.prototype),function(a){var o=a.fabric||(a.fabric={});if(o.Point){o.warn("fabric.Point is already defined");return}o.Point=c;function c(f,u){this.x=f,this.y=u}c.prototype={type:"point",constructor:c,add:function(f){return new c(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new c(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new c(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new c(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new c(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new c(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,u){return typeof u>"u"&&(u=.5),u=Math.max(Math.min(1,u),0),new c(this.x+(f.x-this.x)*u,this.y+(f.y-this.y)*u)},distanceFrom:function(f){var u=this.x-f.x,d=this.y-f.y;return Math.sqrt(u*u+d*d)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new c(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new c(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,u){return this.x=f,this.y=u,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var u=this.x,d=this.y;this.x=f.x,this.y=f.y,f.x=u,f.y=d},clone:function(){return new c(this.x,this.y)}}}(i),function(a){var o=a.fabric||(a.fabric={});if(o.Intersection){o.warn("fabric.Intersection is already defined");return}function c(f){this.status=f,this.points=[]}o.Intersection=c,o.Intersection.prototype={constructor:c,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},o.Intersection.intersectLineLine=function(f,u,d,h){var m,p=(h.x-d.x)*(f.y-d.y)-(h.y-d.y)*(f.x-d.x),g=(u.x-f.x)*(f.y-d.y)-(u.y-f.y)*(f.x-d.x),v=(h.y-d.y)*(u.x-f.x)-(h.x-d.x)*(u.y-f.y);if(v!==0){var b=p/v,y=g/v;0<=b&&b<=1&&0<=y&&y<=1?(m=new c("Intersection"),m.appendPoint(new o.Point(f.x+b*(u.x-f.x),f.y+b*(u.y-f.y)))):m=new c}else p===0||g===0?m=new c("Coincident"):m=new c("Parallel");return m},o.Intersection.intersectLinePolygon=function(f,u,d){var h=new c,m=d.length,p,g,v,b;for(b=0;b<m;b++)p=d[b],g=d[(b+1)%m],v=c.intersectLineLine(f,u,p,g),h.appendPoints(v.points);return h.points.length>0&&(h.status="Intersection"),h},o.Intersection.intersectPolygonPolygon=function(f,u){var d=new c,h=f.length,m;for(m=0;m<h;m++){var p=f[m],g=f[(m+1)%h],v=c.intersectLinePolygon(p,g,u);d.appendPoints(v.points)}return d.points.length>0&&(d.status="Intersection"),d},o.Intersection.intersectPolygonRectangle=function(f,u,d){var h=u.min(d),m=u.max(d),p=new o.Point(m.x,h.y),g=new o.Point(h.x,m.y),v=c.intersectLinePolygon(h,p,f),b=c.intersectLinePolygon(p,m,f),y=c.intersectLinePolygon(m,g,f),_=c.intersectLinePolygon(g,h,f),S=new c;return S.appendPoints(v.points),S.appendPoints(b.points),S.appendPoints(y.points),S.appendPoints(_.points),S.points.length>0&&(S.status="Intersection"),S}}(i),function(a){var o=a.fabric||(a.fabric={});if(o.Color){o.warn("fabric.Color is already defined.");return}function c(u){u?this._tryParsingColor(u):this.setSource([0,0,0,1])}o.Color=c,o.Color.prototype={_tryParsingColor:function(u){var d;u in c.colorNameMap&&(u=c.colorNameMap[u]),u==="transparent"&&(d=[255,255,255,0]),d||(d=c.sourceFromHex(u)),d||(d=c.sourceFromRgb(u)),d||(d=c.sourceFromHsl(u)),d||(d=[0,0,0,1]),d&&this.setSource(d)},_rgbToHsl:function(u,d,h){u/=255,d/=255,h/=255;var m,p,g,v=o.util.array.max([u,d,h]),b=o.util.array.min([u,d,h]);if(g=(v+b)/2,v===b)m=p=0;else{var y=v-b;switch(p=g>.5?y/(2-v-b):y/(v+b),v){case u:m=(d-h)/y+(d<h?6:0);break;case d:m=(h-u)/y+2;break;case h:m=(u-d)/y+4;break}m/=6}return[Math.round(m*360),Math.round(p*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(u){this._source=u},toRgb:function(){var u=this.getSource();return"rgb("+u[0]+","+u[1]+","+u[2]+")"},toRgba:function(){var u=this.getSource();return"rgba("+u[0]+","+u[1]+","+u[2]+","+u[3]+")"},toHsl:function(){var u=this.getSource(),d=this._rgbToHsl(u[0],u[1],u[2]);return"hsl("+d[0]+","+d[1]+"%,"+d[2]+"%)"},toHsla:function(){var u=this.getSource(),d=this._rgbToHsl(u[0],u[1],u[2]);return"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+u[3]+")"},toHex:function(){var u=this.getSource(),d,h,m;return d=u[0].toString(16),d=d.length===1?"0"+d:d,h=u[1].toString(16),h=h.length===1?"0"+h:h,m=u[2].toString(16),m=m.length===1?"0"+m:m,d.toUpperCase()+h.toUpperCase()+m.toUpperCase()},toHexa:function(){var u=this.getSource(),d;return d=Math.round(u[3]*255),d=d.toString(16),d=d.length===1?"0"+d:d,this.toHex()+d.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(u){var d=this.getSource();return d[3]=u,this.setSource(d),this},toGrayscale:function(){var u=this.getSource(),d=parseInt((u[0]*.3+u[1]*.59+u[2]*.11).toFixed(0),10),h=u[3];return this.setSource([d,d,d,h]),this},toBlackWhite:function(u){var d=this.getSource(),h=(d[0]*.3+d[1]*.59+d[2]*.11).toFixed(0),m=d[3];return u=u||127,h=Number(h)<Number(u)?0:255,this.setSource([h,h,h,m]),this},overlayWith:function(u){u instanceof c||(u=new c(u));var d=[],h=this.getAlpha(),m=.5,p=this.getSource(),g=u.getSource(),v;for(v=0;v<3;v++)d.push(Math.round(p[v]*(1-m)+g[v]*m));return d[3]=h,this.setSource(d),this}},o.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,o.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,o.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,o.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f(u,d,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?u+(d-u)*6*h:h<1/2?d:h<2/3?u+(d-u)*(2/3-h)*6:u}o.Color.fromRgb=function(u){return c.fromSource(c.sourceFromRgb(u))},o.Color.sourceFromRgb=function(u){var d=u.match(c.reRGBa);if(d){var h=parseInt(d[1],10)/(/%$/.test(d[1])?100:1)*(/%$/.test(d[1])?255:1),m=parseInt(d[2],10)/(/%$/.test(d[2])?100:1)*(/%$/.test(d[2])?255:1),p=parseInt(d[3],10)/(/%$/.test(d[3])?100:1)*(/%$/.test(d[3])?255:1);return[parseInt(h,10),parseInt(m,10),parseInt(p,10),d[4]?parseFloat(d[4]):1]}},o.Color.fromRgba=c.fromRgb,o.Color.fromHsl=function(u){return c.fromSource(c.sourceFromHsl(u))},o.Color.sourceFromHsl=function(u){var d=u.match(c.reHSLa);if(d){var h=(parseFloat(d[1])%360+360)%360/360,m=parseFloat(d[2])/(/%$/.test(d[2])?100:1),p=parseFloat(d[3])/(/%$/.test(d[3])?100:1),g,v,b;if(m===0)g=v=b=p;else{var y=p<=.5?p*(m+1):p+m-p*m,_=p*2-y;g=f(_,y,h+1/3),v=f(_,y,h),b=f(_,y,h-1/3)}return[Math.round(g*255),Math.round(v*255),Math.round(b*255),d[4]?parseFloat(d[4]):1]}},o.Color.fromHsla=c.fromHsl,o.Color.fromHex=function(u){return c.fromSource(c.sourceFromHex(u))},o.Color.sourceFromHex=function(u){if(u.match(c.reHex)){var d=u.slice(u.indexOf("#")+1),h=d.length===3||d.length===4,m=d.length===8||d.length===4,p=h?d.charAt(0)+d.charAt(0):d.substring(0,2),g=h?d.charAt(1)+d.charAt(1):d.substring(2,4),v=h?d.charAt(2)+d.charAt(2):d.substring(4,6),b=m?h?d.charAt(3)+d.charAt(3):d.substring(6,8):"FF";return[parseInt(p,16),parseInt(g,16),parseInt(v,16),parseFloat((parseInt(b,16)/255).toFixed(2))]}},o.Color.fromSource=function(u){var d=new c;return d.setSource(u),d}}(i),function(a){var o=a.fabric||(a.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],u={},d="left",h="top",m="right",p="bottom",g="center",v={top:p,bottom:h,left:m,right:d,center:g},b=o.util.radiansToDegrees,y=Math.sign||function(se){return(se>0)-(se<0)||+se};function _(se,J){var de=se.angle+b(Math.atan2(J.y,J.x))+360;return Math.round(de%360/45)}function S(se,J){var de=J.transform.target,fe=de.canvas,oe=o.util.object.clone(J);oe.target=de,fe&&fe.fire("object:"+se,oe),de.fire(se,J)}function C(se,J){var de=J.canvas,fe=de.uniScaleKey,oe=se[fe];return de.uniformScaling&&!oe||!de.uniformScaling&&oe}function k(se){return se.originX===g&&se.originY===g}function w(se,J,de){var fe=se.lockScalingX,oe=se.lockScalingY;return!!(fe&&oe||!J&&(fe||oe)&&de||fe&&J==="x"||oe&&J==="y")}function A(se,J,de){var fe="not-allowed",oe=C(se,de),ge="";if(J.x!==0&&J.y===0?ge="x":J.x===0&&J.y!==0&&(ge="y"),w(de,ge,oe))return fe;var Se=_(de,J);return c[Se]+"-resize"}function I(se,J,de){var fe="not-allowed";if(J.x!==0&&de.lockSkewingY||J.y!==0&&de.lockSkewingX)return fe;var oe=_(de,J)%4;return f[oe]+"-resize"}function z(se,J,de){return se[de.canvas.altActionKey]?u.skewCursorStyleHandler(se,J,de):u.scaleCursorStyleHandler(se,J,de)}function H(se,J,de){var fe=se[de.canvas.altActionKey];if(J.x===0)return fe?"skewX":"scaleY";if(J.y===0)return fe?"skewY":"scaleX"}function Q(se,J,de){return de.lockRotation?"not-allowed":J.cursorStyle}function ee(se,J,de,fe){return{e:se,transform:J,pointer:{x:de,y:fe}}}function Z(se){return function(J,de,fe,oe){var ge=de.target,Se=ge.getCenterPoint(),Be=ge.translateToOriginPoint(Se,de.originX,de.originY),Te=se(J,de,fe,oe);return ge.setPositionByOrigin(Be,de.originX,de.originY),Te}}function he(se,J){return function(de,fe,oe,ge){var Se=J(de,fe,oe,ge);return Se&&S(se,ee(de,fe,oe,ge)),Se}}function _e(se,J,de,fe,oe){var ge=se.target,Se=ge.controls[se.corner],Be=ge.canvas.getZoom(),Te=ge.padding/Be,le=ge.toLocalPoint(new o.Point(fe,oe),J,de);return le.x>=Te&&(le.x-=Te),le.x<=-Te&&(le.x+=Te),le.y>=Te&&(le.y-=Te),le.y<=Te&&(le.y+=Te),le.x-=Se.offsetX,le.y-=Se.offsetY,le}function we(se){return se.flipX!==se.flipY}function O(se,J,de,fe,oe){if(se[J]!==0){var ge=se._getTransformedDimensions()[fe],Se=oe/ge*se[de];se.set(de,Se)}}function N(se,J,de,fe){var oe=J.target,ge=oe._getTransformedDimensions(0,oe.skewY),Se=_e(J,J.originX,J.originY,de,fe),Be=Math.abs(Se.x*2)-ge.x,Te=oe.skewX,le;Be<2?le=0:(le=b(Math.atan2(Be/oe.scaleX,ge.y/oe.scaleY)),J.originX===d&&J.originY===p&&(le=-le),J.originX===m&&J.originY===h&&(le=-le),we(oe)&&(le=-le));var Ie=Te!==le;if(Ie){var ze=oe._getTransformedDimensions().y;oe.set("skewX",le),O(oe,"skewY","scaleY","y",ze)}return Ie}function L(se,J,de,fe){var oe=J.target,ge=oe._getTransformedDimensions(oe.skewX,0),Se=_e(J,J.originX,J.originY,de,fe),Be=Math.abs(Se.y*2)-ge.y,Te=oe.skewY,le;Be<2?le=0:(le=b(Math.atan2(Be/oe.scaleY,ge.x/oe.scaleX)),J.originX===d&&J.originY===p&&(le=-le),J.originX===m&&J.originY===h&&(le=-le),we(oe)&&(le=-le));var Ie=Te!==le;if(Ie){var ze=oe._getTransformedDimensions().x;oe.set("skewY",le),O(oe,"skewX","scaleX","x",ze)}return Ie}function D(se,J,de,fe){var oe=J.target,ge=oe.skewX,Se,Be=J.originY;if(oe.lockSkewingX)return!1;if(ge===0){var Te=_e(J,g,g,de,fe);Te.x>0?Se=d:Se=m}else ge>0&&(Se=Be===h?d:m),ge<0&&(Se=Be===h?m:d),we(oe)&&(Se=Se===d?m:d);J.originX=Se;var le=he("skewing",Z(N));return le(se,J,de,fe)}function B(se,J,de,fe){var oe=J.target,ge=oe.skewY,Se,Be=J.originX;if(oe.lockSkewingY)return!1;if(ge===0){var Te=_e(J,g,g,de,fe);Te.y>0?Se=h:Se=p}else ge>0&&(Se=Be===d?h:p),ge<0&&(Se=Be===d?p:h),we(oe)&&(Se=Se===h?p:h);J.originY=Se;var le=he("skewing",Z(L));return le(se,J,de,fe)}function P(se,J,de,fe){var oe=J,ge=oe.target,Se=ge.translateToOriginPoint(ge.getCenterPoint(),oe.originX,oe.originY);if(ge.lockRotation)return!1;var Be=Math.atan2(oe.ey-Se.y,oe.ex-Se.x),Te=Math.atan2(fe-Se.y,de-Se.x),le=b(Te-Be+oe.theta),Ie=!0;if(ge.snapAngle>0){var ze=ge.snapAngle,$e=ge.snapThreshold||ze,ft=Math.ceil(le/ze)*ze,it=Math.floor(le/ze)*ze;Math.abs(le-it)<$e?le=it:Math.abs(le-ft)<$e&&(le=ft)}return le<0&&(le=360+le),le%=360,Ie=ge.angle!==le,ge.angle=le,Ie}function x(se,J,de,fe,oe){oe=oe||{};var ge=J.target,Se=ge.lockScalingX,Be=ge.lockScalingY,Te=oe.by,le,Ie,ze,$e,ft=C(se,ge),it=w(ge,Te,ft),dt,at,Wt=J.gestureScale;if(it)return!1;if(Wt)Ie=J.scaleX*Wt,ze=J.scaleY*Wt;else{if(le=_e(J,J.originX,J.originY,de,fe),dt=Te!=="y"?y(le.x):1,at=Te!=="x"?y(le.y):1,J.signX||(J.signX=dt),J.signY||(J.signY=at),ge.lockScalingFlip&&(J.signX!==dt||J.signY!==at))return!1;if($e=ge._getTransformedDimensions(),ft&&!Te){var Ut=Math.abs(le.x)+Math.abs(le.y),Xt=J.original,ji=Math.abs($e.x*Xt.scaleX/ge.scaleX)+Math.abs($e.y*Xt.scaleY/ge.scaleY),xe=Ut/ji;Ie=Xt.scaleX*xe,ze=Xt.scaleY*xe}else Ie=Math.abs(le.x*ge.scaleX/$e.x),ze=Math.abs(le.y*ge.scaleY/$e.y);k(J)&&(Ie*=2,ze*=2),J.signX!==dt&&Te!=="y"&&(J.originX=v[J.originX],Ie*=-1,J.signX=dt),J.signY!==at&&Te!=="x"&&(J.originY=v[J.originY],ze*=-1,J.signY=at)}var Re=ge.scaleX,Ci=ge.scaleY;return Te?(Te==="x"&&ge.set("scaleX",Ie),Te==="y"&&ge.set("scaleY",ze)):(!Se&&ge.set("scaleX",Ie),!Be&&ge.set("scaleY",ze)),Re!==ge.scaleX||Ci!==ge.scaleY}function W(se,J,de,fe){return x(se,J,de,fe)}function Y(se,J,de,fe){return x(se,J,de,fe,{by:"x"})}function ce(se,J,de,fe){return x(se,J,de,fe,{by:"y"})}function ne(se,J,de,fe){return se[J.target.canvas.altActionKey]?u.skewHandlerX(se,J,de,fe):u.scalingY(se,J,de,fe)}function me(se,J,de,fe){return se[J.target.canvas.altActionKey]?u.skewHandlerY(se,J,de,fe):u.scalingX(se,J,de,fe)}function pe(se,J,de,fe){var oe=J.target,ge=_e(J,J.originX,J.originY,de,fe),Se=oe.strokeWidth/(oe.strokeUniform?oe.scaleX:1),Be=k(J)?2:1,Te=oe.width,le=Math.abs(ge.x*Be/oe.scaleX)-Se;return oe.set("width",Math.max(le,0)),Te!==le}function q(se,J,de,fe){var oe=J.target,ge=de-J.offsetX,Se=fe-J.offsetY,Be=!oe.get("lockMovementX")&&oe.left!==ge,Te=!oe.get("lockMovementY")&&oe.top!==Se;return Be&&oe.set("left",ge),Te&&oe.set("top",Se),(Be||Te)&&S("moving",ee(se,J,de,fe)),Be||Te}u.scaleCursorStyleHandler=A,u.skewCursorStyleHandler=I,u.scaleSkewCursorStyleHandler=z,u.rotationWithSnapping=he("rotating",Z(P)),u.scalingEqually=he("scaling",Z(W)),u.scalingX=he("scaling",Z(Y)),u.scalingY=he("scaling",Z(ce)),u.scalingYOrSkewingX=ne,u.scalingXOrSkewingY=me,u.changeWidth=he("resizing",Z(pe)),u.skewHandlerX=D,u.skewHandlerY=B,u.dragHandler=q,u.scaleOrSkewActionName=H,u.rotationStyleHandler=Q,u.fireEvent=S,u.wrapWithFixedAnchor=Z,u.wrapWithFireEvent=he,u.getLocalPoint=_e,o.controlsUtils=u}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.degreesToRadians,f=o.controlsUtils;function u(h,m,p,g,v){g=g||{};var b=this.sizeX||g.cornerSize||v.cornerSize,y=this.sizeY||g.cornerSize||v.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:v.transparentCorners,S=_?"stroke":"fill",C=!_&&(g.cornerStrokeColor||v.cornerStrokeColor),k=m,w=p,A;h.save(),h.fillStyle=g.cornerColor||v.cornerColor,h.strokeStyle=g.cornerStrokeColor||v.cornerStrokeColor,b>y?(A=b,h.scale(1,y/b),w=p*b/y):y>b?(A=y,h.scale(b/y,1),k=m*y/b):A=b,h.lineWidth=1,h.beginPath(),h.arc(k,w,A/2,0,2*Math.PI,!1),h[S](),C&&h.stroke(),h.restore()}function d(h,m,p,g,v){g=g||{};var b=this.sizeX||g.cornerSize||v.cornerSize,y=this.sizeY||g.cornerSize||v.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:v.transparentCorners,S=_?"stroke":"fill",C=!_&&(g.cornerStrokeColor||v.cornerStrokeColor),k=b/2,w=y/2;h.save(),h.fillStyle=g.cornerColor||v.cornerColor,h.strokeStyle=g.cornerStrokeColor||v.cornerStrokeColor,h.lineWidth=1,h.translate(m,p),h.rotate(c(v.angle)),h[S+"Rect"](-k,-w,b,y),C&&h.strokeRect(-k,-w,b,y),h.restore()}f.renderCircleControl=u,f.renderSquareControl=d}(i),function(a){var o=a.fabric||(a.fabric={});function c(f){for(var u in f)this[u]=f[u]}o.Control=c,o.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(f,u){return u.cursorStyle},getActionName:function(f,u){return u.actionName},getVisibility:function(f,u){var d=f._controlsVisibility;return d&&typeof d[u]<"u"?d[u]:this.visible},setVisibility:function(f){this.visible=f},positionHandler:function(f,u){var d=o.util.transformPoint({x:this.x*f.x+this.offsetX,y:this.y*f.y+this.offsetY},u);return d},calcCornerCoords:function(f,u,d,h,m){var p,g,v,b,y=m?this.touchSizeX:this.sizeX,_=m?this.touchSizeY:this.sizeY;if(y&&_&&y!==_){var S=Math.atan2(_,y),C=Math.sqrt(y*y+_*_)/2,k=S-o.util.degreesToRadians(f),w=Math.PI/2-S-o.util.degreesToRadians(f);p=C*o.util.cos(k),g=C*o.util.sin(k),v=C*o.util.cos(w),b=C*o.util.sin(w)}else{var A=y&&_?y:u;C=A*.7071067812;var k=o.util.degreesToRadians(45-f);p=v=C*o.util.cos(k),g=b=C*o.util.sin(k)}return{tl:{x:d-b,y:h-v},tr:{x:d+p,y:h-g},bl:{x:d-p,y:h+g},br:{x:d+b,y:h+v}}},render:function(f,u,d,h,m){switch(h=h||{},h.cornerStyle||m.cornerStyle){case"circle":o.controlsUtils.renderCircleControl.call(this,f,u,d,h,m);break;default:o.controlsUtils.renderSquareControl.call(this,f,u,d,h,m)}}}}(i),function(){function a(d,h){var m=d.getAttribute("style"),p=d.getAttribute("offset")||0,g,v,b,y;if(p=parseFloat(p)/(/%$/.test(p)?100:1),p=p<0?0:p>1?1:p,m){var _=m.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),y=_.length;y--;){var S=_[y].split(/\s*:\s*/),C=S[0].trim(),k=S[1].trim();C==="stop-color"?g=k:C==="stop-opacity"&&(b=k)}}return g||(g=d.getAttribute("stop-color")||"rgb(0,0,0)"),b||(b=d.getAttribute("stop-opacity")),g=new e.Color(g),v=g.getAlpha(),b=isNaN(parseFloat(b))?1:parseFloat(b),b*=v*h,{offset:p,color:g.toRgb(),opacity:b}}function o(d){return{x1:d.getAttribute("x1")||0,y1:d.getAttribute("y1")||0,x2:d.getAttribute("x2")||"100%",y2:d.getAttribute("y2")||0}}function c(d){return{x1:d.getAttribute("fx")||d.getAttribute("cx")||"50%",y1:d.getAttribute("fy")||d.getAttribute("cy")||"50%",r1:0,x2:d.getAttribute("cx")||"50%",y2:d.getAttribute("cy")||"50%",r2:d.getAttribute("r")||"50%"}}var f=e.util.object.clone;e.Gradient=e.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(d){d||(d={}),d.coords||(d.coords={});var h,m=this;Object.keys(d).forEach(function(p){m[p]=d[p]}),this.id?this.id+="_"+e.Object.__uid++:this.id=e.Object.__uid++,h={x1:d.coords.x1||0,y1:d.coords.y1||0,x2:d.coords.x2||0,y2:d.coords.y2||0},this.type==="radial"&&(h.r1=d.coords.r1||0,h.r2=d.coords.r2||0),this.coords=h,this.colorStops=d.colorStops.slice()},addColorStop:function(d){for(var h in d){var m=new e.Color(d[h]);this.colorStops.push({offset:parseFloat(h),color:m.toRgb(),opacity:m.getAlpha()})}return this},toObject:function(d){var h={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return e.util.populateWithProperties(this,h,d),h},toSVG:function(d,v){var m=f(this.coords,!0),p,g,v=v||{},b,y,_=f(this.colorStops,!0),S=m.r1>m.r2,C=this.gradientTransform?this.gradientTransform.concat():e.iMatrix.concat(),k=-this.offsetX,w=-this.offsetY,A=!!v.additionalTransform,I=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(Z,he){return Z.offset-he.offset}),I==="objectBoundingBox"?(k/=d.width,w/=d.height):(k+=d.width/2,w+=d.height/2),d.type==="path"&&this.gradientUnits!=="percentage"&&(k-=d.pathOffset.x,w-=d.pathOffset.y),C[4]-=k,C[5]-=w,y='id="SVGID_'+this.id+'" gradientUnits="'+I+'"',y+=' gradientTransform="'+(A?v.additionalTransform+" ":"")+e.util.matrixToSVG(C)+'" ',this.type==="linear"?b=["<linearGradient ",y,' x1="',m.x1,'" y1="',m.y1,'" x2="',m.x2,'" y2="',m.y2,`">
`]:this.type==="radial"&&(b=["<radialGradient ",y,' cx="',S?m.x1:m.x2,'" cy="',S?m.y1:m.y2,'" r="',S?m.r1:m.r2,'" fx="',S?m.x2:m.x1,'" fy="',S?m.y2:m.y1,`">
`]),this.type==="radial"){if(S)for(_=_.concat(),_.reverse(),p=0,g=_.length;p<g;p++)_[p].offset=1-_[p].offset;var z=Math.min(m.r1,m.r2);if(z>0){var H=Math.max(m.r1,m.r2),Q=z/H;for(p=0,g=_.length;p<g;p++)_[p].offset+=Q*(1-_[p].offset)}}for(p=0,g=_.length;p<g;p++){var ee=_[p];b.push("<stop ",'offset="',ee.offset*100+"%",'" style="stop-color:',ee.color,typeof ee.opacity<"u"?";stop-opacity: "+ee.opacity:";",`"/>
`)}return b.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),b.join("")},toLive:function(d){var h,m=e.util.object.clone(this.coords),p,g;if(this.type){for(this.type==="linear"?h=d.createLinearGradient(m.x1,m.y1,m.x2,m.y2):this.type==="radial"&&(h=d.createRadialGradient(m.x1,m.y1,m.r1,m.x2,m.y2,m.r2)),p=0,g=this.colorStops.length;p<g;p++){var v=this.colorStops[p].color,b=this.colorStops[p].opacity,y=this.colorStops[p].offset;typeof b<"u"&&(v=new e.Color(v).setAlpha(b).toRgba()),h.addColorStop(y,v)}return h}}}),e.util.object.extend(e.Gradient,{fromElement:function(d,h,m,p){var g=parseFloat(m)/(/%$/.test(m)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var v=d.getElementsByTagName("stop"),b,y=d.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=d.getAttribute("gradientTransform")||"",S=[],C,k,w=0,A=0,I;for(d.nodeName==="linearGradient"||d.nodeName==="LINEARGRADIENT"?(b="linear",C=o(d)):(b="radial",C=c(d)),k=v.length;k--;)S.push(a(v[k],g));I=e.parseTransformAttribute(_),u(h,C,p,y),y==="pixels"&&(w=-h.left,A=-h.top);var z=new e.Gradient({id:d.getAttribute("id"),type:b,coords:C,colorStops:S,gradientUnits:y,gradientTransform:I,offsetX:w,offsetY:A});return z}});function u(d,h,m,p){var g,v;Object.keys(h).forEach(function(b){g=h[b],g==="Infinity"?v=1:g==="-Infinity"?v=0:(v=parseFloat(h[b],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(v*=.01,p==="pixels"&&((b==="x1"||b==="x2"||b==="r2")&&(v*=m.viewBoxWidth||m.width),(b==="y1"||b==="y2")&&(v*=m.viewBoxHeight||m.height)))),h[b]=v})}}(),function(){var a=e.util.toFixed;e.Pattern=e.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(o,c){if(o||(o={}),this.id=e.Object.__uid++,this.setOptions(o),!o.source||o.source&&typeof o.source!="string"){c&&c(this);return}else{var f=this;this.source=e.util.createImage(),e.util.loadImage(o.source,function(u,d){f.source=u,c&&c(f,d)},null,this.crossOrigin)}},toObject:function(o){var c=e.Object.NUM_FRACTION_DIGITS,f,u;return typeof this.source.src=="string"?f=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(f=this.source.toDataURL()),u={type:"pattern",source:f,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:a(this.offsetX,c),offsetY:a(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},e.util.populateWithProperties(this,u,o),u},toSVG:function(o){var c=typeof this.source=="function"?this.source():this.source,f=c.width/o.width,u=c.height/o.height,d=this.offsetX/o.width,h=this.offsetY/o.height,m="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(u=1,h&&(u+=Math.abs(h))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(f=1,d&&(f+=Math.abs(d))),c.src?m=c.src:c.toDataURL&&(m=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+d+'" y="'+h+'" width="'+f+'" height="'+u+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+m+`"></image>
</pattern>
`},setOptions:function(o){for(var c in o)this[c]=o[c]},toLive:function(o){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":o.createPattern(c,this.repeat)}})}(),function(a){var o=a.fabric||(a.fabric={}),c=o.util.toFixed;if(o.Shadow){o.warn("fabric.Shadow is already defined.");return}o.Shadow=o.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){typeof f=="string"&&(f=this._parseShadow(f));for(var u in f)this[u]=f[u];this.id=o.Object.__uid++},_parseShadow:function(f){var u=f.trim(),d=o.Shadow.reOffsetsAndBlur.exec(u)||[],h=u.replace(o.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:h.trim(),offsetX:parseFloat(d[1],10)||0,offsetY:parseFloat(d[2],10)||0,blur:parseFloat(d[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var u=40,d=40,h=o.Object.NUM_FRACTION_DIGITS,m=o.util.rotateVector({x:this.offsetX,y:this.offsetY},o.util.degreesToRadians(-f.angle)),p=20,g=new o.Color(this.color);return f.width&&f.height&&(u=c((Math.abs(m.x)+this.blur)/f.width,h)*100+p,d=c((Math.abs(m.y)+this.blur)/f.height,h)*100+p),f.flipX&&(m.x*=-1),f.flipY&&(m.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+d+'%" height="'+(100+2*d)+'%" x="-'+u+'%" width="'+(100+2*u)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,h)+`"></feGaussianBlur>
	<feOffset dx="`+c(m.x,h)+'" dy="'+c(m.y,h)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},u=o.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(d){this[d]!==u[d]&&(f[d]=this[d])},this),f}}),o.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(i),function(){if(e.StaticCanvas){e.warn("fabric.StaticCanvas is already defined.");return}var a=e.util.object.extend,o=e.util.getElementOffset,c=e.util.removeFromArray,f=e.util.toFixed,u=e.util.transformPoint,d=e.util.invertTransform,h=e.util.getNodeCanvas,m=e.util.createCanvasElement,p=new Error("Could not initialize `canvas` element");e.StaticCanvas=e.util.createClass(e.CommonMethods,{initialize:function(g,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,v)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:e.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,v){var b=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(v),this.interactive||this._initRetinaScaling(),v.overlayImage&&this.setOverlayImage(v.overlayImage,b),v.backgroundImage&&this.setBackgroundImage(v.backgroundImage,b),v.backgroundColor&&this.setBackgroundColor(v.backgroundColor,b),v.overlayColor&&this.setOverlayColor(v.overlayColor,b),this.calcOffset()},_isRetinaScaling:function(){return e.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,e.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=e.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,v,b){v.setAttribute("width",this.width*g),v.setAttribute("height",this.height*g),b.scale(g,g)},calcOffset:function(){return this._offset=o(this.lowerCanvasEl),this},setOverlayImage:function(g,v,b){return this.__setBgOverlayImage("overlayImage",g,v,b)},setBackgroundImage:function(g,v,b){return this.__setBgOverlayImage("backgroundImage",g,v,b)},setOverlayColor:function(g,v){return this.__setBgOverlayColor("overlayColor",g,v)},setBackgroundColor:function(g,v){return this.__setBgOverlayColor("backgroundColor",g,v)},__setBgOverlayImage:function(g,v,b,y){return typeof v=="string"?e.util.loadImage(v,function(_,S){if(_){var C=new e.Image(_,y);this[g]=C,C.canvas=this}b&&b(_,S)},this,y&&y.crossOrigin):(y&&v.setOptions(y),this[g]=v,v&&(v.canvas=this),b&&b(v,!1)),this},__setBgOverlayColor:function(g,v,b){return this[g]=v,this._initGradient(v,g),this._initPattern(v,g,b),this},_createCanvasElement:function(){var g=m();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw p;return g},_initOptions:function(g){var v=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(v.width,10)||0,this.height=this.height||parseInt(v.height,10)||0,this.lowerCanvasEl.style&&(v.width=this.width,v.height=this.height,v.style.width=this.width+"px",v.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=e.util.getById(g)||this._createCanvasElement(),e.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,v){return this.setDimensions({width:g},v)},setHeight:function(g,v){return this.setDimensions({height:g},v)},setDimensions:function(g,v){var b;v=v||{};for(var y in g)b=g[y],v.cssOnly||(this._setBackstoreDimension(y,g[y]),b+="px",this.hasLostContext=!0),v.backstoreOnly||this._setCssDimension(y,b);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),v.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,v){return this.lowerCanvasEl[g]=v,this.upperCanvasEl&&(this.upperCanvasEl[g]=v),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=v),this[g]=v,this},_setCssDimension:function(g,v){return this.lowerCanvasEl.style[g]=v,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=v),this.wrapperEl&&(this.wrapperEl.style[g]=v),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var v=this._activeObject,b=this.backgroundImage,y=this.overlayImage,_,S,C;for(this.viewportTransform=g,S=0,C=this._objects.length;S<C;S++)_=this._objects[S],_.group||_.setCoords(!0);return v&&v.setCoords(),b&&b.setCoords(!0),y&&y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,v){var b=g,y=this.viewportTransform.slice(0);g=u(g,d(this.viewportTransform)),y[0]=v,y[3]=v;var _=u(g,y);return y[4]+=b.x-_.x,y[5]+=b.y-_.y,this.setViewportTransform(y)},setZoom:function(g){return this.zoomToPoint(new e.Point(0,0),g),this},absolutePan:function(g){var v=this.viewportTransform.slice(0);return v[4]=-g.x,v[5]=-g.y,this.setViewportTransform(v)},relativePan:function(g){return this.absolutePan(new e.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=e.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},v=this.width,b=this.height,y=d(this.viewportTransform);return g.tl=u({x:0,y:0},y),g.br=u({x:v,y:b},y),g.tr=new e.Point(g.br.x,g.tl.y),g.bl=new e.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,v){var b=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),e.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(b[0],b[1],b[2],b[3],b[4],b[5]),this._renderObjects(g,v),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var v=this.viewportTransform,b=this.clipPath;g.save(),g.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.globalCompositeOperation="destination-in",b.transform(g),g.scale(1/b.zoomX,1/b.zoomY),g.drawImage(b._cacheCanvas,-b.cacheTranslationX,-b.cacheTranslationY),g.restore()},_renderObjects:function(g,v){var b,y;for(b=0,y=v.length;b<y;++b)v[b]&&v[b].render(g)},_renderBackgroundOrOverlay:function(g,v){var b=this[v+"Color"],y=this[v+"Image"],_=this.viewportTransform,S=this[v+"Vpt"];if(!(!b&&!y)){if(b){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=b.toLive?b.toLive(g,this):b,S&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.transform(1,0,0,1,b.offsetX||0,b.offsetY||0);var C=b.gradientTransform||b.patternTransform;C&&g.transform(C[0],C[1],C[2],C[3],C[4],C[5]),g.fill(),g.restore()}y&&(g.save(),S&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),y.render(g),g.restore())}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new e.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new e.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new e.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var v=this.getCenterPoint();return this._centerObject(g,v)},viewportCenterObject:function(g){var v=this.getVpCenter();return this._centerObject(g,v)},viewportCenterObjectH:function(g){var v=this.getVpCenter();return this._centerObject(g,new e.Point(v.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var v=this.getVpCenter();return this._centerObject(g,new e.Point(g.getCenterPoint().x,v.y))},getVpCenter:function(){var g=this.getCenterPoint(),v=d(this.viewportTransform);return u(g,v)},_centerObject:function(g,v){return g.setPositionByOrigin(v,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,v){var b=this.clipPath,y={version:e.version,objects:this._toObjects(g,v)};return b&&!b.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,g,v)),a(y,this.__serializeBgOverlay(g,v)),e.util.populateWithProperties(this,y,v),y},_toObjects:function(g,v){return this._objects.filter(function(b){return!b.excludeFromExport}).map(function(b){return this._toObject(b,g,v)},this)},_toObject:function(g,v,b){var y;this.includeDefaultValues||(y=g.includeDefaultValues,g.includeDefaultValues=!1);var _=g[v](b);return this.includeDefaultValues||(g.includeDefaultValues=y),_},__serializeBgOverlay:function(g,v){var b={},y=this.backgroundImage,_=this.overlayImage,S=this.backgroundColor,C=this.overlayColor;return S&&S.toObject?S.excludeFromExport||(b.background=S.toObject(v)):S&&(b.background=S),C&&C.toObject?C.excludeFromExport||(b.overlay=C.toObject(v)):C&&(b.overlay=C),y&&!y.excludeFromExport&&(b.backgroundImage=this._toObject(y,g,v)),_&&!_.excludeFromExport&&(b.overlayImage=this._toObject(_,g,v)),b},svgViewportTransformation:!0,toSVG:function(g,v){g||(g={}),g.reviver=v;var b=[];return this._setSVGPreamble(b,g),this._setSVGHeader(b,g),this.clipPath&&b.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(b,"background"),this._setSVGBgOverlayImage(b,"backgroundImage",v),this._setSVGObjects(b,v),this.clipPath&&b.push(`</g>
`),this._setSVGBgOverlayColor(b,"overlay"),this._setSVGBgOverlayImage(b,"overlayImage",v),b.push("</svg>"),b.join("")},_setSVGPreamble:function(g,v){v.suppressPreamble||g.push('<?xml version="1.0" encoding="',v.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,v){var b=v.width||this.width,y=v.height||this.height,_,S='viewBox="0 0 '+this.width+" "+this.height+'" ',C=e.Object.NUM_FRACTION_DIGITS;v.viewBox?S='viewBox="'+v.viewBox.x+" "+v.viewBox.y+" "+v.viewBox.width+" "+v.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,S='viewBox="'+f(-_[4]/_[0],C)+" "+f(-_[5]/_[3],C)+" "+f(this.width/_[0],C)+" "+f(this.height/_[3],C)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',b,'" ','height="',y,'" ',S,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",e.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(v),`</defs>
`)},createSVGClipPathMarkup:function(g){var v=this.clipPath;return v?(v.clipPathId="CLIPPATH_"+e.Object.__uid++,'<clipPath id="'+v.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,v=["background","overlay"].map(function(b){var y=g[b+"Color"];if(y&&y.toLive){var _=g[b+"Vpt"],S=g.viewportTransform,C={width:g.width/(_?S[0]:1),height:g.height/(_?S[3]:1)};return y.toSVG(C,{additionalTransform:_?e.util.matrixToSVG(S):""})}});return v.join("")},createSVGFontFacesMarkup:function(){var g="",v={},b,y,_,S,C,k,w,A,I,z=e.fontPaths,H=[];for(this._objects.forEach(function ee(Z){H.push(Z),Z._objects&&Z._objects.forEach(ee)}),A=0,I=H.length;A<I;A++)if(b=H[A],y=b.fontFamily,!(b.type.indexOf("text")===-1||v[y]||!z[y])&&(v[y]=!0,!!b.styles)){_=b.styles;for(C in _){S=_[C];for(w in S)k=S[w],y=k.fontFamily,!v[y]&&z[y]&&(v[y]=!0)}}for(var Q in v)g+=[`		@font-face {
`,"			font-family: '",Q,`';
`,"			src: url('",z[Q],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,v){var b,y,_,S=this._objects;for(y=0,_=S.length;y<_;y++)b=S[y],!b.excludeFromExport&&this._setSVGObject(g,b,v)},_setSVGObject:function(g,v,b){g.push(v.toSVG(b))},_setSVGBgOverlayImage:function(g,v,b){this[v]&&!this[v].excludeFromExport&&this[v].toSVG&&g.push(this[v].toSVG(b))},_setSVGBgOverlayColor:function(g,v){var b=this[v+"Color"],y=this.viewportTransform,_=this.width,S=this.height;if(b)if(b.toLive){var C=b.repeat,k=e.util.invertTransform(y),w=this[v+"Vpt"],A=w?e.util.matrixToSVG(k):"";g.push('<rect transform="'+A+" translate(",_/2,",",S/2,')"',' x="',b.offsetX-_/2,'" y="',b.offsetY-S/2,'" ','width="',C==="repeat-y"||C==="no-repeat"?b.source.width:_,'" height="',C==="repeat-x"||C==="no-repeat"?b.source.height:S,'" fill="url(#SVGID_'+b.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',b,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var v=this._activeObject,b,y,_;if(g===v&&g.type==="activeSelection")for(_=v._objects,b=_.length;b--;)y=_[b],c(this._objects,y),this._objects.unshift(y);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var v=this._activeObject,b,y,_;if(g===v&&g.type==="activeSelection")for(_=v._objects,b=0;b<_.length;b++)y=_[b],c(this._objects,y),this._objects.push(y);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,v){if(!g)return this;var b=this._activeObject,y,_,S,C,k,w=0;if(g===b&&g.type==="activeSelection")for(k=b._objects,y=0;y<k.length;y++)_=k[y],S=this._objects.indexOf(_),S>0+w&&(C=S-1,c(this._objects,_),this._objects.splice(C,0,_)),w++;else S=this._objects.indexOf(g),S!==0&&(C=this._findNewLowerIndex(g,S,v),c(this._objects,g),this._objects.splice(C,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,v,b){var y,_;if(b)for(y=v,_=v-1;_>=0;--_){var S=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(S){y=_;break}}else y=v-1;return y},bringForward:function(g,v){if(!g)return this;var b=this._activeObject,y,_,S,C,k,w=0;if(g===b&&g.type==="activeSelection")for(k=b._objects,y=k.length;y--;)_=k[y],S=this._objects.indexOf(_),S<this._objects.length-1-w&&(C=S+1,c(this._objects,_),this._objects.splice(C,0,_)),w++;else S=this._objects.indexOf(g),S!==this._objects.length-1&&(C=this._findNewUpperIndex(g,S,v),c(this._objects,g),this._objects.splice(C,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,v,b){var y,_,S;if(b)for(y=v,_=v+1,S=this._objects.length;_<S;++_){var C=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(C){y=_;break}}else y=v+1;return y},moveTo:function(g,v){return c(this._objects,g),this._objects.splice(v,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),e.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),e.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),a(e.StaticCanvas.prototype,e.Observable),a(e.StaticCanvas.prototype,e.Collection),a(e.StaticCanvas.prototype,e.DataURLExporter),a(e.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var v=m();if(!v||!v.getContext)return null;var b=v.getContext("2d");if(!b)return null;switch(g){case"setLineDash":return typeof b.setLineDash<"u";default:return null}}}),e.StaticCanvas.prototype.toJSON=e.StaticCanvas.prototype.toObject,e.isLikelyNode&&(e.StaticCanvas.prototype.createPNGStream=function(){var g=h(this.lowerCanvasEl);return g&&g.createPNGStream()},e.StaticCanvas.prototype.createJPEGStream=function(g){var v=h(this.lowerCanvasEl);return v&&v.createJPEGStream(g)})}(),e.BaseBrush=e.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(a){a.strokeStyle=this.color,a.lineWidth=this.width,a.lineCap=this.strokeLineCap,a.miterLimit=this.strokeMiterLimit,a.lineJoin=this.strokeLineJoin,a.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(a){var o=this.canvas.viewportTransform;a.save(),a.transform(o[0],o[1],o[2],o[3],o[4],o[5])},_setShadow:function(){if(this.shadow){var a=this.canvas,o=this.shadow,c=a.contextTop,f=a.getZoom();a&&a._isRetinaScaling()&&(f*=e.devicePixelRatio),c.shadowColor=o.color,c.shadowBlur=o.blur*f,c.shadowOffsetX=o.offsetX*f,c.shadowOffsetY=o.offsetY*f}},needsFullRender:function(){var a=new e.Color(this.color);return a.getAlpha()<1||!!this.shadow},_resetShadow:function(){var a=this.canvas.contextTop;a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0},_isOutSideCanvas:function(a){return a.x<0||a.x>this.canvas.getWidth()||a.y<0||a.y>this.canvas.getHeight()}}),function(){e.PencilBrush=e.util.createClass(e.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(a){this.canvas=a,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(a,o,c){var f=o.midPointFrom(c);return a.quadraticCurveTo(o.x,o.y,f.x,f.y),f},onMouseDown:function(a,o){this.canvas._isMainEvent(o.e)&&(this.drawStraightLine=o.e[this.straightLineKey],this._prepareForDrawing(a),this._captureDrawingPath(a),this._render())},onMouseMove:function(a,o){if(this.canvas._isMainEvent(o.e)&&(this.drawStraightLine=o.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a))&&this._captureDrawingPath(a)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,f=c.length,u=this.canvas.contextTop;this._saveAndTransform(u),this.oldEnd&&(u.beginPath(),u.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(u,c[f-2],c[f-1],!0),u.stroke(),u.restore()}},onMouseUp:function(a){return this.canvas._isMainEvent(a.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(a){var o=new e.Point(a.x,a.y);this._reset(),this._addPoint(o),this.canvas.contextTop.moveTo(o.x,o.y)},_addPoint:function(a){return this._points.length>1&&a.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(a),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(a){var o=new e.Point(a.x,a.y);return this._addPoint(o)},_render:function(a){var o,c,f=this._points[0],u=this._points[1];if(a=a||this.canvas.contextTop,this._saveAndTransform(a),a.beginPath(),this._points.length===2&&f.x===u.x&&f.y===u.y){var d=this.width/1e3;f=new e.Point(f.x,f.y),u=new e.Point(u.x,u.y),f.x-=d,u.x+=d}for(a.moveTo(f.x,f.y),o=1,c=this._points.length;o<c;o++)this._drawSegment(a,f,u),f=this._points[o],u=this._points[o+1];a.lineTo(f.x,f.y),a.stroke(),a.restore()},convertPointsToSVGPath:function(a){var o=this.width/1e3;return e.util.getSmoothPathFromPoints(a,o)},_isEmptySVGPath:function(a){var o=e.util.joinPath(a);return o==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(a){var o=new e.Path(a,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,o.shadow=new e.Shadow(this.shadow)),o},decimatePoints:function(a,o){if(a.length<=2)return a;var c=this.canvas.getZoom(),f=Math.pow(o/c,2),u,d=a.length-1,h=a[0],m=[h],p;for(u=1;u<d-1;u++)p=Math.pow(h.x-a[u].x,2)+Math.pow(h.y-a[u].y,2),p>=f&&(h=a[u],m.push(h));return m.push(a[d]),m},_finalizeAndAddPath:function(){var a=this.canvas.contextTop;a.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var o=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(o)){this.canvas.requestRenderAll();return}var c=this.createPath(o);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),e.CircleBrush=e.util.createClass(e.BaseBrush,{width:10,initialize:function(a){this.canvas=a,this.points=[]},drawDot:function(a){var o=this.addPoint(a),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,o),c.restore()},dot:function(a,o){a.fillStyle=o.fill,a.beginPath(),a.arc(o.x,o.y,o.radius,0,Math.PI*2,!1),a.closePath(),a.fill()},onMouseDown:function(a){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(a)},_render:function(){var a=this.canvas.contextTop,o,c,f=this.points;for(this._saveAndTransform(a),o=0,c=f.length;o<c;o++)this.dot(a,f[o]);a.restore()},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(a),this._render()):this.drawDot(a))},onMouseUp:function(){var a=this.canvas.renderOnAddRemove,o,c;this.canvas.renderOnAddRemove=!1;var f=[];for(o=0,c=this.points.length;o<c;o++){var u=this.points[o],d=new e.Circle({radius:u.radius,left:u.x,top:u.y,originX:"center",originY:"center",fill:u.fill});this.shadow&&(d.shadow=new e.Shadow(this.shadow)),f.push(d)}var h=new e.Group(f);h.canvas=this.canvas,this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.requestRenderAll()},addPoint:function(a){var o=new e.Point(a.x,a.y),c=e.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new e.Color(this.color).setAlpha(e.util.getRandomInt(0,100)/100).toRgba();return o.radius=c,o.fill=f,this.points.push(o),o}}),e.SprayBrush=e.util.createClass(e.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(a){this.canvas=a,this.sprayChunks=[]},onMouseDown:function(a){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(a),this.render(this.sprayChunkPoints)},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.addSprayChunk(a),this.render(this.sprayChunkPoints))},onMouseUp:function(){var a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var o=[],c=0,f=this.sprayChunks.length;c<f;c++)for(var u=this.sprayChunks[c],d=0,h=u.length;d<h;d++){var m=new e.Rect({width:u[d].width,height:u[d].width,left:u[d].x+1,top:u[d].y+1,originX:"center",originY:"center",fill:this.color});o.push(m)}this.optimizeOverlapping&&(o=this._getOptimizedRects(o));var p=new e.Group(o);this.shadow&&p.set("shadow",new e.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:p}),this.canvas.add(p),this.canvas.fire("path:created",{path:p}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.requestRenderAll()},_getOptimizedRects:function(a){var o={},c,f,u;for(f=0,u=a.length;f<u;f++)c=a[f].left+""+a[f].top,o[c]||(o[c]=a[f]);var d=[];for(c in o)d.push(o[c]);return d},render:function(a){var o=this.canvas.contextTop,c,f;for(o.fillStyle=this.color,this._saveAndTransform(o),c=0,f=a.length;c<f;c++){var u=a[c];typeof u.opacity<"u"&&(o.globalAlpha=u.opacity),o.fillRect(u.x,u.y,u.width,u.width)}o.restore()},_render:function(){var a=this.canvas.contextTop,o,c;for(a.fillStyle=this.color,this._saveAndTransform(a),o=0,c=this.sprayChunks.length;o<c;o++)this.render(this.sprayChunks[o]);a.restore()},addSprayChunk:function(a){this.sprayChunkPoints=[];var o,c,f,u=this.width/2,d;for(d=0;d<this.density;d++){o=e.util.getRandomInt(a.x-u,a.x+u),c=e.util.getRandomInt(a.y-u,a.y+u),this.dotWidthVariance?f=e.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):f=this.dotWidth;var h=new e.Point(o,c);h.width=f,this.randomOpacity&&(h.opacity=e.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(h)}this.sprayChunks.push(this.sprayChunkPoints)}}),e.PatternBrush=e.util.createClass(e.PencilBrush,{getPatternSrc:function(){var a=20,o=5,c=e.util.createCanvasElement(),f=c.getContext("2d");return c.width=c.height=a+o,f.fillStyle=this.color,f.beginPath(),f.arc(a/2,a/2,a/2,0,Math.PI*2,!1),f.closePath(),f.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(a){return a.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(a){this.callSuper("_setBrushStyles",a),a.strokeStyle=this.getPattern(a)},createPath:function(a){var o=this.callSuper("createPath",a),c=o._getLeftTopCoords().scalarAdd(o.strokeWidth/2);return o.stroke=new e.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),o}}),function(){var a=e.util.getPointer,o=e.util.degreesToRadians,c=e.util.isTouchEvent;e.Canvas=e.util.createClass(e.StaticCanvas,{initialize:function(u,d){d||(d={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,d),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=e.PencilBrush&&new e.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var u=this.getActiveObjects(),d,h,m;if(u.length>0&&!this.preserveObjectStacking){h=[],m=[];for(var p=0,g=this._objects.length;p<g;p++)d=this._objects[p],u.indexOf(d)===-1?h.push(d):m.push(d);u.length>1&&(this._activeObject._objects=m),h.push.apply(h,m)}else h=this._objects;return h},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var u=this.contextContainer;return this.renderCanvas(u,this._chooseObjectsToRender()),this},renderTopLayer:function(u){u.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(u),this.contextTopDirty=!0),u.restore()},renderTop:function(){var u=this.contextTop;return this.clearContext(u),this.renderTopLayer(u),this.fire("after:render"),this},_normalizePointer:function(u,d){var h=u.calcTransformMatrix(),m=e.util.invertTransform(h),p=this.restorePointerVpt(d);return e.util.transformPoint(p,m)},isTargetTransparent:function(u,d,h){if(u.shouldCache()&&u._cacheCanvas&&u!==this._activeObject){var m=this._normalizePointer(u,{x:d,y:h}),p=Math.max(u.cacheTranslationX+m.x*u.zoomX,0),g=Math.max(u.cacheTranslationY+m.y*u.zoomY,0),_=e.util.isTransparent(u._cacheContext,Math.round(p),Math.round(g),this.targetFindTolerance);return _}var v=this.contextCache,b=u.selectionBackgroundColor,y=this.viewportTransform;u.selectionBackgroundColor="",this.clearContext(v),v.save(),v.transform(y[0],y[1],y[2],y[3],y[4],y[5]),u.render(v),v.restore(),u.selectionBackgroundColor=b;var _=e.util.isTransparent(v,d,h,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(u){var d=!1;return Array.isArray(this.selectionKey)?d=!!this.selectionKey.find(function(h){return u[h]===!0}):d=u[this.selectionKey],d},_shouldClearSelection:function(u,d){var h=this.getActiveObjects(),m=this._activeObject;return!d||d&&m&&h.length>1&&h.indexOf(d)===-1&&m!==d&&!this._isSelectionKeyPressed(u)||d&&!d.evented||d&&!d.selectable&&m&&m!==d},_shouldCenterTransform:function(u,d,h){if(u){var m;return d==="scale"||d==="scaleX"||d==="scaleY"||d==="resizing"?m=this.centeredScaling||u.centeredScaling:d==="rotate"&&(m=this.centeredRotation||u.centeredRotation),m?!h:h}},_getOriginFromCorner:function(u,d){var h={x:u.originX,y:u.originY};return d==="ml"||d==="tl"||d==="bl"?h.x="right":(d==="mr"||d==="tr"||d==="br")&&(h.x="left"),d==="tl"||d==="mt"||d==="tr"?h.y="bottom":(d==="bl"||d==="mb"||d==="br")&&(h.y="top"),h},_getActionFromCorner:function(u,d,h,m){if(!d||!u)return"drag";var p=m.controls[d];return p.getActionName(h,p,m)},_setupCurrentTransform:function(u,d,h){if(d){var m=this.getPointer(u),p=d.__corner,g=d.controls[p],v=h&&p?g.getActionHandler(u,d,g):e.controlsUtils.dragHandler,b=this._getActionFromCorner(h,p,u,d),y=this._getOriginFromCorner(d,p),_=u[this.centeredKey],S={target:d,action:b,actionHandler:v,corner:p,scaleX:d.scaleX,scaleY:d.scaleY,skewX:d.skewX,skewY:d.skewY,offsetX:m.x-d.left,offsetY:m.y-d.top,originX:y.x,originY:y.y,ex:m.x,ey:m.y,lastX:m.x,lastY:m.y,theta:o(d.angle),width:d.width*d.scaleX,shiftKey:u.shiftKey,altKey:_,original:e.util.saveObjectTransform(d)};this._shouldCenterTransform(d,b,_)&&(S.originX="center",S.originY="center"),S.original.originX=y.x,S.original.originY=y.y,this._currentTransform=S,this._beforeTransform(u)}},setCursor:function(u){this.upperCanvasEl.style.cursor=u},_drawSelection:function(u){var d=this._groupSelector,h=new e.Point(d.ex,d.ey),m=e.util.transformPoint(h,this.viewportTransform),p=new e.Point(d.ex+d.left,d.ey+d.top),g=e.util.transformPoint(p,this.viewportTransform),v=Math.min(m.x,g.x),b=Math.min(m.y,g.y),y=Math.max(m.x,g.x),_=Math.max(m.y,g.y),S=this.selectionLineWidth/2;this.selectionColor&&(u.fillStyle=this.selectionColor,u.fillRect(v,b,y-v,_-b)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(u.lineWidth=this.selectionLineWidth,u.strokeStyle=this.selectionBorderColor,v+=S,b+=S,y-=S,_-=S,e.Object.prototype._setLineDash.call(this,u,this.selectionDashArray),u.strokeRect(v,b,y-v,_-b))},findTarget:function(u,d){if(!this.skipTargetFind){var h=!0,m=this.getPointer(u,h),p=this._activeObject,g=this.getActiveObjects(),v,b,y=c(u),_=g.length>1&&!d||g.length===1;if(this.targets=[],_&&p._findTargetCorner(m,y)||g.length>1&&!d&&p===this._searchPossibleTargets([p],m))return p;if(g.length===1&&p===this._searchPossibleTargets([p],m))if(this.preserveObjectStacking)v=p,b=this.targets,this.targets=[];else return p;var S=this._searchPossibleTargets(this._objects,m);return u[this.altSelectionKey]&&S&&v&&S!==v&&(S=v,this.targets=b),S}},_checkTarget:function(u,d,h){if(d&&d.visible&&d.evented&&d.containsPoint(u))if((this.perPixelTargetFind||d.perPixelTargetFind)&&!d.isEditing){var m=this.isTargetTransparent(d,h.x,h.y);if(!m)return!0}else return!0},_searchPossibleTargets:function(u,d){for(var h,m=u.length,p;m--;){var g=u[m],v=g.group?this._normalizePointer(g.group,d):d;if(this._checkTarget(v,g,d)){h=u[m],h.subTargetCheck&&h instanceof e.Group&&(p=this._searchPossibleTargets(h._objects,d),p&&this.targets.push(p));break}}return h},restorePointerVpt:function(u){return e.util.transformPoint(u,e.util.invertTransform(this.viewportTransform))},getPointer:function(u,d){if(this._absolutePointer&&!d)return this._absolutePointer;if(this._pointer&&d)return this._pointer;var h=a(u),m=this.upperCanvasEl,p=m.getBoundingClientRect(),g=p.width||0,v=p.height||0,b;(!g||!v)&&("top"in p&&"bottom"in p&&(v=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(g=Math.abs(p.right-p.left))),this.calcOffset(),h.x=h.x-this._offset.left,h.y=h.y-this._offset.top,d||(h=this.restorePointerVpt(h));var y=this.getRetinaScaling();return y!==1&&(h.x/=y,h.y/=y),g===0||v===0?b={width:1,height:1}:b={width:m.width/g,height:m.height/v},{x:h.x*b.width,y:h.y*b.height}},_createUpperCanvas:function(){var u=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),d=this.lowerCanvasEl,h=this.upperCanvasEl;h?h.className="":(h=this._createCanvasElement(),this.upperCanvasEl=h),e.util.addClass(h,"upper-canvas "+u),this.wrapperEl.appendChild(h),this._copyCanvasStyle(d,h),this._applyCanvasStyle(h),this.contextTop=h.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=e.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),e.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),e.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(u){var d=this.width||u.width,h=this.height||u.height;e.util.setStyle(u,{position:"absolute",width:d+"px",height:h+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),u.width=d,u.height=h,e.util.makeElementUnselectable(u)},_copyCanvasStyle:function(u,d){d.style.cssText=u.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var u=this._activeObject;return u?u.type==="activeSelection"&&u._objects?u._objects.slice(0):[u]:[]},_onObjectRemoved:function(u){u===this._activeObject&&(this.fire("before:selection:cleared",{target:u}),this._discardActiveObject(),this.fire("selection:cleared",{target:u}),u.fire("deselected")),u===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",u)},_fireSelectionEvents:function(u,d){var h=!1,m=this.getActiveObjects(),p=[],g=[];u.forEach(function(v){m.indexOf(v)===-1&&(h=!0,v.fire("deselected",{e:d,target:v}),g.push(v))}),m.forEach(function(v){u.indexOf(v)===-1&&(h=!0,v.fire("selected",{e:d,target:v}),p.push(v))}),u.length>0&&m.length>0?h&&this.fire("selection:updated",{e:d,selected:p,deselected:g}):m.length>0?this.fire("selection:created",{e:d,selected:p}):u.length>0&&this.fire("selection:cleared",{e:d,deselected:g})},setActiveObject:function(u,d){var h=this.getActiveObjects();return this._setActiveObject(u,d),this._fireSelectionEvents(h,d),this},_setActiveObject:function(u,d){return this._activeObject===u||!this._discardActiveObject(d,u)||u.onSelect({e:d})?!1:(this._activeObject=u,!0)},_discardActiveObject:function(u,d){var h=this._activeObject;if(h){if(h.onDeselect({e:u,object:d}))return!1;this._activeObject=null}return!0},discardActiveObject:function(u){var d=this.getActiveObjects(),h=this.getActiveObject();return d.length&&this.fire("before:selection:cleared",{target:h,e:u}),this._discardActiveObject(u),this._fireSelectionEvents(d,u),this},dispose:function(){var u=this.wrapperEl;return this.removeListeners(),u.removeChild(this.upperCanvasEl),u.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(d){e.util.cleanUpJsdomNode(this[d]),this[d]=void 0}).bind(this)),u.parentNode&&u.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,e.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(u){var d=this._activeObject;d&&d._renderControls(u)},_toObject:function(u,d,h){var m=this._realizeGroupTransformOnObject(u),p=this.callSuper("_toObject",u,d,h);return this._unwindGroupTransformOnObject(u,m),p},_realizeGroupTransformOnObject:function(u){if(u.group&&u.group.type==="activeSelection"&&this._activeObject===u.group){var d=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],h={};return d.forEach(function(m){h[m]=u[m]}),e.util.addTransformToObject(u,this._activeObject.calcOwnMatrix()),h}else return null},_unwindGroupTransformOnObject:function(u,d){d&&u.set(d)},_setSVGObject:function(u,d,h){var m=this._realizeGroupTransformOnObject(d);this.callSuper("_setSVGObject",u,d,h),this._unwindGroupTransformOnObject(d,m)},setViewportTransform:function(u){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),e.StaticCanvas.prototype.setViewportTransform.call(this,u)}});for(var f in e.StaticCanvas)f!=="prototype"&&(e.Canvas[f]=e.StaticCanvas[f])}(),function(){var a=e.util.addListener,o=e.util.removeListener,c=3,f=2,u=1,d={passive:!1};function h(m,p){return m.button&&m.button===p-1}e.util.object.extend(e.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(a,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(m,p){var g=this.upperCanvasEl,v=this._getEventPrefix();m(e.window,"resize",this._onResize),m(g,v+"down",this._onMouseDown),m(g,v+"move",this._onMouseMove,d),m(g,v+"out",this._onMouseOut),m(g,v+"enter",this._onMouseEnter),m(g,"wheel",this._onMouseWheel),m(g,"contextmenu",this._onContextMenu),m(g,"dblclick",this._onDoubleClick),m(g,"dragover",this._onDragOver),m(g,"dragenter",this._onDragEnter),m(g,"dragleave",this._onDragLeave),m(g,"drop",this._onDrop),this.enablePointerEvents||m(g,"touchstart",this._onTouchStart,d),typeof eventjs<"u"&&p in eventjs&&(eventjs[p](g,"gesture",this._onGesture),eventjs[p](g,"drag",this._onDrag),eventjs[p](g,"orientation",this._onOrientationChange),eventjs[p](g,"shake",this._onShake),eventjs[p](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(o,"remove");var m=this._getEventPrefix();o(e.document,m+"up",this._onMouseUp),o(e.document,"touchend",this._onTouchEnd,d),o(e.document,m+"move",this._onMouseMove,d),o(e.document,"touchmove",this._onMouseMove,d)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(m,p){this.__onTransformGesture&&this.__onTransformGesture(m,p)},_onDrag:function(m,p){this.__onDrag&&this.__onDrag(m,p)},_onMouseWheel:function(m){this.__onMouseWheel(m)},_onMouseOut:function(m){var p=this._hoveredTarget;this.fire("mouse:out",{target:p,e:m}),this._hoveredTarget=null,p&&p.fire("mouseout",{e:m});var g=this;this._hoveredTargets.forEach(function(v){g.fire("mouse:out",{target:p,e:m}),v&&p.fire("mouseout",{e:m})}),this._hoveredTargets=[]},_onMouseEnter:function(m){!this._currentTransform&&!this.findTarget(m)&&(this.fire("mouse:over",{target:null,e:m}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(m,p){this.__onOrientationChange&&this.__onOrientationChange(m,p)},_onShake:function(m,p){this.__onShake&&this.__onShake(m,p)},_onLongPress:function(m,p){this.__onLongPress&&this.__onLongPress(m,p)},_onDragOver:function(m){m.preventDefault();var p=this._simpleEventHandler("dragover",m);this._fireEnterLeaveEvents(p,m)},_onDrop:function(m){return this._simpleEventHandler("drop:before",m),this._simpleEventHandler("drop",m)},_onContextMenu:function(m){return this.stopContextMenu&&(m.stopPropagation(),m.preventDefault()),!1},_onDoubleClick:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"dblclick"),this._resetTransformEventData(m)},getPointerId:function(m){var p=m.changedTouches;return p?p[0]&&p[0].identifier:this.enablePointerEvents?m.pointerId:-1},_isMainEvent:function(m){return m.isPrimary===!0?!0:m.isPrimary===!1?!1:m.type==="touchend"&&m.touches.length===0?!0:m.changedTouches?m.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(m){m.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(m)),this.__onMouseDown(m),this._resetTransformEventData();var p=this.upperCanvasEl,g=this._getEventPrefix();a(e.document,"touchend",this._onTouchEnd,d),a(e.document,"touchmove",this._onMouseMove,d),o(p,g+"down",this._onMouseDown)},_onMouseDown:function(m){this.__onMouseDown(m),this._resetTransformEventData();var p=this.upperCanvasEl,g=this._getEventPrefix();o(p,g+"move",this._onMouseMove,d),a(e.document,g+"up",this._onMouseUp),a(e.document,g+"move",this._onMouseMove,d)},_onTouchEnd:function(m){if(!(m.touches.length>0)){this.__onMouseUp(m),this._resetTransformEventData(),this.mainTouchId=null;var p=this._getEventPrefix();o(e.document,"touchend",this._onTouchEnd,d),o(e.document,"touchmove",this._onMouseMove,d);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){a(g.upperCanvasEl,p+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(m){this.__onMouseUp(m),this._resetTransformEventData();var p=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(m)&&(o(e.document,g+"up",this._onMouseUp),o(e.document,g+"move",this._onMouseMove,d),a(p,g+"move",this._onMouseMove,d))},_onMouseMove:function(m){!this.allowTouchScrolling&&m.preventDefault&&m.preventDefault(),this.__onMouseMove(m)},_onResize:function(){this.calcOffset()},_shouldRender:function(m){var p=this._activeObject;return!!p!=!!m||p&&m&&p!==m?!0:(p&&p.isEditing,!1)},__onMouseUp:function(m){var p,g=this._currentTransform,v=this._groupSelector,b=!1,y=!v||v.left===0&&v.top===0;if(this._cacheTransformEventData(m),p=this._target,this._handleEvent(m,"up:before"),h(m,c)){this.fireRightClick&&this._handleEvent(m,"up",c,y);return}if(h(m,f)){this.fireMiddleClick&&this._handleEvent(m,"up",f,y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(m);return}if(this._isMainEvent(m)){if(g&&(this._finalizeCurrentTransform(m),b=g.actionPerformed),!y){var _=p===this._activeObject;this._maybeGroupObjects(m),b||(b=this._shouldRender(p)||!_&&p===this._activeObject)}var S,C;if(p){if(S=p._findTargetCorner(this.getPointer(m,!0),e.util.isTouchEvent(m)),p.selectable&&p!==this._activeObject&&p.activeOn==="up")this.setActiveObject(p,m),b=!0;else{var k=p.controls[S],w=k&&k.getMouseUpHandler(m,p,k);w&&(C=this.getPointer(m),w(m,g,C.x,C.y))}p.isMoving=!1}if(g&&(g.target!==p||g.corner!==S)){var A=g.target&&g.target.controls[g.corner],I=A&&A.getMouseUpHandler(m,p,k);C=C||this.getPointer(m),I&&I(m,g,C.x,C.y)}this._setCursorFromEvent(m,p),this._handleEvent(m,"up",u,y),this._groupSelector=null,this._currentTransform=null,p&&(p.__corner=0),b?this.requestRenderAll():y||this.renderTop()}},_simpleEventHandler:function(m,p){var g=this.findTarget(p),v=this.targets,b={e:p,target:g,subTargets:v};if(this.fire(m,b),g&&g.fire(m,b),!v)return g;for(var y=0;y<v.length;y++)v[y].fire(m,b);return g},_handleEvent:function(m,p,g,v){var b=this._target,y=this.targets||[],_={e:m,target:b,subTargets:y,button:g||u,isClick:v||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};p==="up"&&(_.currentTarget=this.findTarget(m),_.currentSubTargets=this.targets),this.fire("mouse:"+p,_),b&&b.fire("mouse"+p,_);for(var S=0;S<y.length;S++)y[S].fire("mouse"+p,_)},_finalizeCurrentTransform:function(m){var p=this._currentTransform,g=p.target,v={e:m,target:g,transform:p,action:p.action};g._scaling&&(g._scaling=!1),g.setCoords(),(p.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",v)},_onMouseDownInDrawingMode:function(m){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(m).requestRenderAll();var p=this.getPointer(m);this.freeDrawingBrush.onMouseDown(p,{e:m,pointer:p}),this._handleEvent(m,"down")},_onMouseMoveInDrawingMode:function(m){if(this._isCurrentlyDrawing){var p=this.getPointer(m);this.freeDrawingBrush.onMouseMove(p,{e:m,pointer:p})}this.setCursor(this.freeDrawingCursor),this._handleEvent(m,"move")},_onMouseUpInDrawingMode:function(m){var p=this.getPointer(m);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:m,pointer:p}),this._handleEvent(m,"up")},__onMouseDown:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"down:before");var p=this._target;if(h(m,c)){this.fireRightClick&&this._handleEvent(m,"down",c);return}if(h(m,f)){this.fireMiddleClick&&this._handleEvent(m,"down",f);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(m);return}if(this._isMainEvent(m)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var v=this._shouldRender(p),b=this._shouldGroup(m,p);if(this._shouldClearSelection(m,p)?this.discardActiveObject(m):b&&(this._handleGrouping(m,p),p=this._activeObject),this.selection&&(!p||!p.selectable&&!p.isEditing&&p!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),p){var y=p===this._activeObject;p.selectable&&p.activeOn==="down"&&this.setActiveObject(p,m);var _=p._findTargetCorner(this.getPointer(m,!0),e.util.isTouchEvent(m));if(p.__corner=_,p===this._activeObject&&(_||!b)){this._setupCurrentTransform(m,p,y);var S=p.controls[_],g=this.getPointer(m),C=S&&S.getMouseDownHandler(m,p,S);C&&C(m,this._currentTransform,g.x,g.y)}}this._handleEvent(m,"down"),(v||b)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(m){this._resetTransformEventData(),this._pointer=this.getPointer(m,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(m)||null},_beforeTransform:function(m){var p=this._currentTransform;this.stateful&&p.target.saveState(),this.fire("before:transform",{e:m,transform:p})},__onMouseMove:function(m){this._handleEvent(m,"move:before"),this._cacheTransformEventData(m);var p,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(m);return}if(this._isMainEvent(m)){var v=this._groupSelector;v?(g=this._absolutePointer,v.left=g.x-v.ex,v.top=g.y-v.ey,this.renderTop()):this._currentTransform?this._transformObject(m):(p=this.findTarget(m)||null,this._setCursorFromEvent(m,p),this._fireOverOutEvents(p,m)),this._handleEvent(m,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(m,p){var g=this._hoveredTarget,v=this._hoveredTargets,b=this.targets,y=Math.max(v.length,b.length);this.fireSyntheticInOutEvents(m,p,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(b[_],p,{oldTarget:v[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=m,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(m,p){var g=this._draggedoverTarget,v=this._hoveredTargets,b=this.targets,y=Math.max(v.length,b.length);this.fireSyntheticInOutEvents(m,p,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(b[_],p,{oldTarget:v[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=m},fireSyntheticInOutEvents:function(m,p,g){var v,b,y=g.oldTarget,_,S,C=y!==m,k=g.canvasEvtIn,w=g.canvasEvtOut;C&&(v={e:p,target:m,previousTarget:y},b={e:p,target:y,nextTarget:m}),S=m&&C,_=y&&C,_&&(w&&this.fire(w,b),y.fire(g.evtOut,b)),S&&(k&&this.fire(k,v),m.fire(g.evtIn,v))},__onMouseWheel:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"wheel"),this._resetTransformEventData()},_transformObject:function(m){var p=this.getPointer(m),g=this._currentTransform;g.reset=!1,g.shiftKey=m.shiftKey,g.altKey=m[this.centeredKey],this._performTransformAction(m,g,p),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(m,p,g){var v=g.x,b=g.y,y=p.action,_=!1,S=p.actionHandler;S&&(_=S(m,p,v,b)),y==="drag"&&_&&(p.target.isMoving=!0,this.setCursor(p.target.moveCursor||this.moveCursor)),p.actionPerformed=p.actionPerformed||_},_fire:e.controlsUtils.fireEvent,_setCursorFromEvent:function(m,p){if(!p)return this.setCursor(this.defaultCursor),!1;var g=p.hoverCursor||this.hoverCursor,v=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,b=(!v||!v.contains(p))&&p._findTargetCorner(this.getPointer(m,!0));b?this.setCursor(this.getCornerCursor(b,p,m)):(p.subTargetCheck&&this.targets.concat().reverse().map(function(y){g=y.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(m,p,g){var v=p.controls[m];return v.cursorStyleHandler(g,v,p)}})}(),function(){var a=Math.min,o=Math.max;e.util.object.extend(e.Canvas.prototype,{_shouldGroup:function(c,f){var u=this._activeObject;return u&&this._isSelectionKeyPressed(c)&&f&&f.selectable&&this.selection&&(u!==f||u.type==="activeSelection")&&!f.onSelect({e:c})},_handleGrouping:function(c,f){var u=this._activeObject;u.__corner||f===u&&(f=this.findTarget(c,!0),!f||!f.selectable)||(u&&u.type==="activeSelection"?this._updateActiveSelection(f,c):this._createActiveSelection(f,c))},_updateActiveSelection:function(c,f){var u=this._activeObject,d=u._objects.slice(0);u.contains(c)?(u.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),u.size()===1&&this._setActiveObject(u.item(0),f)):(u.addWithUpdate(c),this._hoveredTarget=u,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(d,f)},_createActiveSelection:function(c,f){var u=this.getActiveObjects(),d=this._createGroup(c);this._hoveredTarget=d,this._setActiveObject(d,f),this._fireSelectionEvents(u,f)},_createGroup:function(c){var f=this._objects,u=f.indexOf(this._activeObject)<f.indexOf(c),d=u?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new e.ActiveSelection(d,{canvas:this})},_groupSelectedObjects:function(c){var f=this._collectObjects(c),u;f.length===1?this.setActiveObject(f[0],c):f.length>1&&(u=new e.ActiveSelection(f.reverse(),{canvas:this}),this.setActiveObject(u,c))},_collectObjects:function(c){for(var f=[],u,d=this._groupSelector.ex,h=this._groupSelector.ey,m=d+this._groupSelector.left,p=h+this._groupSelector.top,g=new e.Point(a(d,m),a(h,p)),v=new e.Point(o(d,m),o(h,p)),b=!this.selectionFullyContained,y=d===m&&h===p,_=this._objects.length;_--&&(u=this._objects[_],!(!(!u||!u.selectable||!u.visible)&&(b&&u.intersectsWithRect(g,v,!0)||u.isContainedWithinRect(g,v,!0)||b&&u.containsPoint(g,null,!0)||b&&u.containsPoint(v,null,!0))&&(f.push(u),y))););return f.length>1&&(f=f.filter(function(S){return!S.onSelect({e:c})})),f},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){e.util.object.extend(e.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var o=a.format||"png",c=a.quality||1,f=(a.multiplier||1)*(a.enableRetinaScaling?this.getRetinaScaling():1),u=this.toCanvasElement(f,a);return e.util.toDataURL(u,o,c)},toCanvasElement:function(a,o){a=a||1,o=o||{};var c=(o.width||this.width)*a,f=(o.height||this.height)*a,u=this.getZoom(),d=this.width,h=this.height,m=u*a,p=this.viewportTransform,g=(p[4]-(o.left||0))*a,v=(p[5]-(o.top||0))*a,b=this.interactive,y=[m,0,0,m,g,v],_=this.enableRetinaScaling,S=e.util.createCanvasElement(),C=this.contextTop;return S.width=c,S.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=c,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(S.getContext("2d"),this._objects),this.viewportTransform=p,this.width=d,this.height=h,this.calcViewportBoundaries(),this.interactive=b,this.enableRetinaScaling=_,this.contextTop=C,S}})}(),e.util.object.extend(e.StaticCanvas.prototype,{loadFromJSON:function(a,o,c){if(a){var f=typeof a=="string"?JSON.parse(a):e.util.object.clone(a),u=this,d=f.clipPath,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(m){u.clear(),u._setBgOverlay(f,function(){d?u._enlivenObjects([d],function(p){u.clipPath=p[0],u.__setupCanvas.call(u,f,m,h,o)}):u.__setupCanvas.call(u,f,m,h,o)})},c),this}},__setupCanvas:function(a,o,c,f){var u=this;o.forEach(function(d,h){u.insertAt(d,h)}),this.renderOnAddRemove=c,delete a.objects,delete a.backgroundImage,delete a.overlayImage,delete a.background,delete a.overlay,this._setOptions(a),this.renderAll(),f&&f()},_setBgOverlay:function(a,o){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!a.backgroundImage&&!a.overlayImage&&!a.background&&!a.overlay){o&&o();return}var f=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&o&&o()};this.__setBgOverlay("backgroundImage",a.backgroundImage,c,f),this.__setBgOverlay("overlayImage",a.overlayImage,c,f),this.__setBgOverlay("backgroundColor",a.background,c,f),this.__setBgOverlay("overlayColor",a.overlay,c,f)},__setBgOverlay:function(a,o,c,f){var u=this;if(!o){c[a]=!0,f&&f();return}a==="backgroundImage"||a==="overlayImage"?e.util.enlivenObjects([o],function(d){u[a]=d[0],c[a]=!0,f&&f()}):this["set"+e.util.string.capitalize(a,!0)](o,function(){c[a]=!0,f&&f()})},_enlivenObjects:function(a,o,c){if(!a||a.length===0){o&&o([]);return}e.util.enlivenObjects(a,function(f){o&&o(f)},null,c)},_toDataURL:function(a,o){this.clone(function(c){o(c.toDataURL(a))})},_toDataURLWithMultiplier:function(a,o,c){this.clone(function(f){c(f.toDataURLWithMultiplier(a,o))})},clone:function(a,o){var c=JSON.stringify(this.toJSON(o));this.cloneWithoutData(function(f){f.loadFromJSON(c,function(){a&&a(f)})})},cloneWithoutData:function(a){var o=e.util.createCanvasElement();o.width=this.width,o.height=this.height;var c=new e.Canvas(o);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),a&&a(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):a&&a(c)}}),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.util.object.clone,u=o.util.toFixed,d=o.util.string.capitalize,h=o.util.degreesToRadians,m=!o.isLikelyNode,p=2;o.Object||(o.Object=o.util.createClass(o.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:m,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=o.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var v=o.perfLimitSizeTotal,b=g.width,y=g.height,_=o.maxCacheSideLimit,S=o.minCacheSideLimit;if(b<=_&&y<=_&&b*y<=v)return b<S&&(g.width=S),y<S&&(g.height=S),g;var C=b/y,k=o.util.limitDimsByArea(C,v),w=o.util.capValue,A=w(S,k.x,_),I=w(S,k.y,_);return b>A&&(g.zoomX/=b/A,g.width=A,g.capped=!0),y>I&&(g.zoomY/=y/I,g.height=I,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),v=this._getTransformedDimensions(0,0),b=v.x*g.scaleX/this.scaleX,y=v.y*g.scaleY/this.scaleY;return{width:b+p,height:y+p,zoomX:g.scaleX,zoomY:g.scaleY,x:b,y}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var v=g._currentTransform.target,b=g._currentTransform.action;if(this===v&&b.slice&&b.slice(0,5)==="scale")return!1}var y=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),S=o.minCacheSideLimit,C=_.width,k=_.height,w,A,I=_.zoomX,z=_.zoomY,H=C!==this.cacheWidth||k!==this.cacheHeight,Q=this.zoomX!==I||this.zoomY!==z,ee=H||Q,Z=0,he=0,_e=!1;if(H){var we=this._cacheCanvas.width,O=this._cacheCanvas.height,N=C>we||k>O,L=(C<we*.9||k<O*.9)&&we>S&&O>S;_e=N||L,N&&!_.capped&&(C>S||k>S)&&(Z=C*.1,he=k*.1)}return this instanceof o.Text&&this.path&&(ee=!0,_e=!0,Z+=this.getHeightOfLine(0)*this.zoomX,he+=this.getHeightOfLine(0)*this.zoomY),ee?(_e?(y.width=Math.ceil(C+Z),y.height=Math.ceil(k+he)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,y.width,y.height)),w=_.x/2,A=_.y/2,this.cacheTranslationX=Math.round(y.width/2-w)+w,this.cacheTranslationY=Math.round(y.height/2-A)+A,this.cacheWidth=C,this.cacheHeight=k,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(I,z),this.zoomX=I,this.zoomY=z,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var v=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,b=this.calcTransformMatrix(!v);g.transform(b[0],b[1],b[2],b[3],b[4],b[5])},toObject:function(g){var v=o.Object.NUM_FRACTION_DIGITS,b={type:this.type,version:o.version,originX:this.originX,originY:this.originY,left:u(this.left,v),top:u(this.top,v),width:u(this.width,v),height:u(this.height,v),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:u(this.strokeWidth,v),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:u(this.strokeMiterLimit,v),scaleX:u(this.scaleX,v),scaleY:u(this.scaleY,v),angle:u(this.angle,v),flipX:this.flipX,flipY:this.flipY,opacity:u(this.opacity,v),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:u(this.skewX,v),skewY:u(this.skewY,v)};return this.clipPath&&!this.clipPath.excludeFromExport&&(b.clipPath=this.clipPath.toObject(g),b.clipPath.inverted=this.clipPath.inverted,b.clipPath.absolutePositioned=this.clipPath.absolutePositioned),o.util.populateWithProperties(this,b,g),this.includeDefaultValues||(b=this._removeDefaultValues(b)),b},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var v=o.util.getKlass(g.type).prototype,b=v.stateProperties;return b.forEach(function(y){y==="left"||y==="top"||(g[y]===v[y]&&delete g[y],Array.isArray(g[y])&&Array.isArray(v[y])&&g[y].length===0&&v[y].length===0&&delete g[y])}),g},toString:function(){return"#<fabric."+d(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=o.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),v=g.scaleX,b=g.scaleY;if(this.canvas){var y=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();v*=y*_,b*=y*_}return{scaleX:v,scaleY:b}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,v){var b=g==="scaleX"||g==="scaleY",y=this[g]!==v,_=!1;return b&&(v=this._constrainScale(v)),g==="scaleX"&&v<0?(this.flipX=!this.flipX,v*=-1):g==="scaleY"&&v<0?(this.flipY=!this.flipY,v*=-1):g==="shadow"&&v&&!(v instanceof o.Shadow)?v=new o.Shadow(v):g==="dirty"&&this.group&&this.group.set("dirty",v),this[g]=v,y&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:o.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,v){if(g.save(),v.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",v.absolutePositioned){var b=o.util.invertTransform(this.calcTransformMatrix());g.transform(b[0],b[1],b[2],b[3],b[4],b[5])}v.transform(g),g.scale(1/v.zoomX,1/v.zoomY),g.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),g.restore()},drawObject:function(g,v){var b=this.fill,y=this.stroke;v?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=b,this.stroke=y},_drawClipPath:function(g,v){v&&(v.canvas=this.canvas,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,v))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var v=this.cacheWidth/this.zoomX,b=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-v/2,-b/2,v,b)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var v=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-v.x/2,-v.y/2,v.x,v.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,v){var b=v.stroke;b&&(g.lineWidth=v.strokeWidth,g.lineCap=v.strokeLineCap,g.lineDashOffset=v.strokeDashOffset,g.lineJoin=v.strokeLineJoin,g.miterLimit=v.strokeMiterLimit,b.toLive?b.gradientUnits==="percentage"||b.gradientTransform||b.patternTransform?this._applyPatternForTransformedGradient(g,b):(g.strokeStyle=b.toLive(g,this),this._applyPatternGradientTransform(g,b)):g.strokeStyle=v.stroke)},_setFillStyles:function(g,v){var b=v.fill;b&&(b.toLive?(g.fillStyle=b.toLive(g,this),this._applyPatternGradientTransform(g,v.fill)):g.fillStyle=b)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,v){!v||v.length===0||(1&v.length&&v.push.apply(v,v),g.setLineDash(v))},_renderControls:function(g,v){var b=this.getViewportTransform(),y=this.calcTransformMatrix(),_,S,C;v=v||{},S=typeof v.hasBorders<"u"?v.hasBorders:this.hasBorders,C=typeof v.hasControls<"u"?v.hasControls:this.hasControls,y=o.util.multiplyTransformMatrices(b,y),_=o.util.qrDecompose(y),g.save(),g.translate(_.translateX,_.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),g.rotate(h(this.group?_.angle:this.angle)),v.forActiveSelection||this.group?S&&this.drawBordersInGroup(g,_,v):S&&this.drawBorders(g,v),C&&this.drawControls(g,v),g.restore()},_setShadow:function(g){if(this.shadow){var v=this.shadow,b=this.canvas,y,_=b&&b.viewportTransform[0]||1,S=b&&b.viewportTransform[3]||1;v.nonScaling?y={scaleX:1,scaleY:1}:y=this.getObjectScaling(),b&&b._isRetinaScaling()&&(_*=o.devicePixelRatio,S*=o.devicePixelRatio),g.shadowColor=v.color,g.shadowBlur=v.blur*o.browserShadowBlurConstant*(_+S)*(y.scaleX+y.scaleY)/4,g.shadowOffsetX=v.offsetX*_*y.scaleX,g.shadowOffsetY=v.offsetY*S*y.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,v){if(!v||!v.toLive)return{offsetX:0,offsetY:0};var b=v.gradientTransform||v.patternTransform,y=-this.width/2+v.offsetX||0,_=-this.height/2+v.offsetY||0;return v.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,y,_):g.transform(1,0,0,1,y,_),b&&g.transform(b[0],b[1],b[2],b[3],b[4],b[5]),{offsetX:y,offsetY:_}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var v=this.getObjectScaling();g.scale(1/v.scaleX,1/v.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,v){var b=this._limitCacheSize(this._getCacheCanvasDimensions()),y=o.util.createCanvasElement(),_,S=this.canvas.getRetinaScaling(),C=b.x/this.scaleX/S,k=b.y/this.scaleY/S;y.width=C,y.height=k,_=y.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(C,0),_.lineTo(C,k),_.lineTo(0,k),_.closePath(),_.translate(C/2,k/2),_.scale(b.zoomX/this.scaleX/S,b.zoomY/this.scaleY/S),this._applyPatternGradientTransform(_,v),_.fillStyle=v.toLive(g),_.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(S*this.scaleX/b.zoomX,S*this.scaleY/b.zoomY),g.strokeStyle=_.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=o.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var v=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),v=o.util.transformPoint(v,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,v.x+=g.offsetLeft,v.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(v,"center","center")},clone:function(g,v){var b=this.toObject(v);this.constructor.fromObject?this.constructor.fromObject(b,g):o.Object._fromObject("Object",b,g)},cloneAsImage:function(g,v){var b=this.toCanvasElement(v);return g&&g(new o.Image(b)),this},toCanvasElement:function(g){g||(g={});var v=o.util,b=v.saveObjectTransform(this),y=this.group,_=this.shadow,S=Math.abs,C=(g.multiplier||1)*(g.enableRetinaScaling?o.devicePixelRatio:1);delete this.group,g.withoutTransform&&v.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var k=o.util.createCanvasElement(),w=this.getBoundingRect(!0,!0),A=this.shadow,I,z={x:0,y:0},H,Q,ee;A&&(H=A.blur,A.nonScaling?I={scaleX:1,scaleY:1}:I=this.getObjectScaling(),z.x=2*Math.round(S(A.offsetX)+H)*S(I.scaleX),z.y=2*Math.round(S(A.offsetY)+H)*S(I.scaleY)),Q=w.width+z.x,ee=w.height+z.y,k.width=Math.ceil(Q),k.height=Math.ceil(ee);var Z=new o.StaticCanvas(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(Z.backgroundColor="#fff"),this.setPositionByOrigin(new o.Point(Z.width/2,Z.height/2),"center","center");var he=this.canvas;Z.add(this);var _e=Z.toCanvasElement(C||1,g);return this.shadow=_,this.set("canvas",he),y&&(this.group=y),this.set(b).setCoords(),Z._objects=[],Z.dispose(),Z=null,_e},toDataURL:function(g){return g||(g={}),o.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var v=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return v&&this._setOriginToCenter(),this.set("angle",g),v&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,v){v=v||this.canvas.getPointer(g);var b=new o.Point(v.x,v.y),y=this._getLeftTopCoords();return this.angle&&(b=o.util.rotatePoint(b,y,h(-this.angle))),{x:b.x-y.x,y:b.y-y.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){o.runningAnimations&&o.runningAnimations.cancelByTarget(this)}}),o.util.createAccessors&&o.util.createAccessors(o.Object),c(o.Object.prototype,o.Observable),o.Object.NUM_FRACTION_DIGITS=2,o.Object.ENLIVEN_PROPS=["clipPath"],o.Object._fromObject=function(g,v,b,y){var _=o[g];v=f(v,!0),o.util.enlivenPatterns([v.fill,v.stroke],function(S){typeof S[0]<"u"&&(v.fill=S[0]),typeof S[1]<"u"&&(v.stroke=S[1]),o.util.enlivenObjectEnlivables(v,v,function(){var C=y?new _(v[y],v):new _(v);b&&b(C)})})},o.Object.__uid=0)}(i),function(){var a=e.util.degreesToRadians,o={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};e.util.object.extend(e.Object.prototype,{translateToGivenOrigin:function(f,u,d,h,m){var p=f.x,g=f.y,v,b,y;return typeof u=="string"?u=o[u]:u-=.5,typeof h=="string"?h=o[h]:h-=.5,v=h-u,typeof d=="string"?d=c[d]:d-=.5,typeof m=="string"?m=c[m]:m-=.5,b=m-d,(v||b)&&(y=this._getTransformedDimensions(),p=f.x+v*y.x,g=f.y+b*y.y),new e.Point(p,g)},translateToCenterPoint:function(f,u,d){var h=this.translateToGivenOrigin(f,u,d,"center","center");return this.angle?e.util.rotatePoint(h,f,a(this.angle)):h},translateToOriginPoint:function(f,u,d){var h=this.translateToGivenOrigin(f,"center","center",u,d);return this.angle?e.util.rotatePoint(h,f,a(this.angle)):h},getCenterPoint:function(){var f=new e.Point(this.left,this.top);return this.translateToCenterPoint(f,this.originX,this.originY)},getPointByOrigin:function(f,u){var d=this.getCenterPoint();return this.translateToOriginPoint(d,f,u)},toLocalPoint:function(f,u,d){var h=this.getCenterPoint(),m,p;return typeof u<"u"&&typeof d<"u"?m=this.translateToGivenOrigin(h,"center","center",u,d):m=new e.Point(this.left,this.top),p=new e.Point(f.x,f.y),this.angle&&(p=e.util.rotatePoint(p,h,-a(this.angle))),p.subtractEquals(m)},setPositionByOrigin:function(f,u,d){var h=this.translateToCenterPoint(f,u,d),m=this.translateToOriginPoint(h,this.originX,this.originY);this.set("left",m.x),this.set("top",m.y)},adjustPosition:function(f){var u=a(this.angle),d=this.getScaledWidth(),h=e.util.cos(u)*d,m=e.util.sin(u)*d,p,g;typeof this.originX=="string"?p=o[this.originX]:p=this.originX-.5,typeof f=="string"?g=o[f]:g=f-.5,this.left+=h*(g-p),this.top+=m*(g-p),this.setCoords(),this.originX=f},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var f=this.getCenterPoint();this.originX="center",this.originY="center",this.left=f.x,this.top=f.y},_resetOrigin:function(){var f=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=f.x,this.top=f.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function a(d){return[new e.Point(d.tl.x,d.tl.y),new e.Point(d.tr.x,d.tr.y),new e.Point(d.br.x,d.br.y),new e.Point(d.bl.x,d.bl.y)]}var o=e.util,c=o.degreesToRadians,f=o.multiplyTransformMatrices,u=o.transformPoint;o.object.extend(e.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(d,h){return h?d?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),d?this.aCoords:this.lineCoords)},getCoords:function(d,h){return a(this._getCoords(d,h))},intersectsWithRect:function(d,h,m,p){var g=this.getCoords(m,p),v=e.Intersection.intersectPolygonRectangle(g,d,h);return v.status==="Intersection"},intersectsWithObject:function(d,h,m){var p=e.Intersection.intersectPolygonPolygon(this.getCoords(h,m),d.getCoords(h,m));return p.status==="Intersection"||d.isContainedWithinObject(this,h,m)||this.isContainedWithinObject(d,h,m)},isContainedWithinObject:function(d,h,m){for(var p=this.getCoords(h,m),g=h?d.aCoords:d.lineCoords,v=0,b=d._getImageLines(g);v<4;v++)if(!d.containsPoint(p[v],b))return!1;return!0},isContainedWithinRect:function(d,h,m,p){var g=this.getBoundingRect(m,p);return g.left>=d.x&&g.left+g.width<=h.x&&g.top>=d.y&&g.top+g.height<=h.y},containsPoint:function(d,v,m,p){var g=this._getCoords(m,p),v=v||this._getImageLines(g),b=this._findCrossPoints(d,v);return b!==0&&b%2===1},isOnScreen:function(d){if(!this.canvas)return!1;var h=this.canvas.vptCoords.tl,m=this.canvas.vptCoords.br,p=this.getCoords(!0,d);return p.some(function(g){return g.x<=m.x&&g.x>=h.x&&g.y<=m.y&&g.y>=h.y})||this.intersectsWithRect(h,m,!0,d)?!0:this._containsCenterOfCanvas(h,m,d)},_containsCenterOfCanvas:function(d,h,m){var p={x:(d.x+h.x)/2,y:(d.y+h.y)/2};return!!this.containsPoint(p,null,!0,m)},isPartiallyOnScreen:function(d){if(!this.canvas)return!1;var h=this.canvas.vptCoords.tl,m=this.canvas.vptCoords.br;if(this.intersectsWithRect(h,m,!0,d))return!0;var p=this.getCoords(!0,d).every(function(g){return(g.x>=m.x||g.x<=h.x)&&(g.y>=m.y||g.y<=h.y)});return p&&this._containsCenterOfCanvas(h,m,d)},_getImageLines:function(d){var h={topline:{o:d.tl,d:d.tr},rightline:{o:d.tr,d:d.br},bottomline:{o:d.br,d:d.bl},leftline:{o:d.bl,d:d.tl}};return h},_findCrossPoints:function(d,h){var m,p,g,v,b,y=0,_;for(var S in h)if(_=h[S],!(_.o.y<d.y&&_.d.y<d.y)&&!(_.o.y>=d.y&&_.d.y>=d.y)&&(_.o.x===_.d.x&&_.o.x>=d.x?b=_.o.x:(m=0,p=(_.d.y-_.o.y)/(_.d.x-_.o.x),g=d.y-m*d.x,v=_.o.y-p*_.o.x,b=-(g-v)/(m-p)),b>=d.x&&(y+=1),y===2))break;return y},getBoundingRect:function(d,h){var m=this.getCoords(d,h);return o.makeBoundingBoxFromPoints(m)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(d){return Math.abs(d)<this.minScaleLimit?d<0?-this.minScaleLimit:this.minScaleLimit:d===0?1e-4:d},scale:function(d){return this._set("scaleX",d),this._set("scaleY",d),this.setCoords()},scaleToWidth:function(d,h){var m=this.getBoundingRect(h).width/this.getScaledWidth();return this.scale(d/this.width/m)},scaleToHeight:function(d,h){var m=this.getBoundingRect(h).height/this.getScaledHeight();return this.scale(d/this.height/m)},calcLineCoords:function(){var d=this.getViewportTransform(),h=this.padding,m=c(this.angle),p=o.cos(m),g=o.sin(m),v=p*h,b=g*h,y=v+b,_=v-b,S=this.calcACoords(),C={tl:u(S.tl,d),tr:u(S.tr,d),bl:u(S.bl,d),br:u(S.br,d)};return h&&(C.tl.x-=_,C.tl.y-=y,C.tr.x+=y,C.tr.y-=_,C.bl.x-=y,C.bl.y+=_,C.br.x+=_,C.br.y+=y),C},calcOCoords:function(){var d=this._calcRotateMatrix(),h=this._calcTranslateMatrix(),m=this.getViewportTransform(),p=f(m,h),g=f(p,d),g=f(g,[1/m[0],0,0,1/m[3],0,0]),v=this._calculateCurrentDimensions(),b={};return this.forEachControl(function(y,_,S){b[_]=y.positionHandler(v,g,S)}),b},calcACoords:function(){var d=this._calcRotateMatrix(),h=this._calcTranslateMatrix(),m=f(h,d),p=this._getTransformedDimensions(),g=p.x/2,v=p.y/2;return{tl:u({x:-g,y:-v},m),tr:u({x:g,y:-v},m),bl:u({x:-g,y:v},m),br:u({x:g,y:v},m)}},setCoords:function(d){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),d?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return o.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var d=this.getCenterPoint();return[1,0,0,1,d.x,d.y]},transformMatrixKey:function(d){var h="_",m="";return!d&&this.group&&(m=this.group.transformMatrixKey(d)+h),m+this.top+h+this.left+h+this.scaleX+h+this.scaleY+h+this.skewX+h+this.skewY+h+this.angle+h+this.originX+h+this.originY+h+this.width+h+this.height+h+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(d){var h=this.calcOwnMatrix();if(d||!this.group)return h;var m=this.transformMatrixKey(d),p=this.matrixCache||(this.matrixCache={});return p.key===m?p.value:(this.group&&(h=f(this.group.calcTransformMatrix(!1),h)),p.key=m,p.value=h,h)},calcOwnMatrix:function(){var d=this.transformMatrixKey(!0),h=this.ownMatrixCache||(this.ownMatrixCache={});if(h.key===d)return h.value;var m=this._calcTranslateMatrix(),p={angle:this.angle,translateX:m[4],translateY:m[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return h.key=d,h.value=o.composeMatrix(p),h.value},_getNonTransformedDimensions:function(){var d=this.strokeWidth,h=this.width+d,m=this.height+d;return{x:h,y:m}},_getTransformedDimensions:function(d,h){typeof d>"u"&&(d=this.skewX),typeof h>"u"&&(h=this.skewY);var m,p,g,v=d===0&&h===0;if(this.strokeUniform?(p=this.width,g=this.height):(m=this._getNonTransformedDimensions(),p=m.x,g=m.y),v)return this._finalizeDimensions(p*this.scaleX,g*this.scaleY);var b=o.sizeAfterTransform(p,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:d,skewY:h});return this._finalizeDimensions(b.x,b.y)},_finalizeDimensions:function(d,h){return this.strokeUniform?{x:d+this.strokeWidth,y:h+this.strokeWidth}:{x:d,y:h}},_calculateCurrentDimensions:function(){var d=this.getViewportTransform(),h=this._getTransformedDimensions(),m=u(h,d,!0);return m.scalarAdd(2*this.padding)}})}(),e.util.object.extend(e.Object.prototype,{sendToBack:function(){return this.group?e.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?e.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(a){return this.group?e.StaticCanvas.prototype.sendBackwards.call(this.group,this,a):this.canvas&&this.canvas.sendBackwards(this,a),this},bringForward:function(a){return this.group?e.StaticCanvas.prototype.bringForward.call(this.group,this,a):this.canvas&&this.canvas.bringForward(this,a),this},moveTo:function(a){return this.group&&this.group.type!=="activeSelection"?e.StaticCanvas.prototype.moveTo.call(this.group,this,a):this.canvas&&this.canvas.moveTo(this,a),this}}),function(){function a(c,f){if(f){if(f.toLive)return c+": url(#SVGID_"+f.id+"); ";var u=new e.Color(f),d=c+": "+u.toRgb()+"; ",h=u.getAlpha();return h!==1&&(d+=c+"-opacity: "+h.toString()+"; "),d}else return c+": none; "}var o=e.util.toFixed;e.util.object.extend(e.Object.prototype,{getSvgStyles:function(c){var f=this.fillRule?this.fillRule:"nonzero",u=this.strokeWidth?this.strokeWidth:"0",d=this.strokeDashArray?this.strokeDashArray.join(" "):"none",h=this.strokeDashOffset?this.strokeDashOffset:"0",m=this.strokeLineCap?this.strokeLineCap:"butt",p=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",v=typeof this.opacity<"u"?this.opacity:"1",b=this.visible?"":" visibility: hidden;",y=c?"":this.getSvgFilter(),_=a("fill",this.fill),S=a("stroke",this.stroke);return[S,"stroke-width: ",u,"; ","stroke-dasharray: ",d,"; ","stroke-linecap: ",m,"; ","stroke-dashoffset: ",h,"; ","stroke-linejoin: ",p,"; ","stroke-miterlimit: ",g,"; ",_,"fill-rule: ",f,"; ","opacity: ",v,";",y,b].join("")},getSvgSpanStyles:function(c,f){var u="; ",h=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+u:"",d=c.strokeWidth?"stroke-width: "+c.strokeWidth+u:"",h=h,m=c.fontSize?"font-size: "+c.fontSize+"px"+u:"",p=c.fontStyle?"font-style: "+c.fontStyle+u:"",g=c.fontWeight?"font-weight: "+c.fontWeight+u:"",v=c.fill?a("fill",c.fill):"",b=c.stroke?a("stroke",c.stroke):"",y=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return y&&(y="text-decoration: "+y+u),[b,d,h,m,p,g,y,v,_,f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(f){return c[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,f){var u=c?this.calcTransformMatrix():this.calcOwnMatrix(),d='transform="'+e.util.matrixToSVG(u);return d+(f||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var f=e.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',o(-this.width/2,f),'" y="',o(-this.height/2,f),'" width="',o(this.width,f),'" height="',o(this.height,f),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,f){f=f||{};var u=f.reviver,d=f.additionalTransform||"",h=[this.getSvgTransform(!0,d),this.getSvgCommons()].join(""),m=c.indexOf("COMMON_PARTS");return c[m]=h,u?u(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,f){f=f||{};var u=f.noStyle,d=f.reviver,h=u?"":'style="'+this.getSvgStyles()+'" ',m=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",p=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",v=p&&p.absolutePositioned,b=this.stroke,y=this.fill,_=this.shadow,S,C=[],k,w=c.indexOf("COMMON_PARTS"),A=f.additionalTransform;return p&&(p.clipPathId="CLIPPATH_"+e.Object.__uid++,k='<clipPath id="'+p.clipPathId+`" >
`+p.toClipPathSVG(d)+`</clipPath>
`),v&&C.push("<g ",m,this.getSvgCommons(),` >
`),C.push("<g ",this.getSvgTransform(!1),v?"":m+this.getSvgCommons(),` >
`),S=[h,g,u?"":this.addPaintOrder()," ",A?'transform="'+A+'" ':""].join(""),c[w]=S,y&&y.toLive&&C.push(y.toSVG(this)),b&&b.toLive&&C.push(b.toSVG(this)),_&&C.push(_.toSVG(this)),p&&C.push(k),C.push(c.join("")),C.push(`</g>
`),v&&C.push(`</g>
`),d?d(C.join("")):C.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var a=e.util.object.extend,o="stateProperties";function c(u,d,h){var m={},p=!0;h.forEach(function(g){m[g]=u[g]}),a(u[d],m,p)}function f(u,d,h){if(u===d)return!0;if(Array.isArray(u)){if(!Array.isArray(d)||u.length!==d.length)return!1;for(var m=0,p=u.length;m<p;m++)if(!f(u[m],d[m]))return!1;return!0}else if(u&&typeof u=="object"){var g=Object.keys(u),v;if(!d||typeof d!="object"||!h&&g.length!==Object.keys(d).length)return!1;for(var m=0,p=g.length;m<p;m++)if(v=g[m],!(v==="canvas"||v==="group")&&!f(u[v],d[v]))return!1;return!0}}e.util.object.extend(e.Object.prototype,{hasStateChanged:function(u){u=u||o;var d="_"+u;return Object.keys(this[d]).length<this[u].length?!0:!f(this[d],this,!0)},saveState:function(u){var d=u&&u.propertySet||o,h="_"+d;return this[h]?(c(this,h,this[d]),u&&u.stateProperties&&c(this,h,u.stateProperties),this):this.setupState(u)},setupState:function(u){u=u||{};var d=u.propertySet||o;return u.propertySet=d,this["_"+d]={},this.saveState(u),this}})}(),function(){var a=e.util.degreesToRadians;e.util.object.extend(e.Object.prototype,{_findTargetCorner:function(o,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f=o.x,u=o.y,d,h,m=Object.keys(this.oCoords),p=m.length-1,g;for(this.__corner=0;p>=0;p--)if(g=m[p],!!this.isControlVisible(g)&&(h=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),d=this._findCrossPoints({x:f,y:u},h),d!==0&&d%2===1))return this.__corner=g,g;return!1},forEachControl:function(o){for(var c in this.controls)o(this.controls[c],c,this)},_setCornerCoords:function(){var o=this.oCoords;for(var c in o){var f=this.controls[c];o[c].corner=f.calcCornerCoords(this.angle,this.cornerSize,o[c].x,o[c].y,!1),o[c].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,o[c].x,o[c].y,!0)}},drawSelectionBackground:function(o){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;o.save();var c=this.getCenterPoint(),f=this._calculateCurrentDimensions(),u=this.canvas.viewportTransform;return o.translate(c.x,c.y),o.scale(1/u[0],1/u[3]),o.rotate(a(this.angle)),o.fillStyle=this.selectionBackgroundColor,o.fillRect(-f.x/2,-f.y/2,f.x,f.y),o.restore(),this},drawBorders:function(o,c){c=c||{};var f=this._calculateCurrentDimensions(),u=this.borderScaleFactor,d=f.x+u,h=f.y+u,m=typeof c.hasControls<"u"?c.hasControls:this.hasControls,p=!1;return o.save(),o.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(o,c.borderDashArray||this.borderDashArray),o.strokeRect(-d/2,-h/2,d,h),m&&(o.beginPath(),this.forEachControl(function(g,v,b){g.withConnection&&g.getVisibility(b,v)&&(p=!0,o.moveTo(g.x*d,g.y*h),o.lineTo(g.x*d+g.offsetX,g.y*h+g.offsetY))}),p&&o.stroke()),o.restore(),this},drawBordersInGroup:function(o,c,f){f=f||{};var u=e.util.sizeAfterTransform(this.width,this.height,c),d=this.strokeWidth,h=this.strokeUniform,m=this.borderScaleFactor,p=u.x+d*(h?this.canvas.getZoom():c.scaleX)+m,g=u.y+d*(h?this.canvas.getZoom():c.scaleY)+m;return o.save(),this._setLineDash(o,f.borderDashArray||this.borderDashArray),o.strokeStyle=f.borderColor||this.borderColor,o.strokeRect(-p/2,-g/2,p,g),o.restore(),this},drawControls:function(o,c){c=c||{},o.save();var f=this.canvas.getRetinaScaling(),u,d;return o.setTransform(f,0,0,f,0,0),o.strokeStyle=o.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(o.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(o,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(u=this.group.calcTransformMatrix()),this.forEachControl(function(h,m,p){d=p.oCoords[m],h.getVisibility(p,m)&&(u&&(d=e.util.transformPoint(d,u)),h.render(o,d.x,d.y,c,p))}),o.restore(),this},isControlVisible:function(o){return this.controls[o]&&this.controls[o].getVisibility(this,o)},setControlVisible:function(o,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[o]=c,this},setControlsVisibility:function(o){o||(o={});for(var c in o)this.setControlVisible(c,o[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),e.util.object.extend(e.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(a,o){o=o||{};var c=function(){},f=o.onComplete||c,u=o.onChange||c,d=this;return e.util.animate({target:this,startValue:a.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(h){a.set("left",h),d.requestRenderAll(),u()},onComplete:function(){a.setCoords(),f()}})},fxCenterObjectV:function(a,o){o=o||{};var c=function(){},f=o.onComplete||c,u=o.onChange||c,d=this;return e.util.animate({target:this,startValue:a.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(h){a.set("top",h),d.requestRenderAll(),u()},onComplete:function(){a.setCoords(),f()}})},fxRemove:function(a,o){o=o||{};var c=function(){},f=o.onComplete||c,u=o.onChange||c,d=this;return e.util.animate({target:this,startValue:a.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(h){a.set("opacity",h),d.requestRenderAll(),u()},onComplete:function(){d.remove(a),f()}})}}),e.util.object.extend(e.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var a=[],o,c,f=[];for(o in arguments[0])a.push(o);for(var u=0,d=a.length;u<d;u++)o=a[u],c=u!==d-1,f.push(this._animate(o,arguments[0][o],arguments[1],c));return f}else return this._animate.apply(this,arguments)},_animate:function(a,o,c,f){var u=this,d;o=o.toString(),c?c=e.util.object.clone(c):c={},~a.indexOf(".")&&(d=a.split("."));var h=u.colorProperties.indexOf(a)>-1||d&&u.colorProperties.indexOf(d[1])>-1,m=d?this.get(d[0])[d[1]]:this.get(a);"from"in c||(c.from=m),h||(~o.indexOf("=")?o=m+parseFloat(o.replace("=","")):o=parseFloat(o));var p={target:this,startValue:c.from,endValue:o,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,v,b){return c.abort.call(u,g,v,b)},onChange:function(g,v,b){d?u[d[0]][d[1]]=g:u.set(a,g),!f&&c.onChange&&c.onChange(g,v,b)},onComplete:function(g,v,b){f||(u.setCoords(),c.onComplete&&c.onComplete(g,v,b))}};return h?e.util.animateColor(p.startValue,p.endValue,p.duration,p):e.util.animate(p)}}),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.util.object.clone,u={x1:1,x2:1,y1:1,y2:1};if(o.Line){o.warn("fabric.Line is already defined");return}o.Line=o.util.createClass(o.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:o.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(h,m){h||(h=[0,0,0,0]),this.callSuper("initialize",m),this.set("x1",h[0]),this.set("y1",h[1]),this.set("x2",h[2]),this.set("y2",h[3]),this._setWidthHeight(m)},_setWidthHeight:function(h){h||(h={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in h?h.left:this._getLeftToOriginX(),this.top="top"in h?h.top:this._getTopToOriginY()},_set:function(h,m){return this.callSuper("_set",h,m),typeof u[h]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:d({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:d({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(h){h.beginPath();var m=this.calcLinePoints();h.moveTo(m.x1,m.y1),h.lineTo(m.x2,m.y2),h.lineWidth=this.strokeWidth;var p=h.strokeStyle;h.strokeStyle=this.stroke||h.fillStyle,this.stroke&&this._renderStroke(h),h.strokeStyle=p},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(h){return c(this.callSuper("toObject",h),this.calcLinePoints())},_getNonTransformedDimensions:function(){var h=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(h.y-=this.strokeWidth),this.height===0&&(h.x-=this.strokeWidth)),h},calcLinePoints:function(){var h=this.x1<=this.x2?-1:1,m=this.y1<=this.y2?-1:1,p=h*this.width*.5,g=m*this.height*.5,v=h*this.width*-.5,b=m*this.height*-.5;return{x1:p,x2:v,y1:g,y2:b}},_toSVG:function(){var h=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',h.x1,'" y1="',h.y1,'" x2="',h.x2,'" y2="',h.y2,`" />
`]}}),o.Line.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),o.Line.fromElement=function(h,m,p){p=p||{};var g=o.parseAttributes(h,o.Line.ATTRIBUTE_NAMES),v=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];m(new o.Line(v,c(g,p)))},o.Line.fromObject=function(h,m){function p(v){delete v.points,m&&m(v)}var g=f(h,!0);g.points=[h.x1,h.y1,h.x2,h.y2],o.Object._fromObject("Line",g,p,"points")};function d(h,m){var p=h.origin,g=h.axis1,v=h.axis2,b=h.dimension,y=m.nearest,_=m.center,S=m.farthest;return function(){switch(this.get(p)){case y:return Math.min(this.get(g),this.get(v));case _:return Math.min(this.get(g),this.get(v))+.5*this.get(b);case S:return Math.max(this.get(g),this.get(v))}}}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.degreesToRadians;if(o.Circle){o.warn("fabric.Circle is already defined.");return}o.Circle=o.util.createClass(o.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:o.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(u,d){return this.callSuper("_set",u,d),u==="radius"&&this.setRadius(d),this},toObject:function(u){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(u))},_toSVG:function(){var u,d=0,h=0,m=(this.endAngle-this.startAngle)%360;if(m===0)u=["<circle ","COMMON_PARTS",'cx="'+d+'" cy="'+h+'" ','r="',this.radius,`" />
`];else{var p=c(this.startAngle),g=c(this.endAngle),v=this.radius,b=o.util.cos(p)*v,y=o.util.sin(p)*v,_=o.util.cos(g)*v,S=o.util.sin(g)*v,C=m>180?"1":"0";u=['<path d="M '+b+" "+y," A "+v+" "+v," 0 ",+C+" 1"," "+_+" "+S,'" ',"COMMON_PARTS",` />
`]}return u},_render:function(u){u.beginPath(),u.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(u)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(u){return this.radius=u,this.set("width",u*2).set("height",u*2)}}),o.Circle.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),o.Circle.fromElement=function(u,d){var h=o.parseAttributes(u,o.Circle.ATTRIBUTE_NAMES);if(!f(h))throw new Error("value of `r` attribute is required and can not be negative");h.left=(h.left||0)-h.radius,h.top=(h.top||0)-h.radius,d(new o.Circle(h))};function f(u){return"radius"in u&&u.radius>=0}o.Circle.fromObject=function(u,d){o.Object._fromObject("Circle",u,d)}}(i),function(a){var o=a.fabric||(a.fabric={});if(o.Triangle){o.warn("fabric.Triangle is already defined");return}o.Triangle=o.util.createClass(o.Object,{type:"triangle",width:100,height:100,_render:function(c){var f=this.width/2,u=this.height/2;c.beginPath(),c.moveTo(-f,u),c.lineTo(0,-u),c.lineTo(f,u),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,f=this.height/2,u=[-c+" "+f,"0 "+-f,c+" "+f].join(",");return["<polygon ","COMMON_PARTS",'points="',u,'" />']}}),o.Triangle.fromObject=function(c,f){return o.Object._fromObject("Triangle",c,f)}}(i),function(a){var o=a.fabric||(a.fabric={}),c=Math.PI*2;if(o.Ellipse){o.warn("fabric.Ellipse is already defined.");return}o.Ellipse=o.util.createClass(o.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:o.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,u){switch(this.callSuper("_set",f,u),f){case"rx":this.rx=u,this.set("width",u*2);break;case"ry":this.ry=u,this.set("height",u*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,c,!1),f.restore(),this._renderPaintInOrder(f)}}),o.Ellipse.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),o.Ellipse.fromElement=function(f,u){var d=o.parseAttributes(f,o.Ellipse.ATTRIBUTE_NAMES);d.left=(d.left||0)-d.rx,d.top=(d.top||0)-d.ry,u(new o.Ellipse(d))},o.Ellipse.fromObject=function(f,u){o.Object._fromObject("Ellipse",f,u)}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend;if(o.Rect){o.warn("fabric.Rect is already defined");return}o.Rect=o.util.createClass(o.Object,{stateProperties:o.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:o.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var u=this.rx?Math.min(this.rx,this.width/2):0,d=this.ry?Math.min(this.ry,this.height/2):0,h=this.width,m=this.height,p=-this.width/2,g=-this.height/2,v=u!==0||d!==0,b=1-.5522847498;f.beginPath(),f.moveTo(p+u,g),f.lineTo(p+h-u,g),v&&f.bezierCurveTo(p+h-b*u,g,p+h,g+b*d,p+h,g+d),f.lineTo(p+h,g+m-d),v&&f.bezierCurveTo(p+h,g+m-b*d,p+h-b*u,g+m,p+h-u,g+m),f.lineTo(p+u,g+m),v&&f.bezierCurveTo(p+b*u,g+m,p,g+m-b*d,p,g+m-d),f.lineTo(p,g+d),v&&f.bezierCurveTo(p,g+b*d,p+b*u,g,p+u,g),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){var f=-this.width/2,u=-this.height/2;return["<rect ","COMMON_PARTS",'x="',f,'" y="',u,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),o.Rect.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),o.Rect.fromElement=function(f,u,d){if(!f)return u(null);d=d||{};var h=o.parseAttributes(f,o.Rect.ATTRIBUTE_NAMES);h.left=h.left||0,h.top=h.top||0,h.height=h.height||0,h.width=h.width||0;var m=new o.Rect(c(d?o.util.object.clone(d):{},h));m.visible=m.visible&&m.width>0&&m.height>0,u(m)},o.Rect.fromObject=function(f,u){return o.Object._fromObject("Rect",f,u)}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.util.array.min,u=o.util.array.max,d=o.util.toFixed,h=o.util.projectStrokeOnPoints;if(o.Polyline){o.warn("fabric.Polyline is already defined");return}o.Polyline=o.util.createClass(o.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:o.Object.prototype.cacheProperties.concat("points"),initialize:function(m,p){p=p||{},this.points=m||[],this.callSuper("initialize",p),this._setPositionDimensions(p)},_projectStrokeOnPoints:function(){return h(this.points,this,!0)},_setPositionDimensions:function(m){var p=this._calcDimensions(m),g,v=this.exactBoundingBox?this.strokeWidth:0;this.width=p.width-v,this.height=p.height-v,m.fromSVG||(g=this.translateToGivenOrigin({x:p.left-this.strokeWidth/2+v/2,y:p.top-this.strokeWidth/2+v/2},"left","top",this.originX,this.originY)),typeof m.left>"u"&&(this.left=m.fromSVG?p.left:g.x),typeof m.top>"u"&&(this.top=m.fromSVG?p.top:g.y),this.pathOffset={x:p.left+this.width/2+v/2,y:p.top+this.height/2+v/2}},_calcDimensions:function(){var m=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,p=f(m,"x")||0,g=f(m,"y")||0,v=u(m,"x")||0,b=u(m,"y")||0,y=v-p,_=b-g;return{left:p,top:g,width:y,height:_}},toObject:function(m){return c(this.callSuper("toObject",m),{points:this.points.concat()})},_toSVG:function(){for(var m=[],p=this.pathOffset.x,g=this.pathOffset.y,v=o.Object.NUM_FRACTION_DIGITS,b=0,y=this.points.length;b<y;b++)m.push(d(this.points[b].x-p,v),",",d(this.points[b].y-g,v)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',m.join(""),`" />
`]},commonRender:function(m){var p,g=this.points.length,v=this.pathOffset.x,b=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;m.beginPath(),m.moveTo(this.points[0].x-v,this.points[0].y-b);for(var y=0;y<g;y++)p=this.points[y],m.lineTo(p.x-v,p.y-b);return!0},_render:function(m){this.commonRender(m)&&this._renderPaintInOrder(m)},complexity:function(){return this.get("points").length}}),o.Polyline.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(),o.Polyline.fromElementGenerator=function(m){return function(p,g,v){if(!p)return g(null);v||(v={});var b=o.parsePointsAttribute(p.getAttribute("points")),y=o.parseAttributes(p,o[m].ATTRIBUTE_NAMES);y.fromSVG=!0,g(new o[m](b,c(y,v)))}},o.Polyline.fromElement=o.Polyline.fromElementGenerator("Polyline"),o.Polyline.fromObject=function(m,p){return o.Object._fromObject("Polyline",m,p,"points")}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.projectStrokeOnPoints;if(o.Polygon){o.warn("fabric.Polygon is already defined");return}o.Polygon=o.util.createClass(o.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),o.Polygon.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(),o.Polygon.fromElement=o.Polyline.fromElementGenerator("Polygon"),o.Polygon.fromObject=function(f,u){o.Object._fromObject("Polygon",f,u,"points")}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.array.min,f=o.util.array.max,u=o.util.object.extend,d=o.util.object.clone,h=o.util.toFixed;if(o.Path){o.warn("fabric.Path is already defined");return}o.Path=o.util.createClass(o.Object,{type:"path",path:null,cacheProperties:o.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:o.Object.prototype.stateProperties.concat("path"),initialize:function(m,p){p=d(p||{}),delete p.path,this.callSuper("initialize",p),this._setPath(m||[],p)},_setPath:function(m,p){this.path=o.util.makePathSimpler(Array.isArray(m)?m:o.util.parsePath(m)),o.Polyline.prototype._setPositionDimensions.call(this,p||{})},_renderPathCommands:function(m){var p,g=0,v=0,b=0,y=0,_=0,S=0,C=-this.pathOffset.x,k=-this.pathOffset.y;m.beginPath();for(var w=0,A=this.path.length;w<A;++w)switch(p=this.path[w],p[0]){case"L":b=p[1],y=p[2],m.lineTo(b+C,y+k);break;case"M":b=p[1],y=p[2],g=b,v=y,m.moveTo(b+C,y+k);break;case"C":b=p[5],y=p[6],_=p[3],S=p[4],m.bezierCurveTo(p[1]+C,p[2]+k,_+C,S+k,b+C,y+k);break;case"Q":m.quadraticCurveTo(p[1]+C,p[2]+k,p[3]+C,p[4]+k),b=p[3],y=p[4],_=p[1],S=p[2];break;case"z":case"Z":b=g,y=v,m.closePath();break}},_render:function(m){this._renderPathCommands(m),this._renderPaintInOrder(m)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(m){return u(this.callSuper("toObject",m),{path:this.path.map(function(p){return p.slice()})})},toDatalessObject:function(m){var p=this.toObject(["sourcePath"].concat(m));return p.sourcePath&&delete p.path,p},_toSVG:function(){var m=o.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',m,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var m=o.Object.NUM_FRACTION_DIGITS;return" translate("+h(-this.pathOffset.x,m)+", "+h(-this.pathOffset.y,m)+")"},toClipPathSVG:function(m){var p=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:m,additionalTransform:p})},toSVG:function(m){var p=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:m,additionalTransform:p})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var m=[],p=[],g,v=0,b=0,y=0,_=0,S,C=0,k=this.path.length;C<k;++C){switch(g=this.path[C],g[0]){case"L":y=g[1],_=g[2],S=[];break;case"M":y=g[1],_=g[2],v=y,b=_,S=[];break;case"C":S=o.util.getBoundsOfCurve(y,_,g[1],g[2],g[3],g[4],g[5],g[6]),y=g[5],_=g[6];break;case"Q":S=o.util.getBoundsOfCurve(y,_,g[1],g[2],g[1],g[2],g[3],g[4]),y=g[3],_=g[4];break;case"z":case"Z":y=v,_=b;break}S.forEach(function(ee){m.push(ee.x),p.push(ee.y)}),m.push(y),p.push(_)}var w=c(m)||0,A=c(p)||0,I=f(m)||0,z=f(p)||0,H=I-w,Q=z-A;return{left:w,top:A,width:H,height:Q}}}),o.Path.fromObject=function(m,p){if(typeof m.sourcePath=="string"){var g=m.sourcePath;o.loadSVGFromURL(g,function(v){var b=v[0];b.setOptions(m),m.clipPath?o.util.enlivenObjects([m.clipPath],function(y){b.clipPath=y[0],p&&p(b)}):p&&p(b)})}else o.Object._fromObject("Path",m,p,"path")},o.Path.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(["d"]),o.Path.fromElement=function(m,p,g){var v=o.parseAttributes(m,o.Path.ATTRIBUTE_NAMES);v.fromSVG=!0,p(new o.Path(v.d,u(v,g)))}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.array.min,f=o.util.array.max;o.Group||(o.Group=o.util.createClass(o.Object,o.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(u,d,h){d=d||{},this._objects=[],h&&this.callSuper("initialize",d),this._objects=u||[];for(var m=this._objects.length;m--;)this._objects[m].group=this;if(h)this._updateObjectsACoords();else{var p=d&&d.centerPoint;d.originX!==void 0&&(this.originX=d.originX),d.originY!==void 0&&(this.originY=d.originY),p||this._calcBounds(),this._updateObjectsCoords(p),delete d.centerPoint,this.callSuper("initialize",d)}this.setCoords()},_updateObjectsACoords:function(){for(var u=!0,d=this._objects.length;d--;)this._objects[d].setCoords(u)},_updateObjectsCoords:function(d){for(var d=d||this.getCenterPoint(),h=this._objects.length;h--;)this._updateObjectCoords(this._objects[h],d)},_updateObjectCoords:function(u,d){var h=u.left,m=u.top,p=!0;u.set({left:h-d.x,top:m-d.y}),u.group=this,u.setCoords(p)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(u){var d=!!this.group;return this._restoreObjectsState(),o.util.resetObjectTransform(this),u&&(d&&o.util.removeTransformFromObject(u,this.group.calcTransformMatrix()),this._objects.push(u),u.group=this,u._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,d?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(u){return this._restoreObjectsState(),o.util.resetObjectTransform(this),this.remove(u),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(u){this.dirty=!0,u.group=this,u._set("canvas",this.canvas)},_onObjectRemoved:function(u){this.dirty=!0,delete u.group},_set:function(u,d){var h=this._objects.length;if(this.useSetOnGroup)for(;h--;)this._objects[h].setOnGroup(u,d);if(u==="canvas")for(;h--;)this._objects[h]._set(u,d);o.Object.prototype._set.call(this,u,d)},toObject:function(u){var d=this.includeDefaultValues,h=this._objects.filter(function(p){return!p.excludeFromExport}).map(function(p){var g=p.includeDefaultValues;p.includeDefaultValues=d;var v=p.toObject(u);return p.includeDefaultValues=g,v}),m=o.Object.prototype.toObject.call(this,u);return m.objects=h,m},toDatalessObject:function(u){var d,h=this.sourcePath;if(h)d=h;else{var m=this.includeDefaultValues;d=this._objects.map(function(g){var v=g.includeDefaultValues;g.includeDefaultValues=m;var b=g.toDatalessObject(u);return g.includeDefaultValues=v,b})}var p=o.Object.prototype.toDatalessObject.call(this,u);return p.objects=d,p},render:function(u){this._transformDone=!0,this.callSuper("render",u),this._transformDone=!1},shouldCache:function(){var u=o.Object.prototype.shouldCache.call(this);if(u){for(var d=0,h=this._objects.length;d<h;d++)if(this._objects[d].willDrawShadow())return this.ownCaching=!1,!1}return u},willDrawShadow:function(){if(o.Object.prototype.willDrawShadow.call(this))return!0;for(var u=0,d=this._objects.length;u<d;u++)if(this._objects[u].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(u){for(var d=0,h=this._objects.length;d<h;d++)this._objects[d].render(u);this._drawClipPath(u,this.clipPath)},isCacheDirty:function(u){if(this.callSuper("isCacheDirty",u))return!0;if(!this.statefullCache)return!1;for(var d=0,h=this._objects.length;d<h;d++)if(this._objects[d].isCacheDirty(!0)){if(this._cacheCanvas){var m=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-m/2,-p/2,m,p)}return!0}return!1},_restoreObjectsState:function(){var u=this.calcOwnMatrix();return this._objects.forEach(function(d){o.util.addTransformToObject(d,u),delete d.group,d.setCoords()}),this},destroy:function(){return this._objects.forEach(function(u){u.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var u=this._objects,d=this.canvas;this._objects=[];var h=this.toObject();delete h.objects;var m=new o.ActiveSelection([]);return m.set(h),m.type="activeSelection",d.remove(this),u.forEach(function(p){p.group=m,p.dirty=!0,d.add(p)}),m.canvas=d,m._objects=u,d._activeObject=m,m.setCoords(),m}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var u=!0;return this.forEachObject(function(d){d.setCoords(u)}),this},_calcBounds:function(u){for(var d=[],h=[],m,p,g,v=["tr","br","bl","tl"],b=0,y=this._objects.length,_,S=v.length;b<y;++b){for(m=this._objects[b],g=m.calcACoords(),_=0;_<S;_++)p=v[_],d.push(g[p].x),h.push(g[p].y);m.aCoords=g}this._getBounds(d,h,u)},_getBounds:function(u,d,h){var m=new o.Point(c(u),c(d)),p=new o.Point(f(u),f(d)),g=m.y||0,v=m.x||0,b=p.x-m.x||0,y=p.y-m.y||0;this.width=b,this.height=y,h||this.setPositionByOrigin({x:v,y:g},"left","top")},_toSVG:function(u){for(var d=["<g ","COMMON_PARTS",` >
`],h=0,m=this._objects.length;h<m;h++)d.push("		",this._objects[h].toSVG(u));return d.push(`</g>
`),d},getSvgStyles:function(){var u=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",d=this.visible?"":" visibility: hidden;";return[u,this.getSvgFilter(),d].join("")},toClipPathSVG:function(u){for(var d=[],h=0,m=this._objects.length;h<m;h++)d.push("	",this._objects[h].toClipPathSVG(u));return this._createBaseClipPathSVGMarkup(d,{reviver:u})}}),o.Group.fromObject=function(u,d){var h=u.objects,m=o.util.object.clone(u,!0);if(delete m.objects,typeof h=="string"){o.loadSVGFromURL(h,function(p){var g=o.util.groupSVGElements(p,u,h),v=m.clipPath;delete m.clipPath,g.set(m),v?o.util.enlivenObjects([v],function(b){g.clipPath=b[0],d&&d(g)}):d&&d(g)});return}o.util.enlivenObjects(h,function(p){o.util.enlivenObjectEnlivables(u,m,function(){d&&d(new o.Group(p,m,!0))})})})}(i),function(a){var o=a.fabric||(a.fabric={});o.ActiveSelection||(o.ActiveSelection=o.util.createClass(o.Group,{type:"activeSelection",initialize:function(c,f){f=f||{},this._objects=c||[];for(var u=this._objects.length;u--;)this._objects[u].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),o.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var f=o.Object.prototype.toObject.call(this),u=new o.Group([]);if(delete f.type,u.set(f),c.forEach(function(h){h.canvas.remove(h),h.group=u}),u._objects=c,!this.canvas)return u;var d=this.canvas;return d.add(u),d._activeObject=u,u.setCoords(),u},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,f,u){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,f),u=u||{},typeof u.hasControls>"u"&&(u.hasControls=!1),u.forActiveSelection=!0;for(var d=0,h=this._objects.length;d<h;d++)this._objects[d]._renderControls(c,u);c.restore()}}),o.ActiveSelection.fromObject=function(c,f){o.util.enlivenObjects(c.objects,function(u){delete c.objects,f&&f(new o.ActiveSelection(u,c,!0))})})}(i),function(a){var o=e.util.object.extend;if(a.fabric||(a.fabric={}),a.fabric.Image){e.warn("fabric.Image is already defined.");return}e.Image=e.util.createClass(e.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:e.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:e.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,f){f||(f={}),this.filters=[],this.cacheKey="texture"+e.Object.__uid++,this.callSuper("initialize",f),this._initElement(c,f)},getElement:function(){return this._element||{}},setElement:function(c,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var f=e.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){e.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var f=this.width/2,u=this.height/2;c.beginPath(),c.moveTo(-f,-u),c.lineTo(f,-u),c.lineTo(f,u),c.lineTo(-f,u),c.lineTo(-f,-u),c.closePath()}},toObject:function(c){var f=[];this.filters.forEach(function(d){d&&f.push(d.toObject())});var u=o(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(u.resizeFilter=this.resizeFilter.toObject()),u},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],f=[],u,d=this._element,h=-this.width/2,m=-this.height/2,p="",g="";if(!d)return[];if(this.hasCrop()){var v=e.Object.__uid++;c.push('<clipPath id="imageCrop_'+v+`">
`,'	<rect x="'+h+'" y="'+m+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),p=' clip-path="url(#imageCrop_'+v+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),f.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',h-this.cropX,'" y="',m-this.cropY,'" width="',d.width||d.naturalWidth,'" height="',d.height||d.height,g,'"',p,`></image>
`),this.stroke||this.strokeDashArray){var b=this.fill;this.fill=null,u=["	<rect ",'x="',h,'" y="',m,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=b}return this.paintFirst!=="fill"?c=c.concat(u,f):c=c.concat(f,u),c},getSrc:function(c){var f=c?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(c,f,u){return e.util.loadImage(c,function(d,h){this.setElement(d,u),this._setWidthHeight(),f&&f(this,h)},this,u&&u.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,f=this.minimumScaleTrigger,u=this.getTotalObjectScaling(),d=u.scaleX,h=u.scaleY,m=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||d>f&&h>f){this._element=m,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=d,this._lastScaleY=h;return}e.filterBackend||(e.filterBackend=e.initFilterBackend());var p=e.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,v=m.width,b=m.height;p.width=v,p.height=b,this._element=p,this._lastScaleX=c.scaleX=d,this._lastScaleY=c.scaleY=h,e.filterBackend.applyFilters([c],m,v,b,this._element,g),this._filterScalingX=p.width/this._originalElement.width,this._filterScalingY=p.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(m){return m&&!m.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,u=f.naturalWidth||f.width,d=f.naturalHeight||f.height;if(this._element===this._originalElement){var h=e.util.createCanvasElement();h.width=u,h.height=d,this._element=h,this._filteredEl=h}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,u,d),this._lastScaleX=1,this._lastScaleY=1;return e.filterBackend||(e.filterBackend=e.initFilterBackend()),e.filterBackend.applyFilters(c,this._originalElement,u,d,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){e.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){e.util.setImageSmoothing(c,this.imageSmoothing),e.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var f=this._element;if(f){var u=this._filterScalingX,d=this._filterScalingY,h=this.width,m=this.height,p=Math.min,g=Math.max,v=g(this.cropX,0),b=g(this.cropY,0),y=f.naturalWidth||f.width,_=f.naturalHeight||f.height,S=v*u,C=b*d,k=p(h*u,y-S),w=p(m*d,_-C),A=-h/2,I=-m/2,z=p(h,y/u-v),H=p(m,_/d-b);f&&c.drawImage(f,S,C,k,w,A,I,z,H)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,f){this.setElement(e.util.getById(c),f),e.util.addClass(this.getElement(),e.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,f){c&&c.length?e.util.enlivenObjects(c,function(u){f&&f(u)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(c){c||(c={});var f=this.getElement();this.width=c.width||f.naturalWidth||f.width||0,this.height=c.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var c=e.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),f=this._element.width,u=this._element.height,d=1,h=1,m=0,p=0,g=0,v=0,b,y=this.width,_=this.height,S={width:y,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(d=h=e.util.findScaleToFit(this._element,S),b=(y-f*d)/2,c.alignX==="Min"&&(m=-b),c.alignX==="Max"&&(m=b),b=(_-u*h)/2,c.alignY==="Min"&&(p=-b),c.alignY==="Max"&&(p=b)),c.meetOrSlice==="slice"&&(d=h=e.util.findScaleToCover(this._element,S),b=f-y/d,c.alignX==="Mid"&&(g=b/2),c.alignX==="Max"&&(g=b),b=u-_/h,c.alignY==="Mid"&&(v=b/2),c.alignY==="Max"&&(v=b),f=y/d,u=_/h)):(d=y/f,h=_/u),{width:f,height:u,scaleX:d,scaleY:h,offsetLeft:m,offsetTop:p,cropX:g,cropY:v}}}),e.Image.CSS_CANVAS="canvas-img",e.Image.prototype.getSvgSrc=e.Image.prototype.getSrc,e.Image.fromObject=function(c,f){var u=e.util.object.clone(c);e.util.loadImage(u.src,function(d,h){if(h){f&&f(null,!0);return}e.Image.prototype._initFilters.call(u,u.filters,function(m){u.filters=m||[],e.Image.prototype._initFilters.call(u,[u.resizeFilter],function(p){u.resizeFilter=p[0],e.util.enlivenObjectEnlivables(u,u,function(){var g=new e.Image(d,u);f(g,!1)})})})},null,u.crossOrigin)},e.Image.fromURL=function(c,f,u){e.util.loadImage(c,function(d,h){f&&f(new e.Image(d,u),h)},null,u&&u.crossOrigin)},e.Image.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),e.Image.fromElement=function(c,f,u){var d=e.parseAttributes(c,e.Image.ATTRIBUTE_NAMES);e.Image.fromURL(d["xlink:href"],f,o(u?e.util.object.clone(u):{},d))}}(i),e.util.object.extend(e.Object.prototype,{_getAngleValueForStraighten:function(){var a=this.angle%360;return a>0?Math.round((a-1)/90)*90:Math.round(a/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(a){a=a||{};var o=function(){},c=a.onComplete||o,f=a.onChange||o,u=this;return e.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(d){u.rotate(d),f()},onComplete:function(){u.setCoords(),c()}})}}),e.util.object.extend(e.StaticCanvas.prototype,{straightenObject:function(a){return a.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(a){return a.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function a(c,f){var u="precision "+f+` float;
void main(){}`,d=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(d,u),c.compileShader(d),!!c.getShaderParameter(d,c.COMPILE_STATUS)}e.isWebglSupported=function(c){if(e.isLikelyNode)return!1;c=c||e.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),u=f.getContext("webgl")||f.getContext("experimental-webgl"),d=!1;if(u){e.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),d=e.maxTextureSize>=c;for(var h=["highp","mediump","lowp"],m=0;m<3;m++)if(a(u,h[m])){e.webGlPrecision=h[m];break}}return this.isSupported=d,d},e.WebglFilterBackend=o;function o(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}o.prototype={tileSize:2048,resources:{},setupGLContext:function(c,f){this.dispose(),this.createWebGLCanvas(c,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,f)},chooseFastestCopyGLTo2DMethod:function(c,f){var u=typeof window.performance<"u",d;try{new ImageData(1,1),d=!0}catch{d=!1}var h=typeof ArrayBuffer<"u",m=typeof Uint8ClampedArray<"u";if(u&&d&&h&&m){var p=e.util.createCanvasElement(),g=new ArrayBuffer(c*f*4);if(e.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var v={imageBuffer:g,destinationWidth:c,destinationHeight:f,targetCanvas:p},b,y,_;p.width=c,p.height=f,b=window.performance.now(),s.call(v,this.gl,v),y=window.performance.now()-b,b=window.performance.now(),l.call(v,this.gl,v),_=window.performance.now()-b,y>_?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,f){var u=e.util.createCanvasElement();u.width=c,u.height=f;var d={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},h=u.getContext("webgl",d);h||(h=u.getContext("experimental-webgl",d)),h&&(h.clearColor(0,0,0,0),this.canvas=u,this.gl=h)},applyFilters:function(c,f,u,d,h,m){var p=this.gl,g;m&&(g=this.getCachedTexture(m,f));var v={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:u,sourceHeight:d,destinationWidth:u,destinationHeight:d,context:p,sourceTexture:this.createTexture(p,u,d,!g&&f),targetTexture:this.createTexture(p,u,d),originalTexture:g||this.createTexture(p,u,d,!g&&f),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:h},b=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,b),c.forEach(function(y){y&&y.applyTo(v)}),r(v),this.copyGLTo2D(p,v),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(v.sourceTexture),p.deleteTexture(v.targetTexture),p.deleteFramebuffer(b),h.getContext("2d").setTransform(1,0,0,1,0,0),v},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,f,u,d,h){var m=c.createTexture();return c.bindTexture(c.TEXTURE_2D,m),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,h||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,h||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),d?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,d):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,f,u,0,c.RGBA,c.UNSIGNED_BYTE,null),m},getCachedTexture:function(c,f){if(this.textureCache[c])return this.textureCache[c];var u=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[c]=u,u},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,f={renderer:"",vendor:""};if(!c)return f;var u=c.getExtension("WEBGL_debug_renderer_info");if(u){var d=c.getParameter(u.UNMASKED_RENDERER_WEBGL),h=c.getParameter(u.UNMASKED_VENDOR_WEBGL);d&&(f.renderer=d.toLowerCase()),h&&(f.vendor=h.toLowerCase())}return this.gpuInfo=f,f}}}();function r(a){var o=a.targetCanvas,c=o.width,f=o.height,u=a.destinationWidth,d=a.destinationHeight;(c!==u||f!==d)&&(o.width=u,o.height=d)}function s(a,o){var c=a.canvas,f=o.targetCanvas,u=f.getContext("2d");u.translate(0,f.height),u.scale(1,-1);var d=c.height-f.height;u.drawImage(c,0,d,f.width,f.height,0,0,f.width,f.height)}function l(a,o){var c=o.targetCanvas,f=c.getContext("2d"),u=o.destinationWidth,d=o.destinationHeight,h=u*d*4,m=new Uint8Array(this.imageBuffer,0,h),p=new Uint8ClampedArray(this.imageBuffer,0,h);a.readPixels(0,0,u,d,a.RGBA,a.UNSIGNED_BYTE,m);var g=new ImageData(p,u,d);f.putImageData(g,0,0)}(function(){var a=function(){};e.Canvas2dFilterBackend=o;function o(){}o.prototype={evictCachesForKey:a,dispose:a,clearWebGLCaches:a,resources:{},applyFilters:function(c,f,u,d,h){var m=h.getContext("2d");m.drawImage(f,0,0,u,d);var p=m.getImageData(0,0,u,d),g=m.getImageData(0,0,u,d),v={sourceWidth:u,sourceHeight:d,imageData:p,originalEl:f,originalImageData:g,canvasEl:h,ctx:m,filterBackend:this};return c.forEach(function(b){b.applyTo(v)}),(v.imageData.width!==u||v.imageData.height!==d)&&(h.width=v.imageData.width,h.height=v.imageData.height),m.putImageData(v.imageData,0,0),v}}})(),e.Image=e.Image||{},e.Image.filters=e.Image.filters||{},e.Image.filters.BaseFilter=e.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(a){a&&this.setOptions(a)},setOptions:function(a){for(var o in a)this[o]=a[o]},createProgram:function(a,o,c){o=o||this.fragmentSource,c=c||this.vertexSource,e.webGlPrecision!=="highp"&&(o=o.replace(/precision highp float/g,"precision "+e.webGlPrecision+" float"));var f=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(f,c),a.compileShader(f),!a.getShaderParameter(f,a.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+a.getShaderInfoLog(f));var u=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(u,o),a.compileShader(u),!a.getShaderParameter(u,a.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+a.getShaderInfoLog(u));var d=a.createProgram();if(a.attachShader(d,f),a.attachShader(d,u),a.linkProgram(d),!a.getProgramParameter(d,a.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+a.getProgramInfoLog(d));var h=this.getAttributeLocations(a,d),m=this.getUniformLocations(a,d)||{};return m.uStepW=a.getUniformLocation(d,"uStepW"),m.uStepH=a.getUniformLocation(d,"uStepH"),{program:d,attributeLocations:h,uniformLocations:m}},getAttributeLocations:function(a,o){return{aPosition:a.getAttribLocation(o,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(a,o,c){var f=o.aPosition,u=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,u),a.enableVertexAttribArray(f),a.vertexAttribPointer(f,2,a.FLOAT,!1,0,0),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW)},_setupFrameBuffer:function(a){var o=a.context,c,f;a.passes>1?(c=a.destinationWidth,f=a.destinationHeight,(a.sourceWidth!==c||a.sourceHeight!==f)&&(o.deleteTexture(a.targetTexture),a.targetTexture=a.filterBackend.createTexture(o,c,f)),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,a.targetTexture,0)):(o.bindFramebuffer(o.FRAMEBUFFER,null),o.finish())},_swapTextures:function(a){a.passes--,a.pass++;var o=a.targetTexture;a.targetTexture=a.sourceTexture,a.sourceTexture=o},isNeutralState:function(){var a=this.mainParameter,o=e.Image.filters[this.type].prototype;if(a)if(Array.isArray(o[a])){for(var c=o[a].length;c--;)if(this[a][c]!==o[a][c])return!1;return!0}else return o[a]===this[a];else return!1},applyTo:function(a){a.webgl?(this._setupFrameBuffer(a),this.applyToWebGL(a),this._swapTextures(a)):this.applyTo2d(a)},retrieveShader:function(a){return a.programCache.hasOwnProperty(this.type)||(a.programCache[this.type]=this.createProgram(a.context)),a.programCache[this.type]},applyToWebGL:function(a){var o=a.context,c=this.retrieveShader(a);a.pass===0&&a.originalTexture?o.bindTexture(o.TEXTURE_2D,a.originalTexture):o.bindTexture(o.TEXTURE_2D,a.sourceTexture),o.useProgram(c.program),this.sendAttributeData(o,c.attributeLocations,a.aPosition),o.uniform1f(c.uniformLocations.uStepW,1/a.sourceWidth),o.uniform1f(c.uniformLocations.uStepH,1/a.sourceHeight),this.sendUniformData(o,c.uniformLocations),o.viewport(0,0,a.destinationWidth,a.destinationHeight),o.drawArrays(o.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(a,o,c){a.activeTexture(c),a.bindTexture(a.TEXTURE_2D,o),a.activeTexture(a.TEXTURE0)},unbindAdditionalTexture:function(a,o){a.activeTexture(o),a.bindTexture(a.TEXTURE_2D,null),a.activeTexture(a.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(a){this[this.mainParameter]=a},sendUniformData:function(){},createHelpLayer:function(a){if(!a.helpLayer){var o=document.createElement("canvas");o.width=a.sourceWidth,o.height=a.sourceHeight,a.helpLayer=o}},toObject:function(){var a={type:this.type},o=this.mainParameter;return o&&(a[o]=this[o]),a},toJSON:function(){return this.toObject()}}),e.Image.filters.BaseFilter.fromObject=function(a,o){var c=new e.Image.filters[a.type](a);return o&&o(c),c},function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.ColorMatrix=f(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(u){this.callSuper("initialize",u),this.matrix=this.matrix.slice(0)},applyTo2d:function(u){var d=u.imageData,h=d.data,m=h.length,p=this.matrix,g,v,b,y,_,S=this.colorsOnly;for(_=0;_<m;_+=4)g=h[_],v=h[_+1],b=h[_+2],S?(h[_]=g*p[0]+v*p[1]+b*p[2]+p[4]*255,h[_+1]=g*p[5]+v*p[6]+b*p[7]+p[9]*255,h[_+2]=g*p[10]+v*p[11]+b*p[12]+p[14]*255):(y=h[_+3],h[_]=g*p[0]+v*p[1]+b*p[2]+y*p[3]+p[4]*255,h[_+1]=g*p[5]+v*p[6]+b*p[7]+y*p[8]+p[9]*255,h[_+2]=g*p[10]+v*p[11]+b*p[12]+y*p[13]+p[14]*255,h[_+3]=g*p[15]+v*p[16]+b*p[17]+y*p[18]+p[19]*255)},getUniformLocations:function(u,d){return{uColorMatrix:u.getUniformLocation(d,"uColorMatrix"),uConstants:u.getUniformLocation(d,"uConstants")}},sendUniformData:function(u,d){var h=this.matrix,m=[h[0],h[1],h[2],h[3],h[5],h[6],h[7],h[8],h[10],h[11],h[12],h[13],h[15],h[16],h[17],h[18]],p=[h[4],h[9],h[14],h[19]];u.uniformMatrix4fv(d.uColorMatrix,!1,m),u.uniform4fv(d.uConstants,p)}}),o.Image.filters.ColorMatrix.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Brightness=f(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(u){if(this.brightness!==0){var d=u.imageData,h=d.data,m,p=h.length,g=Math.round(this.brightness*255);for(m=0;m<p;m+=4)h[m]=h[m]+g,h[m+1]=h[m+1]+g,h[m+2]=h[m+2]+g}},getUniformLocations:function(u,d){return{uBrightness:u.getUniformLocation(d,"uBrightness")}},sendUniformData:function(u,d){u.uniform1f(d.uBrightness,this.brightness)}}),o.Image.filters.Brightness.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.Image.filters,u=o.util.createClass;f.Convolute=u(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(d){var h=Math.sqrt(this.matrix.length),m=this.type+"_"+h+"_"+(this.opaque?1:0),p=this.fragmentSource[m];return d.programCache.hasOwnProperty(m)||(d.programCache[m]=this.createProgram(d.context,p)),d.programCache[m]},applyTo2d:function(d){var h=d.imageData,m=h.data,p=this.matrix,g=Math.round(Math.sqrt(p.length)),v=Math.floor(g/2),b=h.width,y=h.height,_=d.ctx.createImageData(b,y),S=_.data,C=this.opaque?1:0,k,w,A,I,z,H,Q,ee,Z,he,_e,we,O;for(_e=0;_e<y;_e++)for(he=0;he<b;he++){for(z=(_e*b+he)*4,k=0,w=0,A=0,I=0,O=0;O<g;O++)for(we=0;we<g;we++)Q=_e+O-v,H=he+we-v,!(Q<0||Q>=y||H<0||H>=b)&&(ee=(Q*b+H)*4,Z=p[O*g+we],k+=m[ee]*Z,w+=m[ee+1]*Z,A+=m[ee+2]*Z,C||(I+=m[ee+3]*Z));S[z]=k,S[z+1]=w,S[z+2]=A,C?S[z+3]=m[z+3]:S[z+3]=I}d.imageData=_},getUniformLocations:function(d,h){return{uMatrix:d.getUniformLocation(h,"uMatrix"),uOpaque:d.getUniformLocation(h,"uOpaque"),uHalfSize:d.getUniformLocation(h,"uHalfSize"),uSize:d.getUniformLocation(h,"uSize")}},sendUniformData:function(d,h){d.uniform1fv(h.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),o.Image.filters.Convolute.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Grayscale=f(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(u){var d=u.imageData,h=d.data,m,p=h.length,g,v=this.mode;for(m=0;m<p;m+=4)v==="average"?g=(h[m]+h[m+1]+h[m+2])/3:v==="lightness"?g=(Math.min(h[m],h[m+1],h[m+2])+Math.max(h[m],h[m+1],h[m+2]))/2:v==="luminosity"&&(g=.21*h[m]+.72*h[m+1]+.07*h[m+2]),h[m]=g,h[m+1]=g,h[m+2]=g},retrieveShader:function(u){var d=this.type+"_"+this.mode;if(!u.programCache.hasOwnProperty(d)){var h=this.fragmentSource[this.mode];u.programCache[d]=this.createProgram(u.context,h)}return u.programCache[d]},getUniformLocations:function(u,d){return{uMode:u.getUniformLocation(d,"uMode")}},sendUniformData:function(u,d){var h=1;u.uniform1i(d.uMode,h)},isNeutralState:function(){return!1}}),o.Image.filters.Grayscale.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Invert=f(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(u){var d=u.imageData,h=d.data,m,p=h.length;for(m=0;m<p;m+=4)h[m]=255-h[m],h[m+1]=255-h[m+1],h[m+2]=255-h[m+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(u,d){return{uInvert:u.getUniformLocation(d,"uInvert")}},sendUniformData:function(u,d){u.uniform1i(d.uInvert,this.invert)}}),o.Image.filters.Invert.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.Image.filters,u=o.util.createClass;f.Noise=u(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(d){if(this.noise!==0){var h=d.imageData,m=h.data,p,g=m.length,v=this.noise,b;for(p=0,g=m.length;p<g;p+=4)b=(.5-Math.random())*v,m[p]+=b,m[p+1]+=b,m[p+2]+=b}},getUniformLocations:function(d,h){return{uNoise:d.getUniformLocation(h,"uNoise"),uSeed:d.getUniformLocation(h,"uSeed")}},sendUniformData:function(d,h){d.uniform1f(h.uNoise,this.noise/255),d.uniform1f(h.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),o.Image.filters.Noise.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Pixelate=f(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(u){var d=u.imageData,h=d.data,m=d.height,p=d.width,g,v,b,y,_,S,C,k,w,A,I;for(v=0;v<m;v+=this.blocksize)for(b=0;b<p;b+=this.blocksize)for(g=v*4*p+b*4,y=h[g],_=h[g+1],S=h[g+2],C=h[g+3],A=Math.min(v+this.blocksize,m),I=Math.min(b+this.blocksize,p),k=v;k<A;k++)for(w=b;w<I;w++)g=k*4*p+w*4,h[g]=y,h[g+1]=_,h[g+2]=S,h[g+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(u,d){return{uBlocksize:u.getUniformLocation(d,"uBlocksize"),uStepW:u.getUniformLocation(d,"uStepW"),uStepH:u.getUniformLocation(d,"uStepH")}},sendUniformData:function(u,d){u.uniform1f(d.uBlocksize,this.blocksize)}}),o.Image.filters.Pixelate.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.extend,f=o.Image.filters,u=o.util.createClass;f.RemoveColor=u(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(d){var h=d.imageData,m=h.data,p,g=this.distance*255,v,b,y,_=new o.Color(this.color).getSource(),S=[_[0]-g,_[1]-g,_[2]-g],C=[_[0]+g,_[1]+g,_[2]+g];for(p=0;p<m.length;p+=4)v=m[p],b=m[p+1],y=m[p+2],v>S[0]&&b>S[1]&&y>S[2]&&v<C[0]&&b<C[1]&&y<C[2]&&(m[p+3]=0)},getUniformLocations:function(d,h){return{uLow:d.getUniformLocation(h,"uLow"),uHigh:d.getUniformLocation(h,"uHigh")}},sendUniformData:function(d,h){var m=new o.Color(this.color).getSource(),p=parseFloat(this.distance),g=[0+m[0]/255-p,0+m[1]/255-p,0+m[2]/255-p,1],v=[m[0]/255+p,m[1]/255+p,m[2]/255+p,1];d.uniform4fv(h.uLow,g),d.uniform4fv(h.uHigh,v)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),o.Image.filters.RemoveColor.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass,u={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var d in u)c[d]=f(c.ColorMatrix,{type:d,matrix:u[d],mainParameter:!1,colorsOnly:!0}),o.Image.filters[d].fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric,c=o.Image.filters,f=o.util.createClass;c.BlendColor=f(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(u){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[u]+`}
}`},retrieveShader:function(u){var d=this.type+"_"+this.mode,h;return u.programCache.hasOwnProperty(d)||(h=this.buildSource(this.mode),u.programCache[d]=this.createProgram(u.context,h)),u.programCache[d]},applyTo2d:function(u){var d=u.imageData,h=d.data,m=h.length,p,g,v,b,y,_,S,C=1-this.alpha;S=new o.Color(this.color).getSource(),p=S[0]*this.alpha,g=S[1]*this.alpha,v=S[2]*this.alpha;for(var k=0;k<m;k+=4)switch(b=h[k],y=h[k+1],_=h[k+2],this.mode){case"multiply":h[k]=b*p/255,h[k+1]=y*g/255,h[k+2]=_*v/255;break;case"screen":h[k]=255-(255-b)*(255-p)/255,h[k+1]=255-(255-y)*(255-g)/255,h[k+2]=255-(255-_)*(255-v)/255;break;case"add":h[k]=b+p,h[k+1]=y+g,h[k+2]=_+v;break;case"diff":case"difference":h[k]=Math.abs(b-p),h[k+1]=Math.abs(y-g),h[k+2]=Math.abs(_-v);break;case"subtract":h[k]=b-p,h[k+1]=y-g,h[k+2]=_-v;break;case"darken":h[k]=Math.min(b,p),h[k+1]=Math.min(y,g),h[k+2]=Math.min(_,v);break;case"lighten":h[k]=Math.max(b,p),h[k+1]=Math.max(y,g),h[k+2]=Math.max(_,v);break;case"overlay":h[k]=p<128?2*b*p/255:255-2*(255-b)*(255-p)/255,h[k+1]=g<128?2*y*g/255:255-2*(255-y)*(255-g)/255,h[k+2]=v<128?2*_*v/255:255-2*(255-_)*(255-v)/255;break;case"exclusion":h[k]=p+b-2*p*b/255,h[k+1]=g+y-2*g*y/255,h[k+2]=v+_-2*v*_/255;break;case"tint":h[k]=p+b*C,h[k+1]=g+y*C,h[k+2]=v+_*C}},getUniformLocations:function(u,d){return{uColor:u.getUniformLocation(d,"uColor")}},sendUniformData:function(u,d){var h=new o.Color(this.color).getSource();h[0]=this.alpha*h[0]/255,h[1]=this.alpha*h[1]/255,h[2]=this.alpha*h[2]/255,h[3]=this.alpha,u.uniform4fv(d.uColor,h)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),o.Image.filters.BlendColor.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric,c=o.Image.filters,f=o.util.createClass;c.BlendImage=f(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(u){var d=this.type+"_"+this.mode,h=this.fragmentSource[this.mode];return u.programCache.hasOwnProperty(d)||(u.programCache[d]=this.createProgram(u.context,h)),u.programCache[d]},applyToWebGL:function(u){var d=u.context,h=this.createTexture(u.filterBackend,this.image);this.bindAdditionalTexture(d,h,d.TEXTURE1),this.callSuper("applyToWebGL",u),this.unbindAdditionalTexture(d,d.TEXTURE1)},createTexture:function(u,d){return u.getCachedTexture(d.cacheKey,d._element)},calculateMatrix:function(){var u=this.image,d=u._element.width,h=u._element.height;return[1/u.scaleX,0,0,0,1/u.scaleY,0,-u.left/d,-u.top/h,1]},applyTo2d:function(u){var d=u.imageData,h=u.filterBackend.resources,m=d.data,p=m.length,g=d.width,v=d.height,b,y,_,S,C,k,w,A,I,z,H=this.image,Q;h.blendImage||(h.blendImage=o.util.createCanvasElement()),I=h.blendImage,z=I.getContext("2d"),I.width!==g||I.height!==v?(I.width=g,I.height=v):z.clearRect(0,0,g,v),z.setTransform(H.scaleX,0,0,H.scaleY,H.left,H.top),z.drawImage(H._element,0,0,g,v),Q=z.getImageData(0,0,g,v).data;for(var ee=0;ee<p;ee+=4)switch(C=m[ee],k=m[ee+1],w=m[ee+2],A=m[ee+3],b=Q[ee],y=Q[ee+1],_=Q[ee+2],S=Q[ee+3],this.mode){case"multiply":m[ee]=C*b/255,m[ee+1]=k*y/255,m[ee+2]=w*_/255,m[ee+3]=A*S/255;break;case"mask":m[ee+3]=S;break}},getUniformLocations:function(u,d){return{uTransformMatrix:u.getUniformLocation(d,"uTransformMatrix"),uImage:u.getUniformLocation(d,"uImage")}},sendUniformData:function(u,d){var h=this.calculateMatrix();u.uniform1i(d.uImage,1),u.uniformMatrix3fv(d.uTransformMatrix,!1,h)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),o.Image.filters.BlendImage.fromObject=function(u,d){o.Image.fromObject(u.image,function(h){var m=o.util.object.clone(u);m.image=h,d(new o.Image.filters.BlendImage(m))})}}(i),function(a){var o=a.fabric||(a.fabric={}),c=Math.pow,f=Math.floor,u=Math.sqrt,d=Math.abs,h=Math.round,m=Math.sin,p=Math.ceil,g=o.Image.filters,v=o.util.createClass;g.Resize=v(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(b,y){return{uDelta:b.getUniformLocation(y,"uDelta"),uTaps:b.getUniformLocation(y,"uTaps")}},sendUniformData:function(b,y){b.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),b.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(b){var y=this.getFilterWindow(),_=this.type+"_"+y;if(!b.programCache.hasOwnProperty(_)){var S=this.generateShader(y);b.programCache[_]=this.createProgram(b.context,S)}return b.programCache[_]},getFilterWindow:function(){var b=this.tempScale;return Math.ceil(this.lanczosLobes/b)},getTaps:function(){for(var b=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,_=this.getFilterWindow(),S=new Array(_),C=1;C<=_;C++)S[C-1]=b(C*y);return S},generateShader:function(S){for(var y=new Array(S),_=this.fragmentSourceTOP,S,C=1;C<=S;C++)y[C-1]=C+".0 * uDelta";return _+="uniform float uTaps["+S+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,y.forEach(function(k,w){_+="  color += texture2D(uTexture, vTexCoord + "+k+") * uTaps["+w+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+k+") * uTaps["+w+`];
`,_+="  sum += 2.0 * uTaps["+w+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(b){b.webgl?(b.passes++,this.width=b.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=b.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),b.destinationWidth=this.dW,this._setupFrameBuffer(b),this.applyToWebGL(b),this._swapTextures(b),b.sourceWidth=b.destinationWidth,this.height=b.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),b.destinationHeight=this.dH,this._setupFrameBuffer(b),this.applyToWebGL(b),this._swapTextures(b),b.sourceHeight=b.destinationHeight):this.applyTo2d(b)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(b){return function(y){if(y>=b||y<=-b)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;y*=Math.PI;var _=y/b;return m(y)/y*m(_)/_}},applyTo2d:function(b){var y=b.imageData,_=this.scaleX,S=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/S;var C=y.width,k=y.height,w=h(C*_),A=h(k*S),I;this.resizeType==="sliceHack"?I=this.sliceByTwo(b,C,k,w,A):this.resizeType==="hermite"?I=this.hermiteFastResize(b,C,k,w,A):this.resizeType==="bilinear"?I=this.bilinearFiltering(b,C,k,w,A):this.resizeType==="lanczos"&&(I=this.lanczosResize(b,C,k,w,A)),b.imageData=I},sliceByTwo:function(b,y,_,S,C){var k=b.imageData,w=.5,A=!1,I=!1,z=y*w,H=_*w,Q=o.filterBackend.resources,ee,Z,he=0,_e=0,we=y,O=0;for(Q.sliceByTwo||(Q.sliceByTwo=document.createElement("canvas")),ee=Q.sliceByTwo,(ee.width<y*1.5||ee.height<_)&&(ee.width=y*1.5,ee.height=_),Z=ee.getContext("2d"),Z.clearRect(0,0,y*1.5,_),Z.putImageData(k,0,0),S=f(S),C=f(C);!A||!I;)y=z,_=H,S<f(z*w)?z=f(z*w):(z=S,A=!0),C<f(H*w)?H=f(H*w):(H=C,I=!0),Z.drawImage(ee,he,_e,y,_,we,O,z,H),he=we,_e=O,O+=H;return Z.getImageData(he,_e,S,C)},lanczosResize:function(b,y,_,S,C){function k(L){var D,B,P,x,W,Y,ce,ne,me,pe,q;for(O.x=(L+.5)*H,N.x=f(O.x),D=0;D<C;D++){for(O.y=(D+.5)*Q,N.y=f(O.y),W=0,Y=0,ce=0,ne=0,me=0,B=N.x-he;B<=N.x+he;B++)if(!(B<0||B>=y)){pe=f(1e3*d(B-O.x)),we[pe]||(we[pe]={});for(var se=N.y-_e;se<=N.y+_e;se++)se<0||se>=_||(q=f(1e3*d(se-O.y)),we[pe][q]||(we[pe][q]=z(u(c(pe*ee,2)+c(q*Z,2))/1e3)),P=we[pe][q],P>0&&(x=(se*y+B)*4,W+=P,Y+=P*w[x],ce+=P*w[x+1],ne+=P*w[x+2],me+=P*w[x+3]))}x=(D*S+L)*4,I[x]=Y/W,I[x+1]=ce/W,I[x+2]=ne/W,I[x+3]=me/W}return++L<S?k(L):A}var w=b.imageData.data,A=b.ctx.createImageData(S,C),I=A.data,z=this.lanczosCreate(this.lanczosLobes),H=this.rcpScaleX,Q=this.rcpScaleY,ee=2/this.rcpScaleX,Z=2/this.rcpScaleY,he=p(H*this.lanczosLobes/2),_e=p(Q*this.lanczosLobes/2),we={},O={},N={};return k(0)},bilinearFiltering:function(b,y,_,S,C){var k,w,A,I,z,H,Q,ee,Z,he,_e,we,O=0,N,L=this.rcpScaleX,D=this.rcpScaleY,B=4*(y-1),P=b.imageData,x=P.data,W=b.ctx.createImageData(S,C),Y=W.data;for(Q=0;Q<C;Q++)for(ee=0;ee<S;ee++)for(z=f(L*ee),H=f(D*Q),Z=L*ee-z,he=D*Q-H,N=4*(H*y+z),_e=0;_e<4;_e++)k=x[N+_e],w=x[N+4+_e],A=x[N+B+_e],I=x[N+B+4+_e],we=k*(1-Z)*(1-he)+w*Z*(1-he)+A*he*(1-Z)+I*Z*he,Y[O++]=we;return W},hermiteFastResize:function(b,y,_,S,C){for(var k=this.rcpScaleX,w=this.rcpScaleY,A=p(k/2),I=p(w/2),z=b.imageData,H=z.data,Q=b.ctx.createImageData(S,C),ee=Q.data,Z=0;Z<C;Z++)for(var he=0;he<S;he++){for(var _e=(he+Z*S)*4,we=0,O=0,N=0,L=0,D=0,B=0,P=0,x=(Z+.5)*w,W=f(Z*w);W<(Z+1)*w;W++)for(var Y=d(x-(W+.5))/I,ce=(he+.5)*k,ne=Y*Y,me=f(he*k);me<(he+1)*k;me++){var pe=d(ce-(me+.5))/A,q=u(ne+pe*pe);q>1&&q<-1||(we=2*q*q*q-3*q*q+1,we>0&&(pe=4*(me+W*y),P+=we*H[pe+3],N+=we,H[pe+3]<255&&(we=we*H[pe+3]/250),L+=we*H[pe],D+=we*H[pe+1],B+=we*H[pe+2],O+=we))}ee[_e]=L/O,ee[_e+1]=D/O,ee[_e+2]=B/O,ee[_e+3]=P/N}return Q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),o.Image.filters.Resize.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Contrast=f(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(u){if(this.contrast!==0){var d=u.imageData,h,p,m=d.data,p=m.length,g=Math.floor(this.contrast*255),v=259*(g+255)/(255*(259-g));for(h=0;h<p;h+=4)m[h]=v*(m[h]-128)+128,m[h+1]=v*(m[h+1]-128)+128,m[h+2]=v*(m[h+2]-128)+128}},getUniformLocations:function(u,d){return{uContrast:u.getUniformLocation(d,"uContrast")}},sendUniformData:function(u,d){u.uniform1f(d.uContrast,this.contrast)}}),o.Image.filters.Contrast.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Saturation=f(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(u){if(this.saturation!==0){var d=u.imageData,h=d.data,m=h.length,p=-this.saturation,g,v;for(g=0;g<m;g+=4)v=Math.max(h[g],h[g+1],h[g+2]),h[g]+=v!==h[g]?(v-h[g])*p:0,h[g+1]+=v!==h[g+1]?(v-h[g+1])*p:0,h[g+2]+=v!==h[g+2]?(v-h[g+2])*p:0}},getUniformLocations:function(u,d){return{uSaturation:u.getUniformLocation(d,"uSaturation")}},sendUniformData:function(u,d){u.uniform1f(d.uSaturation,-this.saturation)}}),o.Image.filters.Saturation.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Vibrance=f(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(u){if(this.vibrance!==0){var d=u.imageData,h=d.data,m=h.length,p=-this.vibrance,g,v,b,y;for(g=0;g<m;g+=4)v=Math.max(h[g],h[g+1],h[g+2]),b=(h[g]+h[g+1]+h[g+2])/3,y=Math.abs(v-b)*2/255*p,h[g]+=v!==h[g]?(v-h[g])*y:0,h[g+1]+=v!==h[g+1]?(v-h[g+1])*y:0,h[g+2]+=v!==h[g+2]?(v-h[g+2])*y:0}},getUniformLocations:function(u,d){return{uVibrance:u.getUniformLocation(d,"uVibrance")}},sendUniformData:function(u,d){u.uniform1f(d.uVibrance,-this.vibrance)}}),o.Image.filters.Vibrance.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Blur=f(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(u){u.webgl?(this.aspectRatio=u.sourceWidth/u.sourceHeight,u.passes++,this._setupFrameBuffer(u),this.horizontal=!0,this.applyToWebGL(u),this._swapTextures(u),this._setupFrameBuffer(u),this.horizontal=!1,this.applyToWebGL(u),this._swapTextures(u)):this.applyTo2d(u)},applyTo2d:function(u){u.imageData=this.simpleBlur(u)},simpleBlur:function(u){var d=u.filterBackend.resources,h,m,p=u.imageData.width,g=u.imageData.height;d.blurLayer1||(d.blurLayer1=o.util.createCanvasElement(),d.blurLayer2=o.util.createCanvasElement()),h=d.blurLayer1,m=d.blurLayer2,(h.width!==p||h.height!==g)&&(m.width=h.width=p,m.height=h.height=g);var v=h.getContext("2d"),b=m.getContext("2d"),y=15,_,S,C,k,w=this.blur*.06*.5;for(v.putImageData(u.imageData,0,0),b.clearRect(0,0,p,g),k=-y;k<=y;k++)_=(Math.random()-.5)/4,S=k/y,C=w*S*p+_,b.globalAlpha=1-Math.abs(S),b.drawImage(h,C,_),v.drawImage(m,0,0),b.globalAlpha=1,b.clearRect(0,0,m.width,m.height);for(k=-y;k<=y;k++)_=(Math.random()-.5)/4,S=k/y,C=w*S*g+_,b.globalAlpha=1-Math.abs(S),b.drawImage(h,_,C),v.drawImage(m,0,0),b.globalAlpha=1,b.clearRect(0,0,m.width,m.height);u.ctx.drawImage(h,0,0);var A=u.ctx.getImageData(0,0,h.width,h.height);return v.globalAlpha=1,v.clearRect(0,0,h.width,h.height),A},getUniformLocations:function(u,d){return{delta:u.getUniformLocation(d,"uDelta")}},sendUniformData:function(u,d){var h=this.chooseRightDelta();u.uniform2fv(d.delta,h)},chooseRightDelta:function(){var u=1,d=[0,0],h;return this.horizontal?this.aspectRatio>1&&(u=1/this.aspectRatio):this.aspectRatio<1&&(u=this.aspectRatio),h=u*this.blur*.12,this.horizontal?d[0]=h:d[1]=h,d}}),c.Blur.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Gamma=f(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(u){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,u)},applyTo2d:function(u){var d=u.imageData,h=d.data,m=this.gamma,p=h.length,g=1/m[0],v=1/m[1],b=1/m[2],y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),y=0,p=256;y<p;y++)this.rVals[y]=Math.pow(y/255,g)*255,this.gVals[y]=Math.pow(y/255,v)*255,this.bVals[y]=Math.pow(y/255,b)*255;for(y=0,p=h.length;y<p;y+=4)h[y]=this.rVals[h[y]],h[y+1]=this.gVals[h[y+1]],h[y+2]=this.bVals[h[y+2]]},getUniformLocations:function(u,d){return{uGamma:u.getUniformLocation(d,"uGamma")}},sendUniformData:function(u,d){u.uniform3fv(d.uGamma,this.gamma)}}),o.Image.filters.Gamma.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.Composed=f(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(u){this.callSuper("initialize",u),this.subFilters=this.subFilters.slice(0)},applyTo:function(u){u.passes+=this.subFilters.length-1,this.subFilters.forEach(function(d){d.applyTo(u)})},toObject:function(){return o.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(u){return u.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(u){return!u.isNeutralState()})}}),o.Image.filters.Composed.fromObject=function(u,d){var h=u.subFilters||[],m=h.map(function(g){return new o.Image.filters[g.type](g)}),p=new o.Image.filters.Composed({subFilters:m});return d&&d(p),p}}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.Image.filters,f=o.util.createClass;c.HueRotation=f(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var u=this.rotation*Math.PI,d=o.util.cos(u),h=o.util.sin(u),m=1/3,p=Math.sqrt(m)*h,g=1-d;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=d+g/3,this.matrix[1]=m*g-p,this.matrix[2]=m*g+p,this.matrix[5]=m*g+p,this.matrix[6]=d+m*g,this.matrix[7]=m*g-p,this.matrix[10]=m*g-p,this.matrix[11]=m*g+p,this.matrix[12]=d+m*g},isNeutralState:function(u){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,u)},applyTo:function(u){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,u)}}),o.Image.filters.HueRotation.fromObject=o.Image.filters.BaseFilter.fromObject}(i),function(a){var o=a.fabric||(a.fabric={}),c=o.util.object.clone;if(o.Text){o.warn("fabric.Text is already defined");return}var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");o.Text=o.util.createClass(o.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:o.Object.prototype.stateProperties.concat(f),cacheProperties:o.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(u,d){this.styles=d?d.styles||{}:{},this.text=u,this.__skipDimension=!0,this.callSuper("initialize",d),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var u=this.path;u&&(u.segmentsInfo=o.util.getPathSegmentsInfo(u.path))},getMeasuringContext:function(){return o._measuringContext||(o._measuringContext=this.canvas&&this.canvas.contextCache||o.util.createCanvasElement().getContext("2d")),o._measuringContext},_splitText:function(){var u=this._splitTextIntoLines(this.text);return this.textLines=u.lines,this._textLines=u.graphemeLines,this._unwrappedTextLines=u._unwrappedLines,this._text=u.graphemeText,u},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var u,d,h,m,p,g,v,b=0,y=this._textLines.length;b<y;b++)if(!(this.textAlign!=="justify"&&(b===y-1||this.isEndOfWrapping(b)))&&(m=0,p=this._textLines[b],d=this.getLineWidth(b),d<this.width&&(v=this.textLines[b].match(this._reSpacesAndTabs)))){h=v.length,u=(this.width-d)/h;for(var _=0,S=p.length;_<=S;_++)g=this.__charBounds[b][_],this._reSpaceAndTab.test(p[_])?(g.width+=u,g.kernedWidth+=u,g.left+=m,m+=u):g.left+=m}},isEndOfWrapping:function(u){return u===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var u=this.callSuper("_getCacheCanvasDimensions"),d=this.fontSize;return u.width+=d*u.zoomX,u.height+=d*u.zoomY,u},_render:function(u){var d=this.path;d&&!d.isNotVisible()&&d._render(u),this._setTextStyles(u),this._renderTextLinesBackground(u),this._renderTextDecoration(u,"underline"),this._renderText(u),this._renderTextDecoration(u,"overline"),this._renderTextDecoration(u,"linethrough")},_renderText:function(u){this.paintFirst==="stroke"?(this._renderTextStroke(u),this._renderTextFill(u)):(this._renderTextFill(u),this._renderTextStroke(u))},_setTextStyles:function(u,d,h){if(u.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":u.textBaseline="middle";break;case"ascender":u.textBaseline="top";break;case"descender":u.textBaseline="bottom";break}u.font=this._getFontDeclaration(d,h)},calcTextWidth:function(){for(var u=this.getLineWidth(0),d=1,h=this._textLines.length;d<h;d++){var m=this.getLineWidth(d);m>u&&(u=m)}return u},_renderTextLine:function(u,d,h,m,p,g){this._renderChars(u,d,h,m,p,g)},_renderTextLinesBackground:function(u){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var d,h,m=u.fillStyle,p,g,v=this._getLeftOffset(),b=this._getTopOffset(),y=0,_=0,S,C,k=this.path,w,A=0,I=this._textLines.length;A<I;A++){if(d=this.getHeightOfLine(A),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",A)){b+=d;continue}p=this._textLines[A],h=this._getLineLeftOffset(A),_=0,y=0,g=this.getValueOfPropertyAt(A,0,"textBackgroundColor");for(var z=0,H=p.length;z<H;z++)S=this.__charBounds[A][z],C=this.getValueOfPropertyAt(A,z,"textBackgroundColor"),k?(u.save(),u.translate(S.renderLeft,S.renderTop),u.rotate(S.angle),u.fillStyle=C,C&&u.fillRect(-S.width/2,-d/this.lineHeight*(1-this._fontSizeFraction),S.width,d/this.lineHeight),u.restore()):C!==g?(w=v+h+y,this.direction==="rtl"&&(w=this.width-w-_),u.fillStyle=g,g&&u.fillRect(w,b,_,d/this.lineHeight),y=S.left,_=S.width,g=C):_+=S.kernedWidth;C&&!k&&(w=v+h+y,this.direction==="rtl"&&(w=this.width-w-_),u.fillStyle=C,u.fillRect(w,b,_,d/this.lineHeight)),b+=d}u.fillStyle=m,this._removeShadow(u)}},getFontCache:function(u){var d=u.fontFamily.toLowerCase();o.charWidthsCache[d]||(o.charWidthsCache[d]={});var h=o.charWidthsCache[d],m=u.fontStyle.toLowerCase()+"_"+(u.fontWeight+"").toLowerCase();return h[m]||(h[m]={}),h[m]},_measureChar:function(u,d,h,m){var p=this.getFontCache(d),g=this._getFontDeclaration(d),v=this._getFontDeclaration(m),b=h+u,y=g===v,_,S,C,k=d.fontSize/this.CACHE_FONT_SIZE,w;if(h&&p[h]!==void 0&&(C=p[h]),p[u]!==void 0&&(w=_=p[u]),y&&p[b]!==void 0&&(S=p[b],w=S-C),_===void 0||C===void 0||S===void 0){var A=this.getMeasuringContext();this._setTextStyles(A,d,!0)}return _===void 0&&(w=_=A.measureText(u).width,p[u]=_),C===void 0&&y&&h&&(C=A.measureText(h).width,p[h]=C),y&&S===void 0&&(S=A.measureText(b).width,p[b]=S,w=S-C),{width:_*k,kernedWidth:w*k}},getHeightOfChar:function(u,d){return this.getValueOfPropertyAt(u,d,"fontSize")},measureLine:function(u){var d=this._measureLine(u);return this.charSpacing!==0&&(d.width-=this._getWidthOfCharSpacing()),d.width<0&&(d.width=0),d},_measureLine:function(u){var d=0,h,m,p=this._textLines[u],g,v,b=0,y=new Array(p.length),_=0,S,C,k=this.path,w=this.pathSide==="right";for(this.__charBounds[u]=y,h=0;h<p.length;h++)m=p[h],v=this._getGraphemeBox(m,u,h,g),y[h]=v,d+=v.kernedWidth,g=m;if(y[h]={left:v?v.left+v.width:0,width:0,kernedWidth:0,height:this.fontSize},k){switch(C=k.segmentsInfo[k.segmentsInfo.length-1].length,S=o.util.getPointOnPath(k.path,0,k.segmentsInfo),S.x+=k.pathOffset.x,S.y+=k.pathOffset.y,this.textAlign){case"left":_=w?C-d:0;break;case"center":_=(C-d)/2;break;case"right":_=w?0:C-d;break}for(_+=this.pathStartOffset*(w?-1:1),h=w?p.length-1:0;w?h>=0:h<p.length;w?h--:h++)v=y[h],_>C?_%=C:_<0&&(_+=C),this._setGraphemeOnPath(_,v,S),_+=v.kernedWidth}return{width:d,numOfSpaces:b}},_setGraphemeOnPath:function(u,d,h){var m=u+d.kernedWidth/2,p=this.path,g=o.util.getPointOnPath(p.path,m,p.segmentsInfo);d.renderLeft=g.x-h.x,d.renderTop=g.y-h.y,d.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(u,d,h,m,p){var g=this.getCompleteStyleDeclaration(d,h),v=m?this.getCompleteStyleDeclaration(d,h-1):{},b=this._measureChar(u,g,m,v),y=b.kernedWidth,_=b.width,S;this.charSpacing!==0&&(S=this._getWidthOfCharSpacing(),_+=S,y+=S);var C={width:_,left:0,height:g.fontSize,kernedWidth:y,deltaY:g.deltaY};if(h>0&&!p){var k=this.__charBounds[d][h-1];C.left=k.left+k.width+b.kernedWidth-b.width}return C},getHeightOfLine:function(u){if(this.__lineHeights[u])return this.__lineHeights[u];for(var d=this._textLines[u],h=this.getHeightOfChar(u,0),m=1,p=d.length;m<p;m++)h=Math.max(this.getHeightOfChar(u,m),h);return this.__lineHeights[u]=h*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var u,d=0,h=0,m=this._textLines.length;h<m;h++)u=this.getHeightOfLine(h),d+=h===m-1?u/this.lineHeight:u;return d},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(u,d){u.save();for(var h=0,m=this._getLeftOffset(),p=this._getTopOffset(),g=0,v=this._textLines.length;g<v;g++){var b=this.getHeightOfLine(g),y=b/this.lineHeight,_=this._getLineLeftOffset(g);this._renderTextLine(d,u,this._textLines[g],m+_,p+h+y,g),h+=b}u.restore()},_renderTextFill:function(u){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(u,"fillText")},_renderTextStroke:function(u){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this._setLineDash(u,this.strokeDashArray),u.beginPath(),this._renderTextCommon(u,"strokeText"),u.closePath(),u.restore())},_renderChars:function(u,d,h,m,p,g){var v=this.getHeightOfLine(g),b=this.textAlign.indexOf("justify")!==-1,y,_,S="",C,k=0,w,A=this.path,I=!b&&this.charSpacing===0&&this.isEmptyStyles(g)&&!A,z=this.direction==="ltr",H=this.direction==="ltr"?1:-1,Q,ee=d.canvas.getAttribute("dir");if(d.save(),ee!==this.direction&&(d.canvas.setAttribute("dir",z?"ltr":"rtl"),d.direction=z?"ltr":"rtl",d.textAlign=z?"left":"right"),p-=v*this._fontSizeFraction/this.lineHeight,I){this._renderChar(u,d,g,0,h.join(""),m,p,v),d.restore();return}for(var Z=0,he=h.length-1;Z<=he;Z++)w=Z===he||this.charSpacing||A,S+=h[Z],C=this.__charBounds[g][Z],k===0?(m+=H*(C.kernedWidth-C.width),k+=C.width):k+=C.kernedWidth,b&&!w&&this._reSpaceAndTab.test(h[Z])&&(w=!0),w||(y=y||this.getCompleteStyleDeclaration(g,Z),_=this.getCompleteStyleDeclaration(g,Z+1),w=o.util.hasStyleChanged(y,_,!1)),w&&(A?(d.save(),d.translate(C.renderLeft,C.renderTop),d.rotate(C.angle),this._renderChar(u,d,g,Z,S,-k/2,0,v),d.restore()):(Q=m,this._renderChar(u,d,g,Z,S,Q,p,v)),S="",y=_,m+=H*k,k=0);d.restore()},_applyPatternGradientTransformText:function(u){var d=o.util.createCanvasElement(),h,m=this.width+this.strokeWidth,p=this.height+this.strokeWidth;return d.width=m,d.height=p,h=d.getContext("2d"),h.beginPath(),h.moveTo(0,0),h.lineTo(m,0),h.lineTo(m,p),h.lineTo(0,p),h.closePath(),h.translate(m/2,p/2),h.fillStyle=u.toLive(h),this._applyPatternGradientTransform(h,u),h.fill(),h.createPattern(d,"no-repeat")},handleFiller:function(u,d,h){var m,p;return h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?(m=-this.width/2,p=-this.height/2,u.translate(m,p),u[d]=this._applyPatternGradientTransformText(h),{offsetX:m,offsetY:p}):(u[d]=h.toLive(u,this),this._applyPatternGradientTransform(u,h)):(u[d]=h,{offsetX:0,offsetY:0})},_setStrokeStyles:function(u,d){return u.lineWidth=d.strokeWidth,u.lineCap=this.strokeLineCap,u.lineDashOffset=this.strokeDashOffset,u.lineJoin=this.strokeLineJoin,u.miterLimit=this.strokeMiterLimit,this.handleFiller(u,"strokeStyle",d.stroke)},_setFillStyles:function(u,d){return this.handleFiller(u,"fillStyle",d.fill)},_renderChar:function(u,d,h,m,p,g,v){var b=this._getStyleDeclaration(h,m),y=this.getCompleteStyleDeclaration(h,m),_=u==="fillText"&&y.fill,S=u==="strokeText"&&y.stroke&&y.strokeWidth,C,k;!S&&!_||(d.save(),_&&(C=this._setFillStyles(d,y)),S&&(k=this._setStrokeStyles(d,y)),d.font=this._getFontDeclaration(y),b&&b.textBackgroundColor&&this._removeShadow(d),b&&b.deltaY&&(v+=b.deltaY),_&&d.fillText(p,g-C.offsetX,v-C.offsetY),S&&d.strokeText(p,g-k.offsetX,v-k.offsetY),d.restore())},setSuperscript:function(u,d){return this._setScript(u,d,this.superscript)},setSubscript:function(u,d){return this._setScript(u,d,this.subscript)},_setScript:function(u,d,h){var m=this.get2DCursorLocation(u,!0),p=this.getValueOfPropertyAt(m.lineIndex,m.charIndex,"fontSize"),g=this.getValueOfPropertyAt(m.lineIndex,m.charIndex,"deltaY"),v={fontSize:p*h.size,deltaY:g+p*h.baseline};return this.setSelectionStyles(v,u,d),this},_getLineLeftOffset:function(u){var d=this.getLineWidth(u),h=this.width-d,m=this.textAlign,p=this.direction,v,g=0,v=this.isEndOfWrapping(u);return m==="justify"||m==="justify-center"&&!v||m==="justify-right"&&!v||m==="justify-left"&&!v?0:(m==="center"&&(g=h/2),m==="right"&&(g=h),m==="justify-center"&&(g=h/2),m==="justify-right"&&(g=h),p==="rtl"&&(g-=h),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var u=this._forceClearCache;return u||(u=this.hasStateChanged("_dimensionAffectingProps")),u&&(this.dirty=!0,this._forceClearCache=!1),u},getLineWidth:function(u){if(this.__lineWidths[u]!==void 0)return this.__lineWidths[u];var d=this.measureLine(u),h=d.width;return this.__lineWidths[u]=h,h},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(u,d,h){var m=this._getStyleDeclaration(u,d);return m&&typeof m[h]<"u"?m[h]:this[h]},_renderTextDecoration:function(u,d){if(!(!this[d]&&!this.styleHas(d))){for(var h,m,p,g,v,b,y,_,S=this._getLeftOffset(),C=this._getTopOffset(),k,w,A,I,z,H,Q,ee,Z=this.path,he=this._getWidthOfCharSpacing(),_e=this.offsets[d],we=0,O=this._textLines.length;we<O;we++){if(h=this.getHeightOfLine(we),!this[d]&&!this.styleHas(d,we)){C+=h;continue}y=this._textLines[we],H=h/this.lineHeight,g=this._getLineLeftOffset(we),w=0,A=0,_=this.getValueOfPropertyAt(we,0,d),ee=this.getValueOfPropertyAt(we,0,"fill"),k=C+H*(1-this._fontSizeFraction),m=this.getHeightOfChar(we,0),v=this.getValueOfPropertyAt(we,0,"deltaY");for(var N=0,L=y.length;N<L;N++)if(I=this.__charBounds[we][N],z=this.getValueOfPropertyAt(we,N,d),Q=this.getValueOfPropertyAt(we,N,"fill"),p=this.getHeightOfChar(we,N),b=this.getValueOfPropertyAt(we,N,"deltaY"),Z&&z&&Q)u.save(),u.fillStyle=ee,u.translate(I.renderLeft,I.renderTop),u.rotate(I.angle),u.fillRect(-I.kernedWidth/2,_e*p+b,I.kernedWidth,this.fontSize/15),u.restore();else if((z!==_||Q!==ee||p!==m||b!==v)&&A>0){var D=S+g+w;this.direction==="rtl"&&(D=this.width-D-A),_&&ee&&(u.fillStyle=ee,u.fillRect(D,k+_e*m+v,A,this.fontSize/15)),w=I.left,A=I.width,_=z,ee=Q,m=p,v=b}else A+=I.kernedWidth;var D=S+g+w;this.direction==="rtl"&&(D=this.width-D-A),u.fillStyle=Q,z&&Q&&u.fillRect(D,k+_e*m+v,A-he,this.fontSize/15),C+=h}this._removeShadow(u)}},_getFontDeclaration:function(u,d){var h=u||this,m=this.fontFamily,p=o.Text.genericFonts.indexOf(m.toLowerCase())>-1,g=m===void 0||m.indexOf("'")>-1||m.indexOf(",")>-1||m.indexOf('"')>-1||p?h.fontFamily:'"'+h.fontFamily+'"';return[o.isLikelyNode?h.fontWeight:h.fontStyle,o.isLikelyNode?h.fontStyle:h.fontWeight,d?this.CACHE_FONT_SIZE+"px":h.fontSize+"px",g].join(" ")},render:function(u){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",u)))},_splitTextIntoLines:function(u){for(var d=u.split(this._reNewline),h=new Array(d.length),m=[`
`],p=[],g=0;g<d.length;g++)h[g]=o.util.string.graphemeSplit(d[g]),p=p.concat(h[g],m);return p.pop(),{_unwrappedLines:h,lines:d,graphemeText:p,graphemeLines:h}},toObject:function(u){var d=f.concat(u),h=this.callSuper("toObject",d);return h.styles=o.util.stylesToArray(this.styles,this.text),h.path&&(h.path=this.path.toObject()),h},set:function(u,d){this.callSuper("set",u,d);var h=!1,m=!1;if(typeof u=="object")for(var p in u)p==="path"&&this.setPathInfo(),h=h||this._dimensionAffectingProps.indexOf(p)!==-1,m=m||p==="path";else h=this._dimensionAffectingProps.indexOf(u)!==-1,m=u==="path";return m&&this.setPathInfo(),h&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),o.Text.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),o.Text.DEFAULT_SVG_FONT_SIZE=16,o.Text.fromElement=function(u,d,h){if(!u)return d(null);var m=o.parseAttributes(u,o.Text.ATTRIBUTE_NAMES),p=m.textAnchor||"left";if(h=o.util.object.extend(h?c(h):{},m),h.top=h.top||0,h.left=h.left||0,m.textDecoration){var g=m.textDecoration;g.indexOf("underline")!==-1&&(h.underline=!0),g.indexOf("overline")!==-1&&(h.overline=!0),g.indexOf("line-through")!==-1&&(h.linethrough=!0),delete h.textDecoration}"dx"in m&&(h.left+=m.dx),"dy"in m&&(h.top+=m.dy),"fontSize"in h||(h.fontSize=o.Text.DEFAULT_SVG_FONT_SIZE);var v="";"textContent"in u?v=u.textContent:"firstChild"in u&&u.firstChild!==null&&"data"in u.firstChild&&u.firstChild.data!==null&&(v=u.firstChild.data),v=v.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var b=h.strokeWidth;h.strokeWidth=0;var y=new o.Text(v,h),_=y.getScaledHeight()/y.height,S=(y.height+y.strokeWidth)*y.lineHeight-y.height,C=S*_,k=y.getScaledHeight()+C,w=0;p==="center"&&(w=y.getScaledWidth()/2),p==="right"&&(w=y.getScaledWidth()),y.set({left:y.left-w,top:y.top-(k-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:typeof b<"u"?b:1}),d(y)},o.Text.fromObject=function(u,d){var h=c(u),m=u.path;return delete h.path,o.Object._fromObject("Text",h,function(p){p.styles=o.util.stylesFromArray(u.styles,u.text),m?o.Object._fromObject("Path",m,function(g){p.set("path",g),d(p)},"path"):d(p)},"text")},o.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],o.util.createAccessors&&o.util.createAccessors(o.Text)}(i),function(){e.util.object.extend(e.Text.prototype,{isEmptyStyles:function(a){if(!this.styles||typeof a<"u"&&!this.styles[a])return!0;var o=typeof a>"u"?this.styles:{line:this.styles[a]};for(var c in o)for(var f in o[c])for(var u in o[c][f])return!1;return!0},styleHas:function(a,o){if(!this.styles||!a||a===""||typeof o<"u"&&!this.styles[o])return!1;var c=typeof o>"u"?this.styles:{0:this.styles[o]};for(var f in c)for(var u in c[f])if(typeof c[f][u][a]<"u")return!0;return!1},cleanStyle:function(a){if(!this.styles||!a||a==="")return!1;var o=this.styles,c=0,f,u,d=!0,h=0,m;for(var p in o){f=0;for(var g in o[p]){var m=o[p][g],v=m.hasOwnProperty(a);c++,v?(u?m[a]!==u&&(d=!1):u=m[a],m[a]===this[a]&&delete m[a]):d=!1,Object.keys(m).length!==0?f++:delete o[p][g]}f===0&&delete o[p]}for(var b=0;b<this._textLines.length;b++)h+=this._textLines[b].length;d&&c===h&&(this[a]=u,this.removeStyle(a))},removeStyle:function(a){if(!(!this.styles||!a||a==="")){var o=this.styles,c,f,u;for(f in o){c=o[f];for(u in c)delete c[u][a],Object.keys(c[u]).length===0&&delete c[u];Object.keys(c).length===0&&delete o[f]}}},_extendStyles:function(a,o){var c=this.get2DCursorLocation(a);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),e.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),o)},get2DCursorLocation:function(a,o){typeof a>"u"&&(a=this.selectionStart);for(var c=o?this._unwrappedTextLines:this._textLines,f=c.length,u=0;u<f;u++){if(a<=c[u].length)return{lineIndex:u,charIndex:a};a-=c[u].length+this.missingNewlineOffset(u)}return{lineIndex:u-1,charIndex:c[u-1].length<a?c[u-1].length:a}},getSelectionStyles:function(a,o,c){typeof a>"u"&&(a=this.selectionStart||0),typeof o>"u"&&(o=this.selectionEnd||a);for(var f=[],u=a;u<o;u++)f.push(this.getStyleAtPosition(u,c));return f},getStyleAtPosition:function(a,o){var c=this.get2DCursorLocation(a),f=o?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return f||{}},setSelectionStyles:function(a,o,c){typeof o>"u"&&(o=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||o);for(var f=o;f<c;f++)this._extendStyles(f,a);return this._forceClearCache=!0,this},_getStyleDeclaration:function(a,o){var c=this.styles&&this.styles[a];return c?c[o]:null},getCompleteStyleDeclaration:function(a,o){for(var c=this._getStyleDeclaration(a,o)||{},f={},u,d=0;d<this._styleProperties.length;d++)u=this._styleProperties[d],f[u]=typeof c[u]>"u"?this[u]:c[u];return f},_setStyleDeclaration:function(a,o,c){this.styles[a][o]=c},_deleteStyleDeclaration:function(a,o){delete this.styles[a][o]},_getLineStyle:function(a){return!!this.styles[a]},_setLineStyle:function(a){this.styles[a]={}},_deleteLineStyle:function(a){delete this.styles[a]}})}(),function(){function a(o){o.textDecoration&&(o.textDecoration.indexOf("underline")>-1&&(o.underline=!0),o.textDecoration.indexOf("line-through")>-1&&(o.linethrough=!0),o.textDecoration.indexOf("overline")>-1&&(o.overline=!0),delete o.textDecoration)}e.IText=e.util.createClass(e.Text,e.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(o,c){this.callSuper("initialize",o,c),this.initBehavior()},setSelectionStart:function(o){o=Math.max(o,0),this._updateAndFire("selectionStart",o)},setSelectionEnd:function(o){o=Math.min(o,this.text.length),this._updateAndFire("selectionEnd",o)},_updateAndFire:function(o,c){this[o]!==c&&(this._fireSelectionChanged(),this[o]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(o){this.clearContextTop(),this.callSuper("render",o),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(o){this.callSuper("_render",o)},clearContextTop:function(o){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,f=this.canvas.viewportTransform;c.save(),c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(c),this._clearTextArea(c),o||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var o=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(o,c):this.renderSelection(o,c),c.restore()}},_clearTextArea:function(o){var c=this.width+4,f=this.height+4;o.clearRect(-c/2,-f/2,c,f)},_getCursorBoundaries:function(o){typeof o>"u"&&(o=this.selectionStart);var c=this._getLeftOffset(),f=this._getTopOffset(),u=this._getCursorBoundariesOffsets(o);return{left:c,top:f,leftOffset:u.left,topOffset:u.top}},_getCursorBoundariesOffsets:function(o){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,f,u,d=0,h=0,m,p=this.get2DCursorLocation(o);u=p.charIndex,f=p.lineIndex;for(var g=0;g<f;g++)d+=this.getHeightOfLine(g);c=this._getLineLeftOffset(f);var v=this.__charBounds[f][u];return v&&(h=v.left),this.charSpacing!==0&&u===this._textLines[f].length&&(h-=this._getWidthOfCharSpacing()),m={top:d,left:c+(h>0?h:0)},this.direction==="rtl"&&(m.left*=-1),this.cursorOffsetCache=m,this.cursorOffsetCache},renderCursor:function(o,c){var f=this.get2DCursorLocation(),u=f.lineIndex,d=f.charIndex>0?f.charIndex-1:0,h=this.getValueOfPropertyAt(u,d,"fontSize"),m=this.scaleX*this.canvas.getZoom(),p=this.cursorWidth/m,g=o.topOffset,v=this.getValueOfPropertyAt(u,d,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(u)/this.lineHeight-h*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(o,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(u,d,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(o.left+o.leftOffset-p/2,g+o.top+v,p,h)},renderSelection:function(o,c){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,u=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,d=this.textAlign.indexOf("justify")!==-1,h=this.get2DCursorLocation(f),m=this.get2DCursorLocation(u),p=h.lineIndex,g=m.lineIndex,v=h.charIndex<0?0:h.charIndex,b=m.charIndex<0?0:m.charIndex,y=p;y<=g;y++){var _=this._getLineLeftOffset(y)||0,S=this.getHeightOfLine(y),C=0,k=0,w=0;if(y===p&&(k=this.__charBounds[p][v].left),y>=p&&y<g)w=d&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===g)if(b===0)w=this.__charBounds[g][b].left;else{var A=this._getWidthOfCharSpacing();w=this.__charBounds[g][b-1].left+this.__charBounds[g][b-1].width-A}C=S,(this.lineHeight<1||y===g&&this.lineHeight>1)&&(S/=this.lineHeight);var I=o.left+_+k,z=w-k,H=S,Q=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",H=1,Q=S):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(I=this.width-I-z),c.fillRect(I,o.top+o.topOffset+Q,z,H),o.topOffset+=C}},getCurrentCharFontSize:function(){var o=this._getCurrentCharIndex();return this.getValueOfPropertyAt(o.l,o.c,"fontSize")},getCurrentCharColor:function(){var o=this._getCurrentCharIndex();return this.getValueOfPropertyAt(o.l,o.c,"fill")},_getCurrentCharIndex:function(){var o=this.get2DCursorLocation(this.selectionStart,!0),c=o.charIndex>0?o.charIndex-1:0;return{l:o.lineIndex,c}}}),e.IText.fromObject=function(o,c){var f=e.util.stylesFromArray(o.styles,o.text),u=Object.assign({},o,{styles:f});if(a(u),u.styles)for(var d in u.styles)for(var h in u.styles[d])a(u.styles[d][h]);e.Object._fromObject("IText",u,c,"text")}}(),function(){var a=e.util.object.clone;e.util.object.extend(e.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var o=this;this.on("added",function(){var c=o.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,o._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(o))})},initRemovedHandler:function(){var o=this;this.on("removed",function(){var c=o.canvas;c&&(c._iTextInstances=c._iTextInstances||[],e.util.removeFromArray(c._iTextInstances,o),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,o._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(o){o._mouseUpITextHandler=function(){o._iTextInstances&&o._iTextInstances.forEach(function(c){c.__isMousedown=!1})},o.on("mouse:up",o._mouseUpITextHandler)},_removeCanvasHandlers:function(o){o.off("mouse:up",o._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(o,c,f,u){var d;return d={isAborted:!1,abort:function(){this.isAborted=!0}},o.animate("_currentCursorOpacity",c,{duration:f,onComplete:function(){d.isAborted||o[u]()},onChange:function(){o.canvas&&o.selectionStart===o.selectionEnd&&o.renderCursorOrSelection()},abort:function(){return d.isAborted}}),d},_onTickComplete:function(){var o=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){o._currentTickCompleteState=o._animateCursor(o,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(o){var c=this,f=o?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},f)},abortCursorAnimation:function(){var o=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,o&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(o){var c=0,f=o-1;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f--;for(;/\S/.test(this._text[f])&&f>-1;)c++,f--;return o-c},findWordBoundaryRight:function(o){var c=0,f=o;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f++;for(;/\S/.test(this._text[f])&&f<this._text.length;)c++,f++;return o+c},findLineBoundaryLeft:function(o){for(var c=0,f=o-1;!/\n/.test(this._text[f])&&f>-1;)c++,f--;return o-c},findLineBoundaryRight:function(o){for(var c=0,f=o;!/\n/.test(this._text[f])&&f<this._text.length;)c++,f++;return o+c},searchWordBoundary:function(o,c){for(var f=this._text,u=this._reSpace.test(f[o])?o-1:o,d=f[u],h=e.reNonWord;!h.test(d)&&u>0&&u<f.length;)u+=c,d=f[u];return h.test(d)&&(u+=c===1?0:1),u},selectWord:function(o){o=o||this.selectionStart;var c=this.searchWordBoundary(o,-1),f=this.searchWordBoundary(o,1);this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(o){o=o||this.selectionStart;var c=this.findLineBoundaryLeft(o),f=this.findLineBoundaryRight(o);return this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(o){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(o),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(o){o._iTextInstances&&o._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(o){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(o.e),f=this.selectionStart,u=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||f===u)&&(f===c||u===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==f||this.selectionEnd!==u)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(o,c,f){var u=f.slice(0,o),d=e.util.string.graphemeSplit(u).length;if(o===c)return{selectionStart:d,selectionEnd:d};var h=f.slice(o,c),m=e.util.string.graphemeSplit(h).length;return{selectionStart:d,selectionEnd:d+m}},fromGraphemeToStringSelection:function(o,c,f){var u=f.slice(0,o),d=u.join("").length;if(o===c)return{selectionStart:d,selectionEnd:d};var h=f.slice(o,c),m=h.join("").length;return{selectionStart:d,selectionEnd:d+m}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var o=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=o.selectionStart,this.hiddenTextarea.selectionEnd=o.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var o=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=o.selectionEnd,this.inCompositionMode||(this.selectionStart=o.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var o=this._calcTextareaPosition();this.hiddenTextarea.style.left=o.left,this.hiddenTextarea.style.top=o.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var o=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(o),f=this.get2DCursorLocation(o),u=f.lineIndex,d=f.charIndex,h=this.getValueOfPropertyAt(u,d,"fontSize")*this.lineHeight,m=c.leftOffset,p=this.calcTransformMatrix(),g={x:c.left+m,y:c.top+c.topOffset+h},v=this.canvas.getRetinaScaling(),b=this.canvas.upperCanvasEl,y=b.width/v,_=b.height/v,S=y-h,C=_-h,k=b.clientWidth/y,w=b.clientHeight/_;return g=e.util.transformPoint(g,p),g=e.util.transformPoint(g,this.canvas.viewportTransform),g.x*=k,g.y*=w,g.x<0&&(g.x=0),g.x>S&&(g.x=S),g.y<0&&(g.y=0),g.y>C&&(g.y=C),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:h+"px",charHeight:h}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var o=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),o&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),o&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var o in this.styles)this._textLines[o]||delete this.styles[o]},removeStyleFromTo:function(o,c){var f=this.get2DCursorLocation(o,!0),u=this.get2DCursorLocation(c,!0),d=f.lineIndex,h=f.charIndex,m=u.lineIndex,p=u.charIndex,g,v;if(d!==m){if(this.styles[d])for(g=h;g<this._unwrappedTextLines[d].length;g++)delete this.styles[d][g];if(this.styles[m])for(g=p;g<this._unwrappedTextLines[m].length;g++)v=this.styles[m][g],v&&(this.styles[d]||(this.styles[d]={}),this.styles[d][h+g-p]=v);for(g=d+1;g<=m;g++)delete this.styles[g];this.shiftLineStyles(m,d-m)}else if(this.styles[d]){v=this.styles[d];var b=p-h,y,_;for(g=h;g<p;g++)delete v[g];for(_ in this.styles[d])y=parseInt(_,10),y>=p&&(v[y-b]=v[_],delete v[_])}},shiftLineStyles:function(o,c){var f=a(this.styles);for(var u in this.styles){var d=parseInt(u,10);d>o&&(this.styles[d+c]=f[d],f[d-c]||delete this.styles[d])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(o,c,f,u){var d,h={},m=!1,p=this._unwrappedTextLines[o].length===c;f||(f=1),this.shiftLineStyles(o,f),this.styles[o]&&(d=this.styles[o][c===0?c:c-1]);for(var g in this.styles[o]){var v=parseInt(g,10);v>=c&&(m=!0,h[v-c]=this.styles[o][g],p&&c===0||delete this.styles[o][g])}var b=!1;for(m&&!p&&(this.styles[o+f]=h,b=!0),b&&f--;f>0;)u&&u[f-1]?this.styles[o+f]={0:a(u[f-1])}:d?this.styles[o+f]={0:a(d)}:delete this.styles[o+f],f--;this._forceClearCache=!0},insertCharStyleObject:function(o,c,f,u){this.styles||(this.styles={});var d=this.styles[o],h=d?a(d):{};f||(f=1);for(var m in h){var p=parseInt(m,10);p>=c&&(d[p+f]=h[p],h[p-f]||delete d[p])}if(this._forceClearCache=!0,u){for(;f--;)Object.keys(u[f]).length&&(this.styles[o]||(this.styles[o]={}),this.styles[o][c+f]=a(u[f]));return}if(d)for(var g=d[c?c-1:1];g&&f--;)this.styles[o][c+f]=a(g)},insertNewStyleBlock:function(o,c,f){for(var u=this.get2DCursorLocation(c,!0),d=[0],h=0,m=0;m<o.length;m++)o[m]===`
`?(h++,d[h]=0):d[h]++;d[0]>0&&(this.insertCharStyleObject(u.lineIndex,u.charIndex,d[0],f),f=f&&f.slice(d[0]+1)),h&&this.insertNewlineStyleObject(u.lineIndex,u.charIndex+d[0],h);for(var m=1;m<h;m++)d[m]>0?this.insertCharStyleObject(u.lineIndex+m,0,d[m],f):f&&this.styles[u.lineIndex+m]&&f[0]&&(this.styles[u.lineIndex+m][0]=f[0]),f=f&&f.slice(d[m]+1);d[m]>0&&this.insertCharStyleObject(u.lineIndex+m,0,d[m],f)},setSelectionStartEndWithShift:function(o,c,f){f<=o?(c===o?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=o),this.selectionStart=f):f>o&&f<c?this._selectionDirection==="right"?this.selectionEnd=f:this.selectionStart=f:(c===o?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=f)},setSelectionInBoundaries:function(){var o=this.text.length;this.selectionStart>o?this.selectionStart=o:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>o?this.selectionEnd=o:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),e.util.object.extend(e.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(a){if(this.canvas){this.__newClickTime=+new Date;var o=a.pointer;this.isTripleClick(o)&&(this.fire("tripleclick",a),this._stopEvent(a.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=o,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(a){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===a.x&&this.__lastPointer.y===a.y},_stopEvent:function(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(a){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(a.e))},tripleClickHandler:function(a){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(a.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(a.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(a){if(this.__isMousedown=!1,!(!this.editable||this.group||a.transform&&a.transform.actionPerformed||a.e.button&&a.e.button!==1)){if(this.canvas){var o=this.canvas._activeObject;if(o&&o!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(a.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(a){var o=this.getSelectionStartFromPointer(a),c=this.selectionStart,f=this.selectionEnd;a.shiftKey?this.setSelectionStartEndWithShift(c,f,o):(this.selectionStart=o,this.selectionEnd=o),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(a){for(var o=this.getLocalPointer(a),c=0,f=0,u=0,d=0,h=0,m,p,g=0,v=this._textLines.length;g<v&&u<=o.y;g++)u+=this.getHeightOfLine(g)*this.scaleY,h=g,g>0&&(d+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));m=this._getLineLeftOffset(h),f=m*this.scaleX,p=this._textLines[h],this.direction==="rtl"&&(o.x=this.width*this.scaleX-o.x+f);for(var b=0,y=p.length;b<y&&(c=f,f+=this.__charBounds[h][b].kernedWidth*this.scaleX,f<=o.x);b++)d++;return this._getNewSelectionStartFromOffset(o,c,f,d,y)},_getNewSelectionStartFromOffset:function(a,o,c,f,u){var d=a.x-o,h=c-a.x,m=h>d||h<0?0:1,p=f+m;return this.flipX&&(p=u-p),p>this._text.length&&(p=this._text.length),p}}),e.util.object.extend(e.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=e.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var a=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+a.top+"; left: "+a.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+a.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):e.document.body.appendChild(this.hiddenTextarea),e.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),e.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),e.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),e.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(e.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(a){if(this.isEditing){var o=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(a.keyCode in o)this[o[a.keyCode]](a);else if(a.keyCode in this.ctrlKeysMapDown&&(a.ctrlKey||a.metaKey))this[this.ctrlKeysMapDown[a.keyCode]](a);else return;a.stopImmediatePropagation(),a.preventDefault(),a.keyCode>=33&&a.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(a){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(a.keyCode in this.ctrlKeysMapUp&&(a.ctrlKey||a.metaKey))this[this.ctrlKeysMapUp[a.keyCode]](a);else return;a.stopImmediatePropagation(),a.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(a){var o=this.fromPaste;if(this.fromPaste=!1,a&&a.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,f=this._text.length,u=c.length,d,h,m=u-f,p=this.selectionStart,g=this.selectionEnd,v=p!==g,b,y,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var S=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),C=p>S.selectionStart;v?(d=this._text.slice(p,g),m+=g-p):u<f&&(C?d=this._text.slice(g+m,g):d=this._text.slice(p,p-m)),h=c.slice(S.selectionEnd-m,S.selectionEnd),d&&d.length&&(h.length&&(b=this.getSelectionStyles(p,p+1,!1),b=h.map(function(){return b[0]})),v?(y=p,_=g):C?(y=g-d.length,_=g):(y=g,_=g+d.length),this.removeStyleFromTo(y,_)),h.length&&(o&&h.join("")===e.copiedText&&!e.disableStyleCopyPaste&&(b=e.copiedTextStyle),this.insertNewStyleBlock(h,p,b)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(a){this.compositionStart=a.target.selectionStart,this.compositionEnd=a.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(e.copiedText=this.getSelectedText(),e.disableStyleCopyPaste?e.copiedTextStyle=null:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(a){return a&&a.clipboardData||e.window.clipboardData},_getWidthBeforeCursor:function(a,o){var c=this._getLineLeftOffset(a),f;return o>0&&(f=this.__charBounds[a][o-1],c+=f.left+f.width),c},getDownCursorOffset:function(a,o){var c=this._getSelectionForOffset(a,o),f=this.get2DCursorLocation(c),u=f.lineIndex;if(u===this._textLines.length-1||a.metaKey||a.keyCode===34)return this._text.length-c;var d=f.charIndex,h=this._getWidthBeforeCursor(u,d),m=this._getIndexOnLine(u+1,h),p=this._textLines[u].slice(d);return p.length+m+1+this.missingNewlineOffset(u)},_getSelectionForOffset:function(a,o){return a.shiftKey&&this.selectionStart!==this.selectionEnd&&o?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(a,o){var c=this._getSelectionForOffset(a,o),f=this.get2DCursorLocation(c),u=f.lineIndex;if(u===0||a.metaKey||a.keyCode===33)return-c;var d=f.charIndex,h=this._getWidthBeforeCursor(u,d),m=this._getIndexOnLine(u-1,h),p=this._textLines[u].slice(0,d),g=this.missingNewlineOffset(u-1);return-this._textLines[u-1].length+m-p.length+(1-g)},_getIndexOnLine:function(a,o){for(var c=this._textLines[a],f=this._getLineLeftOffset(a),u=f,d=0,h,m,p=0,g=c.length;p<g;p++)if(h=this.__charBounds[a][p].width,u+=h,u>o){m=!0;var v=u-h,b=u,y=Math.abs(v-o),_=Math.abs(b-o);d=_<y?p:p-1;break}return m||(d=c.length-1),d},moveCursorDown:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",a)},moveCursorUp:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",a)},_moveCursorUpOrDown:function(a,o){var c="get"+a+"CursorOffset",f=this[c](o,this._selectionDirection==="right");o.shiftKey?this.moveCursorWithShift(f):this.moveCursorWithoutShift(f),f!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(a){var o=this._selectionDirection==="left"?this.selectionStart+a:this.selectionEnd+a;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,o),a!==0},moveCursorWithoutShift:function(a){return a<0?(this.selectionStart+=a,this.selectionEnd=this.selectionStart):(this.selectionEnd+=a,this.selectionStart=this.selectionEnd),a!==0},moveCursorLeft:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",a)},_move:function(a,o,c){var f;if(a.altKey)f=this["findWordBoundary"+c](this[o]);else if(a.metaKey||a.keyCode===35||a.keyCode===36)f=this["findLineBoundary"+c](this[o]);else return this[o]+=c==="Left"?-1:1,!0;if(typeof f<"u"&&this[o]!==f)return this[o]=f,!0},_moveLeft:function(a,o){return this._move(a,o,"Left")},_moveRight:function(a,o){return this._move(a,o,"Right")},moveCursorLeftWithoutShift:function(a){var o=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(o=this._moveLeft(a,"selectionStart")),this.selectionEnd=this.selectionStart,o},moveCursorLeftWithShift:function(a){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(a,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(a,"selectionStart")},moveCursorRight:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",a)},_moveCursorLeftOrRight:function(a,o){var c="moveCursor"+a+"With";this._currentCursorOpacity=1,o.shiftKey?c+="Shift":c+="outShift",this[c](o)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(a){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(a,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(a,"selectionEnd")},moveCursorRightWithoutShift:function(a){var o=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(o=this._moveRight(a,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,o},removeChars:function(a,o){typeof o>"u"&&(o=a+1),this.removeStyleFromTo(a,o),this._text.splice(a,o-a),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(a,o,c,f){typeof f>"u"&&(f=c),f>c&&this.removeStyleFromTo(c,f);var u=e.util.string.graphemeSplit(a);this.insertNewStyleBlock(u,c,o),this._text=[].concat(this._text.slice(0,c),u,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var a=e.util.toFixed,o=/  +/g;e.util.object.extend(e.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(f)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var f=!0,u=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",u?'text-decoration="'+u+'" ':"",'style="',this.getSvgStyles(f),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,f){var u=[],d=[],h=c,m;this._setSVGBg(d);for(var p=0,g=this._textLines.length;p<g;p++)m=this._getLineLeftOffset(p),(this.textBackgroundColor||this.styleHas("textBackgroundColor",p))&&this._setSVGTextLineBg(d,p,f+m,h),this._setSVGTextLineText(u,p,f+m,h),h+=this.getHeightOfLine(p);return{textSpans:u,textBgRects:d}},_createTextCharSpan:function(c,f,u,d){var h=c!==c.trim()||c.match(o),m=this.getSvgSpanStyles(f,h),p=m?'style="'+m+'"':"",g=f.deltaY,v="",b=e.Object.NUM_FRACTION_DIGITS;return g&&(v=' dy="'+a(g,b)+'" '),['<tspan x="',a(u,b),'" y="',a(d,b),'" ',v,p,">",e.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,f,u,d){var h=this.getHeightOfLine(f),m=this.textAlign.indexOf("justify")!==-1,p,g,v="",b,y,_=0,S=this._textLines[f],C;d+=h*(1-this._fontSizeFraction)/this.lineHeight;for(var k=0,w=S.length-1;k<=w;k++)C=k===w||this.charSpacing,v+=S[k],b=this.__charBounds[f][k],_===0?(u+=b.kernedWidth-b.width,_+=b.width):_+=b.kernedWidth,m&&!C&&this._reSpaceAndTab.test(S[k])&&(C=!0),C||(p=p||this.getCompleteStyleDeclaration(f,k),g=this.getCompleteStyleDeclaration(f,k+1),C=e.util.hasStyleChanged(p,g,!0)),C&&(y=this._getStyleDeclaration(f,k)||{},c.push(this._createTextCharSpan(v,y,u,d)),v="",p=g,u+=_,_=0)},_pushTextBgRect:function(c,f,u,d,h,m){var p=e.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(f),' x="',a(u,p),'" y="',a(d,p),'" width="',a(h,p),'" height="',a(m,p),`"></rect>
`)},_setSVGTextLineBg:function(c,f,u,d){for(var h=this._textLines[f],m=this.getHeightOfLine(f)/this.lineHeight,p=0,g=0,v,b,y=this.getValueOfPropertyAt(f,0,"textBackgroundColor"),_=0,S=h.length;_<S;_++)v=this.__charBounds[f][_],b=this.getValueOfPropertyAt(f,_,"textBackgroundColor"),b!==y?(y&&this._pushTextBgRect(c,y,u+g,d,p,m),g=v.left,p=v.width,y=b):p+=v.kernedWidth;b&&this._pushTextBgRect(c,b,u+g,d,p,m)},_getFillAttributes:function(c){var f=c&&typeof c=="string"?new e.Color(c):"";return!f||!f.getSource()||f.getAlpha()===1?'fill="'+c+'"':'opacity="'+f.getAlpha()+'" fill="'+f.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var f=0,u=0,d=0;d<c;d++)f+=this.getHeightOfLine(d);return u=this.getHeightOfLine(d),{lineTop:f,offset:(this._fontSizeMult-this._fontSizeFraction)*u/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var f=e.Object.prototype.getSvgStyles.call(this,c);return f+" white-space: pre;"}})}(),function(a){var o=a.fabric||(a.fabric={});o.Textbox=o.util.createClass(o.IText,o.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:o.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var f=0,u=0,d=0,h={},m=0;m<c.graphemeLines.length;m++)c.graphemeText[d]===`
`&&m>0?(u=0,d++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[d])&&m>0&&(u++,d++),h[m]={line:f,offset:u},d+=c.graphemeLines[m].length,u+=c.graphemeLines[m].length;return h},styleHas:function(c,f){if(this._styleMap&&!this.isWrapping){var u=this._styleMap[f];u&&(f=u.line)}return o.Text.prototype.styleHas.call(this,c,f)},isEmptyStyles:function(c){if(!this.styles)return!0;var f=0,u=c+1,d,h,m=!1,p=this._styleMap[c],g=this._styleMap[c+1];p&&(c=p.line,f=p.offset),g&&(u=g.line,m=u===c,d=g.offset),h=typeof c>"u"?this.styles:{line:this.styles[c]};for(var v in h)for(var b in h[v])if(b>=f&&(!m||b<d))for(var y in h[v][b])return!1;return!0},_getStyleDeclaration:function(c,f){if(this._styleMap&&!this.isWrapping){var u=this._styleMap[c];if(!u)return null;c=u.line,f=u.offset+f}return this.callSuper("_getStyleDeclaration",c,f)},_setStyleDeclaration:function(c,f,u){var d=this._styleMap[c];c=d.line,f=d.offset+f,this.styles[c][f]=u},_deleteStyleDeclaration:function(c,f){var u=this._styleMap[c];c=u.line,f=u.offset+f,delete this.styles[c][f]},_getLineStyle:function(c){var f=this._styleMap[c];return!!this.styles[f.line]},_setLineStyle:function(c){var f=this._styleMap[c];this.styles[f.line]={}},_wrapText:function(c,f){var u=[],d;for(this.isWrapping=!0,d=0;d<c.length;d++)u=u.concat(this._wrapLine(c[d],d,f));return this.isWrapping=!1,u},_measureWord:function(c,f,u){var d=0,h,m=!0;u=u||0;for(var p=0,g=c.length;p<g;p++){var v=this._getGraphemeBox(c[p],f,p+u,h,m);d+=v.kernedWidth,h=c[p]}return d},_wrapLine:function(c,f,u,I){var h=0,m=this.splitByGrapheme,p=[],g=[],v=m?o.util.string.graphemeSplit(c):c.split(this._wordJoiners),b="",y=0,_=m?"":" ",S=0,C=0,k=0,w=!0,A=this._getWidthOfCharSpacing(),I=I||0;v.length===0&&v.push([]),u-=I;for(var z=0;z<v.length;z++)b=m?v[z]:o.util.string.graphemeSplit(v[z]),S=this._measureWord(b,f,y),y+=b.length,h+=C+S-A,h>u&&!w?(p.push(g),g=[],h=S,w=!0):h+=A,!w&&!m&&g.push(_),g=g.concat(b),C=m?0:this._measureWord([_],f,y),y++,w=!1,S>k&&(k=S);return z&&p.push(g),k+I>this.dynamicMinWidth&&(this.dynamicMinWidth=k-A+I),p},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var f=o.Text.prototype._splitTextIntoLines.call(this,c),u=this._wrapText(f.lines,this.width),d=new Array(u.length),h=0;h<u.length;h++)d[h]=u[h].join("");return f.lines=d,f.graphemeLines=u,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var f in this._styleMap)this._textLines[f]&&(c[this._styleMap[f].line]=1);for(var f in this.styles)c[f]||delete this.styles[f]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),o.Textbox.fromObject=function(c,f){var u=o.util.stylesFromArray(c.styles,c.text),d=Object.assign({},c,{styles:u});return o.Object._fromObject("Textbox",d,f,"text")}}(i),function(){var a=e.controlsUtils,o=a.scaleSkewCursorStyleHandler,c=a.scaleCursorStyleHandler,f=a.scalingEqually,u=a.scalingYOrSkewingX,d=a.scalingXOrSkewingY,h=a.scaleOrSkewActionName,m=e.Object.prototype.controls;if(m.ml=new e.Control({x:-.5,y:0,cursorStyleHandler:o,actionHandler:d,getActionName:h}),m.mr=new e.Control({x:.5,y:0,cursorStyleHandler:o,actionHandler:d,getActionName:h}),m.mb=new e.Control({x:0,y:.5,cursorStyleHandler:o,actionHandler:u,getActionName:h}),m.mt=new e.Control({x:0,y:-.5,cursorStyleHandler:o,actionHandler:u,getActionName:h}),m.tl=new e.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),m.tr=new e.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),m.bl=new e.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:f}),m.br=new e.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:f}),m.mtr=new e.Control({x:0,y:-.5,actionHandler:a.rotationWithSnapping,cursorStyleHandler:a.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),e.Textbox){var p=e.Textbox.prototype.controls={};p.mtr=m.mtr,p.tr=m.tr,p.br=m.br,p.tl=m.tl,p.bl=m.bl,p.mt=m.mt,p.mb=m.mb,p.mr=new e.Control({x:.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:o,actionName:"resizing"}),p.ml=new e.Control({x:-.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:o,actionName:"resizing"})}}(),function(){e.Object.ENLIVEN_PROPS.push("eraser");var a=e.Object.prototype._drawClipPath,o=e.Object.prototype.needsItsOwnCache,c=e.Object.prototype.toObject,f=e.Object.prototype.getSvgCommons,u=e.Object.prototype._createBaseClipPathSVGMarkup,d=e.Object.prototype._createBaseSVGMarkup;e.Object.prototype.cacheProperties.push("eraser"),e.Object.prototype.stateProperties.push("eraser"),e.util.object.extend(e.Object.prototype,{erasable:!0,eraser:void 0,needsItsOwnCache:function(){return o.call(this)||!!this.eraser},_drawClipPath:function(p,g){if(a.call(this,p,g),this.eraser){var v=this._getNonTransformedDimensions();this.eraser.isType("eraser")&&this.eraser.set({width:v.x,height:v.y}),a.call(this,p,this.eraser)}},toObject:function(p){var g=c.call(this,["erasable"].concat(p));return this.eraser&&!this.eraser.excludeFromExport&&(g.eraser=this.eraser.toObject(p)),g},getSvgCommons:function(){return f.call(this)+(this.eraser?'mask="url(#'+this.eraser.clipPathId+')" ':"")},_createEraserSVGMarkup:function(p){return this.eraser?(this.eraser.clipPathId="MASK_"+e.Object.__uid++,['<mask id="',this.eraser.clipPathId,'" >',this.eraser.toSVG(p),"</mask>",`
`].join("")):""},_createBaseClipPathSVGMarkup:function(p,g){return[this._createEraserSVGMarkup(g&&g.reviver),u.call(this,p,g)].join("")},_createBaseSVGMarkup:function(p,g){return[this._createEraserSVGMarkup(g&&g.reviver),d.call(this,p,g)].join("")}});var h=e.Group.prototype._restoreObjectsState;e.util.object.extend(e.Group.prototype,{_addEraserPathToObjects:function(p){this._objects.forEach(function(g){e.EraserBrush.prototype._addPathToObjectEraser.call(e.EraserBrush.prototype,g,p)})},applyEraserToObjects:function(){var p=this,g=this.eraser;if(g){delete this.eraser;var v=p.calcTransformMatrix();g.clone(function(b){var y=p.clipPath;b.getObjects("path").forEach(function(_){var S=e.util.multiplyTransformMatrices(v,_.calcTransformMatrix());e.util.applyTransformToObject(_,S),y?y.clone(function(C){var k=e.EraserBrush.prototype.applyClipPathToPath.call(e.EraserBrush.prototype,_,C,v);p._addEraserPathToObjects(k)},["absolutePositioned","inverted"]):p._addEraserPathToObjects(_)})})}},_restoreObjectsState:function(){return this.erasable===!0&&this.applyEraserToObjects(),h.call(this)}}),e.Eraser=e.util.createClass(e.Group,{type:"eraser",originX:"center",originY:"center",drawObject:function(p){p.save(),p.fillStyle="black",p.fillRect(-this.width/2,-this.height/2,this.width,this.height),p.restore(),this.callSuper("drawObject",p)},_getBounds:function(){},_toSVG:function(p){var g=["<g ","COMMON_PARTS",` >
`],v=-this.width/2,b=-this.height/2,y=["<rect ",'fill="white" ','x="',v,'" y="',b,'" width="',this.width,'" height="',this.height,`" />
`].join("");g.push("		",y);for(var _=0,S=this._objects.length;_<S;_++)g.push("		",this._objects[_].toSVG(p));return g.push(`</g>
`),g}}),e.Eraser.fromObject=function(p,g){var v=p.objects;e.util.enlivenObjects(v,function(b){var y=e.util.object.clone(p,!0);delete y.objects,e.util.enlivenObjectEnlivables(p,y,function(){g&&g(new e.Eraser(b,y,!0))})})};var m=e.Canvas.prototype._renderOverlay;e.util.object.extend(e.Canvas.prototype,{isErasing:function(){return this.isDrawingMode&&this.freeDrawingBrush&&this.freeDrawingBrush.type==="eraser"&&this.freeDrawingBrush._isErasing},_renderOverlay:function(p){m.call(this,p),this.isErasing()&&!this.freeDrawingBrush.inverted&&this.freeDrawingBrush._render()}}),e.EraserBrush=e.util.createClass(e.PencilBrush,{type:"eraser",inverted:!1,_isErasing:!1,_isErasable:function(p){return p.erasable!==!1},_prepareCollectionTraversal:function(p,g,v){p.forEachObject(function(b){b.forEachObject&&b.erasable==="deep"?this._prepareCollectionTraversal(b,g,v):!this.inverted&&b.erasable&&b.visible?(b.visible=!1,p.dirty=!0,v.visibility.push(b),v.collection.push(p)):this.inverted&&b.visible&&(b.erasable&&b.eraser?(b.eraser.inverted=!0,b.dirty=!0,p.dirty=!0,v.eraser.push(b),v.collection.push(p)):(b.visible=!1,p.dirty=!0,v.visibility.push(b),v.collection.push(p)))},this)},preparePattern:function(){this._patternCanvas||(this._patternCanvas=e.util.createCanvasElement());var p=this._patternCanvas;p.width=this.canvas.width,p.height=this.canvas.height;var g=p.getContext("2d");if(this.canvas._isRetinaScaling()){var v=this.canvas.getRetinaScaling();this.canvas.__initRetinaScaling(v,p,g)}var b=this.canvas.backgroundImage,y=b&&this._isErasable(b),_=this.canvas.overlayImage,S=_&&this._isErasable(_);if(!this.inverted&&(b&&!y||this.canvas.backgroundColor))y&&(this.canvas.backgroundImage=void 0),this.canvas._renderBackground(g),y&&(this.canvas.backgroundImage=b);else if(this.inverted&&b&&y){var C=this.canvas.backgroundColor;this.canvas.backgroundColor=void 0,this.canvas._renderBackground(g),this.canvas.backgroundColor=C}g.save(),g.transform.apply(g,this.canvas.viewportTransform);var k={visibility:[],eraser:[],collection:[]};if(this._prepareCollectionTraversal(this.canvas,g,k),this.canvas._renderObjects(g,this.canvas._objects),k.visibility.forEach(function(w){w.visible=!0}),k.eraser.forEach(function(w){w.eraser.inverted=!1,w.dirty=!0}),k.collection.forEach(function(w){w.dirty=!0}),g.restore(),!this.inverted&&(_&&!S||this.canvas.overlayColor))S&&(this.canvas.overlayImage=void 0),m.call(this.canvas,g),S&&(this.canvas.overlayImage=_);else if(this.inverted&&_&&S){var C=this.canvas.overlayColor;this.canvas.overlayColor=void 0,m.call(this.canvas,g),this.canvas.overlayColor=C}},_setBrushStyles:function(p){this.callSuper("_setBrushStyles",p),p.strokeStyle="black"},_saveAndTransform:function(p){this.callSuper("_saveAndTransform",p),this._setBrushStyles(p),p.globalCompositeOperation=p===this.canvas.getContext()?"destination-out":"source-over"},needsFullRender:function(){return!0},onMouseDown:function(p,g){this.canvas._isMainEvent(g.e)&&(this._prepareForDrawing(p),this._captureDrawingPath(p),this.preparePattern(),this._isErasing=!0,this.canvas.fire("erasing:start"),this._render())},_render:function(){var p;this.inverted||(p=this.canvas.getContext(),this.callSuper("_render",p)),p=this.canvas.contextTop,this.canvas.clearContext(p),this.callSuper("_render",p),p.save();var g=this.canvas.getRetinaScaling(),v=1/g;p.scale(v,v),p.globalCompositeOperation="source-in",p.drawImage(this._patternCanvas,0,0),p.restore()},createPath:function(p){var g=this.callSuper("createPath",p);return g.globalCompositeOperation=this.inverted?"source-over":"destination-out",g.stroke=this.inverted?"white":"black",g},applyClipPathToPath:function(p,g,v){var b=e.util.invertTransform(p.calcTransformMatrix()),y=g.calcTransformMatrix(),_=g.absolutePositioned?b:e.util.multiplyTransformMatrices(b,v);return g.absolutePositioned=!1,e.util.applyTransformToObject(g,e.util.multiplyTransformMatrices(_,y)),p.clipPath=p.clipPath?e.util.mergeClipPaths(g,p.clipPath):g,p},clonePathWithClipPath:function(p,g,v){var b=g.calcTransformMatrix(),y=g.clipPath,_=this;p.clone(function(S){y.clone(function(C){v(_.applyClipPathToPath(S,C,b))},["absolutePositioned","inverted"])})},_addPathToObjectEraser:function(p,g){var v=this;if(p.forEachObject&&p.erasable==="deep"){var b=p._objects.filter(function(_){return _.erasable});b.length>0&&p.clipPath?this.clonePathWithClipPath(g,p,function(_){b.forEach(function(S){v._addPathToObjectEraser(S,_)})}):b.length>0&&b.forEach(function(_){v._addPathToObjectEraser(_,g)});return}var y=p.eraser;y||(y=new e.Eraser,p.eraser=y),g.clone(function(_){var S=e.util.multiplyTransformMatrices(e.util.invertTransform(p.calcTransformMatrix()),_.calcTransformMatrix());e.util.applyTransformToObject(_,S),y.addWithUpdate(_),p.set("dirty",!0),p.fire("erasing:end",{path:_}),p.group&&Array.isArray(v.__subTargets)&&v.__subTargets.push(p)})},applyEraserToCanvas:function(p){var g=this.canvas,v={};return["backgroundImage","overlayImage"].forEach(function(b){var y=g[b];y&&y.erasable&&(this._addPathToObjectEraser(y,p),v[b]=y)},this),v},_finalizeAndAddPath:function(){var p=this.canvas.contextTop,g=this.canvas;p.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate)),g.clearContext(g.contextTop),this._isErasing=!1;var v=this._points&&this._points.length>1?this.convertPointsToSVGPath(this._points):null;if(!v||this._isEmptySVGPath(v)){g.fire("erasing:end"),g.requestRenderAll();return}var b=this.createPath(v);b.setCoords(),g.fire("before:path:created",{path:b});var y=this.applyEraserToCanvas(b),_=this;this.__subTargets=[];var S=[];g.forEachObject(function(C){C.erasable&&C.intersectsWithObject(b,!0,!0)&&(_._addPathToObjectEraser(C,b),S.push(C))}),g.fire("erasing:end",{path:b,targets:S,subTargets:this.__subTargets,drawables:y}),delete this.__subTargets,g.requestRenderAll(),this._resetShadow(),g.fire("path:created",{path:b})}})}()})(Wi);const nC=(i,e=1e3)=>{let t;return(...n)=>{clearTimeout(t),t=setTimeout(()=>{i(...n)},e)}},Zn=Nt(2),hr=Nt("#000000"),mn=Nt("select"),Rr=Nt(!1),um=Nt(null),Mr=Nt(null),fm=Nt(null),hm=Nt(null);class rC{constructor(e){Qe(this,"isDrawing",Nt(!1));Qe(this,"subscribeToStrokeWidth",null);Qe(this,"subscribeToStrokeColor",null);Qe(this,"clearBoard",()=>{this.canvas.clear(),this.resetEvents(),this.saveBoard()});Qe(this,"resetZoom",()=>{this.resetEvents(),this.canvas.setZoom(1)});Qe(this,"defineModifiedListener",()=>{this.canvas.on("object:modified",()=>{this.saveBoard()})});Qe(this,"resetEvents",()=>{mn.set("select"),this.canvas.defaultCursor="default",this.canvas.off(),this.canvas.isDrawingMode=!1,document.querySelectorAll(".fabric-toolbar-button.btn-neutral").forEach(e=>{e.classList.remove("btn-neutral"),e.classList.add("btn-ghost")}),this.subscribeToStrokeWidth&&this.subscribeToStrokeWidth(),this.subscribeToStrokeColor&&this.subscribeToStrokeColor(),this.setZoom(),this.defineModifiedListener()});Qe(this,"setZoom",()=>{this.canvas.on("mouse:wheel",e=>{var t=e.e.deltaY,n=this.canvas.getZoom();n*=.999**t,n>1&&(n=1),n<.01&&(n=.01),this.canvas.setZoom(n),e.e.preventDefault(),e.e.stopPropagation()})});Qe(this,"activateEraser",()=>{this.resetEvents(),setTimeout(()=>{mn.set("eraser"),this.canvas.freeDrawingBrush=new Wi.fabric.EraserBrush(this.canvas),this.canvas.isDrawingMode=!0,this.subscribeToStrokeWidth=Zn.subscribe(e=>{this.canvas.freeDrawingBrush.width=e*3})},100),this.canvas.on("mouse:up",()=>{this.saveBoard()})});Qe(this,"drawline",e=>{this.resetEvents(),setTimeout(()=>{mn.set("line"),this.canvas.defaultCursor="crosshair";let t;this.canvas.on("mouse:down",n=>{this.isDrawing.set(!0);let r=this.canvas.getPointer(n.e),s=[r.x,r.y,r.x,r.y];t=new Wi.fabric.Line(s,{strokeWidth:Ht(Zn),stroke:Ht(hr)}),this.canvas.add(t),this.canvas.renderAll()}),this.canvas.on("mouse:move",n=>{if(!Ht(this.isDrawing))return;let r=this.canvas.getPointer(n.e);t.set({x2:r.x,y2:r.y}),this.canvas.renderAll()}),this.canvas.on("mouse:up",()=>{this.isDrawing.set(!1),this.saveBoard()})},100)});Qe(this,"drawRect",e=>{this.resetEvents(),setTimeout(()=>{mn.set("rect"),this.canvas.defaultCursor="crosshair";let t;this.canvas.on("mouse:down",n=>{this.isDrawing.set(!0);let r=this.canvas.getPointer(n.e),s={x:r.x,y:r.y},l={x:r.x,y:r.y};t=new Wi.fabric.Rect({left:s.x,top:s.y,width:l.x-s.x,height:l.y-s.y,strokeWidth:Ht(Zn),stroke:Ht(hr),fill:"transparent"}),this.canvas.add(t),this.canvas.renderAll()}),this.canvas.on("mouse:move",n=>{if(!Ht(this.isDrawing))return;let r=this.canvas.getPointer(n.e);t&&t.left&&t.top&&(t.set({width:r.x-t.left,height:r.y-t.top}),this.canvas.renderAll())}),this.canvas.on("mouse:up",()=>{this.isDrawing.set(!1),this.saveBoard()})},100)});Qe(this,"drawCircle",e=>{this.resetEvents(),setTimeout(()=>{mn.set("circle"),this.canvas.defaultCursor="crosshair";let t;this.canvas.on("mouse:down",n=>{this.isDrawing.set(!0);let r=this.canvas.getPointer(n.e),s={x:r.x,y:r.y},l={x:r.x,y:r.y},a=Math.abs((l.x-s.x)/2);t=new Wi.fabric.Circle({left:s.x-a,top:s.y-a,radius:a,strokeWidth:Ht(Zn),stroke:Ht(hr),fill:"transparent"}),this.canvas.add(t),this.canvas.renderAll()}),this.canvas.on("mouse:move",n=>{if(!Ht(this.isDrawing))return;let r=this.canvas.getPointer(n.e);if(t&&t.left){let s=Math.abs((r.x-t.left)/2);t.set({radius:s}),this.canvas.renderAll()}}),this.canvas.on("mouse:up",()=>{this.isDrawing.set(!1),this.saveBoard()})},100)});Qe(this,"drawFreeform",e=>{this.resetEvents(),setTimeout(()=>{mn.set("freeform"),this.canvas.freeDrawingBrush=new Wi.fabric.PencilBrush(this.canvas),this.canvas.isDrawingMode=!0,this.subscribeToStrokeWidth=Zn.subscribe(t=>{this.canvas.freeDrawingBrush.width=t}),this.subscribeToStrokeColor=hr.subscribe(t=>{this.canvas.freeDrawingBrush.color=t}),this.canvas.on("mouse:down",()=>{this.isDrawing.set(!0)}),this.canvas.on("mouse:up",()=>{this.isDrawing.set(!1),this.saveBoard()})},100)});Qe(this,"addText",(e="Edit me")=>{this.resetEvents(),setTimeout(()=>{mn.set("select");const t=new Wi.fabric.IText(e,{left:50,top:50,fontSize:Ht(Zn)*10,fill:Ht(hr)});this.canvas.add(t),this.saveBoard()},100)});Qe(this,"pasteItem",(e=null)=>{this.resetEvents(),setTimeout(async()=>{},100)});Qe(this,"startTakingScreenshot",async()=>{this.resetEvents(),setTimeout(async()=>{const e=await navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"window",width:{ideal:1920,max:1920},height:{ideal:1080,max:1080}}}),t=e.getVideoTracks()[0];new ImageCapture(t).grabFrame().then(function(r){const s=document.getElementById("capturedStill");s.width=window.innerWidth,s.height=window.innerHeight,s.getContext("2d").drawImage(r,0,0,window.innerWidth,window.innerHeight)}),setTimeout(()=>{e.getTracks().forEach(r=>r.stop())},1e3),Rr.set(!0)},100)});Qe(this,"saveBoard",nC(()=>{Mr.set(this.canvas.toJSON()),fm.set(Date.now())}));Qe(this,"setFixed",e=>{this.canvas.getObjects().forEach(t=>{t.lockMovementX=e,t.lockMovementY=e})});Qe(this,"enterDragMode",()=>{this.resetEvents(),setTimeout(()=>{mn.set("move");let e=!1,t,n;this.canvas.discardActiveObject(),this.canvas.defaultCursor="move",this.canvas.on("mouse:up",r=>{e=!1}),this.canvas.on("mouse:down",r=>{e=!0,t=r.e.clientX,n=r.e.clientY}),this.canvas.on("mouse:move",r=>{if(!e)return;let s=0,l=0;t&&(s=r.e.clientX-t),n&&(l=r.e.clientY-n),t=r.e.clientX,n=r.e.clientY;let a=new Wi.fabric.Point(s,l);this.canvas.relativePan(a)})},100)});Qe(this,"finishTakingScreenshot",e=>{Wi.fabric.Image.fromURL(e,t=>{t.set({left:100,top:100}),this.canvas.add(t),this.canvas.renderAll(),this.saveBoard()})});this.canvas=e,this.isDrawing.subscribe(t=>{this.setFixed(t)}),document.onkeydown=t=>{t.key==="Delete"&&this.canvas.getActiveObjects().forEach(n=>{this.canvas.remove(n),this.saveBoard()})},document.addEventListener("paste",t=>{const n=t.clipboardData;if(n){const r=n.items;let s=null;r.length>0&&(s=r[0].kind),this.pasteItem(s)}}),Ht(Mr)&&this.canvas.loadFromJSON(Ht(Mr),async()=>{}),hm.subscribe(()=>{this.canvas.loadFromJSON(Ht(Mr),async()=>{})}),this.setZoom(),this.defineModifiedListener()}}const sC=new TextEncoder,oC=new TextDecoder,aC=Nt(Yr.h720),us=Nt([]),fs=Nt([]),dm=Nt(null);class cC{constructor(e,t){Qe(this,"room");Qe(this,"wsURL","wss://instrukti-nf5brd5y.livekit.cloud");Qe(this,"token");Qe(this,"localViewContainer");Qe(this,"joinRoom",async()=>{await this.room.connect(this.wsURL,this.token),await this.muteMic(),await this.turnVideoOff();const e=Array.from(this.room.participants.values()).filter(t=>t.sid!=this.room.localParticipant.sid);us.set(e),dm.subscribe(t=>{t&&this.sendMessage(t.message)})});Qe(this,"subscribeToEvents",async()=>{await this.room.on("participantConnected",this.participantConnected),await this.room.on("participantDisconnected",this.participantDisconnected),await this.room.on("trackSubscribed",this.trackSubscription),await this.room.on("trackUnsubscribed",this.trackUnsubscription),await this.room.on("dataReceived",this.handleDataRecieved)});Qe(this,"leaveRoom",async()=>{await this.room.disconnect()});Qe(this,"muteMic",async()=>{this.room&&await this.room.localParticipant.setMicrophoneEnabled(!1)});Qe(this,"unMuteMic",async()=>{this.room&&await this.room.localParticipant.setMicrophoneEnabled(!0,{noiseSuppression:!0,echoCancellation:!0})});Qe(this,"turnVideoOff",async()=>{this.room&&await this.room.localParticipant.setCameraEnabled(!1)});Qe(this,"turnVideoOn",async()=>{this.room&&await this.room.localParticipant.setCameraEnabled(!0,{resolution:Ht(aC)}),this.setLocalView()});Qe(this,"shareScreen",async()=>{await this.room.localParticipant.setScreenShareEnabled(!0)});Qe(this,"stopSharing",async()=>{await this.room.localParticipant.setScreenShareEnabled(!1)});Qe(this,"trackSubscription",async(e,t,n)=>{console.log(e.kind),setTimeout(()=>{const r=e.attach();r.id=e.kind+"_"+n.sid,e.kind==="video"&&(r.classList.add("object-cover"),r.classList.add("rounded-full"),r.classList.add("!w-20"),r.classList.add("!h-20"),r.classList.add("md:!w-32"),r.classList.add("md:!h-32"));const s=document.getElementById(n.sid);s&&s.appendChild(r)},500)});Qe(this,"trackUnsubscription",async(e,t,n)=>{});Qe(this,"participantConnected",async e=>{const t=Array.from(this.room.participants.values()).filter(n=>n.sid!=this.room.localParticipant.sid);us.set(t)});Qe(this,"participantDisconnected",async e=>{let t=Ht(us);t=t.filter(n=>n.sid!=e.sid),us.set(t)});Qe(this,"handleDataRecieved",async(e,t,n,r)=>{const s=oC.decode(e),{type:l,data:a}=JSON.parse(s);if(l==="board")Mr.set(a),setTimeout(()=>{hm.set(Date.now())},100);else if(l==="chat"){const o=Ht(fs);fs.set([...o,{sender:a.sender,message:a.message}])}});Qe(this,"setLocalView",async()=>{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0});this.localViewContainer.srcObject=e});Qe(this,"publishData",async e=>{const t=sC.encode(e);await this.room.localParticipant.publishData(t,Yt.LOSSY)});Qe(this,"sendMessage",async e=>{const t=Ht(fs);fs.set([...t,{sender:"me",message:e}]);const r={type:"chat",data:{sender:this.room.localParticipant.identity,message:e}};this.publishData(JSON.stringify(r))});this.localViewContainer=e,this.setLocalView(),this.room=new cm,this.token=t}}const lC=async(i,e)=>{const t=await fetch(`http://localhost:8090/api/getJoinToken?room=${e}&name=${i}`,{method:"GET"}),{token:n}=await t.json();return n},uo=Nt(null);function sf(i,e,t){const n=i.slice();return n[1]=e[t],n}function uC(i){let e,t,n,r,s;return t=new js({props:{class:"w-2/3",$$slots:{default:[dC]},$$scope:{ctx:i}}}),r=new xh({props:{class:"text-right !m-0 text-gray-600",$$slots:{default:[mC]},$$scope:{ctx:i}}}),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),V(r.$$.fragment),te(e,"class","flex justify-end my-2")},m(l,a){$(l,e,a),U(t,e,null),$(l,n,a),U(r,l,a),s=!0},p(l,a){const o={};a&129&&(o.$$scope={dirty:a,ctx:l}),t.$set(o);const c={};a&129&&(c.$$scope={dirty:a,ctx:l}),r.$set(c)},i(l){s||(T(t.$$.fragment,l),T(r.$$.fragment,l),s=!0)},o(l){E(t.$$.fragment,l),E(r.$$.fragment,l),s=!1},d(l){l&&(K(e),K(n)),j(t),j(r,l)}}}function fC(i){let e,t,n,r,s;return t=new js({props:{bgColor:"primary",class:"w-2/3",$$slots:{default:[pC]},$$scope:{ctx:i}}}),r=new xh({props:{class:"!m-0 text-gray-600",$$slots:{default:[vC]},$$scope:{ctx:i}}}),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),V(r.$$.fragment),te(e,"class","flex justify-start my-2")},m(l,a){$(l,e,a),U(t,e,null),$(l,n,a),U(r,l,a),s=!0},p(l,a){const o={};a&129&&(o.$$scope={dirty:a,ctx:l}),t.$set(o);const c={};a&129&&(c.$$scope={dirty:a,ctx:l}),r.$set(c)},i(l){s||(T(t.$$.fragment,l),T(r.$$.fragment,l),s=!0)},o(l){E(t.$$.fragment,l),E(r.$$.fragment,l),s=!1},d(l){l&&(K(e),K(n)),j(t),j(r,l)}}}function hC(i){let e=i[1].message+"",t;return{c(){t=et(e)},m(n,r){$(n,t,r)},p(n,r){r&1&&e!==(e=n[1].message+"")&&ui(t,e)},d(n){n&&K(t)}}}function dC(i){let e,t;return e=new Vs({props:{$$slots:{default:[hC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&129&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function mC(i){let e=i[1].sender+"",t;return{c(){t=et(e)},m(n,r){$(n,t,r)},p(n,r){r&1&&e!==(e=n[1].sender+"")&&ui(t,e)},d(n){n&&K(t)}}}function gC(i){let e=i[1].message+"",t;return{c(){t=et(e)},m(n,r){$(n,t,r)},p(n,r){r&1&&e!==(e=n[1].message+"")&&ui(t,e)},d(n){n&&K(t)}}}function pC(i){let e,t;return e=new Vs({props:{$$slots:{default:[gC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&129&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function vC(i){let e=i[1].sender+"",t;return{c(){t=et(e)},m(n,r){$(n,t,r)},p(n,r){r&1&&e!==(e=n[1].sender+"")&&ui(t,e)},d(n){n&&K(t)}}}function of(i){let e,t,n,r;const s=[fC,uC],l=[];function a(o,c){return o[1].sender!=="me"?0:1}return e=a(i),t=l[e]=s[e](i),{c(){t.c(),n=Rt()},m(o,c){l[e].m(o,c),$(o,n,c),r=!0},p(o,c){let f=e;e=a(o),e===f?l[e].p(o,c):(Je(),E(l[f],1,1,()=>{l[f]=null}),qe(),t=l[e],t?t.p(o,c):(t=l[e]=s[e](o),t.c()),T(t,1),t.m(n.parentNode,n))},i(o){r||(T(t),r=!0)},o(o){E(t),r=!1},d(o){o&&K(n),l[e].d(o)}}}function bC(i){let e,t;return e=new yt({props:{name:"send"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function yC(i){let e,t,n,r,s,l,a,o,c,f,u,d,h=zr(i[0].reverse()),m=[];for(let b=0;b<h.length;b+=1)m[b]=of(sf(i,h,b));const p=b=>E(m[b],1,1,()=>{m[b]=null});function g(b){i[4](b)}let v={borderRounded:!0,size:"lg",placeholder:"Message..."};return i[1]!==void 0&&(v.value=i[1]),s=new gc({props:v}),Fe.push(()=>nt(s,"value",g)),c=new rt({props:{color:"primary",size:"md",$$slots:{default:[bC]},$$scope:{ctx:i}}}),c.$on("click",i[2]),{c(){e=ve("div");for(let b=0;b<m.length;b+=1)m[b].c();t=ue(),n=ve("form"),r=ve("div"),V(s.$$.fragment),a=ue(),o=ve("div"),V(c.$$.fragment),te(e,"class","flex-grow flex flex-col-reverse overflow-y-auto mb-4"),te(r,"class","flex-grow"),te(n,"class","flex items-center justify-between space-x-2")},m(b,y){$(b,e,y);for(let _=0;_<m.length;_+=1)m[_]&&m[_].m(e,null);$(b,t,y),$(b,n,y),ae(n,r),U(s,r,null),ae(n,a),ae(n,o),U(c,o,null),f=!0,u||(d=Ge(n,"submit",ki(i[3])),u=!0)},p(b,[y]){if(y&1){h=zr(b[0].reverse());let C;for(C=0;C<h.length;C+=1){const k=sf(b,h,C);m[C]?(m[C].p(k,y),T(m[C],1)):(m[C]=of(k),m[C].c(),T(m[C],1),m[C].m(e,null))}for(Je(),C=h.length;C<m.length;C+=1)p(C);qe()}const _={};!l&&y&2&&(l=!0,_.value=b[1],lt(()=>l=!1)),s.$set(_);const S={};y&128&&(S.$$scope={dirty:y,ctx:b}),c.$set(S)},i(b){if(!f){for(let y=0;y<h.length;y+=1)T(m[y]);T(s.$$.fragment,b),T(c.$$.fragment,b),f=!0}},o(b){m=m.filter(Boolean);for(let y=0;y<m.length;y+=1)E(m[y]);E(s.$$.fragment,b),E(c.$$.fragment,b),f=!1},d(b){b&&(K(e),K(t),K(n)),Wc(m,b),j(s),j(c),u=!1,d()}}}function _C(i,e,t){let n;Ct(i,fs,o=>t(0,n=o));let r;const s=()=>{r&&(dm.set({time:Date.now(),message:r}),t(1,r=""))};function l(o){Xc.call(this,i,o)}function a(o){r=o,t(1,r)}return[n,r,s,l,a]}class mm extends Ye{constructor(e){super(),He(this,e,_C,yC,Ve,{})}}function CC(i){let e;return{c(){e=et("Chat")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function SC(i){let e,t;return e=new yt({props:{name:"x"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function kC(i){let e,t,n,r,s,l,a,o;return t=new Ke({props:{textColor:"primary",fontWeight:"bolder",fontSize:"1",$$slots:{default:[CC]},$$scope:{ctx:i}}}),s=new rt({props:{$$slots:{default:[SC]},$$scope:{ctx:i}}}),s.$on("click",i[0]),a=new Pt({props:{text:"Close"}}),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),r=ve("div"),V(s.$$.fragment),l=ue(),V(a.$$.fragment),te(e,"class","flex justify-between items-center")},m(c,f){$(c,e,f),U(t,e,null),ae(e,n),ae(e,r),U(s,r,null),ae(r,l),U(a,r,null),o=!0},p(c,f){const u={};f&4&&(u.$$scope={dirty:f,ctx:c}),t.$set(u);const d={};f&4&&(d.$$scope={dirty:f,ctx:c}),s.$set(d)},i(c){o||(T(t.$$.fragment,c),T(s.$$.fragment,c),T(a.$$.fragment,c),o=!0)},o(c){E(t.$$.fragment,c),E(s.$$.fragment,c),E(a.$$.fragment,c),o=!1},d(c){c&&K(e),j(t),j(s),j(a)}}}function TC(i){let e,t;return e=new No({props:{class:"w-full",$$slots:{default:[kC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function wC(i){let e,t;return e=new mm({}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function PC(i){let e,t,n,r;return e=new Lo({props:{$$slots:{default:[TC]},$$scope:{ctx:i}}}),n=new Vs({props:{class:"h-5/6 bg-gray-200 flex flex-col rounded-b-2xl",$$slots:{default:[wC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&4&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&4&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function EC(i){let e,t;return e=new js({props:{class:"m-4 h-full flex-grow !rounded-2xl",$$slots:{default:[PC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,[r]){const s={};r&4&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function OC(i){const e=Gr();return[()=>{e("hideChat")}]}class xC extends Ye{constructor(e){super(),He(this,e,OC,EC,Ve,{})}}function AC(i){let e,t;return e=new yt({props:{name:"clock-hour-4"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function DC(i){let e;return{c(){e=et("This modal is placed in the center of the screen.")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function RC(i){let e;return{c(){e=et("Start")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function MC(i){let e;return{c(){e=et("Cancel")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function IC(i){let e,t,n,r;return e=new rt({props:{color:"green",$$slots:{default:[RC]},$$scope:{ctx:i}}}),e.$on("click",i[2]),n=new rt({props:{color:"red",$$slots:{default:[MC]},$$scope:{ctx:i}}}),n.$on("click",i[3]),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&32&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&32&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function LC(i){let e,t,n,r;return e=new Bb({props:{$$slots:{default:[DC]},$$scope:{ctx:i}}}),n=new Wb({props:{$$slots:{default:[IC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&32&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&33&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function NC(i){let e,t,n,r,s,l,a;e=new rt({props:{color:"primary",class:"!rounded-full",$$slots:{default:[AC]},$$scope:{ctx:i}}}),e.$on("click",i[1]),n=new Pt({props:{text:"Start Timer"}});function o(f){i[4](f)}let c={title:"Set Timer",placement:"center",$$slots:{default:[LC]},$$scope:{ctx:i}};return i[0]!==void 0&&(c.show=i[0]),s=new Mb({props:c}),Fe.push(()=>nt(s,"show",o)),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment),r=ue(),V(s.$$.fragment)},m(f,u){U(e,f,u),$(f,t,u),U(n,f,u),$(f,r,u),U(s,f,u),a=!0},p(f,[u]){const d={};u&32&&(d.$$scope={dirty:u,ctx:f}),e.$set(d);const h={};u&33&&(h.$$scope={dirty:u,ctx:f}),!l&&u&1&&(l=!0,h.show=f[0],lt(()=>l=!1)),s.$set(h)},i(f){a||(T(e.$$.fragment,f),T(n.$$.fragment,f),T(s.$$.fragment,f),a=!0)},o(f){E(e.$$.fragment,f),E(n.$$.fragment,f),E(s.$$.fragment,f),a=!1},d(f){f&&(K(t),K(r)),j(e,f),j(n,f),j(s,f)}}}function FC(i,e,t){let n=!1;const r=()=>t(0,n=!0),s=()=>t(0,n=!1),l=()=>t(0,n=!1);function a(o){n=o,t(0,n)}return[n,r,s,l,a]}class BC extends Ye{constructor(e){super(),He(this,e,FC,NC,Ve,{})}}function UC(i){let e,t;return e=new yt({props:{name:"mood-smile"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function jC(i){let e;return{c(){e=et("")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function VC(i){let e;return{c(){e=et("")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function zC(i){let e;return{c(){e=et("")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function WC(i){let e;return{c(){e=et("")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function XC(i){let e,t,n,r,s,l,a,o,c;return t=new rt({props:{size:"lg",class:"text-4xl xl:text-5xl",$$slots:{default:[jC]},$$scope:{ctx:i}}}),r=new rt({props:{size:"lg",class:"text-4xl xl:text-5xl",$$slots:{default:[VC]},$$scope:{ctx:i}}}),l=new rt({props:{size:"lg",class:"text-4xl xl:text-5xl",$$slots:{default:[zC]},$$scope:{ctx:i}}}),o=new rt({props:{size:"lg",class:"text-4xl xl:text-5xl",$$slots:{default:[WC]},$$scope:{ctx:i}}}),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),V(r.$$.fragment),s=ue(),V(l.$$.fragment),a=ue(),V(o.$$.fragment),te(e,"class","flex flex-col space-y-4")},m(f,u){$(f,e,u),U(t,e,null),ae(e,n),U(r,e,null),ae(e,s),U(l,e,null),ae(e,a),U(o,e,null),c=!0},p(f,u){const d={};u&1&&(d.$$scope={dirty:u,ctx:f}),t.$set(d);const h={};u&1&&(h.$$scope={dirty:u,ctx:f}),r.$set(h);const m={};u&1&&(m.$$scope={dirty:u,ctx:f}),l.$set(m);const p={};u&1&&(p.$$scope={dirty:u,ctx:f}),o.$set(p)},i(f){c||(T(t.$$.fragment,f),T(r.$$.fragment,f),T(l.$$.fragment,f),T(o.$$.fragment,f),c=!0)},o(f){E(t.$$.fragment,f),E(r.$$.fragment,f),E(l.$$.fragment,f),E(o.$$.fragment,f),c=!1},d(f){f&&K(e),j(t),j(r),j(l),j(o)}}}function HC(i){let e,t;return e=new Fh({props:{$$slots:{default:[XC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function YC(i){let e,t,n,r;return e=new rt({props:{color:"warning",class:"!rounded-full",$$slots:{default:[UC]},$$scope:{ctx:i}}}),n=new Nh({props:{trigger:"hover",placement:"top",$$slots:{default:[HC]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,[l]){const a={};l&1&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&1&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}class GC extends Ye{constructor(e){super(),He(this,e,null,YC,Ve,{})}}const un=Nt(!1),Hn=Nt(!1),Is=Nt(!1),cn=Nt(!1),JC=()=>{Hn.set(!0),Is.set(!0),un.set(!0)},qC=()=>{un.set(!1),Is.set(!1),Hn.set(!1)},KC=()=>{cn.set(!0),un.set(!0)},QC=()=>{cn.set(!1),un.set(!1)};function ZC(i){const e=i-1;return e*e*e+1}function Vt(i,{delay:e=0,duration:t=400,easing:n=ZC,axis:r="y"}={}){const s=getComputedStyle(i),l=+s.opacity,a=r==="y"?"height":"width",o=parseFloat(s[a]),c=r==="y"?["top","bottom"]:["left","right"],f=c.map(v=>`${v[0].toUpperCase()}${v.slice(1)}`),u=parseFloat(s[`padding${f[0]}`]),d=parseFloat(s[`padding${f[1]}`]),h=parseFloat(s[`margin${f[0]}`]),m=parseFloat(s[`margin${f[1]}`]),p=parseFloat(s[`border${f[0]}Width`]),g=parseFloat(s[`border${f[1]}Width`]);return{delay:e,duration:t,easing:n,css:v=>`overflow: hidden;opacity: ${Math.min(v*20,1)*l};${a}: ${v*o}px;padding-${c[0]}: ${v*u}px;padding-${c[1]}: ${v*d}px;margin-${c[0]}: ${v*h}px;margin-${c[1]}: ${v*m}px;border-${c[0]}-width: ${v*p}px;border-${c[1]}-width: ${v*g}px;`}}function af(i,e,t){const n=i.slice();return n[29]=e[t],n[31]=t,n}function $C(i){let e;return{c(){e=et("Call")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function eS(i){let e,t;return e=new yt({props:{name:"message-circle-2"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function tS(i){let e,t;return e=new yt({props:{name:"paperclip"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function cf(i){let e,t,n,r;return e=new rt({props:{$$slots:{default:[iS]},$$scope:{ctx:i}}}),e.$on("click",i[16]),n=new Pt({props:{text:"Show Chat"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[1]&2&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function iS(i){let e,t;return e=new yt({props:{name:"message-circle-2"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function lf(i){let e,t,n,r;return e=new rt({props:{$$slots:{default:[nS]},$$scope:{ctx:i}}}),e.$on("click",i[17]),n=new Pt({props:{text:"Show Whiteboard"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[1]&2&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function nS(i){let e,t;return e=new yt({props:{name:"presentation"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function rS(i){let e,t,n,r;return e=new rt({props:{class:"hidden xl:block",$$slots:{default:[oS]},$$scope:{ctx:i}}}),e.$on("click",i[14]),n=new Pt({props:{text:"Minimize"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[1]&2&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function sS(i){let e,t,n,r;return e=new rt({props:{class:"hidden xl:block",$$slots:{default:[aS]},$$scope:{ctx:i}}}),e.$on("click",i[13]),n=new Pt({props:{text:"Maximize"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[1]&2&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function oS(i){let e,t;return e=new yt({props:{name:"arrows-minimize"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function aS(i){let e,t;return e=new yt({props:{name:"maximize"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function cS(i){let e,t,n,r,s,l,a,o,c,f,u,d,h,m,p,g,v,b;t=new Ke({props:{textColor:"primary",fontWeight:"bolder",fontSize:"1",$$slots:{default:[$C]},$$scope:{ctx:i}}}),s=new rt({props:{$$slots:{default:[eS]},$$scope:{ctx:i}}}),s.$on("click",i[15]),a=new Pt({props:{text:"Show Chat"}}),c=new rt({props:{$$slots:{default:[tS]},$$scope:{ctx:i}}}),u=new Pt({props:{text:"Show Files"}});let y=i[7]&&cf(i),_=i[10]&&lf(i);const S=[sS,rS],C=[];function k(w,A){return w[8]?1:0}return g=k(i),v=C[g]=S[g](i),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),r=ve("div"),V(s.$$.fragment),l=ue(),V(a.$$.fragment),o=ue(),V(c.$$.fragment),f=ue(),V(u.$$.fragment),d=ue(),h=ve("div"),y&&y.c(),m=ue(),_&&_.c(),p=ue(),v.c(),te(r,"class","block space-x-2 xl:hidden"),te(h,"class","hidden space-x-2 xl:block"),te(e,"class","flex justify-between items-center")},m(w,A){$(w,e,A),U(t,e,null),ae(e,n),ae(e,r),U(s,r,null),ae(r,l),U(a,r,null),ae(r,o),U(c,r,null),ae(r,f),U(u,r,null),ae(e,d),ae(e,h),y&&y.m(h,null),ae(h,m),_&&_.m(h,null),ae(h,p),C[g].m(h,null),b=!0},p(w,A){const I={};A[1]&2&&(I.$$scope={dirty:A,ctx:w}),t.$set(I);const z={};A[1]&2&&(z.$$scope={dirty:A,ctx:w}),s.$set(z);const H={};A[1]&2&&(H.$$scope={dirty:A,ctx:w}),c.$set(H),w[7]?y?(y.p(w,A),A[0]&128&&T(y,1)):(y=cf(w),y.c(),T(y,1),y.m(h,m)):y&&(Je(),E(y,1,1,()=>{y=null}),qe()),w[10]?_?(_.p(w,A),A[0]&1024&&T(_,1)):(_=lf(w),_.c(),T(_,1),_.m(h,p)):_&&(Je(),E(_,1,1,()=>{_=null}),qe());let Q=g;g=k(w),g===Q?C[g].p(w,A):(Je(),E(C[Q],1,1,()=>{C[Q]=null}),qe(),v=C[g],v?v.p(w,A):(v=C[g]=S[g](w),v.c()),T(v,1),v.m(h,null))},i(w){b||(T(t.$$.fragment,w),T(s.$$.fragment,w),T(a.$$.fragment,w),T(c.$$.fragment,w),T(u.$$.fragment,w),T(y),T(_),T(v),b=!0)},o(w){E(t.$$.fragment,w),E(s.$$.fragment,w),E(a.$$.fragment,w),E(c.$$.fragment,w),E(u.$$.fragment,w),E(y),E(_),E(v),b=!1},d(w){w&&K(e),j(t),j(s),j(a),j(c),j(u),y&&y.d(),_&&_.d(),C[g].d()}}}function lS(i){let e,t;return e=new No({props:{class:"w-full",$$slots:{default:[cS]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&1921|r[1]&2&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function uf(i){let e,t,n;return t=new yt({props:{name:"user",color:"tabler",size:"9x"}}),{c(){e=ve("div"),V(t.$$.fragment),te(e,"class","w-full h-full absolute z-10 bg-slate-200 grid place-items-center")},m(r,s){$(r,e,s),U(t,e,null),n=!0},i(r){n||(T(t.$$.fragment,r),n=!0)},o(r){E(t.$$.fragment,r),n=!1},d(r){r&&K(e),j(t)}}}function uS(i){let e,t,n;return e=new Yv({props:{color:"danger",animated:gm}}),{c(){V(e.$$.fragment),t=et("00:20")},m(r,s){U(e,r,s),$(r,t,s),n=!0},p:Oe,i(r){n||(T(e.$$.fragment,r),n=!0)},o(r){E(e.$$.fragment,r),n=!1},d(r){r&&K(t),j(e,r)}}}function ff(i){let e,t,n,r,s,l,a,o,c,f,u,d,h,m,p,g,v,b,y,_,S,C,k,w,A,I,z,H,Q,ee,Z,he,_e,we,O,N,L,D;return t=new rt({props:{color:i[1]?"primary":"red",class:"!rounded-full",$$slots:{default:[fS]},$$scope:{ctx:i}}}),t.$on("click",i[19]),r=new Pt({props:{text:"Mic "+(i[1]?"On":"Off")}}),o=new rt({props:{color:i[2]?"primary":"red",class:"!rounded-full",$$slots:{default:[hS]},$$scope:{ctx:i}}}),o.$on("click",i[20]),f=new Pt({props:{text:"Camera "+(i[2]?"On":"Off")}}),m=new rt({props:{color:i[3]?"red":"primary",class:"!rounded-full",$$slots:{default:[dS]},$$scope:{ctx:i}}}),m.$on("click",i[21]),g=new Pt({props:{text:i[3]?"Stop Sharing":"Share Screen"}}),_=new rt({props:{color:i[4]?"red":"primary",class:"!rounded-full",$$slots:{default:[mS]},$$scope:{ctx:i}}}),_.$on("click",i[22]),C=new Pt({props:{text:(i[4]?"Lower":"Raise")+" Hand"}}),I=new BC({}),ee=new GC({}),we=new rt({props:{color:"red",class:"!rounded-full",$$slots:{default:[gS]},$$scope:{ctx:i}}}),N=new Pt({props:{text:"End Call"}}),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),V(r.$$.fragment),l=ue(),a=ve("div"),V(o.$$.fragment),c=ue(),V(f.$$.fragment),d=ue(),h=ve("div"),V(m.$$.fragment),p=ue(),V(g.$$.fragment),b=ue(),y=ve("div"),V(_.$$.fragment),S=ue(),V(C.$$.fragment),w=ue(),A=ve("div"),V(I.$$.fragment),H=ue(),Q=ve("div"),V(ee.$$.fragment),he=ue(),_e=ve("div"),V(we.$$.fragment),O=ue(),V(N.$$.fragment)},m(B,P){$(B,e,P),U(t,e,null),ae(e,n),U(r,e,null),$(B,l,P),$(B,a,P),U(o,a,null),ae(a,c),U(f,a,null),$(B,d,P),$(B,h,P),U(m,h,null),ae(h,p),U(g,h,null),$(B,b,P),$(B,y,P),U(_,y,null),ae(y,S),U(C,y,null),$(B,w,P),$(B,A,P),U(I,A,null),$(B,H,P),$(B,Q,P),U(ee,Q,null),$(B,he,P),$(B,_e,P),U(we,_e,null),ae(_e,O),U(N,_e,null),D=!0},p(B,P){const x={};P[0]&2&&(x.color=B[1]?"primary":"red"),P[0]&2|P[1]&2&&(x.$$scope={dirty:P,ctx:B}),t.$set(x);const W={};P[0]&2&&(W.text="Mic "+(B[1]?"On":"Off")),r.$set(W);const Y={};P[0]&4&&(Y.color=B[2]?"primary":"red"),P[0]&4|P[1]&2&&(Y.$$scope={dirty:P,ctx:B}),o.$set(Y);const ce={};P[0]&4&&(ce.text="Camera "+(B[2]?"On":"Off")),f.$set(ce);const ne={};P[0]&8&&(ne.color=B[3]?"red":"primary"),P[0]&8|P[1]&2&&(ne.$$scope={dirty:P,ctx:B}),m.$set(ne);const me={};P[0]&8&&(me.text=B[3]?"Stop Sharing":"Share Screen"),g.$set(me);const pe={};P[0]&16&&(pe.color=B[4]?"red":"primary"),P[0]&16|P[1]&2&&(pe.$$scope={dirty:P,ctx:B}),_.$set(pe);const q={};P[0]&16&&(q.text=(B[4]?"Lower":"Raise")+" Hand"),C.$set(q);const se={};P[1]&2&&(se.$$scope={dirty:P,ctx:B}),we.$set(se)},i(B){D||(T(t.$$.fragment,B),T(r.$$.fragment,B),B&&ri(()=>{D&&(s||(s=jt(e,Vt,{axis:"y",delay:120},!0)),s.run(1))}),T(o.$$.fragment,B),T(f.$$.fragment,B),B&&ri(()=>{D&&(u||(u=jt(a,Vt,{axis:"y",delay:100},!0)),u.run(1))}),T(m.$$.fragment,B),T(g.$$.fragment,B),B&&ri(()=>{D&&(v||(v=jt(h,Vt,{axis:"y",delay:80},!0)),v.run(1))}),T(_.$$.fragment,B),T(C.$$.fragment,B),B&&ri(()=>{D&&(k||(k=jt(y,Vt,{axis:"y",delay:60},!0)),k.run(1))}),T(I.$$.fragment,B),B&&ri(()=>{D&&(z||(z=jt(A,Vt,{axis:"y",delay:40},!0)),z.run(1))}),T(ee.$$.fragment,B),B&&ri(()=>{D&&(Z||(Z=jt(Q,Vt,{axis:"y",delay:20},!0)),Z.run(1))}),T(we.$$.fragment,B),T(N.$$.fragment,B),B&&ri(()=>{D&&(L||(L=jt(_e,Vt,{axis:"y"},!0)),L.run(1))}),D=!0)},o(B){E(t.$$.fragment,B),E(r.$$.fragment,B),B&&(s||(s=jt(e,Vt,{axis:"y",delay:120},!1)),s.run(0)),E(o.$$.fragment,B),E(f.$$.fragment,B),B&&(u||(u=jt(a,Vt,{axis:"y",delay:100},!1)),u.run(0)),E(m.$$.fragment,B),E(g.$$.fragment,B),B&&(v||(v=jt(h,Vt,{axis:"y",delay:80},!1)),v.run(0)),E(_.$$.fragment,B),E(C.$$.fragment,B),B&&(k||(k=jt(y,Vt,{axis:"y",delay:60},!1)),k.run(0)),E(I.$$.fragment,B),B&&(z||(z=jt(A,Vt,{axis:"y",delay:40},!1)),z.run(0)),E(ee.$$.fragment,B),B&&(Z||(Z=jt(Q,Vt,{axis:"y",delay:20},!1)),Z.run(0)),E(we.$$.fragment,B),E(N.$$.fragment,B),B&&(L||(L=jt(_e,Vt,{axis:"y"},!1)),L.run(0)),D=!1},d(B){B&&(K(e),K(l),K(a),K(d),K(h),K(b),K(y),K(w),K(A),K(H),K(Q),K(he),K(_e)),j(t),j(r),B&&s&&s.end(),j(o),j(f),B&&u&&u.end(),j(m),j(g),B&&v&&v.end(),j(_),j(C),B&&k&&k.end(),j(I),B&&z&&z.end(),j(ee),B&&Z&&Z.end(),j(we),j(N),B&&L&&L.end()}}}function fS(i){let e,t;return e=new yt({props:{name:i[1]?"microphone":"microphone-off"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&2&&(s.name=n[1]?"microphone":"microphone-off"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function hS(i){let e,t;return e=new yt({props:{name:i[2]?"video":"video-off"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&4&&(s.name=n[2]?"video":"video-off"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function dS(i){let e,t;return e=new yt({props:{name:i[3]?"screen-share-off":"screen-share"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&8&&(s.name=n[3]?"screen-share-off":"screen-share"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function mS(i){let e,t;return e=new yt({props:{name:i[4]?"hand-off":"hand-stop"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&16&&(s.name=n[4]?"hand-off":"hand-stop"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function gS(i){let e,t;return e=new yt({props:{name:"phone-off"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function pS(i){let e,t;return e=new yt({props:{name:i[5]?"menu-2":"x"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r[0]&32&&(s.name=n[5]?"menu-2":"x"),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function hf(i){let e,t,n;return t=new hv({props:{id:i[29].sid,shape:"circle",color:"azure",class:"!w-20 !h-20 md:!w-32 md:!h-32 !text-3xl"}}),{c(){e=ve("div"),V(t.$$.fragment)},m(r,s){$(r,e,s),U(t,e,null),n=!0},p(r,s){const l={};s[0]&2048&&(l.id=r[29].sid),t.$set(l)},i(r){n||(T(t.$$.fragment,r),n=!0)},o(r){E(t.$$.fragment,r),n=!1},d(r){r&&K(e),j(t)}}}function vS(i){let e,t,n,r,s,l,a,o,c,f,u,d,h,m,p,g,v,b,y,_=!i[2]&&uf();f=new Py({props:{color:"danger",$$slots:{default:[uS]},$$scope:{ctx:i}}});let S=gm,C=!i[5]&&ff(i);g=new rt({props:{color:"purple",class:"!rounded-full",$$slots:{default:[pS]},$$scope:{ctx:i}}}),g.$on("click",i[23]);let k=zr(i[11]),w=[];for(let I=0;I<k.length;I+=1)w[I]=hf(af(i,k,I));const A=I=>E(w[I],1,1,()=>{w[I]=null});return{c(){e=ve("div"),t=ve("video"),r=ue(),_&&_.c(),s=ue(),l=ve("div"),a=ve("div"),o=ve("div"),c=ve("div"),V(f.$$.fragment),u=ue(),d=ue(),h=ve("div"),C&&C.c(),m=ue(),p=ve("div"),V(g.$$.fragment),v=ue(),b=ve("div");for(let I=0;I<w.length;I+=1)w[I].c();te(t,"class",n=dl(i[8]?"object-scale-down":"object-cover")+" svelte-1ssm3a8"),t.autoplay=!0,t.muted=!0,te(e,"class","h-full w-full fill absolute rounded-b-2xl svelte-1ssm3a8"),te(h,"class","flex-grow mt-3 flex flex-col space-y-4 justify-end"),te(o,"class","flex flex-col flex-grow"),te(b,"class","flex flex-col justify-between"),te(a,"class","flex-grow flex"),te(l,"class","absolute z-20 h-full w-full flex flex-col p-4")},m(I,z){$(I,e,z),ae(e,t),i[18](t),ae(e,r),_&&_.m(e,null),$(I,s,z),$(I,l,z),ae(l,a),ae(a,o),ae(o,c),U(f,c,null),ae(c,u),ae(o,d),ae(o,h),C&&C.m(h,null),ae(h,m),ae(h,p),U(g,p,null),ae(a,v),ae(a,b);for(let H=0;H<w.length;H+=1)w[H]&&w[H].m(b,null);y=!0},p(I,z){(!y||z[0]&256&&n!==(n=dl(I[8]?"object-scale-down":"object-cover")+" svelte-1ssm3a8"))&&te(t,"class",n),I[2]?_&&(Je(),E(_,1,1,()=>{_=null}),qe()):_?z[0]&4&&T(_,1):(_=uf(),_.c(),T(_,1),_.m(e,null));const H={};z[1]&2&&(H.$$scope={dirty:z,ctx:I}),f.$set(H),I[5]?C&&(Je(),E(C,1,1,()=>{C=null}),qe()):C?(C.p(I,z),z[0]&32&&T(C,1)):(C=ff(I),C.c(),T(C,1),C.m(h,m));const Q={};if(z[0]&32|z[1]&2&&(Q.$$scope={dirty:z,ctx:I}),g.$set(Q),z[0]&2048){k=zr(I[11]);let ee;for(ee=0;ee<k.length;ee+=1){const Z=af(I,k,ee);w[ee]?(w[ee].p(Z,z),T(w[ee],1)):(w[ee]=hf(Z),w[ee].c(),T(w[ee],1),w[ee].m(b,null))}for(Je(),ee=k.length;ee<w.length;ee+=1)A(ee);qe()}},i(I){if(!y){T(_),T(f.$$.fragment,I),T(S),T(C),T(g.$$.fragment,I);for(let z=0;z<k.length;z+=1)T(w[z]);y=!0}},o(I){E(_),E(f.$$.fragment,I),E(S),E(C),E(g.$$.fragment,I),w=w.filter(Boolean);for(let z=0;z<w.length;z+=1)E(w[z]);y=!1},d(I){I&&(K(e),K(s),K(l)),i[18](null),_&&_.d(),j(f),C&&C.d(),j(g),Wc(w,I)}}}function bS(i){let e,t,n,r;return e=new Lo({props:{$$slots:{default:[lS]},$$scope:{ctx:i}}}),n=new Vs({props:{class:"h-5/6 bg-gray-200 !p-0 relative rounded-b-2xl",$$slots:{default:[vS]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[0]&1921|l[1]&2&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l[0]&2430|l[1]&2&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function yS(i){let e,t;return e=new mm({}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function _S(i){let e,t,n,r;return e=new cy({props:{title:"Offcanvas Title"}}),n=new ey({props:{class:"h-[100dvh] flex flex-col p-4",$$slots:{default:[yS]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l[1]&2&&(a.$$scope={dirty:l,ctx:s}),n.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function CS(i){let e,t,n,r,s;e=new js({props:{class:"m-4 h-full flex-grow !rounded-2xl",$$slots:{default:[bS]},$$scope:{ctx:i}}});function l(o){i[24](o)}let a={autoClose:!0,backdrop:!0,$$slots:{default:[_S]},$$scope:{ctx:i}};return i[0]!==void 0&&(a.show=i[0]),n=new qb({props:a}),Fe.push(()=>nt(n,"show",l)),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(o,c){U(e,o,c),$(o,t,c),U(n,o,c),s=!0},p(o,c){const f={};c[0]&4095|c[1]&2&&(f.$$scope={dirty:c,ctx:o}),e.$set(f);const u={};c[1]&2&&(u.$$scope={dirty:c,ctx:o}),!r&&c[0]&1&&(r=!0,u.show=o[0],lt(()=>r=!1)),n.$set(u)},i(o){s||(T(e.$$.fragment,o),T(n.$$.fragment,o),s=!0)},o(o){E(e.$$.fragment,o),E(n.$$.fragment,o),s=!1},d(o){o&&K(t),j(e,o),j(n,o)}}}let gm=!1;function SS(i,e,t){let n,r,s,l,a,o,c;Ct(i,Mr,he=>t(26,n=he)),Ct(i,uo,he=>t(27,r=he)),Ct(i,un,he=>t(7,s=he)),Ct(i,Hn,he=>t(8,l=he)),Ct(i,cn,he=>t(9,a=he)),Ct(i,Is,he=>t(10,o=he)),Ct(i,us,he=>t(11,c=he));let f,u=!1,d=!1,h=!1,m=!1,p=!1,g=!1,v;const b=he=>{if(f)switch(he){case"mic":t(1,d=!d),d?f.unMuteMic():f.muteMic();break;case"video":t(2,h=!h),h?f.turnVideoOn():f.turnVideoOff();break;case"screen":t(3,m=!m),m?f.shareScreen():f.stopSharing();break;case"hand":t(4,p=!p);break}},y=Gr(),_=()=>y("maximize"),S=()=>y("minimize");Ui(()=>{r&&setTimeout(async()=>{f=new cC(v,r),await f.joinRoom(),await f.subscribeToEvents(),fm.subscribe(he=>{const _e={type:"board",data:n};f.publishData(JSON.stringify(_e))})},500)});const C=()=>t(0,u=!u),k=()=>{Jt(un,s=!1,s),Jt(Hn,l=!1,l),Jt(cn,a=!1,a)},w=()=>{Jt(Is,o=!1,o),Jt(Hn,l=!1,l),Jt(cn,a=!1,a),s&&Jt(cn,a=!0,a)};function A(he){Fe[he?"unshift":"push"](()=>{v=he,t(6,v)})}const I=()=>b("mic"),z=()=>b("video"),H=()=>b("screen"),Q=()=>b("hand"),ee=()=>t(5,g=!g);function Z(he){u=he,t(0,u)}return[u,d,h,m,p,g,v,s,l,a,o,c,b,_,S,C,k,w,A,I,z,H,Q,ee,Z]}class kS extends Ye{constructor(e){super(),He(this,e,SS,CS,Ve,{},null,[-1,-1])}}var TS={grad:.9,turn:360,rad:360/(2*Math.PI)},dn=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},Gt=function(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*i)/t+0},Ei=function(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),i>t?t:i>e?i:e},pm=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},df=function(i){return{r:Ei(i.r,0,255),g:Ei(i.g,0,255),b:Ei(i.b,0,255),a:Ei(i.a)}},Ka=function(i){return{r:Gt(i.r),g:Gt(i.g),b:Gt(i.b),a:Gt(i.a,3)}},wS=/^#([0-9a-f]{3,8})$/i,Gs=function(i){var e=i.toString(16);return e.length<2?"0"+e:e},vm=function(i){var e=i.r,t=i.g,n=i.b,r=i.a,s=Math.max(e,t,n),l=s-Math.min(e,t,n),a=l?s===e?(t-n)/l:s===t?2+(n-e)/l:4+(e-t)/l:0;return{h:60*(a<0?a+6:a),s:s?l/s*100:0,v:s/255*100,a:r}},bm=function(i){var e=i.h,t=i.s,n=i.v,r=i.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),l=n*(1-t),a=n*(1-(e-s)*t),o=n*(1-(1-e+s)*t),c=s%6;return{r:255*[n,a,l,l,o,n][c],g:255*[o,n,n,a,l,l][c],b:255*[l,l,o,n,n,a][c],a:r}},mf=function(i){return{h:pm(i.h),s:Ei(i.s,0,100),l:Ei(i.l,0,100),a:Ei(i.a)}},gf=function(i){return{h:Gt(i.h),s:Gt(i.s),l:Gt(i.l),a:Gt(i.a,3)}},pf=function(i){return bm((t=(e=i).s,{h:e.h,s:(t*=((n=e.l)<50?n:100-n)/100)>0?2*t/(n+t)*100:0,v:n+t,a:e.a}));var e,t,n},Cs=function(i){return{h:(e=vm(i)).h,s:(r=(200-(t=e.s))*(n=e.v)/100)>0&&r<200?t*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,t,n,r},PS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ES=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,OS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bc={string:[[function(i){var e=wS.exec(i);return e?(i=e[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Gt(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?Gt(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var e=OS.exec(i)||xS.exec(i);return e?e[2]!==e[4]||e[4]!==e[6]?null:df({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(i){var e=PS.exec(i)||ES.exec(i);if(!e)return null;var t,n,r=mf({h:(t=e[1],n=e[2],n===void 0&&(n="deg"),Number(t)*(TS[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return pf(r)},"hsl"]],object:[[function(i){var e=i.r,t=i.g,n=i.b,r=i.a,s=r===void 0?1:r;return dn(e)&&dn(t)&&dn(n)?df({r:Number(e),g:Number(t),b:Number(n),a:Number(s)}):null},"rgb"],[function(i){var e=i.h,t=i.s,n=i.l,r=i.a,s=r===void 0?1:r;if(!dn(e)||!dn(t)||!dn(n))return null;var l=mf({h:Number(e),s:Number(t),l:Number(n),a:Number(s)});return pf(l)},"hsl"],[function(i){var e=i.h,t=i.s,n=i.v,r=i.a,s=r===void 0?1:r;if(!dn(e)||!dn(t)||!dn(n))return null;var l=function(a){return{h:pm(a.h),s:Ei(a.s,0,100),v:Ei(a.v,0,100),a:Ei(a.a)}}({h:Number(e),s:Number(t),v:Number(n),a:Number(s)});return bm(l)},"hsv"]]},vf=function(i,e){for(var t=0;t<e.length;t++){var n=e[t][0](i);if(n)return[n,e[t][1]]}return[null,void 0]},AS=function(i){return typeof i=="string"?vf(i.trim(),Bc.string):typeof i=="object"&&i!==null?vf(i,Bc.object):[null,void 0]},Qa=function(i,e){var t=Cs(i);return{h:t.h,s:Ei(t.s+100*e,0,100),l:t.l,a:t.a}},Za=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},bf=function(i,e){var t=Cs(i);return{h:t.h,s:t.s,l:Ei(t.l+100*e,0,100),a:t.a}},Uc=function(){function i(e){this.parsed=AS(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return Gt(Za(this.rgba),2)},i.prototype.isDark=function(){return Za(this.rgba)<.5},i.prototype.isLight=function(){return Za(this.rgba)>=.5},i.prototype.toHex=function(){return e=Ka(this.rgba),t=e.r,n=e.g,r=e.b,l=(s=e.a)<1?Gs(Gt(255*s)):"","#"+Gs(t)+Gs(n)+Gs(r)+l;var e,t,n,r,s,l},i.prototype.toRgb=function(){return Ka(this.rgba)},i.prototype.toRgbString=function(){return e=Ka(this.rgba),t=e.r,n=e.g,r=e.b,(s=e.a)<1?"rgba("+t+", "+n+", "+r+", "+s+")":"rgb("+t+", "+n+", "+r+")";var e,t,n,r,s},i.prototype.toHsl=function(){return gf(Cs(this.rgba))},i.prototype.toHslString=function(){return e=gf(Cs(this.rgba)),t=e.h,n=e.s,r=e.l,(s=e.a)<1?"hsla("+t+", "+n+"%, "+r+"%, "+s+")":"hsl("+t+", "+n+"%, "+r+"%)";var e,t,n,r,s},i.prototype.toHsv=function(){return e=vm(this.rgba),{h:Gt(e.h),s:Gt(e.s),v:Gt(e.v),a:Gt(e.a,3)};var e},i.prototype.invert=function(){return ni({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},i.prototype.saturate=function(e){return e===void 0&&(e=.1),ni(Qa(this.rgba,e))},i.prototype.desaturate=function(e){return e===void 0&&(e=.1),ni(Qa(this.rgba,-e))},i.prototype.grayscale=function(){return ni(Qa(this.rgba,-1))},i.prototype.lighten=function(e){return e===void 0&&(e=.1),ni(bf(this.rgba,e))},i.prototype.darken=function(e){return e===void 0&&(e=.1),ni(bf(this.rgba,-e))},i.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},i.prototype.alpha=function(e){return typeof e=="number"?ni({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Gt(this.rgba.a,3);var t},i.prototype.hue=function(e){var t=Cs(this.rgba);return typeof e=="number"?ni({h:e,s:t.s,l:t.l,a:t.a}):Gt(t.h)},i.prototype.isEqual=function(e){return this.toHex()===ni(e).toHex()},i}(),ni=function(i){return i instanceof Uc?i:new Uc(i)},yf=[],DS=function(i){i.forEach(function(e){yf.indexOf(e)<0&&(e(Uc,Bc),yf.push(e))})},$a=function(i){var e=i/255;return e<.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},ec=function(i){return .2126*$a(i.r)+.7152*$a(i.g)+.0722*$a(i.b)};function RS(i){i.prototype.luminance=function(){return e=ec(this.rgba),(t=2)===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n+0;var e,t,n},i.prototype.contrast=function(e){e===void 0&&(e="#FFF");var t,n,r,s,l,a,o,c=e instanceof i?e:new i(e);return s=this.rgba,l=c.toRgb(),a=ec(s),o=ec(l),t=a>o?(a+.05)/(o+.05):(o+.05)/(a+.05),(n=2)===void 0&&(n=0),r===void 0&&(r=Math.pow(10,n)),Math.floor(r*t)/r+0},i.prototype.isReadable=function(e,t){return e===void 0&&(e="#FFF"),t===void 0&&(t={}),this.contrast(e)>=(a=(l=(n=t).size)===void 0?"normal":l,(s=(r=n.level)===void 0?"AA":r)==="AAA"&&a==="normal"?7:s==="AA"&&a==="large"?3:4.5);var n,r,s,l,a}}const vn=Nt({ArrowLeft:0,ArrowUp:0,ArrowRight:0,ArrowDown:0}),ul=og(vn,i=>({...i,ArrowV:i.ArrowUp+i.ArrowDown,ArrowH:i.ArrowLeft+i.ArrowRight,ArrowVH:i.ArrowUp+i.ArrowDown+i.ArrowLeft+i.ArrowRight}));function fl(i,e=.001,t=.01){const s=Math.min(1,Math.max(1,i-50)/50);return e+(t-e)/2*(1-Math.cos(Math.PI*s))}const{window:os}=zc;function MS(i){let e,t,n,r,s,l;var a=i[2].pickerIndicator;function o(c,f){return{props:{pos:c[9],isDark:c[5],hex:ni({h:c[3],s:c[0],v:c[1],a:1}).toHex()}}}return a&&(t=Dt(a,o(i))),{c(){var c,f;e=ve("div"),t&&V(t.$$.fragment),te(e,"class","picker svelte-uiwgvv"),te(e,"tabindex","0"),bi(e,"--color-bg",i[8]),te(e,"aria-label","saturation and brightness picker (arrow keyboard navigation)"),te(e,"aria-valuemin",0),te(e,"aria-valuemax",100),te(e,"aria-valuetext",n="saturation "+((c=i[9].x)==null?void 0:c.toFixed())+"%, brightness "+((f=i[9].y)==null?void 0:f.toFixed())+"%")},m(c,f){$(c,e,f),t&&U(t,e,null),i[18](e),r=!0,s||(l=[Ge(e,"mousedown",ki(i[10])),Ge(e,"touchstart",i[16]),Ge(e,"touchmove",ki(i[16])),Ge(e,"touchend",i[16])],s=!0)},p(c,f){var u,d;if(f&4&&a!==(a=c[2].pickerIndicator)){if(t){Je();const h=t;E(h.$$.fragment,1,0,()=>{j(h,1)}),qe()}a?(t=Dt(a,o(c)),V(t.$$.fragment),T(t.$$.fragment,1),U(t,e,null)):t=null}else if(a){const h={};f&512&&(h.pos=c[9]),f&32&&(h.isDark=c[5]),f&11&&(h.hex=ni({h:c[3],s:c[0],v:c[1],a:1}).toHex()),t.$set(h)}(!r||f&256)&&bi(e,"--color-bg",c[8]),(!r||f&512&&n!==(n="saturation "+((u=c[9].x)==null?void 0:u.toFixed())+"%, brightness "+((d=c[9].y)==null?void 0:d.toFixed())+"%"))&&te(e,"aria-valuetext",n)},i(c){r||(t&&T(t.$$.fragment,c),r=!0)},o(c){t&&E(t.$$.fragment,c),r=!1},d(c){c&&K(e),t&&j(t),i[18](null),s=!1,Lt(l)}}}function IS(i){let e,t,n,r,s;var l=i[2].pickerWrapper;function a(o,c){return{props:{focused:o[7],toRight:o[4],$$slots:{default:[MS]},$$scope:{ctx:o}}}}return l&&(e=Dt(l,a(i))),{c(){e&&V(e.$$.fragment),t=Rt()},m(o,c){e&&U(e,o,c),$(o,t,c),n=!0,r||(s=[Ge(os,"mouseup",i[11]),Ge(os,"mousedown",i[13]),Ge(os,"mousemove",i[12]),Ge(os,"keyup",i[14]),Ge(os,"keydown",i[15])],r=!0)},p(o,[c]){if(c&4&&l!==(l=o[2].pickerWrapper)){if(e){Je();const f=e;E(f.$$.fragment,1,0,()=>{j(f,1)}),qe()}l?(e=Dt(l,a(o)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(l){const f={};c&128&&(f.focused=o[7]),c&16&&(f.toRight=o[4]),c&67109743&&(f.$$scope={dirty:c,ctx:o}),e.$set(f)}},i(o){n||(e&&T(e.$$.fragment,o),n=!0)},o(o){e&&E(e.$$.fragment,o),n=!1},d(o){o&&K(t),e&&j(e,o),r=!1,Lt(s)}}}function _f(i,e,t){return Math.min(Math.max(e,i),t)}function LS(i,e,t){let n,r;Ct(i,vn,Q=>t(22,n=Q)),Ct(i,ul,Q=>t(23,r=Q));let{components:s}=e,{h:l}=e,{s:a}=e,{v:o}=e,{isOpen:c}=e,{toRight:f}=e,{isDark:u}=e,d,h=!1,m=!1,p,g,v,b={x:100,y:0};function y(Q){let ee={x:Q.offsetX,y:Q.offsetY},Z=d.getBoundingClientRect().width,he=d.getBoundingClientRect().height;t(0,a=_f(ee.x/Z,0,1)*100),t(1,o=_f((he-ee.y)/he,0,1)*100)}function _(Q){Q.button===0&&(h=!0,y(Q))}function S(){h=!1}function C(Q){h&&y({offsetX:Math.max(0,Math.min(d.getBoundingClientRect().width,Q.clientX-d.getBoundingClientRect().left)),offsetY:Math.max(0,Math.min(d.getBoundingClientRect().height,Q.clientY-d.getBoundingClientRect().top))})}function k(Q){Q.target.isSameNode(d)||t(7,m=!1)}function w(Q){var ee;Q.key==="Tab"&&t(7,m=!!((ee=document.activeElement)!=null&&ee.isSameNode(d))),!Q.repeat&&m&&I()}function A(Q){m&&r.ArrowVH&&(Q.preventDefault(),Q.repeat||I())}function I(){r.ArrowVH?p||(g=0,p=window.setInterval(()=>{let Q=fl(++g);t(0,a=Math.min(100,Math.max(0,a+(n.ArrowRight-n.ArrowLeft)*Q*100))),t(1,o=Math.min(100,Math.max(0,o+(n.ArrowUp-n.ArrowDown)*Q*100)))},10)):p&&(clearInterval(p),p=void 0)}function z(Q){Q.preventDefault(),y({offsetX:Q.changedTouches[0].clientX-d.getBoundingClientRect().left,offsetY:Q.changedTouches[0].clientY-d.getBoundingClientRect().top})}function H(Q){Fe[Q?"unshift":"push"](()=>{d=Q,t(6,d)})}return i.$$set=Q=>{"components"in Q&&t(2,s=Q.components),"h"in Q&&t(3,l=Q.h),"s"in Q&&t(0,a=Q.s),"v"in Q&&t(1,o=Q.v),"isOpen"in Q&&t(17,c=Q.isOpen),"toRight"in Q&&t(4,f=Q.toRight),"isDark"in Q&&t(5,u=Q.isDark)},i.$$.update=()=>{i.$$.dirty&8&&typeof l=="number"&&t(8,v=ni({h:l,s:100,v:100,a:1}).toHex()),i.$$.dirty&67&&typeof a=="number"&&typeof o=="number"&&d&&t(9,b={x:a,y:100-o})},[a,o,s,l,f,u,d,m,v,b,_,S,C,k,w,A,z,c,H]}class NS extends Ye{constructor(e){super(),He(this,e,LS,IS,Ve,{components:2,h:3,s:0,v:1,isOpen:17,toRight:4,isDark:5})}}const{window:Js}=zc;function FS(i){let e,t,n,r,s,l;var a=i[1].sliderIndicator;function o(c,f){return{props:{pos:c[4],toRight:c[2]}}}return a&&(t=Dt(a,o(i))),{c(){e=ve("div"),t&&V(t.$$.fragment),te(e,"class","slider svelte-14nweqy"),te(e,"tabindex","0"),te(e,"aria-label","hue picker (arrow keyboard navigation)"),te(e,"aria-valuemin",0),te(e,"aria-valuemax",360),te(e,"aria-valuenow",n=Math.round(i[0])),ei(e,"to-right",i[2])},m(c,f){$(c,e,f),t&&U(t,e,null),i[12](e),r=!0,s||(l=[Ge(e,"mousedown",ki(i[6])),Ge(e,"touchstart",i[11]),Ge(e,"touchmove",ki(i[11])),Ge(e,"touchend",i[11])],s=!0)},p(c,f){if(f&2&&a!==(a=c[1].sliderIndicator)){if(t){Je();const u=t;E(u.$$.fragment,1,0,()=>{j(u,1)}),qe()}a?(t=Dt(a,o(c)),V(t.$$.fragment),T(t.$$.fragment,1),U(t,e,null)):t=null}else if(a){const u={};f&16&&(u.pos=c[4]),f&4&&(u.toRight=c[2]),t.$set(u)}(!r||f&1&&n!==(n=Math.round(c[0])))&&te(e,"aria-valuenow",n),(!r||f&4)&&ei(e,"to-right",c[2])},i(c){r||(t&&T(t.$$.fragment,c),r=!0)},o(c){t&&E(t.$$.fragment,c),r=!1},d(c){c&&K(e),t&&j(t),i[12](null),s=!1,Lt(l)}}}function BS(i){let e,t,n,r,s;var l=i[1].sliderWrapper;function a(o,c){return{props:{focused:o[5],toRight:o[2],$$slots:{default:[FS]},$$scope:{ctx:o}}}}return l&&(e=Dt(l,a(i))),{c(){e&&V(e.$$.fragment),t=Rt()},m(o,c){e&&U(e,o,c),$(o,t,c),n=!0,r||(s=[Ge(Js,"mouseup",i[7]),Ge(Js,"mousemove",i[8]),Ge(Js,"keyup",i[9]),Ge(Js,"keydown",i[10])],r=!0)},p(o,[c]){if(c&2&&l!==(l=o[1].sliderWrapper)){if(e){Je();const f=e;E(f.$$.fragment,1,0,()=>{j(f,1)}),qe()}l?(e=Dt(l,a(o)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(l){const f={};c&32&&(f.focused=o[5]),c&4&&(f.toRight=o[2]),c&1048607&&(f.$$scope={dirty:c,ctx:o}),e.$set(f)}},i(o){n||(e&&T(e.$$.fragment,o),n=!0)},o(o){e&&E(e.$$.fragment,o),n=!1},d(o){o&&K(t),e&&j(e,o),r=!1,Lt(s)}}}function US(i,e,t){let n,r;Ct(i,vn,k=>t(16,n=k)),Ct(i,ul,k=>t(17,r=k));let{components:s}=e,{toRight:l}=e,a,o=!1,{h:c}=e,f=0,u=!1,d,h;function m(k){const w=l?a.getBoundingClientRect().width:a.getBoundingClientRect().height,A=Math.max(0,Math.min(w,k));t(0,c=A/w*360)}function p(k){k.button===0&&(o=!0,m(l?k.offsetX:k.offsetY))}function g(){o=!1}function v(k){o&&m(l?k.clientX-a.getBoundingClientRect().left:k.clientY-a.getBoundingClientRect().top)}function b(k){var w;k.key==="Tab"&&t(5,u=!!((w=document.activeElement)!=null&&w.isSameNode(a))),!k.repeat&&u&&_()}function y(k){u&&r.ArrowVH&&(k.preventDefault(),k.repeat||_())}function _(){r.ArrowVH?d||(h=0,d=window.setInterval(()=>{const k=fl(++h),w=l?n.ArrowRight-n.ArrowLeft:n.ArrowDown-n.ArrowUp;t(0,c=Math.min(360,Math.max(0,c+w*360*k)))},10)):d&&(clearInterval(d),d=void 0)}function S(k){k.preventDefault(),m(l?k.changedTouches[0].clientX-a.getBoundingClientRect().left:k.changedTouches[0].clientY-a.getBoundingClientRect().top)}function C(k){Fe[k?"unshift":"push"](()=>{a=k,t(3,a)})}return i.$$set=k=>{"components"in k&&t(1,s=k.components),"toRight"in k&&t(2,l=k.toRight),"h"in k&&t(0,c=k.h)},i.$$.update=()=>{i.$$.dirty&9&&typeof c=="number"&&a&&t(4,f=100*c/360)},[c,s,l,a,f,u,p,g,v,b,y,S,C]}class jS extends Ye{constructor(e){super(),He(this,e,US,BS,Ve,{components:1,toRight:2,h:0})}}const{window:qs}=zc;function VS(i){let e,t,n,r,s,l,a;var o=i[0].alphaIndicator;function c(f,u){return{props:{pos:f[5],toRight:f[2]}}}return o&&(t=Dt(o,c(i))),{c(){var f,u;e=ve("div"),t&&V(t.$$.fragment),te(e,"class","alpha svelte-f2vq53"),te(e,"tabindex","0"),bi(e,"--alpha-color",(f=i[1])==null?void 0:f.substring(0,7)),te(e,"aria-label","transparency picker (arrow keyboard navigation)"),te(e,"aria-valuemin",0),te(e,"aria-valuemax",100),te(e,"aria-valuenow",n=Math.round(i[5])),te(e,"aria-valuetext",r=((u=i[5])==null?void 0:u.toFixed())+"%"),ei(e,"to-right",i[2])},m(f,u){$(f,e,u),t&&U(t,e,null),i[14](e),s=!0,l||(a=[Ge(e,"mousedown",ki(i[6])),Ge(e,"touchstart",i[11]),Ge(e,"touchmove",ki(i[11])),Ge(e,"touchend",i[11])],l=!0)},p(f,u){var d,h;if(u&1&&o!==(o=f[0].alphaIndicator)){if(t){Je();const m=t;E(m.$$.fragment,1,0,()=>{j(m,1)}),qe()}o?(t=Dt(o,c(f)),V(t.$$.fragment),T(t.$$.fragment,1),U(t,e,null)):t=null}else if(o){const m={};u&32&&(m.pos=f[5]),u&4&&(m.toRight=f[2]),t.$set(m)}(!s||u&2)&&bi(e,"--alpha-color",(d=f[1])==null?void 0:d.substring(0,7)),(!s||u&32&&n!==(n=Math.round(f[5])))&&te(e,"aria-valuenow",n),(!s||u&32&&r!==(r=((h=f[5])==null?void 0:h.toFixed())+"%"))&&te(e,"aria-valuetext",r),(!s||u&4)&&ei(e,"to-right",f[2])},i(f){s||(t&&T(t.$$.fragment,f),s=!0)},o(f){t&&E(t.$$.fragment,f),s=!1},d(f){f&&K(e),t&&j(t),i[14](null),l=!1,Lt(a)}}}function zS(i){let e,t,n,r,s;var l=i[0].alphaWrapper;function a(o,c){return{props:{focused:o[4],toRight:o[2],$$slots:{default:[VS]},$$scope:{ctx:o}}}}return l&&(e=Dt(l,a(i))),{c(){e&&V(e.$$.fragment),t=Rt()},m(o,c){e&&U(e,o,c),$(o,t,c),n=!0,r||(s=[Ge(qs,"mouseup",i[7]),Ge(qs,"mousemove",i[8]),Ge(qs,"keyup",i[9]),Ge(qs,"keydown",i[10])],r=!0)},p(o,[c]){if(c&1&&l!==(l=o[0].alphaWrapper)){if(e){Je();const f=e;E(f.$$.fragment,1,0,()=>{j(f,1)}),qe()}l?(e=Dt(l,a(o)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(l){const f={};c&16&&(f.focused=o[4]),c&4&&(f.toRight=o[2]),c&4194351&&(f.$$scope={dirty:c,ctx:o}),e.$set(f)}},i(o){n||(e&&T(e.$$.fragment,o),n=!0)},o(o){e&&E(e.$$.fragment,o),n=!1},d(o){o&&K(t),e&&j(e,o),r=!1,Lt(s)}}}function WS(i,e,t){let n,r;Ct(i,vn,A=>t(18,n=A)),Ct(i,ul,A=>t(19,r=A));let{components:s}=e,{isOpen:l}=e,{a=1}=e,{hex:o}=e,{toRight:c}=e,f,u=!1,d=!1,h,m,p;function g(A){const I=c?f.getBoundingClientRect().width:f.getBoundingClientRect().height,z=Math.max(0,Math.min(I,A));t(12,a=z/I)}function v(A){A.button===0&&(u=!0,g(c?A.offsetX:A.offsetY))}function b(){u=!1}function y(A){u&&g(c?A.clientX-f.getBoundingClientRect().left:A.clientY-f.getBoundingClientRect().top)}function _(A){var I;A.key==="Tab"&&t(4,d=!!((I=document.activeElement)!=null&&I.isSameNode(f))),!A.repeat&&d&&C()}function S(A){d&&r.ArrowVH&&(A.preventDefault(),A.repeat||C())}function C(){r.ArrowVH?h||(m=0,h=window.setInterval(()=>{const A=fl(++m),I=c?n.ArrowRight-n.ArrowLeft:n.ArrowDown-n.ArrowUp;t(12,a=Math.min(1,Math.max(0,a+I*A)))},10)):h&&(clearInterval(h),h=void 0)}function k(A){A.preventDefault(),g(c?A.changedTouches[0].clientX-f.getBoundingClientRect().left:A.changedTouches[0].clientY-f.getBoundingClientRect().top)}function w(A){Fe[A?"unshift":"push"](()=>{f=A,t(3,f)})}return i.$$set=A=>{"components"in A&&t(0,s=A.components),"isOpen"in A&&t(13,l=A.isOpen),"a"in A&&t(12,a=A.a),"hex"in A&&t(1,o=A.hex),"toRight"in A&&t(2,c=A.toRight)},i.$$.update=()=>{i.$$.dirty&4104&&typeof a=="number"&&f&&t(5,p=100*a)},[s,o,c,f,d,p,v,b,y,_,S,k,a,l,w]}class XS extends Ye{constructor(e){super(),He(this,e,WS,zS,Ve,{components:0,isOpen:13,a:12,hex:1,toRight:2})}}function HS(i){let e,t,n,r,s,l,a,o,c,f=i[2]&&Cf(i);return{c(){e=ve("div"),t=ve("input"),n=ue(),r=ve("input"),s=ue(),l=ve("input"),a=ue(),f&&f.c(),te(t,"aria-label","hue chanel color"),t.value=i[8],te(t,"type","number"),te(t,"min","0"),te(t,"max","360"),te(t,"class","svelte-11z4jba"),te(r,"aria-label","saturation chanel color"),r.value=i[7],te(r,"type","number"),te(r,"min","0"),te(r,"max","100"),te(r,"class","svelte-11z4jba"),te(l,"aria-label","brightness chanel color"),l.value=i[6],te(l,"type","number"),te(l,"min","0"),te(l,"max","100"),te(l,"class","svelte-11z4jba"),te(e,"class","input-container svelte-11z4jba")},m(u,d){$(u,e,d),ae(e,t),ae(e,n),ae(e,r),ae(e,s),ae(e,l),ae(e,a),f&&f.m(e,null),o||(c=[Ge(t,"input",i[12]("h")),Ge(r,"input",i[12]("s")),Ge(l,"input",i[12]("v"))],o=!0)},p(u,d){d&256&&t.value!==u[8]&&(t.value=u[8]),d&128&&r.value!==u[7]&&(r.value=u[7]),d&64&&l.value!==u[6]&&(l.value=u[6]),u[2]?f?f.p(u,d):(f=Cf(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&K(e),f&&f.d(),o=!1,Lt(c)}}}function YS(i){let e,t,n,r,s,l,a,o,c,f,u,d,h=i[2]&&Sf(i);return{c(){e=ve("div"),t=ve("input"),r=ue(),s=ve("input"),a=ue(),o=ve("input"),f=ue(),h&&h.c(),te(t,"aria-label","red chanel color"),t.value=n=i[0].r,te(t,"type","number"),te(t,"min","0"),te(t,"max","255"),te(t,"class","svelte-11z4jba"),te(s,"aria-label","green chanel color"),s.value=l=i[0].g,te(s,"type","number"),te(s,"min","0"),te(s,"max","255"),te(s,"class","svelte-11z4jba"),te(o,"aria-label","blue chanel color"),o.value=c=i[0].b,te(o,"type","number"),te(o,"min","0"),te(o,"max","255"),te(o,"class","svelte-11z4jba"),te(e,"class","input-container svelte-11z4jba")},m(m,p){$(m,e,p),ae(e,t),ae(e,r),ae(e,s),ae(e,a),ae(e,o),ae(e,f),h&&h.m(e,null),u||(d=[Ge(t,"input",i[11]("r")),Ge(s,"input",i[11]("g")),Ge(o,"input",i[11]("b"))],u=!0)},p(m,p){p&1&&n!==(n=m[0].r)&&t.value!==n&&(t.value=n),p&1&&l!==(l=m[0].g)&&s.value!==l&&(s.value=l),p&1&&c!==(c=m[0].b)&&o.value!==c&&(o.value=c),m[2]?h?h.p(m,p):(h=Sf(m),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(m){m&&K(e),h&&h.d(),u=!1,Lt(d)}}}function GS(i){let e,t,n,r,s,l=i[2]&&kf(i);return{c(){e=ve("div"),t=ve("input"),n=ue(),l&&l.c(),t.value=i[1],bi(t,"flex","3"),te(t,"class","svelte-11z4jba"),te(e,"class","input-container svelte-11z4jba")},m(a,o){$(a,e,o),ae(e,t),ae(e,n),l&&l.m(e,null),r||(s=Ge(t,"input",i[10]),r=!0)},p(a,o){o&2&&t.value!==a[1]&&(t.value=a[1]),a[2]?l?l.p(a,o):(l=kf(a),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&K(e),l&&l.d(),r=!1,s()}}}function Cf(i){let e,t,n;return{c(){e=ve("input"),te(e,"aria-label","transparency chanel color"),e.value=i[5],te(e,"type","number"),te(e,"min","0"),te(e,"max","1"),te(e,"step","0.01"),te(e,"class","svelte-11z4jba")},m(r,s){$(r,e,s),t||(n=Ge(e,"input",i[12]("a")),t=!0)},p(r,s){s&32&&e.value!==r[5]&&(e.value=r[5])},d(r){r&&K(e),t=!1,n()}}}function Sf(i){let e,t,n;return{c(){e=ve("input"),te(e,"aria-label","transparency chanel color"),e.value=i[5],te(e,"type","number"),te(e,"min","0"),te(e,"max","1"),te(e,"step","0.01"),te(e,"class","svelte-11z4jba")},m(r,s){$(r,e,s),t||(n=Ge(e,"input",i[11]("a")),t=!0)},p(r,s){s&32&&e.value!==r[5]&&(e.value=r[5])},d(r){r&&K(e),t=!1,n()}}}function kf(i){let e,t,n;return{c(){e=ve("input"),te(e,"aria-label","hexadecimal color"),e.value=i[5],te(e,"type","number"),te(e,"min","0"),te(e,"max","1"),te(e,"step","0.01"),te(e,"class","svelte-11z4jba")},m(r,s){$(r,e,s),t||(n=Ge(e,"input",i[11]("a")),t=!0)},p(r,s){s&32&&e.value!==r[5]&&(e.value=r[5])},d(r){r&&K(e),t=!1,n()}}}function Tf(i){let e,t=i[9][i[4]]+"",n,r,s,l;return{c(){e=ve("button"),n=et(t),te(e,"aria-label",r="change inputs to "+i[9][(i[4]+1)%3]),te(e,"class","svelte-11z4jba")},m(a,o){$(a,e,o),ae(e,n),s||(l=Ge(e,"click",i[14]),s=!0)},p(a,o){o&16&&t!==(t=a[9][a[4]]+"")&&ui(n,t),o&16&&r!==(r="change inputs to "+a[9][(a[4]+1)%3])&&te(e,"aria-label",r)},d(a){a&&K(e),s=!1,l()}}}function JS(i){let e,t;function n(a,o){return a[4]===0?GS:a[4]===1?YS:HS}let r=n(i),s=r(i),l=i[3]&&Tf(i);return{c(){e=ve("div"),s.c(),t=ue(),l&&l.c(),te(e,"class","text-input svelte-11z4jba")},m(a,o){$(a,e,o),s.m(e,null),ae(e,t),l&&l.m(e,null)},p(a,[o]){r===(r=n(a))&&s?s.p(a,o):(s.d(1),s=r(a),s&&(s.c(),s.m(e,t))),a[3]?l?l.p(a,o):(l=Tf(a),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:Oe,o:Oe,d(a){a&&K(e),s.d(),l&&l.d()}}}const qS=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;function KS(i,e,t){let n,r,s,l,{isAlpha:a}=e,{rgb:o}=e,{hsv:c}=e,{hex:f}=e,{canChangeMode:u}=e;const d=["HEX","RGB","HSV"];let h=0;function m(b){const y=b.target;qS.test(y.value)&&t(1,f=y.value)}function p(b){return function(y){t(0,o={...o,[b]:parseFloat(y.target.value)})}}function g(b){return function(y){t(13,c={...c,[b]:parseFloat(y.target.value)})}}const v=()=>t(4,h=(h+1)%3);return i.$$set=b=>{"isAlpha"in b&&t(2,a=b.isAlpha),"rgb"in b&&t(0,o=b.rgb),"hsv"in b&&t(13,c=b.hsv),"hex"in b&&t(1,f=b.hex),"canChangeMode"in b&&t(3,u=b.canChangeMode)},i.$$.update=()=>{i.$$.dirty&8192&&t(8,n=Math.round(c.h)),i.$$.dirty&8192&&t(7,r=Math.round(c.s)),i.$$.dirty&8192&&t(6,s=Math.round(c.v)),i.$$.dirty&8192&&t(5,l=c.a===void 0?1:Math.round(c.a*100)/100)},[o,f,a,u,h,l,s,r,n,d,m,p,g,c,v]}class QS extends Ye{constructor(e){super(),He(this,e,KS,JS,Ve,{isAlpha:2,rgb:0,hsv:13,hex:1,canChangeMode:3})}}function ZS(i){let e;return{c(){e=ve("div"),te(e,"class","slider-indicator svelte-13znx8u"),bi(e,"top",i[0])},m(t,n){$(t,e,n)},p(t,[n]){n&1&&bi(e,"top",t[0])},i:Oe,o:Oe,d(t){t&&K(e)}}}function $S(i,e,t){let n,{pos:r}=e,{toRight:s}=e;return i.$$set=l=>{"pos"in l&&t(1,r=l.pos),"toRight"in l&&t(2,s=l.toRight)},i.$$.update=()=>{i.$$.dirty&2&&t(0,n=`calc(${r} * (var(--picker-height, 200px) - 14px) / 100 + 2px)`)},[n,r,s]}class wf extends Ye{constructor(e){super(),He(this,e,$S,ZS,Ve,{pos:1,toRight:2})}}function ek(i){let e,t;return{c(){e=ve("div"),te(e,"class","picker-indicator svelte-1nw247x"),te(e,"style",t=`left: ${i[2]}; top: ${i[1]}; box-shadow: 0 0 4px ${i[0]?"white":"black"};`)},m(n,r){$(n,e,r)},p(n,[r]){r&7&&t!==(t=`left: ${n[2]}; top: ${n[1]}; box-shadow: 0 0 4px ${n[0]?"white":"black"};`)&&te(e,"style",t)},i:Oe,o:Oe,d(n){n&&K(e)}}}function tk(i,e,t){let n,r,{pos:s}=e,{hex:l}=e,{isDark:a}=e;return i.$$set=o=>{"pos"in o&&t(3,s=o.pos),"hex"in o&&t(4,l=o.hex),"isDark"in o&&t(0,a=o.isDark)},i.$$.update=()=>{i.$$.dirty&8&&t(2,n=`calc(${s.x} * (var(--picker-width, 200px) - 14px) / 100 + 2px)`),i.$$.dirty&8&&t(1,r=`calc(${s.y} * (var(--picker-height, 200px) - 14px) / 100 + 2px)`)},[a,r,n,s,l]}class ik extends Ye{constructor(e){super(),He(this,e,tk,ek,Ve,{pos:3,hex:4,isDark:0})}}function nk(i){let e,t;return{c:Oe,m(n,r){e||(t=[Ge(window,"keyup",i[0]),Ge(window,"keydown",i[1])],e=!0)},p:Oe,i:Oe,o:Oe,d(n){e=!1,Lt(t)}}}function rk(i,e,t){let n;Ct(i,vn,l=>t(2,n=l));function r(l){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(l.key)&&(Jt(vn,n[l.key]=0,n),vn.set(n))}function s(l){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(l.key)&&(l.repeat||(Jt(vn,n[l.key]=1,n),vn.set(n)))}return[r,s]}class sk extends Ye{constructor(e){super(),He(this,e,rk,nk,Ve,{})}}function ok(i){let e,t;const n=i[3].default,r=gt(n,i,i[2],null);return{c(){e=ve("div"),r&&r.c(),te(e,"class","picker-wrapper svelte-1hhmcjg"),ei(e,"focused",i[0])},m(s,l){$(s,e,l),r&&r.m(e,null),t=!0},p(s,[l]){r&&r.p&&(!t||l&4)&&vt(r,n,s,s[2],t?pt(n,s[2],l,null):bt(s[2]),null),(!t||l&1)&&ei(e,"focused",s[0])},i(s){t||(T(r,s),t=!0)},o(s){E(r,s),t=!1},d(s){s&&K(e),r&&r.d(s)}}}function ak(i,e,t){let{$$slots:n={},$$scope:r}=e,{focused:s}=e,{toRight:l}=e;return i.$$set=a=>{"focused"in a&&t(0,s=a.focused),"toRight"in a&&t(1,l=a.toRight),"$$scope"in a&&t(2,r=a.$$scope)},[s,l,r,n]}class ck extends Ye{constructor(e){super(),He(this,e,ak,ok,Ve,{focused:0,toRight:1})}}function lk(i){let e,t;const n=i[3].default,r=gt(n,i,i[2],null);return{c(){e=ve("div"),r&&r.c(),te(e,"class","slider-wrapper svelte-1udewng"),ei(e,"focused",i[0])},m(s,l){$(s,e,l),r&&r.m(e,null),t=!0},p(s,[l]){r&&r.p&&(!t||l&4)&&vt(r,n,s,s[2],t?pt(n,s[2],l,null):bt(s[2]),null),(!t||l&1)&&ei(e,"focused",s[0])},i(s){t||(T(r,s),t=!0)},o(s){E(r,s),t=!1},d(s){s&&K(e),r&&r.d(s)}}}function uk(i,e,t){let{$$slots:n={},$$scope:r}=e,{focused:s}=e,{toRight:l}=e;return i.$$set=a=>{"focused"in a&&t(0,s=a.focused),"toRight"in a&&t(1,l=a.toRight),"$$scope"in a&&t(2,r=a.$$scope)},[s,l,r,n]}class Pf extends Ye{constructor(e){super(),He(this,e,uk,lk,Ve,{focused:0,toRight:1})}}function fk(i){let e,t,n,r,s,l,a,o,c,f,u;return{c(){e=ve("label"),t=ve("div"),n=ve("input"),r=ue(),s=ve("div"),l=ue(),a=ve("div"),o=ue(),c=et(i[2]),te(n,"type","color"),n.value=i[1],te(n,"aria-haspopup","dialog"),te(n,"class","svelte-2ybi8r"),te(s,"class","alpha svelte-2ybi8r"),te(a,"class","color svelte-2ybi8r"),bi(a,"background",i[1]),te(t,"class","container svelte-2ybi8r"),te(e,"class","svelte-2ybi8r")},m(d,h){$(d,e,h),ae(e,t),ae(t,n),ae(t,r),ae(t,s),ae(t,l),ae(t,a),ae(e,o),ae(e,c),i[4](e),f||(u=[Ge(n,"click",ki(hk)),Ge(n,"mousedown",ki(dk)),Ge(e,"click",ki(mk)),Ge(e,"mousedown",ki(gk))],f=!0)},p(d,[h]){h&2&&(n.value=d[1]),h&2&&bi(a,"background",d[1]),h&4&&ui(c,d[2])},i:Oe,o:Oe,d(d){d&&K(e),i[4](null),f=!1,Lt(u)}}}const hk=()=>{},dk=()=>{},mk=()=>{},gk=()=>{};function pk(i,e,t){let{labelWrapper:n}=e,{hex:r}=e,{label:s}=e,{isOpen:l}=e;function a(o){Fe[o?"unshift":"push"](()=>{n=o,t(0,n)})}return i.$$set=o=>{"labelWrapper"in o&&t(0,n=o.labelWrapper),"hex"in o&&t(1,r=o.hex),"label"in o&&t(2,s=o.label),"isOpen"in o&&t(3,l=o.isOpen)},[n,r,s,l,a]}class vk extends Ye{constructor(e){super(),He(this,e,pk,fk,Ve,{labelWrapper:0,hex:1,label:2,isOpen:3})}}function bk(i){let e,t,n;const r=i[5].default,s=gt(r,i,i[4],null);return{c(){e=ve("div"),s&&s.c(),te(e,"class","wrapper svelte-6lhts"),te(e,"role",t=i[2]?"dialog":void 0),te(e,"aria-label","color picker"),ei(e,"isOpen",i[1]),ei(e,"isPopup",i[2])},m(l,a){$(l,e,a),s&&s.m(e,null),i[6](e),n=!0},p(l,[a]){s&&s.p&&(!n||a&16)&&vt(s,r,l,l[4],n?pt(r,l[4],a,null):bt(l[4]),null),(!n||a&4&&t!==(t=l[2]?"dialog":void 0))&&te(e,"role",t),(!n||a&2)&&ei(e,"isOpen",l[1]),(!n||a&4)&&ei(e,"isPopup",l[2])},i(l){n||(T(s,l),n=!0)},o(l){E(s,l),n=!1},d(l){l&&K(e),s&&s.d(l),i[6](null)}}}function yk(i,e,t){let{$$slots:n={},$$scope:r}=e,{wrapper:s}=e,{isOpen:l}=e,{isPopup:a}=e,{toRight:o}=e;function c(f){Fe[f?"unshift":"push"](()=>{s=f,t(0,s)})}return i.$$set=f=>{"wrapper"in f&&t(0,s=f.wrapper),"isOpen"in f&&t(1,l=f.isOpen),"isPopup"in f&&t(2,a=f.isPopup),"toRight"in f&&t(3,o=f.toRight),"$$scope"in f&&t(4,r=f.$$scope)},[s,l,a,o,r,n,c]}class _k extends Ye{constructor(e){super(),He(this,e,yk,bk,Ve,{wrapper:0,isOpen:1,isPopup:2,toRight:3})}}function Ef(i,e,t){const n=i.slice();return n[9]=e[t].contrast,n[10]=e[t].hex,n[11]=e[t].placeholder,n[12]=e[t].reverse,n[13]=e[t].size,n}function Of(i){let e,t,n;var r=i[0].a11ySingleNotice;function s(l,a){return{props:{contrast:l[9],textColor:l[12]?l[10]:l[1],bgColor:l[12]?l[1]:l[10],placeholder:l[11],size:l[13]}}}return r&&(e=Dt(r,s(i))),{c(){e&&V(e.$$.fragment),t=Rt()},m(l,a){e&&U(e,l,a),$(l,t,a),n=!0},p(l,a){if(a&1&&r!==(r=l[0].a11ySingleNotice)){if(e){Je();const o=e;E(o.$$.fragment,1,0,()=>{j(o,1)}),qe()}r?(e=Dt(r,s(l)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(r){const o={};a&16&&(o.contrast=l[9]),a&18&&(o.textColor=l[12]?l[10]:l[1]),a&18&&(o.bgColor=l[12]?l[1]:l[10]),a&16&&(o.placeholder=l[11]),a&16&&(o.size=l[13]),e.$set(o)}},i(l){n||(e&&T(e.$$.fragment,l),n=!0)},o(l){e&&E(e.$$.fragment,l),n=!1},d(l){l&&K(t),e&&j(e,l)}}}function xf(i){let e;return{c(){e=ve("span"),te(e,"class","svelte-1s4dluu")},m(t,n){$(t,e,n),e.innerHTML=i[2]},p(t,n){n&4&&(e.innerHTML=t[2])},d(t){t&&K(e)}}}function Ck(i){let e,t,n,r,s,l,a,o,c;var f=i[0].a11ySummary;function u(g,v){return{props:{a11yColors:g[4],hex:g[1]}}}f&&(n=Dt(f,u(i)));let d=zr(i[4]),h=[];for(let g=0;g<d.length;g+=1)h[g]=Of(Ef(i,d,g));const m=g=>E(h[g],1,1,()=>{h[g]=null});let p=i[2]&&xf(i);return{c(){e=ve("details"),t=ve("summary"),n&&V(n.$$.fragment),s=ue(),l=ve("div");for(let g=0;g<h.length;g+=1)h[g].c();a=ue(),p&&p.c(),te(t,"tabindex",r=i[5]?-1:void 0),te(t,"class","svelte-1s4dluu"),te(l,"class","svelte-1s4dluu"),te(e,"class",o="a11y-notice "+(i[5]?"not-closable":"")+" svelte-1s4dluu"),e.open=i[3]},m(g,v){$(g,e,v),ae(e,t),n&&U(n,t,null),ae(e,s),ae(e,l);for(let b=0;b<h.length;b+=1)h[b]&&h[b].m(l,null);ae(l,a),p&&p.m(l,null),c=!0},p(g,[v]){if(v&1&&f!==(f=g[0].a11ySummary)){if(n){Je();const b=n;E(b.$$.fragment,1,0,()=>{j(b,1)}),qe()}f?(n=Dt(f,u(g)),V(n.$$.fragment),T(n.$$.fragment,1),U(n,t,null)):n=null}else if(f){const b={};v&16&&(b.a11yColors=g[4]),v&2&&(b.hex=g[1]),n.$set(b)}if((!c||v&32&&r!==(r=g[5]?-1:void 0))&&te(t,"tabindex",r),v&19){d=zr(g[4]);let b;for(b=0;b<d.length;b+=1){const y=Ef(g,d,b);h[b]?(h[b].p(y,v),T(h[b],1)):(h[b]=Of(y),h[b].c(),T(h[b],1),h[b].m(l,a))}for(Je(),b=d.length;b<h.length;b+=1)m(b);qe()}g[2]?p?p.p(g,v):(p=xf(g),p.c(),p.m(l,null)):p&&(p.d(1),p=null),(!c||v&32&&o!==(o="a11y-notice "+(g[5]?"not-closable":"")+" svelte-1s4dluu"))&&te(e,"class",o),(!c||v&8)&&(e.open=g[3])},i(g){if(!c){n&&T(n.$$.fragment,g);for(let v=0;v<d.length;v+=1)T(h[v]);c=!0}},o(g){n&&E(n.$$.fragment,g),h=h.filter(Boolean);for(let v=0;v<h.length;v+=1)E(h[v]);c=!1},d(g){g&&K(e),n&&j(n),Wc(h,g),p&&p.d()}}}function Sk(i,e,t){let n,r,{components:s}=e,{a11yColors:l}=e,{hex:a}=e,{color:o}=e,{a11yGuidelines:c}=e,{isA11yOpen:f}=e,{isA11yClosable:u}=e;return i.$$set=d=>{"components"in d&&t(0,s=d.components),"a11yColors"in d&&t(6,l=d.a11yColors),"hex"in d&&t(1,a=d.hex),"color"in d&&t(7,o=d.color),"a11yGuidelines"in d&&t(2,c=d.a11yGuidelines),"isA11yOpen"in d&&t(3,f=d.isA11yOpen),"isA11yClosable"in d&&t(8,u=d.isA11yClosable)},i.$$.update=()=>{i.$$.dirty&264&&t(5,n=f&&!u),i.$$.dirty&192&&t(4,r=l.map(d=>({...d,contrast:o==null?void 0:o.contrast(d.hex)})))},[s,a,c,f,r,n,l,o,u]}class kk extends Ye{constructor(e){super(),He(this,e,Sk,Ck,Ve,{components:0,a11yColors:6,hex:1,color:7,a11yGuidelines:2,isA11yOpen:3,isA11yClosable:8})}}function Tk(i){let e,t,n=(i[2]||"Lorem Ipsum")+"",r,s,l,a,o,c,f=(i[3]>=10?i[3].toFixed(1):i[3])+"",u,d,h,m,p;return{c(){e=ve("div"),t=ve("p"),r=et(n),l=ue(),a=ve("div"),o=ve("p"),c=et("contrast: "),u=et(f),d=ue(),h=ve("span"),h.textContent="AA",m=ue(),p=ve("span"),p.textContent="AAA",te(t,"class",s="lorem "+(i[4]==="large"&&"large")+" svelte-obnxge"),bi(t,"color",i[0]),bi(t,"background-color",i[1]),te(o,"class","svelte-obnxge"),te(h,"class","grade svelte-obnxge"),ei(h,"grade-ok",i[3]>(i[4]==="large"?3:4.5)),te(p,"class","grade svelte-obnxge"),ei(p,"grade-ok",i[3]>(i[4]==="large"?4.5:7)),te(a,"class","score svelte-obnxge"),te(e,"class","a11y-single-notice svelte-obnxge")},m(g,v){$(g,e,v),ae(e,t),ae(t,r),ae(e,l),ae(e,a),ae(a,o),ae(o,c),ae(o,u),ae(a,d),ae(a,h),ae(a,m),ae(a,p)},p(g,[v]){v&4&&n!==(n=(g[2]||"Lorem Ipsum")+"")&&ui(r,n),v&16&&s!==(s="lorem "+(g[4]==="large"&&"large")+" svelte-obnxge")&&te(t,"class",s),v&1&&bi(t,"color",g[0]),v&2&&bi(t,"background-color",g[1]),v&8&&f!==(f=(g[3]>=10?g[3].toFixed(1):g[3])+"")&&ui(u,f),v&24&&ei(h,"grade-ok",g[3]>(g[4]==="large"?3:4.5)),v&24&&ei(p,"grade-ok",g[3]>(g[4]==="large"?4.5:7))},i:Oe,o:Oe,d(g){g&&K(e)}}}function wk(i,e,t){let{textColor:n}=e,{bgColor:r}=e,{placeholder:s=void 0}=e,{contrast:l=1}=e,{size:a=void 0}=e;return i.$$set=o=>{"textColor"in o&&t(0,n=o.textColor),"bgColor"in o&&t(1,r=o.bgColor),"placeholder"in o&&t(2,s=o.placeholder),"contrast"in o&&t(3,l=o.contrast),"size"in o&&t(4,a=o.size)},[n,r,s,l,a]}class Pk extends Ye{constructor(e){super(),He(this,e,wk,Tk,Ve,{textColor:0,bgColor:1,placeholder:2,contrast:3,size:4})}}function Ek(i){let e;return{c(){e=et(i[0])},m(t,n){$(t,e,n)},p(t,[n]){n&1&&ui(e,t[0])},i:Oe,o:Oe,d(t){t&&K(e)}}}function Ok({contrast:i,size:e}){return i?e==="large"?i<3?2:i<4.5?1:0:i<4.5?2:i<7?1:0:1}function xk(i,e,t){let n,r,{a11yColors:s}=e,{hex:l}=e;return i.$$set=a=>{"a11yColors"in a&&t(1,s=a.a11yColors),"hex"in a&&t(2,l=a.hex)},i.$$.update=()=>{i.$$.dirty&2&&t(3,n=s.map(Ok).reduce((a,o)=>a+o)),i.$$.dirty&8&&t(0,r=n?` ${n} contrast grade${n&&"s"} fail`:"Contrast grade information")},[r,s,l,n]}class Ak extends Ye{constructor(e){super(),He(this,e,xk,Ek,Ve,{a11yColors:1,hex:2})}}function Dk(i){let e;return{c(){e=ve("input"),te(e,"type","hidden"),e.value=i[2]},m(t,n){$(t,e,n)},p(t,n){n[0]&4&&(e.value=t[2])},i:Oe,o:Oe,d(t){t&&K(e)}}}function Rk(i){let e,t,n,r,s;function l(f){i[26](f)}function a(f){i[27](f)}var o=i[21]().input;function c(f,u){let d={hex:f[2],label:f[6]};return f[19]!==void 0&&(d.labelWrapper=f[19]),f[3]!==void 0&&(d.isOpen=f[3]),{props:d}}return o&&(e=Dt(o,c(i)),Fe.push(()=>nt(e,"labelWrapper",l)),Fe.push(()=>nt(e,"isOpen",a))),{c(){e&&V(e.$$.fragment),r=Rt()},m(f,u){e&&U(e,f,u),$(f,r,u),s=!0},p(f,u){if(o!==(o=f[21]().input)){if(e){Je();const d=e;E(d.$$.fragment,1,0,()=>{j(d,1)}),qe()}o?(e=Dt(o,c(f)),Fe.push(()=>nt(e,"labelWrapper",l)),Fe.push(()=>nt(e,"isOpen",a)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,r.parentNode,r)):e=null}else if(o){const d={};u[0]&4&&(d.hex=f[2]),u[0]&64&&(d.label=f[6]),!t&&u[0]&524288&&(t=!0,d.labelWrapper=f[19],lt(()=>t=!1)),!n&&u[0]&8&&(n=!0,d.isOpen=f[3],lt(()=>n=!1)),e.$set(d)}},i(f){s||(e&&T(e.$$.fragment,f),s=!0)},o(f){e&&E(e.$$.fragment,f),s=!1},d(f){f&&K(r),e&&j(e,f)}}}function Af(i){let e,t,n,r;function s(o){i[32](o)}function l(o){i[33](o)}let a={components:i[21](),hex:i[2],toRight:i[17]};return i[1].a!==void 0&&(a.a=i[1].a),i[3]!==void 0&&(a.isOpen=i[3]),e=new XS({props:a}),Fe.push(()=>nt(e,"a",s)),Fe.push(()=>nt(e,"isOpen",l)),{c(){V(e.$$.fragment)},m(o,c){U(e,o,c),r=!0},p(o,c){const f={};c[0]&4&&(f.hex=o[2]),c[0]&131072&&(f.toRight=o[17]),!t&&c[0]&2&&(t=!0,f.a=o[1].a,lt(()=>t=!1)),!n&&c[0]&8&&(n=!0,f.isOpen=o[3],lt(()=>n=!1)),e.$set(f)},i(o){r||(T(e.$$.fragment,o),r=!0)},o(o){E(e.$$.fragment,o),r=!1},d(o){j(e,o)}}}function Df(i){let e,t,n,r,s,l;function a(d){i[34](d)}function o(d){i[35](d)}function c(d){i[36](d)}var f=i[21]().textInput;function u(d,h){let m={isAlpha:d[7],canChangeMode:d[10]};return d[2]!==void 0&&(m.hex=d[2]),d[0]!==void 0&&(m.rgb=d[0]),d[1]!==void 0&&(m.hsv=d[1]),{props:m}}return f&&(e=Dt(f,u(i)),Fe.push(()=>nt(e,"hex",a)),Fe.push(()=>nt(e,"rgb",o)),Fe.push(()=>nt(e,"hsv",c))),{c(){e&&V(e.$$.fragment),s=Rt()},m(d,h){e&&U(e,d,h),$(d,s,h),l=!0},p(d,h){if(f!==(f=d[21]().textInput)){if(e){Je();const m=e;E(m.$$.fragment,1,0,()=>{j(m,1)}),qe()}f?(e=Dt(f,u(d)),Fe.push(()=>nt(e,"hex",a)),Fe.push(()=>nt(e,"rgb",o)),Fe.push(()=>nt(e,"hsv",c)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,s.parentNode,s)):e=null}else if(f){const m={};h[0]&128&&(m.isAlpha=d[7]),h[0]&1024&&(m.canChangeMode=d[10]),!t&&h[0]&4&&(t=!0,m.hex=d[2],lt(()=>t=!1)),!n&&h[0]&1&&(n=!0,m.rgb=d[0],lt(()=>n=!1)),!r&&h[0]&2&&(r=!0,m.hsv=d[1],lt(()=>r=!1)),e.$set(m)}},i(d){l||(e&&T(e.$$.fragment,d),l=!0)},o(d){e&&E(e.$$.fragment,d),l=!1},d(d){d&&K(s),e&&j(e,d)}}}function Rf(i){let e,t,n;var r=i[21]().a11yNotice;function s(l,a){return{props:{components:l[21](),a11yColors:l[12],color:l[4],hex:l[2],a11yGuidelines:l[13],isA11yOpen:l[14],isA11yClosable:l[15]}}}return r&&(e=Dt(r,s(i))),{c(){e&&V(e.$$.fragment),t=Rt()},m(l,a){e&&U(e,l,a),$(l,t,a),n=!0},p(l,a){if(r!==(r=l[21]().a11yNotice)){if(e){Je();const o=e;E(o.$$.fragment,1,0,()=>{j(o,1)}),qe()}r?(e=Dt(r,s(l)),V(e.$$.fragment),T(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(r){const o={};a[0]&4096&&(o.a11yColors=l[12]),a[0]&16&&(o.color=l[4]),a[0]&4&&(o.hex=l[2]),a[0]&8192&&(o.a11yGuidelines=l[13]),a[0]&16384&&(o.isA11yOpen=l[14]),a[0]&32768&&(o.isA11yClosable=l[15]),e.$set(o)}},i(l){n||(e&&T(e.$$.fragment,l),n=!0)},o(l){e&&E(e.$$.fragment,l),n=!1},d(l){l&&K(t),e&&j(e,l)}}}function Mk(i){let e,t,n,r,s,l,a,o,c,f,u,d;function h(C){i[28](C)}function m(C){i[29](C)}function p(C){i[30](C)}let g={components:i[21](),h:i[1].h,toRight:i[17],isDark:i[5]};i[1].s!==void 0&&(g.s=i[1].s),i[1].v!==void 0&&(g.v=i[1].v),i[3]!==void 0&&(g.isOpen=i[3]),e=new NS({props:g}),Fe.push(()=>nt(e,"s",h)),Fe.push(()=>nt(e,"v",m)),Fe.push(()=>nt(e,"isOpen",p));function v(C){i[31](C)}let b={components:i[21](),toRight:i[17]};i[1].h!==void 0&&(b.h=i[1].h),l=new jS({props:b}),Fe.push(()=>nt(l,"h",v));let y=i[7]&&Af(i),_=i[9]&&Df(i),S=i[11]&&Rf(i);return{c(){V(e.$$.fragment),s=ue(),V(l.$$.fragment),o=ue(),y&&y.c(),c=ue(),_&&_.c(),f=ue(),S&&S.c(),u=Rt()},m(C,k){U(e,C,k),$(C,s,k),U(l,C,k),$(C,o,k),y&&y.m(C,k),$(C,c,k),_&&_.m(C,k),$(C,f,k),S&&S.m(C,k),$(C,u,k),d=!0},p(C,k){const w={};k[0]&2&&(w.h=C[1].h),k[0]&131072&&(w.toRight=C[17]),k[0]&32&&(w.isDark=C[5]),!t&&k[0]&2&&(t=!0,w.s=C[1].s,lt(()=>t=!1)),!n&&k[0]&2&&(n=!0,w.v=C[1].v,lt(()=>n=!1)),!r&&k[0]&8&&(r=!0,w.isOpen=C[3],lt(()=>r=!1)),e.$set(w);const A={};k[0]&131072&&(A.toRight=C[17]),!a&&k[0]&2&&(a=!0,A.h=C[1].h,lt(()=>a=!1)),l.$set(A),C[7]?y?(y.p(C,k),k[0]&128&&T(y,1)):(y=Af(C),y.c(),T(y,1),y.m(c.parentNode,c)):y&&(Je(),E(y,1,1,()=>{y=null}),qe()),C[9]?_?(_.p(C,k),k[0]&512&&T(_,1)):(_=Df(C),_.c(),T(_,1),_.m(f.parentNode,f)):_&&(Je(),E(_,1,1,()=>{_=null}),qe()),C[11]?S?(S.p(C,k),k[0]&2048&&T(S,1)):(S=Rf(C),S.c(),T(S,1),S.m(u.parentNode,u)):S&&(Je(),E(S,1,1,()=>{S=null}),qe())},i(C){d||(T(e.$$.fragment,C),T(l.$$.fragment,C),T(y),T(_),T(S),d=!0)},o(C){E(e.$$.fragment,C),E(l.$$.fragment,C),E(y),E(_),E(S),d=!1},d(C){C&&(K(s),K(o),K(c),K(f),K(u)),j(e,C),j(l,C),y&&y.d(C),_&&_.d(C),S&&S.d(C)}}}function Ik(i){let e,t,n,r,s,l,a,o,c,f,u;e=new sk({});const d=[Rk,Dk],h=[];function m(b,y){return b[8]?0:1}r=m(i),s=h[r]=d[r](i);function p(b){i[37](b)}var g=i[21]().wrapper;function v(b,y){let _={isOpen:b[3],isPopup:b[16],toRight:b[17],$$slots:{default:[Mk]},$$scope:{ctx:b}};return b[20]!==void 0&&(_.wrapper=b[20]),{props:_}}return g&&(a=Dt(g,v(i)),Fe.push(()=>nt(a,"wrapper",p))),{c(){V(e.$$.fragment),t=ue(),n=ve("span"),s.c(),l=ue(),a&&V(a.$$.fragment),te(n,"class","color-picker svelte-7ntk55")},m(b,y){U(e,b,y),$(b,t,y),$(b,n,y),h[r].m(n,null),ae(n,l),a&&U(a,n,null),i[38](n),c=!0,f||(u=[Ge(window,"mousedown",i[22]),Ge(window,"keyup",i[23])],f=!0)},p(b,y){let _=r;if(r=m(b),r===_?h[r].p(b,y):(Je(),E(h[_],1,1,()=>{h[_]=null}),qe(),s=h[r],s?s.p(b,y):(s=h[r]=d[r](b),s.c()),T(s,1),s.m(n,l)),g!==(g=b[21]().wrapper)){if(a){Je();const S=a;E(S.$$.fragment,1,0,()=>{j(S,1)}),qe()}g?(a=Dt(g,v(b)),Fe.push(()=>nt(a,"wrapper",p)),V(a.$$.fragment),T(a.$$.fragment,1),U(a,n,null)):a=null}else if(g){const S={};y[0]&8&&(S.isOpen=b[3]),y[0]&65536&&(S.isPopup=b[16]),y[0]&131072&&(S.toRight=b[17]),y[0]&196287|y[1]&16384&&(S.$$scope={dirty:y,ctx:b}),!o&&y[0]&1048576&&(o=!0,S.wrapper=b[20],lt(()=>o=!1)),a.$set(S)}},i(b){c||(T(e.$$.fragment,b),T(s),a&&T(a.$$.fragment,b),c=!0)},o(b){E(e.$$.fragment,b),E(s),a&&E(a.$$.fragment,b),c=!1},d(b){b&&(K(t),K(n)),j(e,b),h[r].d(),a&&j(a),i[38](null),f=!1,Lt(u)}}}function Lk(i,e,t){DS([RS]);let{components:n={}}=e;const r=Gr();let{label:s="Choose a color"}=e,{isAlpha:l=!0}=e,{isInput:a=!0}=e,{isTextInput:o=!0}=e,{canChangeMode:c=!0}=e,{isA11y:f=!1}=e,{a11yColors:u=[{hex:"#ffffff"}]}=e,{a11yGuidelines:d='<p style="margin: 0; font-size: 12px;">Learn more at <a href="https://webaim.org/articles/contrast/" target="_blank">WebAIM contrast guide</a></p>'}=e,{isA11yOpen:h=!1}=e,{isA11yClosable:m=!0}=e,{isPopup:p=a}=e,{isOpen:g=!a}=e,{toRight:v=!1}=e,{disableCloseClickOutside:b=!1}=e,{rgb:y={r:255,g:0,b:0,a:1}}=e,{hsv:_={h:0,s:100,v:100,a:1}}=e,{hex:S="#ff0000"}=e,{color:C=void 0}=e,{isDark:k=!1}=e,w={r:255,g:0,b:0,a:1},A={h:0,s:100,v:100,a:1},I="#ff0000",z;const H={sliderIndicator:wf,pickerIndicator:ik,alphaIndicator:wf,pickerWrapper:ck,sliderWrapper:Pf,alphaWrapper:Pf,textInput:QS,a11yNotice:kk,a11ySingleNotice:Pk,a11ySummary:Ak,input:vk,wrapper:_k};function Q(){return{...H,...n}}let ee,Z;function he({target:q}){a&&(ee.contains(q)||ee.isSameNode(q)?t(3,g=!g):g&&!Z.contains(q)&&!b&&t(3,g=!1))}function _e(q){q.key==="Tab"&&p&&t(3,g=z==null?void 0:z.contains(document.activeElement))}function we(){_.h===A.h&&_.s===A.s&&_.v===A.v&&_.a===A.a&&y.r===w.r&&y.g===w.g&&y.b===w.b&&y.a===w.a&&S===I||(_.a===void 0&&t(1,_.a=1,_),A.a===void 0&&(A.a=1),y.a===void 0&&t(0,y.a=1,y),w.a===void 0&&(w.a=1),(S==null?void 0:S.substring(7))==="ff"&&t(2,S=S.substring(0,7)),(S==null?void 0:S.substring(7))==="ff"&&t(2,S=S.substring(0,7)),_.h!==A.h||_.s!==A.s||_.v!==A.v||_.a!==A.a?(t(4,C=ni(_)),t(0,y=C.toRgb()),t(2,S=C.toHex())):y.r!==w.r||y.g!==w.g||y.b!==w.b||y.a!==w.a?(t(4,C=ni(y)),t(2,S=C.toHex()),t(1,_=C.toHsv())):S!==I&&(t(4,C=ni(S)),t(0,y=C.toRgb()),t(1,_=C.toHsv())),C&&t(5,k=C.isDark()),A=Object.assign({},_),w=Object.assign({},y),I=S,r("input",{color:C,hsv:_,rgb:y,hex:S}))}function O(q){ee=q,t(19,ee)}function N(q){g=q,t(3,g)}function L(q){i.$$.not_equal(_.s,q)&&(_.s=q,t(1,_))}function D(q){i.$$.not_equal(_.v,q)&&(_.v=q,t(1,_))}function B(q){g=q,t(3,g)}function P(q){i.$$.not_equal(_.h,q)&&(_.h=q,t(1,_))}function x(q){i.$$.not_equal(_.a,q)&&(_.a=q,t(1,_))}function W(q){g=q,t(3,g)}function Y(q){S=q,t(2,S)}function ce(q){y=q,t(0,y)}function ne(q){_=q,t(1,_)}function me(q){Z=q,t(20,Z)}function pe(q){Fe[q?"unshift":"push"](()=>{z=q,t(18,z)})}return i.$$set=q=>{"components"in q&&t(24,n=q.components),"label"in q&&t(6,s=q.label),"isAlpha"in q&&t(7,l=q.isAlpha),"isInput"in q&&t(8,a=q.isInput),"isTextInput"in q&&t(9,o=q.isTextInput),"canChangeMode"in q&&t(10,c=q.canChangeMode),"isA11y"in q&&t(11,f=q.isA11y),"a11yColors"in q&&t(12,u=q.a11yColors),"a11yGuidelines"in q&&t(13,d=q.a11yGuidelines),"isA11yOpen"in q&&t(14,h=q.isA11yOpen),"isA11yClosable"in q&&t(15,m=q.isA11yClosable),"isPopup"in q&&t(16,p=q.isPopup),"isOpen"in q&&t(3,g=q.isOpen),"toRight"in q&&t(17,v=q.toRight),"disableCloseClickOutside"in q&&t(25,b=q.disableCloseClickOutside),"rgb"in q&&t(0,y=q.rgb),"hsv"in q&&t(1,_=q.hsv),"hex"in q&&t(2,S=q.hex),"color"in q&&t(4,C=q.color),"isDark"in q&&t(5,k=q.isDark)},i.$$.update=()=>{i.$$.dirty[0]&7&&(_||y||S)&&we()},[y,_,S,g,C,k,s,l,a,o,c,f,u,d,h,m,p,v,z,ee,Z,Q,he,_e,n,b,O,N,L,D,B,P,x,W,Y,ce,ne,me,pe]}class Nk extends Ye{constructor(e){super(),He(this,e,Lk,Ik,Ve,{components:24,label:6,isAlpha:7,isInput:8,isTextInput:9,canChangeMode:10,isA11y:11,a11yColors:12,a11yGuidelines:13,isA11yOpen:14,isA11yClosable:15,isPopup:16,isOpen:3,toRight:17,disableCloseClickOutside:25,rgb:0,hsv:1,hex:2,color:4,isDark:5},null,[-1,-1])}}function Fk(i){let e;return{c(){e=et("Whiteboard")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Bk(i){let e,t;return e=new yt({props:{name:"adjustments-horizontal"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Uk(i){let e;return{c(){e=et("Select Tool")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function jk(i){let e,t;return e=new yt({props:{name:"pointer-filled"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Vk(i){let e;return{c(){e=et("Select")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function zk(i){let e,t;return e=new yt({props:{name:"arrows-move"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Wk(i){let e;return{c(){e=et("Move")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Xk(i){let e,t;return e=new yt({props:{name:"zoom-reset"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Hk(i){let e;return{c(){e=et("Reset Zoom")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Yk(i){let e,t;return e=new yt({props:{name:"eraser"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Gk(i){let e;return{c(){e=et("Eraser")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Jk(i){let e,t;return e=new yt({props:{name:"screenshot"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function qk(i){let e;return{c(){e=et("Screenshot")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Kk(i){let e,t;return e=new yt({props:{name:"slash"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Qk(i){let e;return{c(){e=et("Line")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function Zk(i){let e,t;return e=new yt({props:{name:"scribble"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function $k(i){let e;return{c(){e=et("Scribble")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function eT(i){let e,t;return e=new yt({props:{name:"circle"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function tT(i){let e;return{c(){e=et("Circle")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function iT(i){let e,t;return e=new yt({props:{name:"rectangle"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function nT(i){let e;return{c(){e=et("Rectangle")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function rT(i){let e,t;return e=new yt({props:{name:"typography"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function sT(i){let e;return{c(){e=et("Text")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function oT(i){let e,t;return e=new yt({props:{name:"trash-filled"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function aT(i){let e;return{c(){e=et("Clear")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function cT(i){let e,t,n;function r(l){i[14](l)}let s={};return i[6]!==void 0&&(s.value=i[6]),e=new hb({props:s}),Fe.push(()=>nt(e,"value",r)),{c(){V(e.$$.fragment)},m(l,a){U(e,l,a),n=!0},p(l,a){const o={};!t&&a&64&&(t=!0,o.value=l[6],lt(()=>t=!1)),e.$set(o)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){j(e,l)}}}function lT(i){let e,t,n,r,s,l,a,o,c,f,u,d,h,m,p,g,v,b,y,_,S,C,k,w,A,I,z,H,Q,ee,Z,he,_e,we,O,N,L,D,B,P,x,W,Y,ce,ne,me,pe,q,se,J,de,fe,oe,ge,Se,Be,Te,le,Ie,ze,$e,ft,it,dt,at,Wt,Ut;n=new rt({props:{color:i[5]==="select"?"dark":"",$$slots:{default:[jk]},$$scope:{ctx:i}}}),n.$on("click",function(){ii(i[4].resetEvents)&&i[4].resetEvents.apply(this,arguments)}),s=new Pt({props:{placement:"left",$$slots:{default:[Vk]},$$scope:{ctx:i}}}),o=new rt({props:{color:i[5]==="move"?"dark":"",$$slots:{default:[zk]},$$scope:{ctx:i}}}),o.$on("click",function(){ii(i[4].enterDragMode)&&i[4].enterDragMode.apply(this,arguments)}),f=new Pt({props:{placement:"left",$$slots:{default:[Wk]},$$scope:{ctx:i}}}),h=new rt({props:{$$slots:{default:[Xk]},$$scope:{ctx:i}}}),h.$on("click",function(){ii(i[4].resetZoom)&&i[4].resetZoom.apply(this,arguments)}),p=new Pt({props:{placement:"left",$$slots:{default:[Hk]},$$scope:{ctx:i}}}),b=new rt({props:{color:i[5]==="eraser"?"dark":"",$$slots:{default:[Yk]},$$scope:{ctx:i}}}),b.$on("click",function(){ii(i[4].activateEraser)&&i[4].activateEraser.apply(this,arguments)}),_=new Pt({props:{placement:"left",$$slots:{default:[Gk]},$$scope:{ctx:i}}}),k=new rt({props:{$$slots:{default:[Jk]},$$scope:{ctx:i}}}),k.$on("click",function(){ii(i[4].startTakingScreenshot)&&i[4].startTakingScreenshot.apply(this,arguments)}),A=new Pt({props:{placement:"left",$$slots:{default:[qk]},$$scope:{ctx:i}}}),H=new rt({props:{color:i[5]==="line"?"dark":"",$$slots:{default:[Kk]},$$scope:{ctx:i}}}),H.$on("click",function(){ii(i[4].drawline)&&i[4].drawline.apply(this,arguments)}),ee=new Pt({props:{placement:"left",$$slots:{default:[Qk]},$$scope:{ctx:i}}}),_e=new rt({props:{color:i[5]==="freeform"?"dark":"",$$slots:{default:[Zk]},$$scope:{ctx:i}}}),_e.$on("click",function(){ii(i[4].drawFreeform)&&i[4].drawFreeform.apply(this,arguments)}),O=new Pt({props:{placement:"left",$$slots:{default:[$k]},$$scope:{ctx:i}}}),D=new rt({props:{color:i[5]==="circle"?"dark":"",$$slots:{default:[eT]},$$scope:{ctx:i}}}),D.$on("click",function(){ii(i[4].drawCircle)&&i[4].drawCircle.apply(this,arguments)}),P=new Pt({props:{placement:"left",$$slots:{default:[tT]},$$scope:{ctx:i}}}),Y=new rt({props:{color:i[5]==="rect"?"dark":"",$$slots:{default:[iT]},$$scope:{ctx:i}}}),Y.$on("click",function(){ii(i[4].drawRect)&&i[4].drawRect.apply(this,arguments)}),ne=new Pt({props:{placement:"left",$$slots:{default:[nT]},$$scope:{ctx:i}}}),q=new rt({props:{$$slots:{default:[rT]},$$scope:{ctx:i}}}),q.$on("click",i[13]),J=new Pt({props:{placement:"left",$$slots:{default:[sT]},$$scope:{ctx:i}}}),oe=new rt({props:{color:"warning",$$slots:{default:[oT]},$$scope:{ctx:i}}}),oe.$on("click",function(){ii(i[4].clearBoard)&&i[4].clearBoard.apply(this,arguments)}),Se=new Pt({props:{placement:"left",$$slots:{default:[aT]},$$scope:{ctx:i}}}),le=new cb({props:{min:2,max:16,step:2,$$slots:{default:[cT]},$$scope:{ctx:i}}});function Xt(xe){i[15](xe)}let ji={isOpen:!0,isPopup:!1,isInput:!1};return i[7]!==void 0&&(ji.hex=i[7]),at=new Nk({props:ji}),Fe.push(()=>nt(at,"hex",Xt)),{c(){e=ve("div"),t=ve("div"),V(n.$$.fragment),r=ue(),V(s.$$.fragment),l=ue(),a=ve("div"),V(o.$$.fragment),c=ue(),V(f.$$.fragment),u=ue(),d=ve("div"),V(h.$$.fragment),m=ue(),V(p.$$.fragment),g=ue(),v=ve("div"),V(b.$$.fragment),y=ue(),V(_.$$.fragment),S=ue(),C=ve("div"),V(k.$$.fragment),w=ue(),V(A.$$.fragment),I=ue(),z=ve("div"),V(H.$$.fragment),Q=ue(),V(ee.$$.fragment),Z=ue(),he=ve("div"),V(_e.$$.fragment),we=ue(),V(O.$$.fragment),N=ue(),L=ve("div"),V(D.$$.fragment),B=ue(),V(P.$$.fragment),x=ue(),W=ve("div"),V(Y.$$.fragment),ce=ue(),V(ne.$$.fragment),me=ue(),pe=ve("div"),V(q.$$.fragment),se=ue(),V(J.$$.fragment),de=ue(),fe=ve("div"),V(oe.$$.fragment),ge=ue(),V(Se.$$.fragment),Be=ue(),Te=ve("div"),V(le.$$.fragment),Ie=ue(),ze=ve("i"),$e=et("Stroke WIdth: "),ft=et(i[6]),it=ue(),dt=ve("div"),V(at.$$.fragment),te(e,"class","grid grid-cols-3 gap-2 place-items-center"),te(dt,"class","mt-2")},m(xe,Re){$(xe,e,Re),ae(e,t),U(n,t,null),ae(t,r),U(s,t,null),ae(e,l),ae(e,a),U(o,a,null),ae(a,c),U(f,a,null),ae(e,u),ae(e,d),U(h,d,null),ae(d,m),U(p,d,null),ae(e,g),ae(e,v),U(b,v,null),ae(v,y),U(_,v,null),ae(e,S),ae(e,C),U(k,C,null),ae(C,w),U(A,C,null),ae(e,I),ae(e,z),U(H,z,null),ae(z,Q),U(ee,z,null),ae(e,Z),ae(e,he),U(_e,he,null),ae(he,we),U(O,he,null),ae(e,N),ae(e,L),U(D,L,null),ae(L,B),U(P,L,null),ae(e,x),ae(e,W),U(Y,W,null),ae(W,ce),U(ne,W,null),ae(e,me),ae(e,pe),U(q,pe,null),ae(pe,se),U(J,pe,null),ae(e,de),ae(e,fe),U(oe,fe,null),ae(fe,ge),U(Se,fe,null),$(xe,Be,Re),$(xe,Te,Re),U(le,Te,null),ae(Te,Ie),ae(Te,ze),ae(ze,$e),ae(ze,ft),$(xe,it,Re),$(xe,dt,Re),U(at,dt,null),Ut=!0},p(xe,Re){i=xe;const Ci={};Re&32&&(Ci.color=i[5]==="select"?"dark":""),Re&8388608&&(Ci.$$scope={dirty:Re,ctx:i}),n.$set(Ci);const Gn={};Re&8388608&&(Gn.$$scope={dirty:Re,ctx:i}),s.$set(Gn);const hn={};Re&32&&(hn.color=i[5]==="move"?"dark":""),Re&8388608&&(hn.$$scope={dirty:Re,ctx:i}),o.$set(hn);const Jn={};Re&8388608&&(Jn.$$scope={dirty:Re,ctx:i}),f.$set(Jn);const xi={};Re&8388608&&(xi.$$scope={dirty:Re,ctx:i}),h.$set(xi);const F={};Re&8388608&&(F.$$scope={dirty:Re,ctx:i}),p.$set(F);const X={};Re&32&&(X.color=i[5]==="eraser"?"dark":""),Re&8388608&&(X.$$scope={dirty:Re,ctx:i}),b.$set(X);const ie={};Re&8388608&&(ie.$$scope={dirty:Re,ctx:i}),_.$set(ie);const be={};Re&8388608&&(be.$$scope={dirty:Re,ctx:i}),k.$set(be);const Ee={};Re&8388608&&(Ee.$$scope={dirty:Re,ctx:i}),A.$set(Ee);const Pe={};Re&32&&(Pe.color=i[5]==="line"?"dark":""),Re&8388608&&(Pe.$$scope={dirty:Re,ctx:i}),H.$set(Pe);const We={};Re&8388608&&(We.$$scope={dirty:Re,ctx:i}),ee.$set(We);const De={};Re&32&&(De.color=i[5]==="freeform"?"dark":""),Re&8388608&&(De.$$scope={dirty:Re,ctx:i}),_e.$set(De);const mt={};Re&8388608&&(mt.$$scope={dirty:Re,ctx:i}),O.$set(mt);const ct={};Re&32&&(ct.color=i[5]==="circle"?"dark":""),Re&8388608&&(ct.$$scope={dirty:Re,ctx:i}),D.$set(ct);const St={};Re&8388608&&(St.$$scope={dirty:Re,ctx:i}),P.$set(St);const _t={};Re&32&&(_t.color=i[5]==="rect"?"dark":""),Re&8388608&&(_t.$$scope={dirty:Re,ctx:i}),Y.$set(_t);const st={};Re&8388608&&(st.$$scope={dirty:Re,ctx:i}),ne.$set(st);const wt={};Re&8388608&&(wt.$$scope={dirty:Re,ctx:i}),q.$set(wt);const Mt={};Re&8388608&&(Mt.$$scope={dirty:Re,ctx:i}),J.$set(Mt);const Ot={};Re&8388608&&(Ot.$$scope={dirty:Re,ctx:i}),oe.$set(Ot);const xt={};Re&8388608&&(xt.$$scope={dirty:Re,ctx:i}),Se.$set(xt);const Vi={};Re&8388672&&(Vi.$$scope={dirty:Re,ctx:i}),le.$set(Vi),(!Ut||Re&64)&&ui(ft,i[6]);const zi={};!Wt&&Re&128&&(Wt=!0,zi.hex=i[7],lt(()=>Wt=!1)),at.$set(zi)},i(xe){Ut||(T(n.$$.fragment,xe),T(s.$$.fragment,xe),T(o.$$.fragment,xe),T(f.$$.fragment,xe),T(h.$$.fragment,xe),T(p.$$.fragment,xe),T(b.$$.fragment,xe),T(_.$$.fragment,xe),T(k.$$.fragment,xe),T(A.$$.fragment,xe),T(H.$$.fragment,xe),T(ee.$$.fragment,xe),T(_e.$$.fragment,xe),T(O.$$.fragment,xe),T(D.$$.fragment,xe),T(P.$$.fragment,xe),T(Y.$$.fragment,xe),T(ne.$$.fragment,xe),T(q.$$.fragment,xe),T(J.$$.fragment,xe),T(oe.$$.fragment,xe),T(Se.$$.fragment,xe),T(le.$$.fragment,xe),T(at.$$.fragment,xe),Ut=!0)},o(xe){E(n.$$.fragment,xe),E(s.$$.fragment,xe),E(o.$$.fragment,xe),E(f.$$.fragment,xe),E(h.$$.fragment,xe),E(p.$$.fragment,xe),E(b.$$.fragment,xe),E(_.$$.fragment,xe),E(k.$$.fragment,xe),E(A.$$.fragment,xe),E(H.$$.fragment,xe),E(ee.$$.fragment,xe),E(_e.$$.fragment,xe),E(O.$$.fragment,xe),E(D.$$.fragment,xe),E(P.$$.fragment,xe),E(Y.$$.fragment,xe),E(ne.$$.fragment,xe),E(q.$$.fragment,xe),E(J.$$.fragment,xe),E(oe.$$.fragment,xe),E(Se.$$.fragment,xe),E(le.$$.fragment,xe),E(at.$$.fragment,xe),Ut=!1},d(xe){xe&&(K(e),K(Be),K(Te),K(it),K(dt)),j(n),j(s),j(o),j(f),j(h),j(p),j(b),j(_),j(k),j(A),j(H),j(ee),j(_e),j(O),j(D),j(P),j(Y),j(ne),j(q),j(J),j(oe),j(Se),j(le),j(at)}}}function uT(i){let e,t,n,r;return e=new Lh({props:{$$slots:{default:[Uk]},$$scope:{ctx:i}}}),n=new Fh({props:{$$slots:{default:[lT]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&8388608&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&8388848&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function Mf(i){let e,t,n,r;return e=new rt({props:{$$slots:{default:[fT]},$$scope:{ctx:i}}}),e.$on("click",i[16]),n=new Pt({props:{text:"Show Chat"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&8388608&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function fT(i){let e,t;return e=new yt({props:{name:"message-circle-2"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function hT(i){let e,t,n,r;return e=new rt({props:{$$slots:{default:[mT]},$$scope:{ctx:i}}}),e.$on("click",i[12]),n=new Pt({props:{text:"Minimize"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&8388608&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function dT(i){let e,t,n,r;return e=new rt({props:{$$slots:{default:[gT]},$$scope:{ctx:i}}}),e.$on("click",i[11]),n=new Pt({props:{text:"Maximize"}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&8388608&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function mT(i){let e,t;return e=new yt({props:{name:"arrows-minimize"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function gT(i){let e,t;return e=new yt({props:{name:"maximize"}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p:Oe,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function pT(i){let e,t,n,r,s,l,a,o,c,f,u,d,h;t=new Ke({props:{textColor:"primary",fontWeight:"bolder",fontSize:"1",$$slots:{default:[Fk]},$$scope:{ctx:i}}}),l=new rt({props:{$$slots:{default:[Bk]},$$scope:{ctx:i}}}),o=new Nh({props:{trigger:"hover",$$slots:{default:[uT]},$$scope:{ctx:i}}});let m=i[8]&&Mf(i);const p=[dT,hT],g=[];function v(b,y){return b[10]?1:0}return u=v(i),d=g[u]=p[u](i),{c(){e=ve("div"),V(t.$$.fragment),n=ue(),r=ve("div"),s=ve("div"),V(l.$$.fragment),a=ue(),V(o.$$.fragment),c=ue(),m&&m.c(),f=ue(),d.c(),te(s,"class","hidden space-x-2 xl:block"),te(e,"class","flex justify-between items-center")},m(b,y){$(b,e,y),U(t,e,null),ae(e,n),ae(e,r),ae(r,s),U(l,s,null),ae(s,a),U(o,s,null),ae(s,c),m&&m.m(s,null),ae(s,f),g[u].m(s,null),h=!0},p(b,y){const _={};y&8388608&&(_.$$scope={dirty:y,ctx:b}),t.$set(_);const S={};y&8388608&&(S.$$scope={dirty:y,ctx:b}),l.$set(S);const C={};y&8388848&&(C.$$scope={dirty:y,ctx:b}),o.$set(C),b[8]?m?(m.p(b,y),y&256&&T(m,1)):(m=Mf(b),m.c(),T(m,1),m.m(s,f)):m&&(Je(),E(m,1,1,()=>{m=null}),qe());let k=u;u=v(b),u===k?g[u].p(b,y):(Je(),E(g[k],1,1,()=>{g[k]=null}),qe(),d=g[u],d?d.p(b,y):(d=g[u]=p[u](b),d.c()),T(d,1),d.m(s,null))},i(b){h||(T(t.$$.fragment,b),T(l.$$.fragment,b),T(o.$$.fragment,b),T(m),T(d),h=!0)},o(b){E(t.$$.fragment,b),E(l.$$.fragment,b),E(o.$$.fragment,b),E(m),E(d),h=!1},d(b){b&&K(e),j(t),j(l),j(o),m&&m.d(),g[u].d()}}}function vT(i){let e,t;return e=new No({props:{class:"w-full",$$slots:{default:[pT]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,r){const s={};r&8390640&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function bT(i){let e,t,n;return{c(){e=ve("div"),t=ve("canvas"),te(t,"id","board"),te(e,"class","w-full h-full canvasParent svelte-1axheft"),ri(()=>i[18].call(e))},m(r,s){$(r,e,s),ae(e,t),i[17](t),n=Hm(e,i[18].bind(e)),i[19](e)},p:Oe,d(r){r&&K(e),i[17](null),n(),i[19](null)}}}function yT(i){let e,t,n,r;return e=new Lo({props:{$$slots:{default:[vT]},$$scope:{ctx:i}}}),n=new Vs({props:{class:"h-5/6 bg-slate-100 rounded-b-2xl !p-0",$$slots:{default:[bT]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment),t=ue(),V(n.$$.fragment)},m(s,l){U(e,s,l),$(s,t,l),U(n,s,l),r=!0},p(s,l){const a={};l&8390640&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const o={};l&8388623&&(o.$$scope={dirty:l,ctx:s}),n.$set(o)},i(s){r||(T(e.$$.fragment,s),T(n.$$.fragment,s),r=!0)},o(s){E(e.$$.fragment,s),E(n.$$.fragment,s),r=!1},d(s){s&&K(t),j(e,s),j(n,s)}}}function _T(i){let e,t;return e=new js({props:{class:"m-4 h-full flex-grow !rounded-2xl",$$slots:{default:[yT]},$$scope:{ctx:i}}}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},p(n,[r]){const s={};r&8390655&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function CT(i,e,t){let n,r,s,l,a,o;Ct(i,mn,I=>t(5,n=I)),Ct(i,Zn,I=>t(6,r=I)),Ct(i,hr,I=>t(7,s=I)),Ct(i,un,I=>t(8,l=I)),Ct(i,Hn,I=>t(9,a=I)),Ct(i,cn,I=>t(10,o=I));let c,f,u,d,h,m,p;const g=Gr(),v=()=>g("maximize"),b=()=>g("minimize");Ui(()=>{setTimeout(()=>{f&&(c=new Wi.fabric.Canvas(f),t(4,p=new rC(c)),um.set(p))},500),m=new ResizeObserver(I=>{if(u&&(t(0,f.width=u.clientWidth,f),t(0,f.height=u.clientHeight,f),c)){const z=u.clientWidth/c.width;c.getObjects().forEach(Q=>{Q.scaleX=Q.scaleX*z,Q.scaleY=Q.scaleY*z,Q.left=Q.left*z,Q.top=Q.top*z,Q.setCoords()}),c.setWidth(u.clientWidth),c.setHeight(u.clientHeight),c.renderAll(),c.calcOffset()}}),m.observe(u)});const y=()=>p.addText();function _(I){r=I,Zn.set(r)}function S(I){s=I,hr.set(s)}const C=()=>{Jt(un,l=!1,l),Jt(Hn,a=!1,a),Jt(cn,o=!1,o)};function k(I){Fe[I?"unshift":"push"](()=>{f=I,t(0,f)})}function w(){d=this.clientHeight,h=this.clientWidth,t(2,d),t(3,h)}function A(I){Fe[I?"unshift":"push"](()=>{u=I,t(1,u)})}return[f,u,d,h,p,n,r,s,l,a,o,v,b,y,_,S,C,k,w,A]}class ST extends Ye{constructor(e){super(),He(this,e,CT,_T,Ve,{})}}function kT(i){let e,t,n,r,s,l,a,o,c,f;return{c(){e=ve("div"),t=ve("div"),t.textContent="Press 'ESC' to exit.",n=ue(),r=ve("canvas"),s=ue(),l=ve("canvas"),a=ue(),o=ve("div"),te(t,"class","fixed top-4 left-1/2 w-48 -ml-24 text-white bg-slate-700 rounded-lg flex items-center justify-start p-4 space-y-4 z-[100]"),te(r,"id","capturedStill"),te(l,"id","cropped"),te(o,"class",c="fixed !z-[50] cursor-crosshair "+(i[2]?"border-red-600":"")+" svelte-14lfei7"),te(o,"id","overlay"),te(e,"class",f=(i[2]?"fixed":"hidden")+" w-[100dvw] h-[100dvh] top-0 left-0 cursor-crosshair bg-contain bg-no-repeat bg-center"),te(e,"id","screenshotContainer")},m(u,d){$(u,e,d),ae(e,t),ae(e,n),ae(e,r),ae(e,s),ae(e,l),ae(e,a),ae(e,o),i[3](o),i[4](e)},p(u,[d]){d&4&&c!==(c="fixed !z-[50] cursor-crosshair "+(u[2]?"border-red-600":"")+" svelte-14lfei7")&&te(o,"class",c),d&4&&f!==(f=(u[2]?"fixed":"hidden")+" w-[100dvw] h-[100dvh] top-0 left-0 cursor-crosshair bg-contain bg-no-repeat bg-center")&&te(e,"class",f)},i:Oe,o:Oe,d(u){u&&K(e),i[3](null),i[4](null)}}}function TT(i,e,t){let n,r;Ct(i,um,h=>t(8,n=h)),Ct(i,Rr,h=>t(2,r=h));let s,l,a=!1,o,c;Ui(()=>{s.addEventListener("mousedown",h=>{a=!0,o=h.clientX,c=h.clientY}),s.addEventListener("mousemove",h=>{if(!a)return;const m=h.clientX-o,p=h.clientY-c,g=m>=0?o:h.clientX,v=p>=0?c:h.clientY;t(1,l.style.top=`${v}px`,l),t(1,l.style.left=`${g}px`,l),t(1,l.style.width=`${m}px`,l),t(1,l.style.height=`${p}px`,l)}),s.addEventListener("mouseup",async h=>{a=!1;const m=Math.abs(h.clientX-o),p=Math.abs(h.clientY-c);o<h.clientX||h.clientX,c<h.clientY||h.clientY;let v=document.getElementById("capturedStill").getContext("2d").getImageData(o,c,h.clientX,h.clientY);const b=document.getElementById("cropped");b.width=m,b.height=p,b.getContext("2d").putImageData(v,0,0);const y=b.toDataURL("image/png");Jt(Rr,r=!1,r),n.finishTakingScreenshot(y)})});const f=async h=>{h.code==="Escape"&&(document.body.style.cursor="auto",Rr.set(!1),t(0,s.style.backgroundImage="none",s))};Rr.subscribe(h=>{if(h){window.addEventListener("keydown",f);return}window.removeEventListener("keydown",f)});function u(h){Fe[h?"unshift":"push"](()=>{l=h,t(1,l)})}function d(h){Fe[h?"unshift":"push"](()=>{s=h,t(0,s)})}return[s,l,r,u,d]}class wT extends Ye{constructor(e){super(),He(this,e,TT,kT,Ve,{})}}function PT(i){let e;return{c(){e=ve("div"),e.innerHTML='<div class="loader svelte-1r9qpz0"></div>',te(e,"class","w-[100dvw] h-[100dvh] z-[200] bg-slate-600 grid place-items-center")},m(t,n){$(t,e,n)},p:Oe,i:Oe,o:Oe,d(t){t&&K(e)}}}class ET extends Ye{constructor(e){super(),He(this,e,null,PT,Ve,{})}}function If(i){let e,t;return e=new ET({}),{c(){V(e.$$.fragment)},m(n,r){U(e,n,r),t=!0},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){j(e,n)}}}function Lf(i){let e,t,n;return t=new wT({}),{c(){e=ve("div"),V(t.$$.fragment),te(e,"class","w-[100dvw] h-[100dvh] z-[100] overflow-hidden")},m(r,s){$(r,e,s),U(t,e,null),n=!0},i(r){n||(T(t.$$.fragment,r),n=!0)},o(r){E(t.$$.fragment,r),n=!1},d(r){r&&K(e),j(t)}}}function OT(i){let e,t,n,r,s,l,a,o,c,f,u=!i[6]&&Nf(i);l=new kS({}),l.$on("maximize",JC),l.$on("minimize",qC);let d=!i[7]&&Ff(i);return{c(){e=ve("div"),t=ve("div"),n=ve("div"),u&&u.c(),r=ue(),s=ve("div"),V(l.$$.fragment),c=ue(),d&&d.c(),te(s,"class",a="h-full flex flex-col w-full "+(i[8]?"xl:w-full":i[7]&&!i[6]?"xl:w-2/3":"xl:w-1/3")+" max-w-full"),te(n,"class","h-full w-full flex gap-4"),te(t,"class","h-full w-full border-2 border-black rounded-xl"),te(e,"class","w-[100dvw] h-[100dvh] bg-white p-2 overflow-hidden")},m(h,m){$(h,e,m),ae(e,t),ae(t,n),u&&u.m(n,null),ae(n,r),ae(n,s),U(l,s,null),ae(n,c),d&&d.m(n,null),f=!0},p(h,m){h[6]?u&&(Je(),E(u,1,1,()=>{u=null}),qe()):u?(u.p(h,m),m&64&&T(u,1)):(u=Nf(h),u.c(),T(u,1),u.m(n,r)),(!f||m&448&&a!==(a="h-full flex flex-col w-full "+(h[8]?"xl:w-full":h[7]&&!h[6]?"xl:w-2/3":"xl:w-1/3")+" max-w-full"))&&te(s,"class",a),h[7]?d&&(Je(),E(d,1,1,()=>{d=null}),qe()):d?(d.p(h,m),m&128&&T(d,1)):(d=Ff(h),d.c(),T(d,1),d.m(n,null))},i(h){f||(T(u),T(l.$$.fragment,h),h&&ri(()=>{f&&(o||(o=jt(s,Vt,{axis:"x"},!0)),o.run(1))}),T(d),f=!0)},o(h){E(u),E(l.$$.fragment,h),h&&(o||(o=jt(s,Vt,{axis:"x"},!1)),o.run(0)),E(d),f=!1},d(h){h&&K(e),u&&u.d(),j(l),h&&o&&o.end(),d&&d.d()}}}function xT(i){let e,t,n,r,s,l,a,o,c,f,u,d,h,m,p;function g(C){i[11](C)}let v={placeholder:"Enter Username"};i[2]!==void 0&&(v.value=i[2]),n=new gc({props:v}),Fe.push(()=>nt(n,"value",g));function b(C){i[12](C)}let y={placeholder:"Enter A Room Name"};i[1]!==void 0&&(y.value=i[1]),l=new gc({props:y}),Fe.push(()=>nt(l,"value",b)),c=new Vv({props:{class:"my-8",$$slots:{default:[AT]},$$scope:{ctx:i}}});function _(C){i[13](C)}let S={placeholder:"Paste your token",disabled:i[2]!=""||i[1]!=""};return i[3]!==void 0&&(S.value=i[3]),u=new n0({props:S}),Fe.push(()=>nt(u,"value",_)),m=new rt({props:{class:"w-full",color:"primary",$$slots:{default:[DT]},$$scope:{ctx:i}}}),m.$on("click",i[10]),{c(){e=ve("div"),t=ve("div"),V(n.$$.fragment),s=ue(),V(l.$$.fragment),o=ue(),V(c.$$.fragment),f=ue(),V(u.$$.fragment),h=ue(),V(m.$$.fragment),te(t,"class","space-y-2 w-11/12 md:w-1/3"),te(e,"class","grid place-items-center w-[100dvw] h-[100dvh] bg-red-300")},m(C,k){$(C,e,k),ae(e,t),U(n,t,null),ae(t,s),U(l,t,null),ae(t,o),U(c,t,null),ae(t,f),U(u,t,null),ae(t,h),U(m,t,null),p=!0},p(C,k){const w={};!r&&k&4&&(r=!0,w.value=C[2],lt(()=>r=!1)),n.$set(w);const A={};!a&&k&2&&(a=!0,A.value=C[1],lt(()=>a=!1)),l.$set(A);const I={};k&32768&&(I.$$scope={dirty:k,ctx:C}),c.$set(I);const z={};k&6&&(z.disabled=C[2]!=""||C[1]!=""),!d&&k&8&&(d=!0,z.value=C[3],lt(()=>d=!1)),u.$set(z);const H={};k&32768&&(H.$$scope={dirty:k,ctx:C}),m.$set(H)},i(C){p||(T(n.$$.fragment,C),T(l.$$.fragment,C),T(c.$$.fragment,C),T(u.$$.fragment,C),T(m.$$.fragment,C),p=!0)},o(C){E(n.$$.fragment,C),E(l.$$.fragment,C),E(c.$$.fragment,C),E(u.$$.fragment,C),E(m.$$.fragment,C),p=!1},d(C){C&&K(e),j(n),j(l),j(c),j(u),j(m)}}}function Nf(i){let e,t,n,r;return t=new xC({}),t.$on("hideChat",i[14]),{c(){e=ve("div"),V(t.$$.fragment),te(e,"class","h-full hidden w-1/3 xl:flex")},m(s,l){$(s,e,l),U(t,e,null),r=!0},p:Oe,i(s){r||(T(t.$$.fragment,s),s&&ri(()=>{r&&(n||(n=jt(e,Vt,{axis:"x"},!0)),n.run(1))}),r=!0)},o(s){E(t.$$.fragment,s),s&&(n||(n=jt(e,Vt,{axis:"x"},!1)),n.run(0)),r=!1},d(s){s&&K(e),j(t),s&&n&&n.end()}}}function Ff(i){let e,t,n,r,s;return t=new ST({}),t.$on("maximize",KC),t.$on("minimize",QC),{c(){e=ve("div"),V(t.$$.fragment),te(e,"class",n="h-full hidden "+(i[9]||i[6]?i[6]?"w-2/3":"w-full":"w-1/3")+" xl:flex")},m(l,a){$(l,e,a),U(t,e,null),s=!0},p(l,a){(!s||a&576&&n!==(n="h-full hidden "+(l[9]||l[6]?l[6]?"w-2/3":"w-full":"w-1/3")+" xl:flex"))&&te(e,"class",n)},i(l){s||(T(t.$$.fragment,l),l&&ri(()=>{s&&(r||(r=jt(e,Vt,{axis:"x"},!0)),r.run(1))}),s=!0)},o(l){E(t.$$.fragment,l),l&&(r||(r=jt(e,Vt,{axis:"x"},!1)),r.run(0)),s=!1},d(l){l&&K(e),j(t),l&&r&&r.end()}}}function AT(i){let e;return{c(){e=et("Or")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function DT(i){let e;return{c(){e=et("Join")},m(t,n){$(t,e,n)},d(t){t&&K(e)}}}function RT(i){let e,t,n,r,s,l,a,o,c=i[0]&&If(),f=i[4]&&Lf();const u=[xT,OT],d=[];function h(m,p){return m[5]?1:0}return s=h(i),l=d[s]=u[s](i),{c(){e=ve("link"),t=ue(),c&&c.c(),n=ue(),f&&f.c(),r=ue(),l.c(),a=Rt(),te(e,"rel","stylesheet"),te(e,"href",rg),document.title="Instrukti Call"},m(m,p){ae(document.head,e),$(m,t,p),c&&c.m(m,p),$(m,n,p),f&&f.m(m,p),$(m,r,p),d[s].m(m,p),$(m,a,p),o=!0},p(m,[p]){m[0]?c?p&1&&T(c,1):(c=If(),c.c(),T(c,1),c.m(n.parentNode,n)):c&&(Je(),E(c,1,1,()=>{c=null}),qe()),m[4]?f?p&16&&T(f,1):(f=Lf(),f.c(),T(f,1),f.m(r.parentNode,r)):f&&(Je(),E(f,1,1,()=>{f=null}),qe());let g=s;s=h(m),s===g?d[s].p(m,p):(Je(),E(d[g],1,1,()=>{d[g]=null}),qe(),l=d[s],l?l.p(m,p):(l=d[s]=u[s](m),l.c()),T(l,1),l.m(a.parentNode,a))},i(m){o||(T(c),T(f),T(l),o=!0)},o(m){E(c),E(f),E(l),o=!1},d(m){m&&(K(t),K(n),K(r),K(a)),K(e),c&&c.d(m),f&&f.d(m),d[s].d(m)}}}function MT(i,e,t){let n,r,s,l,a,o;Ct(i,Rr,b=>t(4,n=b)),Ct(i,uo,b=>t(5,r=b)),Ct(i,un,b=>t(6,s=b)),Ct(i,Is,b=>t(7,l=b)),Ct(i,Hn,b=>t(8,a=b)),Ct(i,cn,b=>t(9,o=b));let c=!0;Ui(()=>{window.onload=()=>{t(0,c=!1)}});let f="",u="",d="";const h=async()=>{if(u!=""||f!=""){const b=await lC(u,f);uo.set(b)}d!=""&&uo.set(d)};function m(b){u=b,t(2,u)}function p(b){f=b,t(1,f)}function g(b){d=b,t(3,d)}return[c,f,u,d,n,r,s,l,a,o,h,m,p,g,()=>{Jt(un,s=!0,s),l?Jt(Hn,a=!0,a):Jt(cn,o=!0,o)}]}class IT extends Ye{constructor(e){super(),He(this,e,MT,RT,Ve,{})}}new IT({target:document.getElementById("app")});export{NT as c,FT as g};
